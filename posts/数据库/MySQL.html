<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.50" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mister-hope.github.io/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL.html"><meta property="og:site_name" content="È∫ªËä±ÁöÑÂ∞èÁ´ô"><meta property="og:title" content="MySQL"><meta property="og:description" content="MySQL ÁÆÄ‰ªã Êï∞ÊçÆÂ∫ì Êï∞ÊçÆÂ∫ìÔºöDataBaseÔºåÁÆÄÁß∞ DBÔºåÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÊï∞ÊçÆÁöÑ‰ªìÂ∫ì Êï∞ÊçÆÂ∫ìÁöÑ‰ºòÂäøÔºö ÂèØ‰ª•ÊåÅ‰πÖÂåñÂ≠òÂÇ®Êï∞ÊçÆ Êñπ‰æøÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÊï∞ÊçÆ ‰ΩøÁî®‰∫ÜÁªü‰∏ÄÁöÑÊñπÂºèÊìç‰ΩúÊï∞ÊçÆÂ∫ì SQL Êï∞ÊçÆÂ∫ì„ÄÅÊï∞ÊçÆË°®„ÄÅÊï∞ÊçÆÁöÑÂÖ≥Á≥ª‰ªãÁªçÔºö Êï∞ÊçÆÂ∫ì Áî®‰∫éÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÊï∞ÊçÆÁöÑ‰ªìÂ∫ì ‰∏Ä‰∏™Â∫ì‰∏≠ÂèØ‰ª•ÂåÖÂê´Â§ö‰∏™Êï∞ÊçÆË°® Êï∞ÊçÆË°® Êï∞ÊçÆÂ∫ìÊúÄÈáçË¶ÅÁöÑÁªÑÊàêÈÉ®ÂàÜ‰πã‰∏Ä Áî±Á∫µÂêëÁöÑÂàóÂíåÊ®™ÂêëÁöÑË°åÁªÑÊàêÔºàÁ±ª‰ºº excel ..."><meta property="og:type" content="article"><meta property="og:image" content="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-10-23T09:26:56.000Z"><meta property="article:author" content="Jack-Chen"><meta property="article:tag" content="ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ì"><meta property="article:tag" content="ËßÜÂõæ"><meta property="article:tag" content="Á¥¢Âºï"><meta property="article:tag" content="‰∫ãÂä°"><meta property="article:published_time" content="2023-01-14T00:00:00.000Z"><meta property="article:modified_time" content="2024-10-23T09:26:56.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"MySQL","image":["https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%9D%83%E9%99%90%E8%8C%83%E5%9B%B4.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SHOW_PROCESSLIST%E5%91%BD%E4%BB%A4.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2%E5%A4%87%E4%BB%BD.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2%E6%81%A2%E5%A4%8D.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQL%E5%88%86%E7%B1%BB.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-DQL%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E5%9B%BE%E8%A7%A3.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E5%A4%9A%E8%A1%A8%E8%AE%BE%E8%AE%A1%E4%B8%80%E5%AF%B9%E4%B8%80.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E5%A4%9A%E8%A1%A8%E8%AE%BE%E8%AE%A1%E4%B8%80%E5%AF%B9%E5%A4%9A.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E5%A4%9A%E8%A1%A8%E8%AE%BE%E8%AE%A1%E5%A4%9A%E5%AF%B9%E5%A4%9A.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-JOIN%E6%9F%A5%E8%AF%A2%E5%9B%BE.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E8%87%AA%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E5%A4%9A%E8%A1%A8%E7%BB%83%E4%B9%A0%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687067490344.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687067452908.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687068663823.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687222999294.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687223807376.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687224588959.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687224857362.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687225707609.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687225756413.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1686905882743.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MERGE.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BB%8B%E7%BB%8D.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E7%BB%84%E5%90%88%E7%B4%A2%E5%BC%95%E5%9B%BE.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%E8%81%9A%E7%B0%87%E5%92%8C%E8%BE%85%E5%8A%A9%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E5%92%8C%E8%BE%85%E5%8A%A9%E7%B4%A2%E5%BC%95%E6%A3%80%E9%94%81%E6%95%B0%E6%8D%AE%E5%9B%BE.jpg","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM%E4%B8%BB%E9%94%AE%E5%92%8C%E8%BE%85%E5%8A%A9%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTree%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B1.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTree%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B2.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTree%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B3.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTree%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B4.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTree%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B5.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTree%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B6.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTree%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B7.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTree%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B8.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E7%B4%A2%E5%BC%95%E7%9A%84%E5%8E%9F%E7%90%861.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E7%B4%A2%E5%BC%95%E7%9A%84%E5%8E%9F%E7%90%862.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%B8%8D%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8%E4%BC%98%E5%8C%961.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8%E4%BC%98%E5%8C%962.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQL%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E9%A2%91%E7%8E%87.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQL%E8%AF%AD%E5%8F%A5%E5%BD%B1%E5%93%8D%E7%9A%84%E8%A1%8C%E6%95%B0.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SHOW_PROCESSLIST%E5%91%BD%E4%BB%A4-1720750205638-6.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-explain%E6%9F%A5%E8%AF%A2SQL%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-explain%E4%B9%8Bid%E7%9B%B8%E5%90%8C.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-explain%E4%B9%8Bid%E4%B8%8D%E5%90%8C.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-explain%E4%B9%8Bid%E7%9B%B8%E5%90%8C%E5%92%8C%E4%B8%8D%E5%90%8C.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-have_profiling.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-profiling.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%9F%A5%E7%9C%8BSQL%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E8%80%97%E6%97%B6.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQL%E6%89%A7%E8%A1%8C%E6%AF%8F%E4%B8%AA%E7%8A%B6%E6%80%81%E6%B6%88%E8%80%97%E7%9A%84%E6%97%B6%E9%97%B4.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQL%E6%89%A7%E8%A1%8C%E6%AF%8F%E4%B8%AA%E7%8A%B6%E6%80%81%E6%B6%88%E8%80%97%E7%9A%84CPU.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%951.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%952.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%953.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%954.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%955.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%956.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%957.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%9510.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%9511.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%9512.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%9513.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%9514.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%9515.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%863.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E6%9F%A5%E7%9C%8B%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053539419.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053603265.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053617687.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053680135.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053697186.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053720439.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053735874.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053753314.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053766267.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053801878.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053884009.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053897233.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053911184.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053921836.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053930426.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%958.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%959.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%20load%20data.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E6%8F%92%E5%85%A5ID%E9%A1%BA%E5%BA%8F%E6%8E%92%E5%88%97%E6%95%B0%E6%8D%AE.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E6%8F%92%E5%85%A5ID%E6%97%A0%E5%BA%8F%E6%8E%92%E5%88%97%E6%95%B0%E6%8D%AE.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE%E5%85%B3%E9%97%AD%E5%94%AF%E4%B8%80%E6%80%A7%E6%A0%A1%E9%AA%8C.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE%E6%89%8B%E5%8A%A8%E6%8F%90%E4%BA%A4%E4%BA%8B%E5%8A%A1.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%20ORDER%20BY%E6%8E%92%E5%BA%8F1.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%20ORDER%20BY%E6%8E%92%E5%BA%8F2.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%20ORDER%20BY%E6%8E%92%E5%BA%8F3.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%20GROUP%20BY%E6%8E%92%E5%BA%8F1.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%20GROUP%20BY%E6%8E%92%E5%BA%8F2.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%20GROUP%20BY%E6%8E%92%E5%BA%8F3.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%20OR%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A21.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%20OR%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A22.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A21.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A22.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A21.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A22.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A23.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E6%8F%90%E7%A4%BA1.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E6%8F%90%E7%A4%BA2.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%BC%98%E5%8C%96SQL%E4%BD%BF%E7%94%A8%E6%8F%90%E7%A4%BA3.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687226636543.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MVCC%E7%89%88%E6%9C%AC%E9%93%BE%E9%9A%90%E8%97%8F%E5%AD%97%E6%AE%B5.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MVCC%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B1.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MVCC%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B2.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687227607521.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687097771548.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM%20%E9%94%81%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM%20%E8%AF%BB%E9%94%811.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM%20%E8%AF%BB%E9%94%812.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM%20%E8%AF%BB%E9%94%813.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM%20%E5%86%99%E9%94%811.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM%20%E5%86%99%E9%94%812.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E9%94%81%E4%BA%89%E7%94%A8%E6%83%85%E5%86%B5%E6%9F%A5%E7%9C%8B1.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E9%94%81%E4%BA%89%E7%94%A8%E6%83%85%E5%86%B5%E6%9F%A5%E7%9C%8B2.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM%20%E9%94%81%E7%8A%B6%E6%80%81.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687173958031.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687173976336.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687173999332.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687174241521.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%20%E9%94%81%E6%93%8D%E4%BD%9C1.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%20%E9%94%81%E6%93%8D%E4%BD%9C2.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%20%E9%94%81%E6%93%8D%E4%BD%9C3.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%20%E9%94%81%E6%93%8D%E4%BD%9C4.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%20%E9%94%81%E6%93%8D%E4%BD%9C5.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%20%E9%94%81%E6%93%8D%E4%BD%9C6.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%20%E9%97%B4%E9%9A%99%E9%94%811.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%20%E9%97%B4%E9%9A%99%E9%94%812.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%84%8F%E5%90%91%E9%94%81%E5%85%BC%E5%AE%B9%E6%80%A7.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%20%E9%94%81%E5%8D%87%E7%BA%A7.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB%E6%9F%A5%E7%9C%8B%E9%94%81%E7%8A%B6%E6%80%81.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86%E5%9B%BE.jpg","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6.jpg","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%9F%A5%E7%9C%8Bmaster%E7%8A%B6%E6%80%81.jpg","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E9%AA%8C%E8%AF%811.jpg","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E9%AA%8C%E8%AF%812.jpg","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%97%A5%E5%BF%97%E8%AF%BB%E5%8F%961.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%97%A5%E5%BF%97%E8%AF%BB%E5%8F%962.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%85%A2%E6%97%A5%E5%BF%97%E8%AF%BB%E5%8F%961.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-%E6%85%A2%E6%97%A5%E5%BF%97%E8%AF%BB%E5%8F%962.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E6%99%AE%E9%80%9A%E8%A1%A8.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E7%AC%AC%E4%B8%80%E8%8C%83%E5%BC%8F.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E7%AC%AC%E4%BA%8C%E8%8C%83%E5%BC%8F.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F.png","https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/%E4%B8%89%E5%A4%A7%E8%8C%83%E5%BC%8F.png"],"datePublished":"2023-01-14T00:00:00.000Z","dateModified":"2024-10-23T09:26:56.000Z","author":[{"@type":"Person","name":"Jack-Chen","url":"https://chemnminghe.top"}]}</script><title>MySQL | È∫ªËä±ÁöÑÂ∞èÁ´ô</title><meta name="description" content="MySQL ÁÆÄ‰ªã Êï∞ÊçÆÂ∫ì Êï∞ÊçÆÂ∫ìÔºöDataBaseÔºåÁÆÄÁß∞ DBÔºåÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÊï∞ÊçÆÁöÑ‰ªìÂ∫ì Êï∞ÊçÆÂ∫ìÁöÑ‰ºòÂäøÔºö ÂèØ‰ª•ÊåÅ‰πÖÂåñÂ≠òÂÇ®Êï∞ÊçÆ Êñπ‰æøÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÊï∞ÊçÆ ‰ΩøÁî®‰∫ÜÁªü‰∏ÄÁöÑÊñπÂºèÊìç‰ΩúÊï∞ÊçÆÂ∫ì SQL Êï∞ÊçÆÂ∫ì„ÄÅÊï∞ÊçÆË°®„ÄÅÊï∞ÊçÆÁöÑÂÖ≥Á≥ª‰ªãÁªçÔºö Êï∞ÊçÆÂ∫ì Áî®‰∫éÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÊï∞ÊçÆÁöÑ‰ªìÂ∫ì ‰∏Ä‰∏™Â∫ì‰∏≠ÂèØ‰ª•ÂåÖÂê´Â§ö‰∏™Êï∞ÊçÆË°® Êï∞ÊçÆË°® Êï∞ÊçÆÂ∫ìÊúÄÈáçË¶ÅÁöÑÁªÑÊàêÈÉ®ÂàÜ‰πã‰∏Ä Áî±Á∫µÂêëÁöÑÂàóÂíåÊ®™ÂêëÁöÑË°åÁªÑÊàêÔºàÁ±ª‰ºº excel ...">
    <link rel="preload" href="/assets/style-Tnuk6l9P.css" as="style"><link rel="stylesheet" href="/assets/style-Tnuk6l9P.css">
    <link rel="modulepreload" href="/assets/app-BYKnUcUk.js"><link rel="modulepreload" href="/assets/MySQL.html-DSI5_9CS.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-Dg26PWDC.js" as="script"><link rel="prefetch" href="/assets/intro.html-KFRiDOsS.js" as="script"><link rel="prefetch" href="/assets/index.html-DXVMGbK_.js" as="script"><link rel="prefetch" href="/assets/index.html-BlkC4sOC.js" as="script"><link rel="prefetch" href="/assets/page.html-8eF0DMIs.js" as="script"><link rel="prefetch" href="/assets/Âåó‰∫¨‰∏≠ÁßëËΩØ.html-Bck9Ovvv.js" as="script"><link rel="prefetch" href="/assets/Âåó‰∫¨Èë´‰∏áÂÆ∂ÁßëÊäÄ.html-DJyWw-CE.js" as="script"><link rel="prefetch" href="/assets/Âçó‰∫¨‰∏≠ÁßëËΩØ.html-CawQ2rVf.js" as="script"><link rel="prefetch" href="/assets/Â§©Ê¥•ÂáΩÊï∞ËßÜÁïå.html-C-TiMN6Z.js" as="script"><link rel="prefetch" href="/assets/ÂÆâÁ°ï‰ø°ÊÅØ(‰∏úÂåóÈÉ®).html-DVi4BHIU.js" as="script"><link rel="prefetch" href="/assets/ÁîòËÇÉ‰∏≠Â∑•ÂõΩÈôÖ.html-NtUMCt1j.js" as="script"><link rel="prefetch" href="/assets/index.html-DMDh3LDY.js" as="script"><link rel="prefetch" href="/assets/index.html-CqzzyQnl.js" as="script"><link rel="prefetch" href="/assets/disable.html-BOrrIM9r.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-DymZ1DOG.js" as="script"><link rel="prefetch" href="/assets/layout.html-A-c9Ggq0.js" as="script"><link rel="prefetch" href="/assets/markdown.html-C8O_PvDt.js" as="script"><link rel="prefetch" href="/assets/page.html-D2smeGlL.js" as="script"><link rel="prefetch" href="/assets/JUC.html-Cj4sCeFN.js" as="script"><link rel="prefetch" href="/assets/JVM.html-DYElkVqJ.js" as="script"><link rel="prefetch" href="/assets/JavaSE.html-Bkoiz6tX.js" as="script"><link rel="prefetch" href="/assets/JavaWeb.html-DWKKED3-.js" as="script"><link rel="prefetch" href="/assets/vue.html-oadawlZV.js" as="script"><link rel="prefetch" href="/assets/Spring.html-wHqo2Q3V.js" as="script"><link rel="prefetch" href="/assets/SpringBoot.html-BZDOUqnu.js" as="script"><link rel="prefetch" href="/assets/SpringMVC.html-BFlMmh-4.js" as="script"><link rel="prefetch" href="/assets/SpringSecurity.html-B3j2Lg8l.js" as="script"><link rel="prefetch" href="/assets/Docker.html-Cy9ibnN8.js" as="script"><link rel="prefetch" href="/assets/Git.html-BlQ49nEZ.js" as="script"><link rel="prefetch" href="/assets/Gradle.html-Dnu6SacT.js" as="script"><link rel="prefetch" href="/assets/Nginx.html-D300gZ6D.js" as="script"><link rel="prefetch" href="/assets/maven.html-CGWWO-4T.js" as="script"><link rel="prefetch" href="/assets/2.html-CKmB1act.js" as="script"><link rel="prefetch" href="/assets/Dubbo.html-7U0rTwA0.js" as="script"><link rel="prefetch" href="/assets/zookeeper.html-BmWaRG4e.js" as="script"><link rel="prefetch" href="/assets/2.html-C8mvFmp5.js" as="script"><link rel="prefetch" href="/assets/3.html-k7U_2ikD.js" as="script"><link rel="prefetch" href="/assets/È°πÁõÆ‰ªãÁªç.html-BWz1Qj32.js" as="script"><link rel="prefetch" href="/assets/elasticsearch.html--akDBJ2P.js" as="script"><link rel="prefetch" href="/assets/RocketMQ.html-BP4wCjEU.js" as="script"><link rel="prefetch" href="/assets/1.html-B-pCz_Xa.js" as="script"><link rel="prefetch" href="/assets/2.html-B1MtwO_F.js" as="script"><link rel="prefetch" href="/assets/3.html-DMy2siDl.js" as="script"><link rel="prefetch" href="/assets/Linux.html-DOMAI1Pp.js" as="script"><link rel="prefetch" href="/assets/Êìç‰ΩúÁ≥ªÁªü.html-DikAXKka.js" as="script"><link rel="prefetch" href="/assets/ËÆ°ÁÆóÊú∫ÁΩëÁªú.html-D4YsVC3c.js" as="script"><link rel="prefetch" href="/assets/1.html-CBzzi2bS.js" as="script"><link rel="prefetch" href="/assets/2.html-CtkFT2MW.js" as="script"><link rel="prefetch" href="/assets/3.html-DyPE17VK.js" as="script"><link rel="prefetch" href="/assets/1.html-BYP8voes.js" as="script"><link rel="prefetch" href="/assets/2.html-B-VuoRyO.js" as="script"><link rel="prefetch" href="/assets/3.html-CFhbBSzB.js" as="script"><link rel="prefetch" href="/assets/1.html-Dfi4JgTT.js" as="script"><link rel="prefetch" href="/assets/2.html-3Ej9hRsH.js" as="script"><link rel="prefetch" href="/assets/3.html-mXKabJxq.js" as="script"><link rel="prefetch" href="/assets/ÂéüÁêÜÁØá.html-DUjvfC2M.js" as="script"><link rel="prefetch" href="/assets/Âü∫Á°ÄÁØá.html-BLI3gQ9e.js" as="script"><link rel="prefetch" href="/assets/ÂÆûÊàòÁØá.html-CU5N4Ilp.js" as="script"><link rel="prefetch" href="/assets/È´òÁ∫ßÁØá.html-p9YGWfFF.js" as="script"><link rel="prefetch" href="/assets/404.html-HcIB-o9i.js" as="script"><link rel="prefetch" href="/assets/index.html-De94tPkF.js" as="script"><link rel="prefetch" href="/assets/index.html-ByvX0y-H.js" as="script"><link rel="prefetch" href="/assets/index.html-DmZGQL8T.js" as="script"><link rel="prefetch" href="/assets/index.html-C0afhGvF.js" as="script"><link rel="prefetch" href="/assets/index.html-wL1ZfdOf.js" as="script"><link rel="prefetch" href="/assets/index.html-eMvOoaZC.js" as="script"><link rel="prefetch" href="/assets/index.html-BmRkjHr_.js" as="script"><link rel="prefetch" href="/assets/index.html-DpHBumR0.js" as="script"><link rel="prefetch" href="/assets/index.html-DysWg-Eb.js" as="script"><link rel="prefetch" href="/assets/index.html-BJeBBKlO.js" as="script"><link rel="prefetch" href="/assets/index.html-DPs9VwAX.js" as="script"><link rel="prefetch" href="/assets/index.html-CkIkyL6y.js" as="script"><link rel="prefetch" href="/assets/index.html-PJluwjn2.js" as="script"><link rel="prefetch" href="/assets/index.html-DovcwOVQ.js" as="script"><link rel="prefetch" href="/assets/index.html-6-xupXrt.js" as="script"><link rel="prefetch" href="/assets/index.html-D4KrBOga.js" as="script"><link rel="prefetch" href="/assets/index.html-CAkSL-EB.js" as="script"><link rel="prefetch" href="/assets/index.html-DpTuR_ad.js" as="script"><link rel="prefetch" href="/assets/index.html-V6g9-9RJ.js" as="script"><link rel="prefetch" href="/assets/index.html-CYkxHVb0.js" as="script"><link rel="prefetch" href="/assets/index.html-BH7kxkTh.js" as="script"><link rel="prefetch" href="/assets/index.html-ZDUam0Bi.js" as="script"><link rel="prefetch" href="/assets/index.html-hwnE4f7-.js" as="script"><link rel="prefetch" href="/assets/index.html-eAo-BbE2.js" as="script"><link rel="prefetch" href="/assets/index.html-CSTxZy1d.js" as="script"><link rel="prefetch" href="/assets/index.html-BY1NzVnX.js" as="script"><link rel="prefetch" href="/assets/index.html-CN0R_zgD.js" as="script"><link rel="prefetch" href="/assets/index.html-DlnBlkCQ.js" as="script"><link rel="prefetch" href="/assets/index.html-Bu8UcH2W.js" as="script"><link rel="prefetch" href="/assets/index.html-DWCXfRVF.js" as="script"><link rel="prefetch" href="/assets/index.html-DjhPDlDo.js" as="script"><link rel="prefetch" href="/assets/index.html-EqhIMeyP.js" as="script"><link rel="prefetch" href="/assets/index.html-DTI8Yt-I.js" as="script"><link rel="prefetch" href="/assets/index.html-lh4uVlGB.js" as="script"><link rel="prefetch" href="/assets/index.html-cIfrys5U.js" as="script"><link rel="prefetch" href="/assets/index.html-CjQudSQG.js" as="script"><link rel="prefetch" href="/assets/index.html-Dpp1nhq1.js" as="script"><link rel="prefetch" href="/assets/index.html-f-CbCiWH.js" as="script"><link rel="prefetch" href="/assets/index.html-iRFzr8Ry.js" as="script"><link rel="prefetch" href="/assets/index.html-BF6v9vBj.js" as="script"><link rel="prefetch" href="/assets/index.html-BA5bibSx.js" as="script"><link rel="prefetch" href="/assets/index.html-CAQayavk.js" as="script"><link rel="prefetch" href="/assets/index.html-DGHxWL1t.js" as="script"><link rel="prefetch" href="/assets/index.html-B57g5aL0.js" as="script"><link rel="prefetch" href="/assets/index.html-BOzDqnUC.js" as="script"><link rel="prefetch" href="/assets/index.html-B-C72qpx.js" as="script"><link rel="prefetch" href="/assets/index.html-BOnn7tpN.js" as="script"><link rel="prefetch" href="/assets/index.html-DhdpaJ0q.js" as="script"><link rel="prefetch" href="/assets/index.html-DPh0Ij6g.js" as="script"><link rel="prefetch" href="/assets/index.html-KvXzk4j_.js" as="script"><link rel="prefetch" href="/assets/index.html-B4QHnHFp.js" as="script"><link rel="prefetch" href="/assets/index.html-CbHuVcPi.js" as="script"><link rel="prefetch" href="/assets/index.html-OU-yfYV-.js" as="script"><link rel="prefetch" href="/assets/index.html-DyiZHthR.js" as="script"><link rel="prefetch" href="/assets/index.html-amzcZaBg.js" as="script"><link rel="prefetch" href="/assets/index.html-x93sL2WV.js" as="script"><link rel="prefetch" href="/assets/index.html-B1ASKpuy.js" as="script"><link rel="prefetch" href="/assets/index.html-D-Vu4wEk.js" as="script"><link rel="prefetch" href="/assets/index.html-D1PaZ4Px.js" as="script"><link rel="prefetch" href="/assets/index.html-ByHe7rrM.js" as="script"><link rel="prefetch" href="/assets/index.html-iYl8oOWK.js" as="script"><link rel="prefetch" href="/assets/index.html-C2TJv6D3.js" as="script"><link rel="prefetch" href="/assets/index.html-CcmzxkUK.js" as="script"><link rel="prefetch" href="/assets/index.html-CS9wFxAs.js" as="script"><link rel="prefetch" href="/assets/index.html-CusJJHmz.js" as="script"><link rel="prefetch" href="/assets/index.html-XBfBFw9n.js" as="script"><link rel="prefetch" href="/assets/index.html-Bb9TU5uP.js" as="script"><link rel="prefetch" href="/assets/index.html-DW06xorC.js" as="script"><link rel="prefetch" href="/assets/index.html-BAJiDExF.js" as="script"><link rel="prefetch" href="/assets/index.html-D2Fi0_YV.js" as="script"><link rel="prefetch" href="/assets/index.html-BLdCr4hE.js" as="script"><link rel="prefetch" href="/assets/index.html-5XkYVEn9.js" as="script"><link rel="prefetch" href="/assets/index.html-lC-C7DH-.js" as="script"><link rel="prefetch" href="/assets/index.html-BozW6VZQ.js" as="script"><link rel="prefetch" href="/assets/index.html-DA9gqjbM.js" as="script"><link rel="prefetch" href="/assets/index.html-DS1ygI10.js" as="script"><link rel="prefetch" href="/assets/index.html-DCO33K0q.js" as="script"><link rel="prefetch" href="/assets/index.html-d5-3wl__.js" as="script"><link rel="prefetch" href="/assets/index.html-BnTM10cR.js" as="script"><link rel="prefetch" href="/assets/index.html-CU0EkorC.js" as="script"><link rel="prefetch" href="/assets/index.html-BSpai6iX.js" as="script"><link rel="prefetch" href="/assets/index.html-CAqEV4PP.js" as="script"><link rel="prefetch" href="/assets/index.html-BEqMhOv2.js" as="script"><link rel="prefetch" href="/assets/index.html-9dOH66Vh.js" as="script"><link rel="prefetch" href="/assets/index.html-x-2WSG3b.js" as="script"><link rel="prefetch" href="/assets/index.html-Dh4QBATH.js" as="script"><link rel="prefetch" href="/assets/index.html-DdvC0JR-.js" as="script"><link rel="prefetch" href="/assets/index.html-DB9Ce9bK.js" as="script"><link rel="prefetch" href="/assets/index.html-GY66i-NL.js" as="script"><link rel="prefetch" href="/assets/index.html-DVd6jweh.js" as="script"><link rel="prefetch" href="/assets/index.html-BsDJyw0T.js" as="script"><link rel="prefetch" href="/assets/index.html-tMlsy0Tt.js" as="script"><link rel="prefetch" href="/assets/index.html-qJ9VOzN6.js" as="script"><link rel="prefetch" href="/assets/index.html-DW6AtmgZ.js" as="script"><link rel="prefetch" href="/assets/index.html-CcE36Sae.js" as="script"><link rel="prefetch" href="/assets/index.html-Cy2lF-_O.js" as="script"><link rel="prefetch" href="/assets/index.html-BTrnHnwl.js" as="script"><link rel="prefetch" href="/assets/index.html-D_AHdFea.js" as="script"><link rel="prefetch" href="/assets/index.html-DCbCRxOr.js" as="script"><link rel="prefetch" href="/assets/index.html-BZJtHztz.js" as="script"><link rel="prefetch" href="/assets/index.html-BcK4qFOY.js" as="script"><link rel="prefetch" href="/assets/index.html-D2EdXpwA.js" as="script"><link rel="prefetch" href="/assets/index.html-CNpKGhwQ.js" as="script"><link rel="prefetch" href="/assets/index.html-LxMNsTlr.js" as="script"><link rel="prefetch" href="/assets/index.html-GbTEJVbb.js" as="script"><link rel="prefetch" href="/assets/index.html-D8MDU7UK.js" as="script"><link rel="prefetch" href="/assets/index.html-0yDW4CE5.js" as="script"><link rel="prefetch" href="/assets/index.html-Btv9D28_.js" as="script"><link rel="prefetch" href="/assets/index.html-uNlrWcWe.js" as="script"><link rel="prefetch" href="/assets/index.html-CbWbdpyP.js" as="script"><link rel="prefetch" href="/assets/index.html-3QLd1atz.js" as="script"><link rel="prefetch" href="/assets/index.html-CxmSYFqm.js" as="script"><link rel="prefetch" href="/assets/index.html-CHLcacMt.js" as="script"><link rel="prefetch" href="/assets/index.html-LkqckBfX.js" as="script"><link rel="prefetch" href="/assets/index.html-aPWs6wmZ.js" as="script"><link rel="prefetch" href="/assets/index.html-LdEHmxw_.js" as="script"><link rel="prefetch" href="/assets/index.html-DlX5crC1.js" as="script"><link rel="prefetch" href="/assets/index.html-BbOKxsD8.js" as="script"><link rel="prefetch" href="/assets/index.html-Cfey_So8.js" as="script"><link rel="prefetch" href="/assets/index.html-BblCy8B5.js" as="script"><link rel="prefetch" href="/assets/index.html-D4muVTPQ.js" as="script"><link rel="prefetch" href="/assets/index.html-DLhQplXf.js" as="script"><link rel="prefetch" href="/assets/index.html-BB7sJ9VJ.js" as="script"><link rel="prefetch" href="/assets/index.html-C0L5ys2E.js" as="script"><link rel="prefetch" href="/assets/index.html-BEoKypIr.js" as="script"><link rel="prefetch" href="/assets/index.html-BmTZPT6G.js" as="script"><link rel="prefetch" href="/assets/index.html-DvcPzIqP.js" as="script"><link rel="prefetch" href="/assets/index.html-D_OIRe_j.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-GXRgw7eJ.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Ë∑≥Ëá≥‰∏ªË¶ÅÂÖßÂÆπ</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/touxiang/vue-color-avatar3.png" alt><!----><span class="vp-site-name hide-in-pad">È∫ªËä±ÁöÑÂ∞èÁ´ô</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="È¶ñÈ°µ"><!--[--><span class="font-icon icon iconfont icon-shouye" style=""></span><!--]-->È¶ñÈ°µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/posts/" aria-label="Â≠¶‰π†Á¨îËÆ∞"><!--[--><span class="font-icon icon iconfont icon-xuexibiji" style=""></span><!--]-->Â≠¶‰π†Á¨îËÆ∞<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/interviewExperience/" aria-label="Èù¢ËØï‰∏ìÊ†è"><!--[--><span class="font-icon icon iconfont icon-flow-interview" style=""></span><!--]-->Èù¢ËØï‰∏ìÊ†è<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/softwareTutorial/" aria-label="ËΩØ‰ª∂ÊïôÁ®ã"><!--[--><span class="font-icon icon iconfont icon-ruanjianjiaocheng1" style=""></span><!--]-->ËΩØ‰ª∂ÊïôÁ®ã<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/aboutMe/" aria-label="ÂÖ≥‰∫éÊàë"><!--[--><span class="font-icon icon iconfont icon-guanyuzuozhe" style=""></span><!--]-->ÂÖ≥‰∫éÊàë<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/skxndbzu/JackChenBlogs" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="È¶ñÈ°µ"><!--[--><span class="font-icon icon iconfont icon-shouye" style=""></span><!--]-->È¶ñÈ°µ<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-meiribikan" style=""></span><span class="vp-sidebar-title">ÂøÖÁúã</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-zhenrenmianshi" style=""></span><span class="vp-sidebar-title">Èù¢ËØï‰∏ìÊ†è</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-java" style=""></span><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-application--web" style=""></span><span class="vp-sidebar-title">ËÆ°ÁÆóÊú∫Âü∫Á°Ä</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-xitongsheji" style=""></span><span class="vp-sidebar-title">Á≥ªÁªüËÆæËÆ°</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><span class="font-icon icon iconfont icon-jurassic_data" style=""></span><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/demo/" aria-label="Êï∞ÊçÆÂ∫ì"><!---->Êï∞ÊçÆÂ∫ì<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/elasticsearch.html" aria-label="elasticsearch"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->elasticsearch<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL.html" aria-label="MySQL"><!--[--><span class="font-icon icon iconfont icon-pen-to-square" style=""></span><!--]-->MySQL<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Redis</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-kaifagongju" style=""></span><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/developmentTool/" aria-label="ÂºÄÂèëÂ∑•ÂÖ∑"><!---->ÂºÄÂèëÂ∑•ÂÖ∑<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-yemiankuangjia_o" style=""></span><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/demo/" aria-label="Â∏∏Áî®Ê°ÜÊû∂"><!---->Â∏∏Áî®Ê°ÜÊû∂<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-yemiankuangjia_o" style=""></span><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/demo/" aria-label="ÂæÆÊúçÂä°Êû∂ÊûÑ"><!---->ÂæÆÊúçÂä°Êû∂ÊûÑ<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-qianduan" style=""></span><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/demo/" aria-label="ÂâçÁ´Ø"><!---->ÂâçÁ´Ø<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon iconfont icon-qianduan" style=""></span><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/demo/" aria-label="Ê∂àÊÅØ‰∏≠Èó¥‰ª∂"><!---->Ê∂àÊÅØ‰∏≠Èó¥‰ª∂<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/intro.html" aria-label="‰ªãÁªçÈ°µ"><!--[--><span class="font-icon icon iconfont icon-fenxiangdingqijieshao" style=""></span><!--]-->‰ªãÁªçÈ°µ<!----></a></li><li><a class="auto-link external-link vp-sidebar-link" href="https://plugin-md-enhance.vuejs.press/zh/guide/content/revealjs/demo.html" aria-label="ÂπªÁÅØÁâá" rel="noopener noreferrer" target="_blank"><!--[--><span class="font-icon icon iconfont icon-huandengpian-04" style=""></span><!--]-->ÂπªÁÅØÁâá<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon iconfont icon-pen-to-square" style=""></span>MySQL</h1><div class="page-info"><span class="page-author-info" aria-label="‰ΩúËÄÖüñä" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://chemnminghe.top" target="_blank" rel="noopener noreferrer">Jack-Chen</a></span><span property="author" content="Jack-Chen"></span></span><!----><span class="page-date-info" aria-label="ÂÜô‰ΩúÊó•ÊúüüìÖ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-01-14T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="ÈòÖËØªÊó∂Èó¥‚åõ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>Â§ßÁ∫¶ 274 ÂàÜÈíü</span><meta property="timeRequired" content="PT274M"></span><span class="page-category-info" aria-label="ÂàÜÁ±ªüåà" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color6 clickable" role="navigation">MySQL</span><!--]--><meta property="articleSection" content="MySQL"></span><span class="page-tag-info" aria-label="Ê†áÁ≠æüè∑" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color6 clickable" role="navigation">ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ì</span><span class="page-tag-item color0 clickable" role="navigation">ËßÜÂõæ</span><span class="page-tag-item color4 clickable" role="navigation">Á¥¢Âºï</span><span class="page-tag-item color4 clickable" role="navigation">‰∫ãÂä°</span><!--]--><meta property="keywords" content="ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ì,ËßÜÂõæ,Á¥¢Âºï,‰∫ãÂä°"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">Ê≠§È°µÂÜÖÂÆπ<button type="button" class="print-button" title="ÊâìÂç∞"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ÁÆÄ‰ªã">ÁÆÄ‰ªã</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Êï∞ÊçÆÂ∫ì">Êï∞ÊçÆÂ∫ì</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mysql-1">MySQL</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#‰ΩìÁ≥ªÊû∂ÊûÑ">‰ΩìÁ≥ªÊû∂ÊûÑ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Êï¥‰ΩìÊû∂ÊûÑ">Êï¥‰ΩìÊû∂ÊûÑ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Âª∫Á´ãËøûÊé•">Âª∫Á´ãËøûÊé•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÊâßË°åÊµÅÁ®ã">ÊâßË°åÊµÅÁ®ã</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÁªàÊ≠¢ÊµÅÁ®ã">ÁªàÊ≠¢ÊµÅÁ®ã</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Â∏∏Áî®Â∑•ÂÖ∑">Â∏∏Áî®Â∑•ÂÖ∑</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ÂçïË°®Êìç‰Ωú">ÂçïË°®Êìç‰Ωú</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sql">SQL</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ddl">DDL</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dml">DML</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dql">DQL</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#dcl">DCL</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#Â§öË°®Êìç‰Ωú">Â§öË°®Êìç‰Ωú</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Á∫¶ÊùüÂàÜÁ±ª">Á∫¶ÊùüÂàÜÁ±ª</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Â§öË°®ËÆæËÆ°">Â§öË°®ËÆæËÆ°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ËøûÊé•Êü•ËØ¢">ËøûÊé•Êü•ËØ¢</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÂµåÂ•óÊü•ËØ¢">ÂµåÂ•óÊü•ËØ¢</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Êü•ËØ¢ÁªÉ‰π†">Êü•ËØ¢ÁªÉ‰π†</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#È´òÁ∫ßÁªìÊûÑ">È´òÁ∫ßÁªìÊûÑ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ËßÜÂõæ">ËßÜÂõæ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Â≠òÂÇ®ËøáÁ®ã">Â≠òÂÇ®ËøáÁ®ã</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Â≠òÂÇ®ÂáΩÊï∞">Â≠òÂÇ®ÂáΩÊï∞</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Ëß¶ÂèëÂô®">Ëß¶ÂèëÂô®</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#Â≠òÂÇ®ÂºïÊìé">Â≠òÂÇ®ÂºïÊìé</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Âü∫Êú¨‰ªãÁªç-3">Âü∫Êú¨‰ªãÁªç</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÂºïÊìéÂØπÊØî">ÂºïÊìéÂØπÊØî</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÂºïÊìéÊìç‰Ωú">ÂºïÊìéÊìç‰Ωú</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#Á¥¢ÂºïÊú∫Âà∂">Á¥¢ÂºïÊú∫Âà∂</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Á¥¢Âºï‰ªãÁªç">Á¥¢Âºï‰ªãÁªç</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Á¥¢ÂºïÊìç‰Ωú">Á¥¢ÂºïÊìç‰Ωú</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ËÅöÁ∞áÁ¥¢Âºï">ËÅöÁ∞áÁ¥¢Âºï</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Á¥¢ÂºïÁªìÊûÑ">Á¥¢ÂºïÁªìÊûÑ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ËÆæËÆ°ÂéüÂàô">ËÆæËÆ°ÂéüÂàô</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Á¥¢Âºï‰ºòÂåñ">Á¥¢Âºï‰ºòÂåñ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#Á≥ªÁªü‰ºòÂåñ">Á≥ªÁªü‰ºòÂåñ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Ë°®‰ºòÂåñ">Ë°®‰ºòÂåñ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#‰ºòÂåñÊ≠•È™§">‰ºòÂåñÊ≠•È™§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Á¥¢Âºï‰ºòÂåñ-1">Á¥¢Âºï‰ºòÂåñ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#sql-‰ºòÂåñ">SQL ‰ºòÂåñ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÁºìÂÜ≤‰ºòÂåñ">ÁºìÂÜ≤‰ºòÂåñ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÂÜÖÂ≠ò‰ºòÂåñ">ÂÜÖÂ≠ò‰ºòÂåñ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Â≠òÂÇ®‰ºòÂåñ">Â≠òÂÇ®‰ºòÂåñ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Âπ∂Âèë‰ºòÂåñ">Âπ∂Âèë‰ºòÂåñ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#‰∫ãÂä°Êú∫Âà∂">‰∫ãÂä°Êú∫Âà∂</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Âü∫Êú¨‰ªãÁªç-7">Âü∫Êú¨‰ªãÁªç</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#‰∫ãÂä°ÁÆ°ÁêÜ">‰∫ãÂä°ÁÆ°ÁêÜ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÈöîÁ¶ªÁ∫ßÂà´">ÈöîÁ¶ªÁ∫ßÂà´</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÂéüÂ≠êÁâπÊÄß">ÂéüÂ≠êÁâπÊÄß</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÈöîÁ¶ªÁâπÊÄß">ÈöîÁ¶ªÁâπÊÄß</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÊåÅ‰πÖÁâπÊÄß">ÊåÅ‰πÖÁâπÊÄß</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#‰∏ÄËá¥ÁâπÊÄß">‰∏ÄËá¥ÁâπÊÄß</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ÈîÅÊú∫Âà∂">ÈîÅÊú∫Âà∂</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Âü∫Êú¨‰ªãÁªç-8">Âü∫Êú¨‰ªãÁªç</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÂÖ®Â±ÄÈîÅ">ÂÖ®Â±ÄÈîÅ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÂÜÖÂ≠òÁªìÊûÑ">ÂÜÖÂ≠òÁªìÊûÑ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#server">Server</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#myisam-1">MyISAM</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#innodb-1">InnoDB</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#‰πêËßÇÈîÅ">‰πêËßÇÈîÅ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#‰∏ª‰ªé">‰∏ª‰ªé</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Âü∫Êú¨‰ªãÁªç-9">Âü∫Êú¨‰ªãÁªç</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#‰∏ª‰ªéÂ§çÂà∂">‰∏ª‰ªéÂ§çÂà∂</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#‰∏ª‰ªéÂª∂Ëøü">‰∏ª‰ªéÂª∂Ëøü</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ËØªÂÜôÂàÜÁ¶ª">ËØªÂÜôÂàÜÁ¶ª</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#‰∏ª‰ªéÊê≠Âª∫">‰∏ª‰ªéÊê≠Âª∫</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#‰∏ª‰ªéÂàáÊç¢">‰∏ª‰ªéÂàáÊç¢</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#Êó•Âøó">Êó•Âøó</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Êó•ÂøóÂàÜÁ±ª">Êó•ÂøóÂàÜÁ±ª</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÈîôËØØÊó•Âøó">ÈîôËØØÊó•Âøó</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÂΩíÊ°£Êó•Âøó">ÂΩíÊ°£Êó•Âøó</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Êü•ËØ¢Êó•Âøó">Êü•ËØ¢Êó•Âøó</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÊÖ¢Êó•Âøó">ÊÖ¢Êó•Âøó</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ËåÉÂºè">ËåÉÂºè</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Á¨¨‰∏ÄËåÉÂºè">Á¨¨‰∏ÄËåÉÂºè</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Á¨¨‰∫åËåÉÂºè">Á¨¨‰∫åËåÉÂºè</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#Á¨¨‰∏âËåÉÂºè">Á¨¨‰∏âËåÉÂºè</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ÊÄªÁªì">ÊÄªÁªì</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql"><span>MySQL</span></a></h1><h2 id="ÁÆÄ‰ªã" tabindex="-1"><a class="header-anchor" href="#ÁÆÄ‰ªã"><span>ÁÆÄ‰ªã</span></a></h2><h3 id="Êï∞ÊçÆÂ∫ì" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÂ∫ì"><span>Êï∞ÊçÆÂ∫ì</span></a></h3><p>Êï∞ÊçÆÂ∫ìÔºöDataBaseÔºåÁÆÄÁß∞ DBÔºåÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÊï∞ÊçÆÁöÑ‰ªìÂ∫ì</p><p>Êï∞ÊçÆÂ∫ìÁöÑ‰ºòÂäøÔºö</p><ul><li>ÂèØ‰ª•ÊåÅ‰πÖÂåñÂ≠òÂÇ®Êï∞ÊçÆ</li><li>Êñπ‰æøÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÊï∞ÊçÆ</li><li>‰ΩøÁî®‰∫ÜÁªü‰∏ÄÁöÑÊñπÂºèÊìç‰ΩúÊï∞ÊçÆÂ∫ì SQL</li></ul><p>Êï∞ÊçÆÂ∫ì„ÄÅÊï∞ÊçÆË°®„ÄÅÊï∞ÊçÆÁöÑÂÖ≥Á≥ª‰ªãÁªçÔºö</p><ul><li>Êï∞ÊçÆÂ∫ì <ul><li>Áî®‰∫éÂ≠òÂÇ®ÂíåÁÆ°ÁêÜÊï∞ÊçÆÁöÑ‰ªìÂ∫ì</li><li>‰∏Ä‰∏™Â∫ì‰∏≠ÂèØ‰ª•ÂåÖÂê´Â§ö‰∏™Êï∞ÊçÆË°®</li></ul></li><li>Êï∞ÊçÆË°® <ul><li>Êï∞ÊçÆÂ∫ìÊúÄÈáçË¶ÅÁöÑÁªÑÊàêÈÉ®ÂàÜ‰πã‰∏Ä</li><li>Áî±Á∫µÂêëÁöÑÂàóÂíåÊ®™ÂêëÁöÑË°åÁªÑÊàêÔºàÁ±ª‰ºº excel Ë°®Ê†ºÔºâ</li><li>ÂèØ‰ª•ÊåáÂÆöÂàóÂêç„ÄÅÊï∞ÊçÆÁ±ªÂûã„ÄÅÁ∫¶ÊùüÁ≠â</li><li>‰∏Ä‰∏™Ë°®‰∏≠ÂèØ‰ª•Â≠òÂÇ®Â§öÊù°Êï∞ÊçÆ</li></ul></li><li>Êï∞ÊçÆÔºöÊÉ≥Ë¶ÅÊ∞∏‰πÖÂåñÂ≠òÂÇ®ÁöÑÊï∞ÊçÆ</li></ul><p>ÂèÇËÄÉËßÜÈ¢ëÔºöhttps://www.bilibili.com/video/BV1zJ411M7TB</p><p>ÂèÇËÄÉ‰∏ìÊ†èÔºöhttps://time.geekbang.org/column/intro/139</p><p>ÂèÇËÄÉ‰π¶Á±çÔºöhttps://book.douban.com/subject/35231266/</p><hr><h3 id="mysql-1" tabindex="-1"><a class="header-anchor" href="#mysql-1"><span>MySQL</span></a></h3><p>MySQL Êï∞ÊçÆÂ∫ìÊòØ‰∏Ä‰∏™ÊúÄÊµÅË°åÁöÑÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÁÆ°ÁêÜÁ≥ªÁªü‰πã‰∏ÄÔºåÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÊòØÂ∞ÜÊï∞ÊçÆ‰øùÂ≠òÂú®‰∏çÂêåÁöÑÊï∞ÊçÆË°®‰∏≠ÔºåËÄå‰∏îË°®‰∏éË°®‰πãÈó¥ÂèØ‰ª•ÊúâÂÖ≥ËÅîÂÖ≥Á≥ªÔºåÊèêÈ´ò‰∫ÜÁÅµÊ¥ªÊÄß</p><p>Áº∫ÁÇπÔºöÊï∞ÊçÆÂ≠òÂÇ®Âú®Á£ÅÁõò‰∏≠ÔºåÂØºËá¥ËØªÂÜôÊÄßËÉΩÂ∑ÆÔºåËÄå‰∏îÊï∞ÊçÆÂÖ≥Á≥ªÂ§çÊùÇÔºåÊâ©Â±ïÊÄßÂ∑Æ</p><p>MySQL ÊâÄ‰ΩøÁî®ÁöÑ SQL ËØ≠Âè•ÊòØÁî®‰∫éËÆøÈóÆÊï∞ÊçÆÂ∫ìÊúÄÂ∏∏Áî®ÁöÑÊ†áÂáÜÂåñËØ≠Ë®Ä</p><h4 id="Á≥ªÁªüÊï∞ÊçÆÂ∫ì" tabindex="-1"><a class="header-anchor" href="#Á≥ªÁªüÊï∞ÊçÆÂ∫ì"><span>Á≥ªÁªüÊï∞ÊçÆÂ∫ì</span></a></h4><p>MysqlÊï∞ÊçÆÂ∫ìÂÆâË£ÖÂÆåÊàêÂêéÔºåËá™Â∏¶‰∫Ü‰∏Ä‰∏ãÂõõ‰∏™Êï∞ÊçÆÂ∫ìÔºåÂÖ∑‰Ωì‰ΩúÁî®Â¶Ç‰∏ãÔºö</p><table><thead><tr><th>Êï∞ÊçÆÂ∫ì</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td>mysql</td><td>Â≠òÂÇ®MySQLÊúçÂä°Âô®Ê≠£Â∏∏ËøêË°åÊâÄÈúÄË¶ÅÁöÑÂêÑÁßç‰ø°ÊÅØ ÔºàÊó∂Âå∫„ÄÅ‰∏ª‰ªé„ÄÅÁî®Êà∑„ÄÅÊùÉÈôêÁ≠âÔºâ</td></tr><tr><td>information_schema</td><td>Êèê‰æõ‰∫ÜËÆøÈóÆÊï∞ÊçÆÂ∫ìÂÖÉÊï∞ÊçÆÁöÑÂêÑÁßçË°®ÂíåËßÜÂõæÔºåÂåÖÂê´Êï∞ÊçÆÂ∫ì„ÄÅË°®„ÄÅÂ≠óÊÆµÁ±ªÂûãÂèäËÆøÈóÆÊùÉÈôêÁ≠â</td></tr><tr><td>performance_schema</td><td>‰∏∫MySQLÊúçÂä°Âô®ËøêË°åÊó∂Áä∂ÊÄÅÊèê‰æõ‰∫Ü‰∏Ä‰∏™Â∫ïÂ±ÇÁõëÊéßÂäüËÉΩÔºå‰∏ªË¶ÅÁî®‰∫éÊî∂ÈõÜÊï∞ÊçÆÂ∫ìÊúçÂä°Âô®ÊÄßËÉΩÂèÇÊï∞</td></tr><tr><td>sys</td><td>ÂåÖÂê´‰∫Ü‰∏ÄÁ≥ªÂàóÊñπ‰æø DBA ÂíåÂºÄÂèë‰∫∫ÂëòÂà©Áî® performance_schemaÊÄßËÉΩÊï∞ÊçÆÂ∫ìËøõË°åÊÄßËÉΩË∞É‰ºòÂíåËØäÊñ≠ÁöÑËßÜÂõæ</td></tr></tbody></table><p>MySQL ÈÖçÁΩÆÔºö</p><ul><li><p>MySQL ÂÆâË£ÖÔºöhttps://www.jianshu.com/p/ba48f1e386f0</p></li><li><p>MySQL ÈÖçÁΩÆÔºö</p><ul><li><p>‰øÆÊîπ MySQL ÈªòËÆ§Â≠óÁ¨¶ÈõÜÔºöÂÆâË£Ö MySQL ‰πãÂêéÁ¨¨‰∏Ä‰ª∂‰∫ãÂ∞±ÊòØ‰øÆÊîπÂ≠óÁ¨¶ÈõÜÁºñÁ†Å</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>vim /etc/mysql/my.cnf</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Ê∑ªÂä†Â¶Ç‰∏ãÂÜÖÂÆπÔºö</span></span>
<span class="line"><span>[mysqld]</span></span>
<span class="line"><span>character-set-server=utf8</span></span>
<span class="line"><span>collation-server=utf8_general_ci</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[client]</span></span>
<span class="line"><span>default-character-set=utf8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂêØÂä® MySQL ÊúçÂä°Ôºö</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> start/restart</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÁôªÂΩï MySQLÔºö</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  Êï≤ÂõûËΩ¶ÔºåËæìÂÖ•ÂØÜÁ†Å</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ÂàùÂßãÂØÜÁ†ÅÊü•ÁúãÔºöcat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /var/log/mysqld.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Âú®root@localhost:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   ÂêéÈù¢ÁöÑÂ∞±ÊòØÂàùÂßãÂØÜÁ†Å</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ÁúãÈªòËÆ§Â≠óÁ¨¶ÈõÜÂëΩ‰ª§Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW VARIABLES LIKE &#39;char%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰øÆÊîπMySQLÁôªÂΩïÂØÜÁ†ÅÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>set global validate_password_policy=0;</span></span>
<span class="line"><span>set global validate_password_length=1;</span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>set password=password(&#39;ÂØÜÁ†Å&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êéà‰∫àËøúÁ®ãËøûÊé•ÊùÉÈôêÔºàMySQL ÂÜÖËæìÂÖ•ÔºâÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÊéàÊùÉ</span></span>
<span class="line"><span>grant all privileges on *.* to &#39;root&#39; @&#39;%&#39; identified by &#39;ÂØÜÁ†Å&#39;;</span></span>
<span class="line"><span>-- Âà∑Êñ∞</span></span>
<span class="line"><span>flush privileges;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>‰øÆÊîπ MySQL ÁªëÂÆö IPÔºö</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/mysql/mysql.conf.d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 666</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysqld.cnf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysqld.cnf</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># bind-address = 127.0.0.1Ê≥®ÈáäËØ•Ë°å</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂÖ≥Èó≠ Linux Èò≤ÁÅ´Â¢ô</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> firewalld.service</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ÊîæË°å3306Á´ØÂè£</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h2 id="‰ΩìÁ≥ªÊû∂ÊûÑ" tabindex="-1"><a class="header-anchor" href="#‰ΩìÁ≥ªÊû∂ÊûÑ"><span>‰ΩìÁ≥ªÊû∂ÊûÑ</span></a></h2><h3 id="Êï¥‰ΩìÊû∂ÊûÑ" tabindex="-1"><a class="header-anchor" href="#Êï¥‰ΩìÊû∂ÊûÑ"><span>Êï¥‰ΩìÊû∂ÊûÑ</span></a></h3><p>‰ΩìÁ≥ªÁªìÊûÑËØ¶Ëß£Ôºö</p><ul><li><p>Á¨¨‰∏ÄÂ±ÇÔºöÁΩëÁªúËøûÊé•Â±Ç</p><ul><li>‰∏Ä‰∫õÂÆ¢Êà∑Á´ØÂíåÈìæÊé•ÊúçÂä°ÔºåÂåÖÂê´Êú¨Âú∞ Socket ÈÄö‰ø°ÂíåÂ§ßÂ§öÊï∞Âü∫‰∫éÂÆ¢Êà∑Á´Ø/ÊúçÂä°Á´ØÂ∑•ÂÖ∑ÂÆûÁé∞ÁöÑ TCP/IP ÈÄö‰ø°Ôºå‰∏ªË¶ÅÂÆåÊàê‰∏Ä‰∫õÁ±ª‰ºº‰∫éËøûÊé•Â§ÑÁêÜ„ÄÅÊéàÊùÉËÆ§ËØÅ„ÄÅÂèäÁõ∏ÂÖ≥ÁöÑÂÆâÂÖ®ÊñπÊ°à</li><li>Âú®ËØ•Â±Ç‰∏äÂºïÂÖ•‰∫Ü<strong>ËøûÊé•Ê±†</strong> Connection Pool ÁöÑÊ¶ÇÂøµÔºåÁÆ°ÁêÜÁºìÂÜ≤Áî®Êà∑ËøûÊé•ÔºåÁ∫øÁ®ãÂ§ÑÁêÜÁ≠âÈúÄË¶ÅÁºìÂ≠òÁöÑÈúÄÊ±Ç</li><li>Âú®ËØ•Â±Ç‰∏äÂÆûÁé∞Âü∫‰∫é SSL ÁöÑÂÆâÂÖ®ÈìæÊé•ÔºåÊúçÂä°Âô®‰πü‰ºö‰∏∫ÂÆâÂÖ®Êé•ÂÖ•ÁöÑÊØè‰∏™ÂÆ¢Êà∑Á´ØÈ™åËØÅÂÆÉÊâÄÂÖ∑ÊúâÁöÑÊìç‰ΩúÊùÉÈôê</li></ul></li><li><p>Á¨¨‰∫åÂ±ÇÔºöÊ†∏ÂøÉÊúçÂä°Â±Ç</p><ul><li>Êü•ËØ¢ÁºìÂ≠ò„ÄÅÂàÜÊûêÂô®„ÄÅ‰ºòÂåñÂô®„ÄÅÊâßË°åÂô®Á≠âÔºåÊ∂µÁõñ MySQL ÁöÑÂ§ßÂ§öÊï∞Ê†∏ÂøÉÊúçÂä°ÂäüËÉΩÔºåÊâÄÊúâÁöÑÂÜÖÁΩÆÂáΩÊï∞ÔºàÊó•Êúü„ÄÅÊï∞Â≠¶„ÄÅÂä†ÂØÜÂáΩÊï∞Á≠âÔºâ <ul><li>Management Serveices &amp; UtilitiesÔºöÁ≥ªÁªüÁÆ°ÁêÜÂíåÊéßÂà∂Â∑•ÂÖ∑ÔºåÂ§á‰ªΩ„ÄÅÂÆâÂÖ®„ÄÅÂ§çÂà∂„ÄÅÈõÜÁæ§Á≠â</li><li>SQL InterfaceÔºöÊé•ÂèóÁî®Êà∑ÁöÑ SQL ÂëΩ‰ª§ÔºåÂπ∂‰∏îËøîÂõûÁî®Êà∑ÈúÄË¶ÅÊü•ËØ¢ÁöÑÁªìÊûú</li><li>ParserÔºöSQL ËØ≠Âè•ÂàÜÊûêÂô®</li><li>OptimizerÔºöÊü•ËØ¢‰ºòÂåñÂô®</li><li>Caches &amp; BuffersÔºöÊü•ËØ¢ÁºìÂ≠òÔºåÊúçÂä°Âô®‰ºöÊü•ËØ¢ÂÜÖÈÉ®ÁöÑÁºìÂ≠òÔºåÂ¶ÇÊûúÁºìÂ≠òÁ©∫Èó¥Ë∂≥Â§üÂ§ßÔºåÂèØ‰ª•Âú®Â§ßÈáèËØªÊìç‰ΩúÁöÑÁéØÂ¢É‰∏≠ÊèêÂçáÁ≥ªÁªüÊÄßËÉΩ</li></ul></li><li>ÊâÄÊúâ<strong>Ë∑®Â≠òÂÇ®ÂºïÊìéÁöÑÂäüËÉΩ</strong>Âú®Ëøô‰∏ÄÂ±ÇÂÆûÁé∞ÔºåÂ¶ÇÂ≠òÂÇ®ËøáÁ®ã„ÄÅËß¶ÂèëÂô®„ÄÅËßÜÂõæÁ≠â</li><li>Âú®ËØ•Â±ÇÊúçÂä°Âô®‰ºöËß£ÊûêÊü•ËØ¢Âπ∂ÂàõÂª∫Áõ∏Â∫îÁöÑÂÜÖÈÉ®Ëß£ÊûêÊ†ëÔºåÂπ∂ÂØπÂÖ∂ÂÆåÊàêÁõ∏Â∫îÁöÑ‰ºòÂåñÂ¶ÇÁ°ÆÂÆöË°®ÁöÑÊü•ËØ¢È°∫Â∫èÔºåÊòØÂê¶Âà©Áî®Á¥¢ÂºïÁ≠âÔºå ÊúÄÂêéÁîüÊàêÁõ∏Â∫îÁöÑÊâßË°åÊìç‰Ωú</li><li>MySQL ‰∏≠ÊúçÂä°Âô®Â±Ç‰∏çÁÆ°ÁêÜ‰∫ãÂä°Ôºå<strong>‰∫ãÂä°ÊòØÁî±Â≠òÂÇ®ÂºïÊìéÂÆûÁé∞ÁöÑ</strong></li></ul></li><li><p>Á¨¨‰∏âÂ±ÇÔºöÂ≠òÂÇ®ÂºïÊìéÂ±Ç</p><ul><li>Pluggable Storage EnginesÔºöÂ≠òÂÇ®ÂºïÊìéÊé•Âè£ÔºåMySQL Âå∫Âà´‰∫éÂÖ∂‰ªñÊï∞ÊçÆÂ∫ìÁöÑÈáçË¶ÅÁâπÁÇπÂ∞±ÊòØÂÖ∂Â≠òÂÇ®ÂºïÊìéÁöÑÊû∂ÊûÑÊ®°ÂºèÊòØÊèí‰ª∂ÂºèÁöÑÔºàÂ≠òÂÇ®ÂºïÊìéÊòØÂü∫‰∫éË°®ÁöÑÔºåËÄå‰∏çÊòØÊï∞ÊçÆÂ∫ìÔºâ</li><li>Â≠òÂÇ®ÂºïÊìé<strong>ÁúüÊ≠£ÁöÑË¥üË¥£‰∫Ü MySQL ‰∏≠Êï∞ÊçÆÁöÑÂ≠òÂÇ®ÂíåÊèêÂèñ</strong>ÔºåÊúçÂä°Âô®ÈÄöËøá API ÂíåÂ≠òÂÇ®ÂºïÊìéËøõË°åÈÄö‰ø°</li><li>‰∏çÂêåÁöÑÂ≠òÂÇ®ÂºïÊìéÂÖ∑Êúâ‰∏çÂêåÁöÑÂäüËÉΩÔºåÂÖ±Áî®‰∏Ä‰∏™ Server Â±ÇÔºåÂèØ‰ª•Ê†πÊçÆÂºÄÂèëÁöÑÈúÄË¶ÅÔºåÊù•ÈÄâÂèñÂêàÈÄÇÁöÑÂ≠òÂÇ®ÂºïÊìé</li></ul></li><li><p>Á¨¨ÂõõÂ±ÇÔºöÁ≥ªÁªüÊñá‰ª∂Â±Ç</p><ul><li>Êï∞ÊçÆÂ≠òÂÇ®Â±ÇÔºå‰∏ªË¶ÅÊòØÂ∞ÜÊï∞ÊçÆÂ≠òÂÇ®Âú®Êñá‰ª∂Á≥ªÁªü‰πã‰∏äÔºåÂπ∂ÂÆåÊàê‰∏éÂ≠òÂÇ®ÂºïÊìéÁöÑ‰∫§‰∫í</li><li>File SystemÔºöÊñá‰ª∂Á≥ªÁªüÔºå‰øùÂ≠òÈÖçÁΩÆÊñá‰ª∂„ÄÅÊï∞ÊçÆÊñá‰ª∂„ÄÅÊó•ÂøóÊñá‰ª∂„ÄÅÈîôËØØÊñá‰ª∂„ÄÅ‰∫åËøõÂà∂Êñá‰ª∂Á≠â</li></ul></li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ΩìÁ≥ªÁªìÊûÑ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h3 id="Âª∫Á´ãËøûÊé•" tabindex="-1"><a class="header-anchor" href="#Âª∫Á´ãËøûÊé•"><span>Âª∫Á´ãËøûÊé•</span></a></h3><h4 id="ËøûÊé•Âô®" tabindex="-1"><a class="header-anchor" href="#ËøûÊé•Âô®"><span>ËøûÊé•Âô®</span></a></h4><p>Ê±†ÂåñÊäÄÊúØÔºöÂØπ‰∫éËÆøÈóÆÊï∞ÊçÆÂ∫ìÊù•ËØ¥ÔºåÂª∫Á´ãËøûÊé•ÁöÑ‰ª£‰ª∑ÊòØÊØîËæÉÊòÇË¥µÁöÑÔºåÂõ†‰∏∫ÊØè‰∏™ËøûÊé•ÂØπÂ∫î‰∏Ä‰∏™Áî®Êù•‰∫§‰∫íÁöÑÁ∫øÁ®ãÔºåÈ¢ëÁπÅÁöÑÂàõÂª∫ÂÖ≥Èó≠ËøûÊé•ÊØîËæÉËÄóË¥πËµÑÊ∫êÔºåÊúâÂøÖË¶ÅÂª∫Á´ãÊï∞ÊçÆÂ∫ìËøûÊé•Ê±†Ôºå‰ª•ÊèêÈ´òËÆøÈóÆÁöÑÊÄßËÉΩ</p><p>ËøûÊé•Âª∫Á´ã TCP ‰ª•ÂêéÈúÄË¶ÅÂÅö<strong>ÊùÉÈôêÈ™åËØÅ</strong>ÔºåÈ™åËØÅÊàêÂäüÂêéÂèØ‰ª•ËøõË°åÊâßË°å SQL„ÄÇÂ¶ÇÊûúËøôÊó∂ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØπËøô‰∏™Áî®Êà∑ÁöÑÊùÉÈôêÂÅö‰∫Ü‰øÆÊîπÔºå‰πü‰∏ç‰ºöÂΩ±ÂìçÂ∑≤ÁªèÂ≠òÂú®ËøûÊé•ÁöÑÊùÉÈôêÔºåÂè™ÊúâÂÜçÊñ∞Âª∫ÁöÑËøûÊé•Êâç‰ºö‰ΩøÁî®Êñ∞ÁöÑÊùÉÈôêËÆæÁΩÆ</p><p>MySQL ÊúçÂä°Âô®ÂèØ‰ª•ÂêåÊó∂ÂíåÂ§ö‰∏™ÂÆ¢Êà∑Á´ØËøõË°å‰∫§‰∫íÔºåÊâÄ‰ª•Ë¶Å‰øùËØÅÊØè‰∏™ËøûÊé•‰ºöËØùÁöÑÈöîÁ¶ªÊÄßÔºà‰∫ãÂä°Êú∫Âà∂ÈÉ®ÂàÜËØ¶Ëß£Ôºâ</p><p>Êï¥‰ΩìÁöÑÊâßË°åÊµÅÁ®ãÔºö</p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQLÁöÑÊâßË°åÊµÅÁ®ã.png" style="zoom:33%;"><hr><h4 id="ÊùÉÈôê‰ø°ÊÅØ" tabindex="-1"><a class="header-anchor" href="#ÊùÉÈôê‰ø°ÊÅØ"><span>ÊùÉÈôê‰ø°ÊÅØ</span></a></h4><p>grant ËØ≠Âè•‰ºöÂêåÊó∂‰øÆÊîπÊï∞ÊçÆË°®ÂíåÂÜÖÂ≠òÔºåÂà§Êñ≠ÊùÉÈôêÁöÑÊó∂ÂÄô‰ΩøÁî®ÁöÑÊòØÂÜÖÂ≠òÊï∞ÊçÆ</p><p>flush privileges ËØ≠Âè•Êú¨Ë∫´‰ºöÁî®Êï∞ÊçÆË°®ÔºàÁ£ÅÁõòÔºâÁöÑÊï∞ÊçÆÈáçÂª∫‰∏Ä‰ªΩÂÜÖÂ≠òÊùÉÈôêÊï∞ÊçÆÔºåÊâÄ‰ª•Âú®ÊùÉÈôêÊï∞ÊçÆÂèØËÉΩÂ≠òÂú®‰∏ç‰∏ÄËá¥ÁöÑÊÉÖÂÜµ‰∏ã‰ΩøÁî®ÔºåËøôÁßç‰∏ç‰∏ÄËá¥ÂæÄÂæÄÊòØÁî±‰∫éÁõ¥Êé•Áî® DML ËØ≠Âè•Êìç‰ΩúÁ≥ªÁªüÊùÉÈôêË°®ÂØºËá¥ÁöÑÔºåÊâÄ‰ª•Â∞ΩÈáè‰∏çË¶Å‰ΩøÁî®ËøôÁ±ªËØ≠Âè•</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ÊùÉÈôêËåÉÂõ¥.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h4 id="ËøûÊé•Áä∂ÊÄÅ" tabindex="-1"><a class="header-anchor" href="#ËøûÊé•Áä∂ÊÄÅ"><span>ËøûÊé•Áä∂ÊÄÅ</span></a></h4><p>ÂÆ¢Êà∑Á´ØÂ¶ÇÊûúÈïøÊó∂Èó¥Ê≤°ÊúâÊìç‰ΩúÔºåËøûÊé•Âô®Â∞±‰ºöËá™Âä®Êñ≠ÂºÄÔºåÊó∂Èó¥ÊòØÁî±ÂèÇÊï∞ wait_timeout ÊéßÂà∂ÁöÑÔºåÈªòËÆ§ÂÄºÊòØ 8 Â∞èÊó∂„ÄÇÂ¶ÇÊûúÂú®ËøûÊé•Ë¢´Êñ≠ÂºÄ‰πãÂêéÔºåÂÆ¢Êà∑Á´Ø<strong>ÂÜçÊ¨°ÂèëÈÄÅËØ∑Ê±Ç</strong>ÁöÑËØùÔºåÂ∞±‰ºöÊî∂Âà∞‰∏Ä‰∏™ÈîôËØØÊèêÈÜíÔºö<code>Lost connection to MySQL server during query</code></p><p>Êï∞ÊçÆÂ∫ìÈáåÈù¢ÔºåÈïøËøûÊé•ÊòØÊåáËøûÊé•ÊàêÂäüÂêéÔºåÂ¶ÇÊûúÂÆ¢Êà∑Á´ØÊåÅÁª≠ÊúâËØ∑Ê±ÇÔºåÂàô‰∏ÄÁõ¥‰ΩøÁî®Âêå‰∏Ä‰∏™ËøûÊé•ÔºõÁü≠ËøûÊé•ÂàôÊòØÊåáÊØèÊ¨°ÊâßË°åÂÆåÂæàÂ∞ëÁöÑÂá†Ê¨°Êü•ËØ¢Â∞±Êñ≠ÂºÄËøûÊé•Ôºå‰∏ãÊ¨°Êü•ËØ¢ÂÜçÈáçÊñ∞Âª∫Á´ã‰∏Ä‰∏™</p><p>‰∏∫‰∫ÜÂáèÂ∞ëËøûÊé•ÁöÑÂàõÂª∫ÔºåÊé®Ëçê‰ΩøÁî®ÈïøËøûÊé•Ôºå‰ΩÜÊòØ<strong>ËøáÂ§öÁöÑÈïøËøûÊé•‰ºöÈÄ†Êàê OOM</strong>ÔºåËß£ÂÜ≥ÊñπÊ°àÔºö</p><ul><li><p>ÂÆöÊúüÊñ≠ÂºÄÈïøËøûÊé•Ôºå‰ΩøÁî®‰∏ÄÊÆµÊó∂Èó¥ÔºåÊàñËÄÖÁ®ãÂ∫èÈáåÈù¢Âà§Êñ≠ÊâßË°åËøá‰∏Ä‰∏™Âç†Áî®ÂÜÖÂ≠òÁöÑÂ§ßÊü•ËØ¢ÂêéÔºåÊñ≠ÂºÄËøûÊé•Ôºå‰πãÂêéË¶ÅÊü•ËØ¢ÂÜçÈáçËøû</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>KILL CONNECTION id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>MySQL 5.7 ÁâàÊú¨ÔºåÂèØ‰ª•Âú®ÊØèÊ¨°ÊâßË°å‰∏Ä‰∏™ÊØîËæÉÂ§ßÁöÑÊìç‰ΩúÂêéÔºåÈÄöËøáÊâßË°å mysql_reset_connection Êù•ÈáçÊñ∞ÂàùÂßãÂåñËøûÊé•ËµÑÊ∫êÔºåËøô‰∏™ËøáÁ®ã‰∏çÈúÄË¶ÅÈáçËøûÂíåÈáçÊñ∞ÂÅöÊùÉÈôêÈ™åËØÅÔºå‰ΩÜÊòØ‰ºöÂ∞ÜËøûÊé•ÊÅ¢Â§çÂà∞ÂàöÂàöÂàõÂª∫ÂÆåÊó∂ÁöÑÁä∂ÊÄÅ</p></li></ul><p>SHOW PROCESSLISTÔºöÊü•ÁúãÂΩìÂâç MySQL Âú®ËøõË°åÁöÑÁ∫øÁ®ãÔºåÂèØ‰ª•ÂÆûÊó∂Âú∞Êü•Áúã SQL ÁöÑÊâßË°åÊÉÖÂÜµÔºåÂÖ∂‰∏≠ÁöÑ Command ÂàóÊòæÁ§∫‰∏∫ Sleep ÁöÑËøô‰∏ÄË°åÔºåÂ∞±Ë°®Á§∫Áé∞Âú®Á≥ªÁªüÈáåÈù¢Êúâ‰∏Ä‰∏™Á©∫Èó≤ËøûÊé•</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SHOW_PROCESSLISTÂëΩ‰ª§.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><table><thead><tr><th>ÂèÇÊï∞</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td>ID</td><td>Áî®Êà∑ÁôªÂΩï mysql Êó∂Á≥ªÁªüÂàÜÈÖçÁöÑ connection_idÔºåÂèØ‰ª•‰ΩøÁî®ÂáΩÊï∞ connection_id() Êü•Áúã</td></tr><tr><td>User</td><td>ÊòæÁ§∫ÂΩìÂâçÁî®Êà∑ÔºåÂ¶ÇÊûú‰∏çÊòØ rootÔºåËøô‰∏™ÂëΩ‰ª§Â∞±Âè™ÊòæÁ§∫Áî®Êà∑ÊùÉÈôêËåÉÂõ¥ÁöÑ sql ËØ≠Âè•</td></tr><tr><td>Host</td><td>ÊòæÁ§∫Ëøô‰∏™ËØ≠Âè•ÊòØ‰ªéÂì™‰∏™ ip ÁöÑÂì™‰∏™Á´ØÂè£‰∏äÂèëÁöÑÔºåÂèØ‰ª•Áî®Êù•Ë∑üË∏™Âá∫Áé∞ÈóÆÈ¢òËØ≠Âè•ÁöÑÁî®Êà∑</td></tr><tr><td>db</td><td>ÊòæÁ§∫Ëøô‰∏™ËøõÁ®ãÁõÆÂâçËøûÊé•ÁöÑÊòØÂì™‰∏™Êï∞ÊçÆÂ∫ì</td></tr><tr><td>Command</td><td>ÊòæÁ§∫ÂΩìÂâçËøûÊé•ÁöÑÊâßË°åÁöÑÂëΩ‰ª§Ôºå‰∏ÄËà¨ÂèñÂÄº‰∏∫‰ºëÁú† Sleep„ÄÅÊü•ËØ¢ Query„ÄÅËøûÊé• Connect Á≠â</td></tr><tr><td>Time</td><td>ÊòæÁ§∫Ëøô‰∏™Áä∂ÊÄÅÊåÅÁª≠ÁöÑÊó∂Èó¥ÔºåÂçï‰ΩçÊòØÁßí</td></tr><tr><td>State</td><td>ÊòæÁ§∫‰ΩøÁî®ÂΩìÂâçËøûÊé•ÁöÑ sql ËØ≠Âè•ÁöÑÁä∂ÊÄÅÔºå‰ª•Êü•ËØ¢‰∏∫‰æãÔºåÈúÄË¶ÅÁªèËøá copying to tmp table„ÄÅsorting result„ÄÅsending dataÁ≠âÁä∂ÊÄÅÊâçÂèØ‰ª•ÂÆåÊàê</td></tr><tr><td>Info</td><td>ÊòæÁ§∫ÊâßË°åÁöÑ sql ËØ≠Âè•ÔºåÊòØÂà§Êñ≠ÈóÆÈ¢òËØ≠Âè•ÁöÑ‰∏Ä‰∏™ÈáçË¶Å‰æùÊçÆ</td></tr></tbody></table><p><strong>Sending data Áä∂ÊÄÅ</strong>Ë°®Á§∫ MySQL Á∫øÁ®ãÂºÄÂßãËÆøÈóÆÊï∞ÊçÆË°åÂπ∂ÊääÁªìÊûúËøîÂõûÁªôÂÆ¢Êà∑Á´ØÔºåËÄå‰∏ç‰ªÖ‰ªÖÂè™ÊòØËøîÂõûÁªôÂÆ¢Êà∑Á´ØÔºåÊòØÂ§Ñ‰∫éÊâßË°åÂô®ËøáÁ®ã‰∏≠ÁöÑ‰ªªÊÑèÈò∂ÊÆµ„ÄÇÁî±‰∫éÂú® Sending data Áä∂ÊÄÅ‰∏ãÔºåMySQL Á∫øÁ®ãÈúÄË¶ÅÂÅöÂ§ßÈáèÁ£ÅÁõòËØªÂèñÊìç‰ΩúÔºåÊâÄ‰ª•ÊòØÊï¥‰∏™Êü•ËØ¢‰∏≠ËÄóÊó∂ÊúÄÈïøÁöÑÁä∂ÊÄÅ</p><hr><h3 id="ÊâßË°åÊµÅÁ®ã" tabindex="-1"><a class="header-anchor" href="#ÊâßË°åÊµÅÁ®ã"><span>ÊâßË°åÊµÅÁ®ã</span></a></h3><h4 id="Êü•ËØ¢ÁºìÂ≠ò" tabindex="-1"><a class="header-anchor" href="#Êü•ËØ¢ÁºìÂ≠ò"><span>Êü•ËØ¢ÁºìÂ≠ò</span></a></h4><h5 id="Â∑•‰ΩúÊµÅÁ®ã" tabindex="-1"><a class="header-anchor" href="#Â∑•‰ΩúÊµÅÁ®ã"><span>Â∑•‰ΩúÊµÅÁ®ã</span></a></h5><p>ÂΩìÊâßË°åÂÆåÂÖ®Áõ∏ÂêåÁöÑ SQL ËØ≠Âè•ÁöÑÊó∂ÂÄôÔºåÊúçÂä°Âô®Â∞±‰ºöÁõ¥Êé•‰ªéÁºìÂ≠ò‰∏≠ËØªÂèñÁªìÊûúÔºåÂΩìÊï∞ÊçÆË¢´‰øÆÊîπÔºå‰πãÂâçÁöÑÁºìÂ≠ò‰ºöÂ§±ÊïàÔºå‰øÆÊîπÊØîËæÉÈ¢ëÁπÅÁöÑË°®‰∏çÈÄÇÂêàÂÅöÊü•ËØ¢ÁºìÂ≠ò</p><p>Êü•ËØ¢ËøáÁ®ãÔºö</p><ol><li>ÂÆ¢Êà∑Á´ØÂèëÈÄÅ‰∏ÄÊù°Êü•ËØ¢ÁªôÊúçÂä°Âô®</li><li>ÊúçÂä°Âô®ÂÖà‰ºöÊ£ÄÊü•Êü•ËØ¢ÁºìÂ≠òÔºåÂ¶ÇÊûúÂëΩ‰∏≠‰∫ÜÁºìÂ≠òÔºåÂàôÁ´ãÂç≥ËøîÂõûÂ≠òÂÇ®Âú®ÁºìÂ≠ò‰∏≠ÁöÑÁªìÊûúÔºà‰∏ÄËà¨ÊòØ K-V ÈîÆÂÄºÂØπÔºâÔºåÂê¶ÂàôËøõÂÖ•‰∏ã‰∏ÄÈò∂ÊÆµ</li><li>ÂàÜÊûêÂô®ËøõË°å SQL ÂàÜÊûêÔºåÂÜçÁî±‰ºòÂåñÂô®ÁîüÊàêÂØπÂ∫îÁöÑÊâßË°åËÆ°Âàí</li><li>ÊâßË°åÂô®Ê†πÊçÆ‰ºòÂåñÂô®ÁîüÊàêÁöÑÊâßË°åËÆ°ÂàíÔºåË∞ÉÁî®Â≠òÂÇ®ÂºïÊìéÁöÑ API Êù•ÊâßË°åÊü•ËØ¢</li><li>Â∞ÜÁªìÊûúËøîÂõûÁªôÂÆ¢Êà∑Á´Ø</li></ol><p>Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ã‰∏çÂª∫ËÆÆ‰ΩøÁî®Êü•ËØ¢ÁºìÂ≠òÔºåÂõ†‰∏∫Êü•ËØ¢ÁºìÂ≠òÂæÄÂæÄÂºäÂ§ß‰∫éÂà©</p><ul><li>Êü•ËØ¢ÁºìÂ≠òÁöÑ<strong>Â§±ÊïàÈùûÂ∏∏È¢ëÁπÅ</strong>ÔºåÂè™Ë¶ÅÊúâÂØπ‰∏Ä‰∏™Ë°®ÁöÑÊõ¥Êñ∞ÔºåËøô‰∏™Ë°®‰∏äÊâÄÊúâÁöÑÊü•ËØ¢ÁºìÂ≠òÈÉΩ‰ºöË¢´Ê∏ÖÁ©∫„ÄÇÂõ†Ê≠§ÂæàÂèØËÉΩË¥πÂäõÂú∞ÊääÁªìÊûúÂ≠òËµ∑Êù•ÔºåËøòÊ≤°‰ΩøÁî®Â∞±Ë¢´‰∏Ä‰∏™Êõ¥Êñ∞ÂÖ®Ê∏ÖÁ©∫‰∫ÜÔºåÂØπ‰∫éÊõ¥Êñ∞ÂéãÂäõÂ§ßÁöÑÊï∞ÊçÆÂ∫ìÊù•ËØ¥ÔºåÊü•ËØ¢ÁºìÂ≠òÁöÑÂëΩ‰∏≠Áéá‰ºöÈùûÂ∏∏‰Ωé</li><li>Èô§Èùû‰∏öÂä°Â∞±ÊòØÊúâ‰∏ÄÂº†ÈùôÊÄÅË°®ÔºåÂæàÈïøÊó∂Èó¥Êâç‰ºöÊõ¥Êñ∞‰∏ÄÊ¨°ÔºåÊØîÂ¶Ç‰∏Ä‰∏™Á≥ªÁªüÈÖçÁΩÆË°®ÔºåÈÇ£ËøôÂº†Ë°®‰∏äÁöÑÊü•ËØ¢ÊâçÈÄÇÂêà‰ΩøÁî®Êü•ËØ¢ÁºìÂ≠ò</li></ul><hr><h5 id="ÁºìÂ≠òÈÖçÁΩÆ" tabindex="-1"><a class="header-anchor" href="#ÁºìÂ≠òÈÖçÁΩÆ"><span>ÁºìÂ≠òÈÖçÁΩÆ</span></a></h5><ol><li><p>Êü•ÁúãÂΩìÂâç MySQL Êï∞ÊçÆÂ∫ìÊòØÂê¶ÊîØÊåÅÊü•ËØ¢ÁºìÂ≠òÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW VARIABLES LIKE &#39;have_query_cache&#39;;	-- YES</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ÁúãÂΩìÂâç MySQL ÊòØÂê¶ÂºÄÂêØ‰∫ÜÊü•ËØ¢ÁºìÂ≠òÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW VARIABLES LIKE &#39;query_cache_type&#39;;	-- OFF</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ÂèÇÊï∞ËØ¥ÊòéÔºö</p><ul><li><p>OFF Êàñ 0ÔºöÊü•ËØ¢ÁºìÂ≠òÂäüËÉΩÂÖ≥Èó≠</p></li><li><p>ON Êàñ 1ÔºöÊü•ËØ¢ÁºìÂ≠òÂäüËÉΩÊâìÂºÄÔºåÊü•ËØ¢ÁªìÊûúÁ¨¶ÂêàÁºìÂ≠òÊù°‰ª∂Âç≥‰ºöÁºìÂ≠òÔºåÂê¶Âàô‰∏ç‰∫àÁºìÂ≠òÔºõÂèØ‰ª•ÊòæÂºèÊåáÂÆö SQL_NO_CACHE ‰∏ç‰∫àÁºìÂ≠ò</p></li><li><p>DEMAND Êàñ 2ÔºöÊü•ËØ¢ÁºìÂ≠òÂäüËÉΩÊåâÈúÄËøõË°åÔºåÊòæÂºèÊåáÂÆö SQL_CACHE ÁöÑ SELECT ËØ≠Âè•ÊâçÁºìÂ≠òÔºåÂÖ∂ÂÆÉ‰∏ç‰∫àÁºìÂ≠ò</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT SQL_CACHE id, name FROM customer; -- SQL_CACHE:Êü•ËØ¢ÁªìÊûúÂèØÁºìÂ≠ò</span></span>
<span class="line"><span>SELECT SQL_NO_CACHE id, name FROM customer;-- SQL_NO_CACHE:‰∏ç‰ΩøÁî®Êü•ËØ¢ÁºìÂ≠ò</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>Êü•ÁúãÊü•ËØ¢ÁºìÂ≠òÁöÑÂç†Áî®Â§ßÂ∞èÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW VARIABLES LIKE &#39;query_cache_size&#39;;-- Âçï‰ΩçÊòØÂ≠óËäÇ 1048576 / 1024 = 1024 = 1KB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ÁúãÊü•ËØ¢ÁºìÂ≠òÁöÑÁä∂ÊÄÅÂèòÈáèÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW STATUS LIKE &#39;Qcache%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Êü•ËØ¢ÁºìÂ≠òÁöÑÁä∂ÊÄÅÂèòÈáè.png" style="zoom:67%;"><table><thead><tr><th>ÂèÇÊï∞</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td>Qcache_free_blocks</td><td>Êü•ËØ¢ÁºìÂ≠ò‰∏≠ÁöÑÂèØÁî®ÂÜÖÂ≠òÂùóÊï∞</td></tr><tr><td>Qcache_free_memory</td><td>Êü•ËØ¢ÁºìÂ≠òÁöÑÂèØÁî®ÂÜÖÂ≠òÈáè</td></tr><tr><td>Qcache_hits</td><td>Êü•ËØ¢ÁºìÂ≠òÂëΩ‰∏≠Êï∞</td></tr><tr><td>Qcache_inserts</td><td>Ê∑ªÂä†Âà∞Êü•ËØ¢ÁºìÂ≠òÁöÑÊü•ËØ¢Êï∞</td></tr><tr><td>Qcache_lowmen_prunes</td><td>Áî±‰∫éÂÜÖÂ≠ò‰∏çË∂≥ËÄå‰ªéÊü•ËØ¢ÁºìÂ≠ò‰∏≠Âà†Èô§ÁöÑÊü•ËØ¢Êï∞</td></tr><tr><td>Qcache_not_cached</td><td>ÈùûÁºìÂ≠òÊü•ËØ¢ÁöÑÊï∞ÈáèÔºàÁî±‰∫é query_cache_type ËÆæÁΩÆËÄåÊó†Ê≥ïÁºìÂ≠òÊàñÊú™ÁºìÂ≠òÔºâ</td></tr><tr><td>Qcache_queries_in_cache</td><td>Êü•ËØ¢ÁºìÂ≠ò‰∏≠Ê≥®ÂÜåÁöÑÊü•ËØ¢Êï∞</td></tr><tr><td>Qcache_total_blocks</td><td>Êü•ËØ¢ÁºìÂ≠ò‰∏≠ÁöÑÂùóÊÄªÊï∞</td></tr></tbody></table></li><li><p>ÈÖçÁΩÆ my.cnfÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 666</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/mysql/my.cnf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> my.cnf</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># mysqld‰∏≠ÈÖçÁΩÆÁºìÂ≠ò</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">query_cache_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ÈáçÂêØÊúçÂä°Êó¢ÂèØÁîüÊïàÔºåÊâßË°å SQL ËØ≠Âè•ËøõË°åÈ™åËØÅ ÔºåÊâßË°å‰∏ÄÊù°ÊØîËæÉËÄóÊó∂ÁöÑ SQL ËØ≠Âè•ÔºåÁÑ∂ÂêéÂÜçÂ§öÊâßË°åÂá†Ê¨°ÔºåÊü•ÁúãÂêéÈù¢Âá†Ê¨°ÁöÑÊâßË°åÊó∂Èó¥ÔºõËé∑ÂèñÈÄöËøáÊü•ÁúãÊü•ËØ¢ÁºìÂ≠òÁöÑÁºìÂ≠òÂëΩ‰∏≠Êï∞ÔºåÊù•Âà§ÂÆöÊòØÂê¶Ëµ∞Êü•ËØ¢ÁºìÂ≠ò</p></li></ol><hr><h5 id="ÁºìÂ≠òÂ§±Êïà" tabindex="-1"><a class="header-anchor" href="#ÁºìÂ≠òÂ§±Êïà"><span>ÁºìÂ≠òÂ§±Êïà</span></a></h5><p>Êü•ËØ¢ÁºìÂ≠òÂ§±ÊïàÁöÑÊÉÖÂÜµÔºö</p><ul><li><p>SQL ËØ≠Âè•‰∏ç‰∏ÄËá¥ÔºåË¶ÅÊÉ≥ÂëΩ‰∏≠Êü•ËØ¢ÁºìÂ≠òÔºåÊü•ËØ¢ÁöÑ SQL ËØ≠Âè•ÂøÖÈ°ª‰∏ÄËá¥ÔºåÂõ†‰∏∫<strong>ÁºìÂ≠ò‰∏≠ key ÊòØÊü•ËØ¢ÁöÑËØ≠Âè•</strong>Ôºåvalue ÊòØÊü•ËØ¢ÁªìÊûÑ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select count(*) from tb_item;</span></span>
<span class="line"><span>Select count(*) from tb_item;	-- ‰∏çËµ∞ÁºìÂ≠òÔºåÈ¶ñÂ≠óÊØç‰∏ç‰∏ÄËá¥</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂΩìÊü•ËØ¢ËØ≠Âè•‰∏≠Êúâ‰∏Ä‰∫õ‰∏çÁ°ÆÂÆöÊü•ËØ¢Êó∂ÔºåÂàô‰∏ç‰ºöÁºìÂ≠òÔºåÊØîÂ¶ÇÔºönow()„ÄÅcurrent_date()„ÄÅcurdate()„ÄÅcurtime()„ÄÅrand()„ÄÅuuid()„ÄÅuser()„ÄÅdatabase()</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM tb_item WHERE updatetime &lt; NOW() LIMIT 1;</span></span>
<span class="line"><span>SELECT USER();</span></span>
<span class="line"><span>SELECT DATABASE();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>‰∏ç‰ΩøÁî®‰ªª‰ΩïË°®Êü•ËØ¢ËØ≠Âè•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT &#39;A&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢ mysql„ÄÅinformation_schema„ÄÅperformance_schema Á≠âÁ≥ªÁªüË°®Êó∂Ôºå‰∏çËµ∞Êü•ËØ¢ÁºìÂ≠òÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM information_schema.engines;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âú®<strong>Ë∑®Â≠òÂÇ®ÂºïÊìé</strong>ÁöÑÂ≠òÂÇ®ËøáÁ®ã„ÄÅËß¶ÂèëÂô®ÊàñÂ≠òÂÇ®ÂáΩÊï∞ÁöÑ‰∏ª‰ΩìÂÜÖÊâßË°åÁöÑÊü•ËØ¢ÔºåÁºìÂ≠òÂ§±Êïà</p></li><li><p>Â¶ÇÊûúË°®Êõ¥ÊîπÔºåÂàô‰ΩøÁî®ËØ•Ë°®ÁöÑ<strong>ÊâÄÊúâÈ´òÈÄüÁºìÂ≠òÊü•ËØ¢ÈÉΩÂ∞ÜÂèò‰∏∫Êó†Êïà</strong>Âπ∂‰ªéÈ´òÈÄüÁºìÂ≠ò‰∏≠Âà†Èô§ÔºåÂåÖÊã¨‰ΩøÁî® MERGE Êò†Â∞ÑÂà∞Â∑≤Êõ¥ÊîπË°®ÁöÑË°®ÁöÑÊü•ËØ¢ÔºåÊØîÂ¶ÇÔºöINSERT„ÄÅUPDATE„ÄÅDELETE„ÄÅALTER TABLE„ÄÅDROP TABLE„ÄÅDROP DATABASE</p></li></ul><hr><h4 id="ÂàÜÊûêÂô®" tabindex="-1"><a class="header-anchor" href="#ÂàÜÊûêÂô®"><span>ÂàÜÊûêÂô®</span></a></h4><p>Ê≤°ÊúâÂëΩ‰∏≠Êü•ËØ¢ÁºìÂ≠òÔºåÂ∞±ÂºÄÂßã‰∫Ü SQL ÁöÑÁúüÊ≠£ÊâßË°åÔºåÂàÜÊûêÂô®‰ºöÂØπ SQL ËØ≠Âè•ÂÅöËß£Êûê</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> t </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Ëß£ÊûêÂô®ÔºöÂ§ÑÁêÜËØ≠Ê≥ïÂíåËß£ÊûêÊü•ËØ¢ÔºåÁîüÊàê‰∏ÄËØæÂØπÂ∫îÁöÑËß£ÊûêÊ†ë</p><ul><li>ÂÖàÂÅö<strong>ËØçÊ≥ïÂàÜÊûê</strong>ÔºåËæìÂÖ•ÁöÑÊòØÁî±Â§ö‰∏™Â≠óÁ¨¶‰∏≤ÂíåÁ©∫Ê†ºÁªÑÊàêÁöÑ‰∏ÄÊù° SQL ËØ≠Âè•ÔºåMySQL ÈúÄË¶ÅËØÜÂà´Âá∫ÈáåÈù¢ÁöÑÂ≠óÁ¨¶‰∏≤ÂàÜÂà´ÊòØ‰ªÄ‰πà‰ª£Ë°®‰ªÄ‰πà„ÄÇ‰ªéËæìÂÖ•ÁöÑ select Ëøô‰∏™ÂÖ≥ÈîÆÂ≠óËØÜÂà´Âá∫Êù•ËøôÊòØ‰∏Ä‰∏™Êü•ËØ¢ËØ≠Âè•ÔºõÊääÂ≠óÁ¨¶‰∏≤ t ËØÜÂà´Êàê Ë°®Âêç tÔºåÊääÂ≠óÁ¨¶‰∏≤ id ËØÜÂà´ÊàêÂàó id</li><li>ÁÑ∂ÂêéÂÅö<strong>ËØ≠Ê≥ïÂàÜÊûê</strong>ÔºåÊ†πÊçÆËØçÊ≥ïÂàÜÊûêÁöÑÁªìÊûúÔºåËØ≠Ê≥ïÂàÜÊûêÂô®‰ºöÊ†πÊçÆËØ≠Ê≥ïËßÑÂàôÔºåÂà§Êñ≠‰Ω†ËæìÂÖ•ÁöÑËøô‰∏™ SQL ËØ≠Âè•ÊòØÂê¶Êª°Ë∂≥ MySQL ËØ≠Ê≥ï„ÄÇÂ¶ÇÊûúËØ≠Âè•‰∏çÂØπÔºåÂ∞±‰ºöÊî∂Âà∞ <code>You have an error in your SQL syntax</code> ÁöÑÈîôËØØÊèêÈÜí</li></ul><p>È¢ÑÂ§ÑÁêÜÂô®ÔºöËøõ‰∏ÄÊ≠•Ê£ÄÊü•Ëß£ÊûêÊ†ëÁöÑÂêàÊ≥ïÊÄßÔºåÊØîÂ¶ÇÊï∞ÊçÆË°®ÂíåÊï∞ÊçÆÂàóÊòØÂê¶Â≠òÂú®„ÄÅÂà´ÂêçÊòØÂê¶ÊúâÊ≠ß‰πâÁ≠â</p><hr><h4 id="‰ºòÂåñÂô®" tabindex="-1"><a class="header-anchor" href="#‰ºòÂåñÂô®"><span>‰ºòÂåñÂô®</span></a></h4><h5 id="ÊàêÊú¨ÂàÜÊûê" tabindex="-1"><a class="header-anchor" href="#ÊàêÊú¨ÂàÜÊûê"><span>ÊàêÊú¨ÂàÜÊûê</span></a></h5><p>‰ºòÂåñÂô®ÊòØÂú®Ë°®ÈáåÈù¢ÊúâÂ§ö‰∏™Á¥¢ÂºïÁöÑÊó∂ÂÄôÔºåÂÜ≥ÂÆö‰ΩøÁî®Âì™‰∏™Á¥¢ÂºïÔºõÊàñËÄÖÂú®‰∏Ä‰∏™ËØ≠Âè•ÊúâÂ§öË°®ÂÖ≥ËÅîÔºàjoinÔºâÁöÑÊó∂ÂÄôÔºåÂÜ≥ÂÆöÂêÑ‰∏™Ë°®ÁöÑËøûÊé•È°∫Â∫è</p><ul><li>Ê†πÊçÆÊêúÁ¥¢Êù°‰ª∂ÊâæÂá∫ÊâÄÊúâÂèØËÉΩÁöÑ‰ΩøÁî®ÁöÑÁ¥¢Âºï</li><li>ÊàêÊú¨ÂàÜÊûêÔºåÊâßË°åÊàêÊú¨Áî± I/O ÊàêÊú¨Âíå CPU ÊàêÊú¨ÁªÑÊàêÔºåËÆ°ÁÆóÂÖ®Ë°®Êâ´ÊèèÂíå‰ΩøÁî®‰∏çÂêåÁ¥¢ÂºïÊâßË°å SQL ÁöÑ‰ª£‰ª∑</li><li>ÊâæÂà∞‰∏Ä‰∏™ÊúÄ‰ºòÁöÑÊâßË°åÊñπÊ°àÔºåÁî®ÊúÄÂ∞èÁöÑ‰ª£‰ª∑ÂéªÊâßË°åËØ≠Âè•</li></ul><p>Âú®Êï∞ÊçÆÂ∫ìÈáåÈù¢ÔºåÊâ´ÊèèË°åÊï∞ÊòØÂΩ±ÂìçÊâßË°å‰ª£‰ª∑ÁöÑÂõ†Á¥†‰πã‰∏ÄÔºåÊâ´ÊèèÁöÑË°åÊï∞Ë∂äÂ∞ëÊÑèÂë≥ÁùÄËÆøÈóÆÁ£ÅÁõòÁöÑÊ¨°Êï∞Ë∂äÂ∞ëÔºåÊ∂àËÄóÁöÑ CPU ËµÑÊ∫êË∂äÂ∞ëÔºå‰ºòÂåñÂô®Ëøò‰ºöÁªìÂêàÊòØÂê¶‰ΩøÁî®‰∏¥Êó∂Ë°®„ÄÅÊòØÂê¶ÊéíÂ∫èÁ≠âÂõ†Á¥†ËøõË°åÁªºÂêàÂà§Êñ≠</p><hr><h5 id="ÁªüËÆ°Êï∞ÊçÆ" tabindex="-1"><a class="header-anchor" href="#ÁªüËÆ°Êï∞ÊçÆ"><span>ÁªüËÆ°Êï∞ÊçÆ</span></a></h5><p>MySQL ‰∏≠‰øùÂ≠òÁùÄ‰∏§ÁßçÁªüËÆ°Êï∞ÊçÆÔºö</p><ul><li>innodb_table_stats Â≠òÂÇ®‰∫ÜË°®ÁöÑÁªüËÆ°Êï∞ÊçÆÔºåÊØè‰∏ÄÊù°ËÆ∞ÂΩïÂØπÂ∫îÁùÄ‰∏Ä‰∏™Ë°®ÁöÑÁªüËÆ°Êï∞ÊçÆ</li><li>innodb_index_stats Â≠òÂÇ®‰∫ÜÁ¥¢ÂºïÁöÑÁªüËÆ°Êï∞ÊçÆÔºåÊØè‰∏ÄÊù°ËÆ∞ÂΩïÂØπÂ∫îÁùÄ‰∏Ä‰∏™Á¥¢ÂºïÁöÑ‰∏Ä‰∏™ÁªüËÆ°È°πÁöÑÊï∞ÊçÆ</li></ul><p>MySQL Âú®ÁúüÊ≠£ÊâßË°åËØ≠Âè•‰πãÂâçÔºåÂπ∂‰∏çËÉΩÁ≤æÁ°ÆÂú∞Áü•ÈÅìÊª°Ë∂≥Êù°‰ª∂ÁöÑËÆ∞ÂΩïÊúâÂ§öÂ∞ëÊù°ÔºåÂè™ËÉΩÊ†πÊçÆÁªüËÆ°‰ø°ÊÅØÊù•‰º∞ÁÆóËÆ∞ÂΩïÔºåÁªüËÆ°‰ø°ÊÅØÂ∞±ÊòØÁ¥¢ÂºïÁöÑÂå∫ÂàÜÂ∫¶Ôºå‰∏Ä‰∏™Á¥¢Âºï‰∏ä‰∏çÂêåÁöÑÂÄºÁöÑ‰∏™Êï∞ÔºàÊØîÂ¶ÇÊÄßÂà´Âè™ËÉΩÊòØÁî∑Â•≥ÔºåÂ∞±ÊòØ 2 ÔºâÔºåÁß∞‰πã‰∏∫Âü∫Êï∞ÔºàcardinalityÔºâÔºå<strong>Âü∫Êï∞Ë∂äÂ§ßËØ¥ÊòéÂå∫ÂàÜÂ∫¶Ë∂äÂ•Ω</strong></p><p>ÈÄöËøá<strong>ÈááÊ†∑ÁªüËÆ°</strong>Êù•Ëé∑ÂèñÂü∫Êï∞ÔºåInnoDB ÈªòËÆ§‰ºöÈÄâÊã© N ‰∏™Êï∞ÊçÆÈ°µÔºåÁªüËÆ°Ëøô‰∫õÈ°µÈù¢‰∏äÁöÑ‰∏çÂêåÂÄºÂæóÂà∞‰∏Ä‰∏™Âπ≥ÂùáÂÄºÔºåÁÑ∂Âêé‰πò‰ª•Ëøô‰∏™Á¥¢ÂºïÁöÑÈ°µÈù¢Êï∞ÔºåÂ∞±ÂæóÂà∞‰∫ÜËøô‰∏™Á¥¢ÂºïÁöÑÂü∫Êï∞</p><p>Âú® MySQL ‰∏≠ÔºåÊúâ‰∏§ÁßçÂ≠òÂÇ®ÁªüËÆ°Êï∞ÊçÆÁöÑÊñπÂºèÔºåÂèØ‰ª•ÈÄöËøáËÆæÁΩÆÂèÇÊï∞ <code>innodb_stats_persistent</code> ÁöÑÂÄºÊù•ÈÄâÊã©Ôºö</p><ul><li>ONÔºöË°®Á§∫ÁªüËÆ°‰ø°ÊÅØ‰ºöÊåÅ‰πÖÂåñÂ≠òÂÇ®ÔºàÈªòËÆ§ÔºâÔºåÈááÊ†∑È°µÊï∞ N ÈªòËÆ§‰∏∫ 20ÔºåÂèØ‰ª•ÈÄöËøá <code>innodb_stats_persistent_sample_pages</code> ÊåáÂÆöÔºåÈ°µÊï∞Ë∂äÂ§öÁªüËÆ°ÁöÑÊï∞ÊçÆË∂äÂáÜÁ°ÆÔºå‰ΩÜÊ∂àËÄóÁöÑËµÑÊ∫êÊõ¥Â§ß</li><li>OFFÔºöË°®Á§∫ÁªüËÆ°‰ø°ÊÅØÂè™Â≠òÂÇ®Âú®ÂÜÖÂ≠òÔºåÈááÊ†∑È°µÊï∞ N ÈªòËÆ§‰∏∫ 8Ôºå‰πüÂèØ‰ª•ÈÄöËøáÁ≥ªÁªüÂèòÈáèËÆæÁΩÆÔºà‰∏çÊé®ËçêÔºåÊØèÊ¨°ÈáçÊñ∞ËÆ°ÁÆóÊµ™Ë¥πËµÑÊ∫êÔºâ</li></ul><p>Êï∞ÊçÆË°®ÊòØ‰ºöÊåÅÁª≠Êõ¥Êñ∞ÁöÑÔºå‰∏§ÁßçÁªüËÆ°‰ø°ÊÅØÁöÑÊõ¥Êñ∞ÊñπÂºèÔºö</p><ul><li>ËÆæÁΩÆ <code>innodb_stats_auto_recalc</code> ‰∏∫ 1ÔºåÂΩìÂèëÁîüÂèòÂä®ÁöÑËÆ∞ÂΩïÊï∞ÈáèË∂ÖËøáË°®Â§ßÂ∞èÁöÑ 10% Êó∂ÔºåËá™Âä®Ëß¶ÂèëÈáçÊñ∞ËÆ°ÁÆóÔºå‰∏çËøáÊòØ<strong>ÂºÇÊ≠•ËøõË°å</strong></li><li>Ë∞ÉÁî® <code>ANALYZE TABLE t</code> ÊâãÂä®Êõ¥Êñ∞ÁªüËÆ°‰ø°ÊÅØÔºåÂè™ÂØπ‰ø°ÊÅØÂÅö<strong>ÈáçÊñ∞ÁªüËÆ°</strong>Ôºà‰∏çÊòØÈáçÂª∫Ë°®ÔºâÔºåÊ≤°Êúâ‰øÆÊîπÊï∞ÊçÆÔºåËøô‰∏™ËøáÁ®ã‰∏≠Âä†‰∫Ü MDL ËØªÈîÅÂπ∂‰∏îÊòØÂêåÊ≠•ËøõË°åÔºåÊâÄ‰ª•‰ºöÊöÇÊó∂ÈòªÂ°ûÁ≥ªÁªü</li></ul><p><strong>EXPLAIN ÊâßË°åËÆ°ÂàíÂú®‰ºòÂåñÂô®Èò∂ÊÆµÁîüÊàê</strong>ÔºåÂ¶ÇÊûú explain ÁöÑÁªìÊûúÈ¢Ñ‰º∞ÁöÑ rows ÂÄºË∑üÂÆûÈôÖÊÉÖÂÜµÂ∑ÆË∑ùÊØîËæÉÂ§ßÔºåÂèØ‰ª•ÊâßË°å analyze ÂëΩ‰ª§ÈáçÊñ∞‰øÆÊ≠£‰ø°ÊÅØ</p><hr><h5 id="ÈîôÈÄâÁ¥¢Âºï" tabindex="-1"><a class="header-anchor" href="#ÈîôÈÄâÁ¥¢Âºï"><span>ÈîôÈÄâÁ¥¢Âºï</span></a></h5><p>ÈááÊ†∑ÁªüËÆ°Êú¨Ë∫´ÊòØ‰º∞ÁÆóÊï∞ÊçÆÔºåÊàñËÄÖ SQL ËØ≠Âè•‰∏≠ÁöÑÂ≠óÊÆµÈÄâÊã©ÊúâÈóÆÈ¢òÊó∂ÔºåÂèØËÉΩÂØºËá¥ MySQL Ê≤°ÊúâÈÄâÊã©Ê≠£Á°ÆÁöÑÊâßË°åÁ¥¢Âºï</p><p>Ëß£ÂÜ≥ÊñπÊ≥ïÔºö</p><ul><li><p>ÈááÁî® force index Âº∫Ë°åÈÄâÊã©‰∏Ä‰∏™Á¥¢Âºï</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> user </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">FORCE</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;seazean&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂèØ‰ª•ËÄÉËôë‰øÆÊîπ SQL ËØ≠Âè•ÔºåÂºïÂØº MySQL ‰ΩøÁî®ÊúüÊúõÁöÑÁ¥¢Âºï</p></li><li><p>Êñ∞Âª∫‰∏Ä‰∏™Êõ¥ÂêàÈÄÇÁöÑÁ¥¢ÂºïÔºåÊù•Êèê‰æõÁªô‰ºòÂåñÂô®ÂÅöÈÄâÊã©ÔºåÊàñÂà†ÊéâËØØÁî®ÁöÑÁ¥¢Âºï</p></li></ul><hr><h4 id="ÊâßË°åÂô®" tabindex="-1"><a class="header-anchor" href="#ÊâßË°åÂô®"><span>ÊâßË°åÂô®</span></a></h4><p>ÂºÄÂßãÊâßË°åÁöÑÊó∂ÂÄôÔºåË¶ÅÂÖàÂà§Êñ≠‰∏Ä‰∏ãÂΩìÂâçËøûÊé•ÂØπË°®ÊúâÊ≤°Êúâ<strong>ÊâßË°åÊü•ËØ¢ÁöÑÊùÉÈôê</strong>ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂ∞±‰ºöËøîÂõûÊ≤°ÊúâÊùÉÈôêÁöÑÈîôËØØÔºåÂú®Â∑•Á®ãÂÆûÁé∞‰∏äÔºåÂ¶ÇÊûúÂëΩ‰∏≠Êü•ËØ¢ÁºìÂ≠òÔºå‰ºöÂú®Êü•ËØ¢ÁºìÂ≠òËøîÂõûÁªìÊûúÁöÑÊó∂ÂÄôÔºåÂÅöÊùÉÈôêÈ™åËØÅ„ÄÇÂ¶ÇÊûúÊúâÊùÉÈôêÔºåÂ∞±ÊâìÂºÄË°®ÁªßÁª≠ÊâßË°åÔºåÊâßË°åÂô®Â∞±‰ºöÊ†πÊçÆË°®ÁöÑÂºïÊìéÂÆö‰πâÔºåÂéª‰ΩøÁî®Ëøô‰∏™ÂºïÊìéÊèê‰æõÁöÑÊé•Âè£</p><hr><h4 id="ÂºïÊìéÂ±Ç" tabindex="-1"><a class="header-anchor" href="#ÂºïÊìéÂ±Ç"><span>ÂºïÊìéÂ±Ç</span></a></h4><p>Server Â±ÇÂíåÂ≠òÂÇ®ÂºïÊìéÂ±ÇÁöÑ‰∫§‰∫íÊòØ<strong>‰ª•ËÆ∞ÂΩï‰∏∫Âçï‰ΩçÁöÑ</strong>ÔºåÂ≠òÂÇ®ÂºïÊìé‰ºöÂ∞ÜÂçïÊù°ËÆ∞ÂΩïËøîÂõûÁªô Server Â±ÇÂÅöËøõ‰∏ÄÊ≠•Â§ÑÁêÜÔºåÂπ∂‰∏çÊòØÁõ¥Êé•ËøîÂõûÊâÄÊúâÁöÑËÆ∞ÂΩï</p><p>Â∑•‰ΩúÊµÅÁ®ãÔºö</p><ul><li>È¶ñÂÖàÊ†πÊçÆ‰∫åÁ∫ßÁ¥¢ÂºïÈÄâÊã©Êâ´ÊèèËåÉÂõ¥ÔºåËé∑ÂèñÁ¨¨‰∏ÄÊù°Á¨¶Âêà‰∫åÁ∫ßÁ¥¢ÂºïÊù°‰ª∂ÁöÑËÆ∞ÂΩïÔºåËøõË°åÂõûË°®Êü•ËØ¢ÔºåÂ∞ÜËÅöÁ∞áÁ¥¢ÂºïÁöÑËÆ∞ÂΩïËøîÂõû Server Â±ÇÔºåÁî± Server Âà§Êñ≠ËÆ∞ÂΩïÊòØÂê¶Á¨¶ÂêàË¶ÅÊ±Ç</li><li>ÁÑ∂ÂêéÂú®‰∫åÁ∫ßÁ¥¢Âºï‰∏äÁªßÁª≠Êâ´Êèè‰∏ã‰∏Ä‰∏™Á¨¶ÂêàÊù°‰ª∂ÁöÑËÆ∞ÂΩï</li></ul><p>Êé®ËçêÈòÖËØªÔºöhttps://mp.weixin.qq.com/s/YZ-LckObephrP1f15mzHpA</p><hr><h3 id="ÁªàÊ≠¢ÊµÅÁ®ã" tabindex="-1"><a class="header-anchor" href="#ÁªàÊ≠¢ÊµÅÁ®ã"><span>ÁªàÊ≠¢ÊµÅÁ®ã</span></a></h3><h4 id="ÁªàÊ≠¢ËØ≠Âè•" tabindex="-1"><a class="header-anchor" href="#ÁªàÊ≠¢ËØ≠Âè•"><span>ÁªàÊ≠¢ËØ≠Âè•</span></a></h4><p>ÁªàÊ≠¢Á∫øÁ®ã‰∏≠Ê≠£Âú®ÊâßË°åÁöÑËØ≠Âè•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>KILL QUERY thread_id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>KILL ‰∏çÊòØÈ©¨‰∏äÁªàÊ≠¢ÁöÑÊÑèÊÄùÔºåËÄåÊòØÂëäËØâÊâßË°åÁ∫øÁ®ãËøôÊù°ËØ≠Âè•Â∑≤Áªè‰∏çÈúÄË¶ÅÁªßÁª≠ÊâßË°åÔºåÂèØ‰ª•ÂºÄÂßãÊâßË°åÂÅúÊ≠¢ÁöÑÈÄªËæëÔºàÁ±ª‰ºº‰∫éÊâìÊñ≠Ôºâ„ÄÇÂõ†‰∏∫ÂØπË°®ÂÅöÂ¢ûÂà†ÊîπÊü•Êìç‰ΩúÔºå‰ºöÂú®Ë°®‰∏äÂä† MDL ËØªÈîÅÔºåÂ¶ÇÊûúÁ∫øÁ®ãË¢´ KILL Êó∂Â∞±Áõ¥Êé•ÁªàÊ≠¢ÔºåÈÇ£Ëøô‰∏™ MDL ËØªÈîÅÂ∞±Ê≤°Êú∫‰ºöË¢´ÈáäÊîæ‰∫Ü</p><p>ÂëΩ‰ª§ <code>KILL QUERYthread_id_A</code> ÁöÑÊâßË°åÊµÅÁ®ãÔºö</p><ul><li>Êää session A ÁöÑËøêË°åÁä∂ÊÄÅÊîπÊàê THD::KILL_QUERYÔºàÂ∞ÜÂèòÈáè killed ËµãÂÄº‰∏∫ THD::KILL_QUERYÔºâ</li><li>Áªô session A ÁöÑÊâßË°åÁ∫øÁ®ãÂèë‰∏Ä‰∏™‰ø°Âè∑ÔºåËÆ© session A Êù•Â§ÑÁêÜËøô‰∏™ THD::KILL_QUERY Áä∂ÊÄÅ</li></ul><p>‰ºöËØùÂ§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅÔºàÈîÅÈòªÂ°ûÔºâÔºåÂøÖÈ°ªÊª°Ë∂≥ÊòØ‰∏Ä‰∏™ÂèØ‰ª•Ë¢´Âî§ÈÜíÁöÑÁ≠âÂæÖÔºåÂøÖÈ°ªÊúâÊú∫‰ºöÂéª<strong>Âà§Êñ≠Á∫øÁ®ãÁöÑÁä∂ÊÄÅ</strong>ÔºåÂ¶ÇÊûú‰∏çÊª°Ë∂≥Â∞±‰ºöÈÄ†Êàê KILL Â§±Ë¥•</p><p>ÂÖ∏ÂûãÂú∫ÊôØÔºöinnodb_thread_concurrency ‰∏∫ 2Ôºå‰ª£Ë°®Âπ∂ÂèëÁ∫øÁ®ã‰∏äÈôêÊï∞ËÆæÁΩÆ‰∏∫ 2</p><ul><li>session A ÊâßË°å‰∫ãÂä°Ôºåsession B ÊâßË°å‰∫ãÂä°ÔºåËææÂà∞Á∫øÁ®ã‰∏äÈôêÔºõÊ≠§Êó∂ session C ÊâßË°å‰∫ãÂä°‰ºöÈòªÂ°ûÁ≠âÂæÖÔºåsession D ÊâßË°å kill query C Êó†Êïà</li><li>C ÁöÑÈÄªËæëÊòØÊØè 10 ÊØ´ÁßíÂà§Êñ≠ÊòØÂê¶ÂèØ‰ª•ËøõÂÖ• InnoDB ÊâßË°åÔºåÂ¶ÇÊûú‰∏çË°åÂ∞±Ë∞ÉÁî® nanosleep ÂáΩÊï∞ËøõÂÖ• sleep Áä∂ÊÄÅÔºåÊ≤°ÊúâÂéªÂà§Êñ≠Á∫øÁ®ãÁä∂ÊÄÅ</li></ul><p>Ë°•ÂÖÖÔºöÊâßË°å Ctrl+C ÁöÑÊó∂ÂÄôÔºåÊòØ MySQL ÂÆ¢Êà∑Á´ØÂè¶Â§ñÂêØÂä®‰∏Ä‰∏™ËøûÊé•ÔºåÁÑ∂ÂêéÂèëÈÄÅ‰∏Ä‰∏™ KILL QUERY ÂëΩ‰ª§</p><hr><h4 id="ÁªàÊ≠¢ËøûÊé•" tabindex="-1"><a class="header-anchor" href="#ÁªàÊ≠¢ËøûÊé•"><span>ÁªàÊ≠¢ËøûÊé•</span></a></h4><p>Êñ≠ÂºÄÁ∫øÁ®ãÁöÑËøûÊé•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>KILL CONNECTION id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Êñ≠ÂºÄËøûÊé•ÂêéÊâßË°å SHOW PROCESSLIST ÂëΩ‰ª§ÔºåÂ¶ÇÊûúËøôÊù°ËØ≠Âè•ÁöÑ Command ÂàóÊòæÁ§∫ KilledÔºå‰ª£Ë°®Á∫øÁ®ãÁöÑÁä∂ÊÄÅÊòØ KILL_CONNECTIONÔºåËØ¥ÊòéËøô‰∏™Á∫øÁ®ãÊúâËØ≠Âè•Ê≠£Âú®ÊâßË°åÔºåÂΩìÂâçÁä∂ÊÄÅÊòØÂÅúÊ≠¢ËØ≠Âè•ÊâßË°å‰∏≠ÔºåÁªàÊ≠¢ÈÄªËæëËÄóÊó∂ËæÉÈïø</p><ul><li>Ë∂ÖÂ§ß‰∫ãÂä°ÊâßË°åÊúüÈó¥Ë¢´ KILLÔºåËøôÊó∂ÂõûÊªöÊìç‰ΩúÈúÄË¶ÅÂØπ‰∫ãÂä°ÊâßË°åÊúüÈó¥ÁîüÊàêÁöÑÊâÄÊúâÊñ∞Êï∞ÊçÆÁâàÊú¨ÂÅöÂõûÊî∂Êìç‰ΩúÔºåËÄóÊó∂ÂæàÈïø</li><li>Â§ßÊü•ËØ¢ÂõûÊªöÔºåÂ¶ÇÊûúÊü•ËØ¢ËøáÁ®ã‰∏≠ÁîüÊàê‰∫ÜÊØîËæÉÂ§ßÁöÑ‰∏¥Êó∂Êñá‰ª∂ÔºåÂà†Èô§‰∏¥Êó∂Êñá‰ª∂ÂèØËÉΩÈúÄË¶ÅÁ≠âÂæÖ IO ËµÑÊ∫êÔºåÂØºËá¥ËÄóÊó∂ËæÉÈïø</li><li>DDL ÂëΩ‰ª§ÊâßË°åÂà∞ÊúÄÂêéÈò∂ÊÆµË¢´ KILLÔºåÈúÄË¶ÅÂà†Èô§‰∏≠Èó¥ËøáÁ®ãÁöÑ‰∏¥Êó∂Êñá‰ª∂Ôºå‰πüÂèØËÉΩÂèó IO ËµÑÊ∫êÂΩ±ÂìçËÄóÊó∂ËæÉ‰πÖ</li></ul><p>ÊÄªÁªìÔºöKILL CONNECTION Êú¨Ë¥®‰∏äÂè™ÊòØÊääÂÆ¢Êà∑Á´ØÁöÑ SQL ËøûÊé•Êñ≠ÂºÄÔºåÂêéÈù¢ÁöÑÁªàÊ≠¢ÊµÅÁ®ãËøòÊòØË¶ÅËµ∞ KILL QUERY</p><p>‰∏Ä‰∏™‰∫ãÂä°Ë¢´ KILL ‰πãÂêéÔºåÊåÅÁª≠Â§Ñ‰∫éÂõûÊªöÁä∂ÊÄÅÔºå‰∏çÂ∫îËØ•Âº∫Ë°åÈáçÂêØÊï¥‰∏™ MySQL ËøõÁ®ãÔºåÂ∫îËØ•Á≠âÂæÖ‰∫ãÂä°Ëá™Â∑±ÊâßË°åÂÆåÊàêÔºåÂõ†‰∏∫ÈáçÂêØÂêé‰æùÁÑ∂ÁªßÁª≠ÂÅöÂõûÊªöÊìç‰ΩúÁöÑÈÄªËæë</p><hr><h3 id="Â∏∏Áî®Â∑•ÂÖ∑" tabindex="-1"><a class="header-anchor" href="#Â∏∏Áî®Â∑•ÂÖ∑"><span>Â∏∏Áî®Â∑•ÂÖ∑</span></a></h3><h4 id="mysql-2" tabindex="-1"><a class="header-anchor" href="#mysql-2"><span>mysql</span></a></h4><p>mysql ‰∏çÊòØÊåá mysql ÊúçÂä°ÔºåËÄåÊòØÊåá mysql ÁöÑÂÆ¢Êà∑Á´ØÂ∑•ÂÖ∑</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [options] [database]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>-u --user=nameÔºöÊåáÂÆöÁî®Êà∑Âêç</li><li>-p --password[=name]ÔºöÊåáÂÆöÂØÜÁ†Å</li><li>-h --host=nameÔºöÊåáÂÆöÊúçÂä°Âô®IPÊàñÂüüÂêç</li><li>-P --port=#ÔºöÊåáÂÆöËøûÊé•Á´ØÂè£</li><li>-e --execute=nameÔºöÊâßË°åSQLËØ≠Âè•Âπ∂ÈÄÄÂá∫ÔºåÂú®ÊéßÂà∂Âè∞ÊâßË°åSQLËØ≠Âè•ÔºåËÄå‰∏çÁî®ËøûÊé•Âà∞Êï∞ÊçÆÂ∫ìÊâßË°å</li></ul><p>Á§∫‰æãÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 127.0.0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -P</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3306</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p2143</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> db01</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;select * from tb_book&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h4 id="admin" tabindex="-1"><a class="header-anchor" href="#admin"><span>admin</span></a></h4><p>mysqladmin ÊòØ‰∏Ä‰∏™ÊâßË°åÁÆ°ÁêÜÊìç‰ΩúÁöÑÂÆ¢Êà∑Á´ØÁ®ãÂ∫èÔºåÁî®Êù•Ê£ÄÊü•ÊúçÂä°Âô®ÁöÑÈÖçÁΩÆÂíåÂΩìÂâçÁä∂ÊÄÅ„ÄÅÂàõÂª∫Âπ∂Âà†Èô§Êï∞ÊçÆÂ∫ìÁ≠â</p><p>ÈÄöËøá <code>mysqladmin --help</code> Êåá‰ª§Êü•ÁúãÂ∏ÆÂä©ÊñáÊ°£</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqladmin</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p2143</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;test01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h4 id="binlog" tabindex="-1"><a class="header-anchor" href="#binlog"><span>binlog</span></a></h4><p>ÊúçÂä°Âô®ÁîüÊàêÁöÑÊó•ÂøóÊñá‰ª∂‰ª•‰∫åËøõÂà∂Ê†ºÂºè‰øùÂ≠òÔºåÂ¶ÇÊûúÈúÄË¶ÅÊ£ÄÊü•Ëøô‰∫õÊñáÊú¨ÔºåÂ∞±Ë¶Å‰ΩøÁî® mysqlbinlog Êó•ÂøóÁÆ°ÁêÜÂ∑•ÂÖ∑</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqlbinlog</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [options]  log-files1 log-files2 ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>-d --database=nameÔºöÊåáÂÆöÊï∞ÊçÆÂ∫ìÂêçÁß∞ÔºåÂè™ÂàóÂá∫ÊåáÂÆöÁöÑÊï∞ÊçÆÂ∫ìÁõ∏ÂÖ≥Êìç‰Ωú</li><li>-o --offset=#ÔºöÂøΩÁï•ÊéâÊó•Âøó‰∏≠ÁöÑÂâç n Ë°åÂëΩ‰ª§„ÄÇ</li><li>-r --result-file=nameÔºöÂ∞ÜËæìÂá∫ÁöÑÊñáÊú¨Ê†ºÂºèÊó•ÂøóËæìÂá∫Âà∞ÊåáÂÆöÊñá‰ª∂„ÄÇ</li><li>-s --short-formÔºöÊòæÁ§∫ÁÆÄÂçïÊ†ºÂºèÔºåÁúÅÁï•Êéâ‰∏Ä‰∫õ‰ø°ÊÅØ„ÄÇ</li><li>--start-datatime=date1 --stop-datetime=date2ÔºöÊåáÂÆöÊó•ÊúüÈó¥ÈöîÂÜÖÁöÑÊâÄÊúâÊó•Âøó</li><li>--start-position=pos1 --stop-position=pos2ÔºöÊåáÂÆö‰ΩçÁΩÆÈó¥ÈöîÂÜÖÁöÑÊâÄÊúâÊó•Âøó</li></ul><hr><h4 id="dump" tabindex="-1"><a class="header-anchor" href="#dump"><span>dump</span></a></h4><h5 id="ÂëΩ‰ª§‰ªãÁªç" tabindex="-1"><a class="header-anchor" href="#ÂëΩ‰ª§‰ªãÁªç"><span>ÂëΩ‰ª§‰ªãÁªç</span></a></h5><p>mysqldump ÂÆ¢Êà∑Á´ØÂ∑•ÂÖ∑Áî®Êù•Â§á‰ªΩÊï∞ÊçÆÂ∫ìÊàñÂú®‰∏çÂêåÊï∞ÊçÆÂ∫ì‰πãÈó¥ËøõË°åÊï∞ÊçÆËøÅÁßªÔºåÂ§á‰ªΩÂÜÖÂÆπÂåÖÂê´ÂàõÂª∫Ë°®ÔºåÂèäÊèíÂÖ•Ë°®ÁöÑ SQL ËØ≠Âè•</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [options] db_name [tables] </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [Â§á‰ªΩÂà∞ËØ•Êñá‰ª∂Âêç]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [options] --database/-B db1 [db2 db3...]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [options] --all-databases/-A</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ËøûÊé•ÈÄâÈ°πÔºö</p><ul><li>-u --user=nameÔºöÊåáÂÆöÁî®Êà∑Âêç</li><li>-p --password[=name]ÔºöÊåáÂÆöÂØÜÁ†Å</li><li>-h --host=nameÔºöÊåáÂÆöÊúçÂä°Âô® IP ÊàñÂüüÂêç</li><li>-P --port=#ÔºöÊåáÂÆöËøûÊé•Á´ØÂè£</li></ul><p>ËæìÂá∫ÂÜÖÂÆπÈÄâÈ°πÔºö</p><ul><li>--add-drop-databaseÔºöÂú®ÊØè‰∏™Êï∞ÊçÆÂ∫ìÂàõÂª∫ËØ≠Âè•ÂâçÂä†‰∏ä Drop database ËØ≠Âè•</li><li>--add-drop-tableÔºöÂú®ÊØè‰∏™Ë°®ÂàõÂª∫ËØ≠Âè•ÂâçÂä†‰∏ä Drop table ËØ≠Âè• , ÈªòËÆ§ÂºÄÂêØÔºå‰∏çÂºÄÂêØ (--skip-add-drop-table)</li><li>-n --no-create-dbÔºö‰∏çÂåÖÂê´Êï∞ÊçÆÂ∫ìÁöÑÂàõÂª∫ËØ≠Âè•</li><li>-t --no-create-infoÔºö‰∏çÂåÖÂê´Êï∞ÊçÆË°®ÁöÑÂàõÂª∫ËØ≠Âè•</li><li>-d --no-dataÔºö‰∏çÂåÖÂê´Êï∞ÊçÆ</li><li>-T, --tab=nameÔºöËá™Âä®ÁîüÊàê‰∏§‰∏™Êñá‰ª∂Ôºö‰∏Ä‰∏™ .sql Êñá‰ª∂ÔºåÂàõÂª∫Ë°®ÁªìÊûÑÁöÑËØ≠Âè•Ôºõ‰∏Ä‰∏™ .txt Êñá‰ª∂ÔºåÊï∞ÊçÆÊñá‰ª∂ÔºåÁõ∏ÂΩì‰∫é select into outfile</li></ul><p>Á§∫‰æãÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p2143</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> db01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tb_book</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --add-drop-database</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --add-drop-table</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> a.sql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqldump</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p2143</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /tmp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> city</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ÔºàÊäätestÊï∞ÊçÆÂ∫ìÈáåÁöÑcityË°®ÁîüÊàê‰∏§‰∏™Ë°®Âú®/tmpÁõÆÂΩï‰∏ãÔºâ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h5 id="Êï∞ÊçÆÂ§á‰ªΩ" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÂ§á‰ªΩ"><span>Êï∞ÊçÆÂ§á‰ªΩ</span></a></h5><p>ÂëΩ‰ª§Ë°åÊñπÂºèÔºö</p><ul><li>Â§á‰ªΩÂëΩ‰ª§Ôºömysqldump -u root -p Êï∞ÊçÆÂ∫ìÂêçÁß∞ &gt; Êñá‰ª∂‰øùÂ≠òË∑ØÂæÑ</li><li>ÊÅ¢Â§ç <ol><li>ÁôªÂΩïMySQLÊï∞ÊçÆÂ∫ìÔºö<code>mysql -u root p</code></li><li>Âà†Èô§Â∑≤ÁªèÂ§á‰ªΩÁöÑÊï∞ÊçÆÂ∫ì</li><li>ÈáçÊñ∞ÂàõÂª∫‰∏éÂ§á‰ªΩÊï∞ÊçÆÂ∫ìÂêçÁß∞Áõ∏ÂêåÁöÑÊï∞ÊçÆÂ∫ì</li><li>‰ΩøÁî®ËØ•Êï∞ÊçÆÂ∫ì</li><li>ÂØºÂÖ•Êñá‰ª∂ÊâßË°åÔºö<code>source Â§á‰ªΩÊñá‰ª∂ÂÖ®Ë∑ØÂæÑ</code></li></ol></li></ul><p>Êõ¥Â§öÊñπÂºèÂèÇËÄÉÔºöhttps://time.geekbang.org/column/article/81925</p><p>ÂõæÂΩ¢ÂåñÁïåÈù¢Ôºö</p><ul><li><p>Â§á‰ªΩ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/ÂõæÂΩ¢ÂåñÁïåÈù¢Â§á‰ªΩ.png" alt="ÂõæÂΩ¢ÂåñÁïåÈù¢Â§á‰ªΩ" tabindex="0" loading="lazy"><figcaption>ÂõæÂΩ¢ÂåñÁïåÈù¢Â§á‰ªΩ</figcaption></figure></li><li><p>ÊÅ¢Â§ç</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/ÂõæÂΩ¢ÂåñÁïåÈù¢ÊÅ¢Â§ç.png" alt="ÂõæÂΩ¢ÂåñÁïåÈù¢ÊÅ¢Â§ç" tabindex="0" loading="lazy"><figcaption>ÂõæÂΩ¢ÂåñÁïåÈù¢ÊÅ¢Â§ç</figcaption></figure></li></ul><hr><h4 id="import" tabindex="-1"><a class="header-anchor" href="#import"><span>import</span></a></h4><p>mysqlimport ÊòØÂÆ¢Êà∑Á´ØÊï∞ÊçÆÂØºÂÖ•Â∑•ÂÖ∑ÔºåÁî®Êù•ÂØºÂÖ•mysqldump Âä† -T ÂèÇÊï∞ÂêéÂØºÂá∫ÁöÑÊñáÊú¨Êñá‰ª∂</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqlimport</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [options]  db_name  textfile1  [textfile2...]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Á§∫‰æãÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqlimport</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p2143</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /tmp/city.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ÂØºÂÖ• sql Êñá‰ª∂ÔºåÂèØ‰ª•‰ΩøÁî® MySQL ‰∏≠ÁöÑ source Êåá‰ª§ :</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>source Êñá‰ª∂ÂÖ®Ë∑ØÂæÑ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h4 id="show" tabindex="-1"><a class="header-anchor" href="#show"><span>show</span></a></h4><p>mysqlshow ÂÆ¢Êà∑Á´ØÂØπË±°Êü•ÊâæÂ∑•ÂÖ∑ÔºåÁî®Êù•ÂæàÂø´Âú∞Êü•ÊâæÂ≠òÂú®Âì™‰∫õÊï∞ÊçÆÂ∫ì„ÄÅÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑË°®„ÄÅË°®‰∏≠ÁöÑÂàóÊàñËÄÖÁ¥¢Âºï</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqlshow</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [options] [db_name [table_name [col_name]]]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>--countÔºöÊòæÁ§∫Êï∞ÊçÆÂ∫ìÂèäË°®ÁöÑÁªüËÆ°‰ø°ÊÅØÔºàÊï∞ÊçÆÂ∫ìÔºåË°® ÂùáÂèØ‰ª•‰∏çÊåáÂÆöÔºâ</li><li>-iÔºöÊòæÁ§∫ÊåáÂÆöÊï∞ÊçÆÂ∫ìÊàñËÄÖÊåáÂÆöË°®ÁöÑ<strong>Áä∂ÊÄÅ‰ø°ÊÅØ</strong></li></ul><p>Á§∫‰æãÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#Êü•ËØ¢ÊØè‰∏™Êï∞ÊçÆÂ∫ìÁöÑË°®ÁöÑÊï∞ÈáèÂèäË°®‰∏≠ËÆ∞ÂΩïÁöÑÊï∞Èáè</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqlshow</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p1234</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --count</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#Êü•ËØ¢testÂ∫ì‰∏≠ÊØè‰∏™Ë°®‰∏≠ÁöÑÂ≠óÊÆµ‰π¶ÔºåÂèäË°åÊï∞</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqlshow</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p1234</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --count</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#Êü•ËØ¢testÂ∫ì‰∏≠bookË°®ÁöÑËØ¶ÁªÜÊÉÖÂÜµ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqlshow</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -p1234</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> book</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> --count</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="ÂçïË°®Êìç‰Ωú" tabindex="-1"><a class="header-anchor" href="#ÂçïË°®Êìç‰Ωú"><span>ÂçïË°®Êìç‰Ωú</span></a></h2><h3 id="sql" tabindex="-1"><a class="header-anchor" href="#sql"><span>SQL</span></a></h3><ul><li><p>SQL</p><ul><li>Structured Query LanguageÔºöÁªìÊûÑÂåñÊü•ËØ¢ËØ≠Ë®Ä</li><li>ÂÆö‰πâ‰∫ÜÊìç‰ΩúÊâÄÊúâÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÁöÑËßÑÂàôÔºåÊØèÁßçÊï∞ÊçÆÂ∫ìÊìç‰ΩúÁöÑÊñπÂºèÂèØËÉΩ‰ºöÂ≠òÂú®‰∏ç‰∏ÄÊ†∑ÁöÑÂú∞ÊñπÔºåÁß∞‰∏∫‚ÄúÊñπË®Ä‚Äù</li></ul></li><li><p>SQL ÈÄöÁî®ËØ≠Ê≥ï</p><ul><li>SQL ËØ≠Âè•ÂèØ‰ª•ÂçïË°åÊàñÂ§öË°å‰π¶ÂÜôÔºå‰ª•<strong>ÂàÜÂè∑ÁªìÂ∞æ</strong>„ÄÇ</li><li>ÂèØ‰ΩøÁî®Á©∫Ê†ºÂíåÁº©ËøõÊù•Â¢ûÂº∫ËØ≠Âè•ÁöÑÂèØËØªÊÄß„ÄÇ</li><li>MySQL Êï∞ÊçÆÂ∫ìÁöÑ SQL ËØ≠Âè•‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºå<strong>ÂÖ≥ÈîÆÂ≠óÂª∫ËÆÆ‰ΩøÁî®Â§ßÂÜô</strong>„ÄÇ</li><li>Êï∞ÊçÆÂ∫ìÁöÑÊ≥®ÈáäÔºö <ul><li>ÂçïË°åÊ≥®ÈáäÔºö-- Ê≥®ÈáäÂÜÖÂÆπ #Ê≥®ÈáäÂÜÖÂÆπÔºàMySQL ÁâπÊúâÔºâ</li><li>Â§öË°åÊ≥®ÈáäÔºö/* Ê≥®ÈáäÂÜÖÂÆπ */</li></ul></li></ul></li><li><p>SQL ÂàÜÁ±ª</p><ul><li><p>DDLÔºàData Definition LanguageÔºâÊï∞ÊçÆÂÆö‰πâËØ≠Ë®Ä</p><ul><li>Áî®Êù•ÂÆö‰πâÊï∞ÊçÆÂ∫ìÂØπË±°ÔºöÊï∞ÊçÆÂ∫ìÔºåË°®ÔºåÂàóÁ≠â„ÄÇÂÖ≥ÈîÆÂ≠óÔºöcreate„ÄÅdrop,„ÄÅalter Á≠â</li></ul></li><li><p>DMLÔºàData Manipulation LanguageÔºâÊï∞ÊçÆÊìç‰ΩúËØ≠Ë®Ä</p><ul><li>Áî®Êù•ÂØπÊï∞ÊçÆÂ∫ì‰∏≠Ë°®ÁöÑÊï∞ÊçÆËøõË°åÂ¢ûÂà†Êîπ„ÄÇÂÖ≥ÈîÆÂ≠óÔºöinsert„ÄÅdelete„ÄÅupdate Á≠â</li></ul></li><li><p>DQLÔºàData Query LanguageÔºâÊï∞ÊçÆÊü•ËØ¢ËØ≠Ë®Ä</p><ul><li>Áî®Êù•Êü•ËØ¢Êï∞ÊçÆÂ∫ì‰∏≠Ë°®ÁöÑËÆ∞ÂΩï(Êï∞ÊçÆ)„ÄÇÂÖ≥ÈîÆÂ≠óÔºöselect„ÄÅwhere Á≠â</li></ul></li><li><p>DCLÔºàData Control LanguageÔºâÊï∞ÊçÆÊéßÂà∂ËØ≠Ë®Ä</p><ul><li>Áî®Êù•ÂÆö‰πâÊï∞ÊçÆÂ∫ìÁöÑËÆøÈóÆÊùÉÈôêÂíåÂÆâÂÖ®Á∫ßÂà´ÔºåÂèäÂàõÂª∫Áî®Êà∑„ÄÇÂÖ≥ÈîÆÂ≠óÔºögrantÔºå revokeÁ≠â</li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQLÂàÜÁ±ª.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul></li></ul><hr><h3 id="ddl" tabindex="-1"><a class="header-anchor" href="#ddl"><span>DDL</span></a></h3><h4 id="Êï∞ÊçÆÂ∫ì-1" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÂ∫ì-1"><span>Êï∞ÊçÆÂ∫ì</span></a></h4><ul><li><p>R(Retrieve)ÔºöÊü•ËØ¢</p><ul><li><p>Êü•ËØ¢ÊâÄÊúâÊï∞ÊçÆÂ∫ìÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW DATABASES;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Êüê‰∏™Êï∞ÊçÆÂ∫ìÁöÑÂàõÂª∫ËØ≠Âè•</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> Êï∞ÊçÆÂ∫ìÂêçÁß∞;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">-- Ê†áÂáÜËØ≠Ê≥ï</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> mysql;     </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">-- Êü•ÁúãmysqlÊï∞ÊçÆÂ∫ìÁöÑÂàõÂª∫Ê†ºÂºè</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>C(Create)ÔºöÂàõÂª∫</p><ul><li><p>ÂàõÂª∫Êï∞ÊçÆÂ∫ì</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE DATABASE Êï∞ÊçÆÂ∫ìÂêçÁß∞;-- Ê†áÂáÜËØ≠Ê≥ï</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE DATABASE db1;     -- ÂàõÂª∫db1Êï∞ÊçÆÂ∫ì</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºàÂà§Êñ≠ÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®ÂàôÂàõÂª∫Ôºâ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE DATABASE IF NOT EXISTS Êï∞ÊçÆÂ∫ìÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºåÂπ∂ÊåáÂÆöÂ≠óÁ¨¶ÈõÜ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE DATABASE Êï∞ÊçÆÂ∫ìÂêçÁß∞ CHARACTER SET Â≠óÁ¨¶ÈõÜÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰æãÂ¶ÇÔºöÂàõÂª∫db4Êï∞ÊçÆÂ∫ì„ÄÅÂ¶ÇÊûú‰∏çÂ≠òÂú®ÂàôÂàõÂª∫ÔºåÊåáÂÆöÂ≠óÁ¨¶ÈõÜ‰∏∫gbk</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫db4Êï∞ÊçÆÂ∫ì„ÄÅÂ¶ÇÊûú‰∏çÂ≠òÂú®ÂàôÂàõÂª∫ÔºåÊåáÂÆöÂ≠óÁ¨¶ÈõÜ‰∏∫gbk</span></span>
<span class="line"><span>CREATE DATABASE IF NOT EXISTS db4 CHARACTER SET gbk;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•Áúãdb4Êï∞ÊçÆÂ∫ìÁöÑÂ≠óÁ¨¶ÈõÜ</span></span>
<span class="line"><span>SHOW CREATE DATABASE db4;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>U(Update)Ôºö‰øÆÊîπ</p><ul><li><p>‰øÆÊîπÊï∞ÊçÆÂ∫ìÁöÑÂ≠óÁ¨¶ÈõÜ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER DATABASE Êï∞ÊçÆÂ∫ìÂêçÁß∞ CHARACTER SET Â≠óÁ¨¶ÈõÜÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Â∏∏Áî®Â≠óÁ¨¶ÈõÜÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>--Êü•ËØ¢ÊâÄÊúâÊîØÊåÅÁöÑÂ≠óÁ¨¶ÈõÜ</span></span>
<span class="line"><span>SHOW CHARSET;</span></span>
<span class="line"><span>--Êü•ÁúãÊâÄÊúâÊîØÊåÅÁöÑÊ†°ÂØπËßÑÂàô</span></span>
<span class="line"><span>SHOW COLLATION;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Â≠óÁ¨¶ÈõÜ: utf8,latinI,GBK,,GBKÊòØutf8ÁöÑÂ≠êÈõÜ</span></span>
<span class="line"><span>-- Ê†°ÂØπËßÑÂàô: ci Â§ßÂ∞èÂÆö‰∏çÊïèÊÑüÔºåcsÊàñbinÂ§ßÂ∞èÂÜôÊïèÊÑü</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>D(Delete)ÔºöÂà†Èô§</p><ul><li><p>Âà†Èô§Êï∞ÊçÆÂ∫ìÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP DATABASE Êï∞ÊçÆÂ∫ìÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âà†Èô§Êï∞ÊçÆÂ∫ì(Âà§Êñ≠ÔºåÂ¶ÇÊûúÂ≠òÂú®ÂàôÂà†Èô§)Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP DATABASE IF EXISTS Êï∞ÊçÆÂ∫ìÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p>‰ΩøÁî®Êï∞ÊçÆÂ∫ìÔºö</p><ul><li><p>Êü•ËØ¢ÂΩìÂâçÊ≠£Âú®‰ΩøÁî®ÁöÑÊï∞ÊçÆÂ∫ìÂêçÁß∞</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT DATABASE();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰ΩøÁî®Êï∞ÊçÆÂ∫ì</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>USE Êï∞ÊçÆÂ∫ìÂêçÁß∞Ôºõ -- Ê†áÂáÜËØ≠Ê≥ï</span></span>
<span class="line"><span>USE db4;	   -- ‰ΩøÁî®db4Êï∞ÊçÆÂ∫ì</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><hr><h4 id="Êï∞ÊçÆË°®" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆË°®"><span>Êï∞ÊçÆË°®</span></a></h4><ul><li><p>R(Retrieve)ÔºöÊü•ËØ¢</p><ul><li><p>Êü•ËØ¢Êï∞ÊçÆÂ∫ì‰∏≠ÊâÄÊúâÁöÑÊï∞ÊçÆË°®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>USE mysql;-- ‰ΩøÁî®mysqlÊï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span></span></span>
<span class="line"><span>SHOW TABLES;-- Êü•ËØ¢Â∫ì‰∏≠ÊâÄÊúâÁöÑË°®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Ë°®ÁªìÊûÑ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DESC Ë°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Ë°®Â≠óÁ¨¶ÈõÜ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW TABLE STATUS FROM Â∫ìÂêç LIKE &#39;Ë°®Âêç&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p>C(Create)ÔºöÂàõÂª∫</p><ul><li><p>ÂàõÂª∫Êï∞ÊçÆË°®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE Ë°®Âêç(</span></span>
<span class="line"><span>    ÂàóÂêç1 Êï∞ÊçÆÁ±ªÂûã1,</span></span>
<span class="line"><span>    ÂàóÂêç2 Êï∞ÊçÆÁ±ªÂûã2,</span></span>
<span class="line"><span>    ....</span></span>
<span class="line"><span>    ÂàóÂêçn Êï∞ÊçÆÁ±ªÂûãn</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê≥®ÊÑèÔºöÊúÄÂêé‰∏ÄÂàóÔºå‰∏çÈúÄË¶ÅÂä†ÈÄóÂè∑</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ÁªôÊüêÂàóÂä†‰∏äÊèèËø∞ÔºåÊ†ºÂºè‰∏∫Ôºö</p><p>ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã comment &#39;Â≠óÊÆµÊèèËø∞&#39;,</p><p>ÊääÊüê‰∏ÄÂàóÂ±ûÊÄßËÆæÁΩÆ‰∏∫Êó†Á¨¶Âè∑ÁöÑ unsigned:</p><p>ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã unsignedÔºå</p></li><li><p>Â§çÂà∂Ë°®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE Ë°®Âêç LIKE Ë¢´Â§çÂà∂ÁöÑË°®Âêç;  -- Ê†áÂáÜËØ≠Ê≥ï</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE TABLE product2 LIKE product; -- Â§çÂà∂productË°®Âà∞product2Ë°®</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êï∞ÊçÆÁ±ªÂûã</p><p>| Êï∞ÊçÆÁ±ªÂûã | ËØ¥Êòé | | --------- | ------------------------------------------------------------ | | TINYINT | 1 byte (-128,127) | | AMALLINT | 2 byte(-32768,32767) | | MEDIUMINT | 3 byte(-8388608,8388607) | | INT | Êï¥Êï∞Á±ªÂûã | | FLOAT | ÂçïÁ≤æÂ∫¶ÊµÆÁÇπ | | DOUBLE | Â∞èÊï∞Á±ªÂûã | | DATE | Êó•ÊúüÔºåÂè™ÂåÖÂê´Âπ¥ÊúàÊó•Ôºöyyyy-MM-dd | | DATETIME | Êó•ÊúüÔºåÂåÖÂê´Âπ¥ÊúàÊó•Êó∂ÂàÜÁßíÔºöyyyy-MM-dd HH:mm:ss | | TIMESTAMP | Êó∂Èó¥Êà≥Á±ªÂûãÔºåÂåÖÂê´Âπ¥ÊúàÊó•Êó∂ÂàÜÁßíÔºöyyyy-MM-dd HH:mm:ss<br>Â¶ÇÊûú‰∏çÁªôËøô‰∏™Â≠óÊÆµËµãÂÄºÊàñËµãÂÄº‰∏∫ NULLÔºåÂàôÈªòËÆ§‰ΩøÁî®ÂΩìÂâçÁöÑÁ≥ªÁªüÊó∂Èó¥ | | CHAR | Â≠óÁ¨¶‰∏≤ÔºåÂÆöÈïøÁ±ªÂûã | | VARCHAR | Â≠óÁ¨¶‰∏≤Ôºå<strong>ÂèòÈïøÁ±ªÂûã</strong><br>name varchar(20) ‰ª£Ë°®ÂßìÂêçÊúÄÂ§ß 20 ‰∏™Â≠óÁ¨¶Ôºözhangsan 8 ‰∏™Â≠óÁ¨¶ÔºåÂº†‰∏â 2 ‰∏™Â≠óÁ¨¶ |</p><p><code>INT(n)</code>Ôºön ‰ª£Ë°®‰ΩçÊï∞</p><ul><li>3ÔºöintÔºà9ÔºâÊòæÁ§∫ÁªìÊûú‰∏∫ 000000010</li><li>3ÔºöintÔºà3ÔºâÊòæÁ§∫ÁªìÊûú‰∏∫ 010</li></ul><p><code>varchar(n)</code>Ôºön Ë°®Á§∫ÁöÑÊòØÂ≠óÁ¨¶Êï∞</p></li><li><p>‰æãÂ¶ÇÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ‰ΩøÁî®db3Êï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span>USE db3;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂàõÂª∫‰∏Ä‰∏™productÂïÜÂìÅË°®</span></span>
<span class="line"><span>CREATE TABLE product(</span></span>
<span class="line"><span>	id INT,				-- ÂïÜÂìÅÁºñÂè∑</span></span>
<span class="line"><span>	NAME VARCHAR(30),	-- ÂïÜÂìÅÂêçÁß∞</span></span>
<span class="line"><span>	price DOUBLE,		-- ÂïÜÂìÅ‰ª∑Ê†º</span></span>
<span class="line"><span>	stock INT,			-- ÂïÜÂìÅÂ∫ìÂ≠ò</span></span>
<span class="line"><span>	insert_time DATE    -- ‰∏äÊû∂Êó∂Èó¥</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><p>‚Äã</p><ul><li><p>U(Update)Ôºö‰øÆÊîπ</p><ul><li><p>‰øÆÊîπË°®Âêç</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç RENAME TO Êñ∞ÁöÑË°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰øÆÊîπË°®ÁöÑÂ≠óÁ¨¶ÈõÜ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç CHARACTER SET Â≠óÁ¨¶ÈõÜÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Ê∑ªÂä†‰∏ÄÂàó</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç ADD ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰øÆÊîπÂàóÊï∞ÊçÆÁ±ªÂûã</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç MODIFY ÂàóÂêç Êñ∞Êï∞ÊçÆÁ±ªÂûã;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰øÆÊîπÂàóÂêçÁß∞ÂíåÊï∞ÊçÆÁ±ªÂûã</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç CHANGE ÂàóÂêç Êñ∞ÂàóÂêç Êñ∞Êï∞ÊçÆÁ±ªÂûã;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âà†Èô§Âàó</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç DROP ÂàóÂêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li><li><p>D(Delete)ÔºöÂà†Èô§</p><ul><li><p>Âà†Èô§Êï∞ÊçÆË°®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP TABLE Ë°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âà†Èô§Êï∞ÊçÆË°®(Âà§Êñ≠ÔºåÂ¶ÇÊûúÂ≠òÂú®ÂàôÂà†Èô§)</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP TABLE IF EXISTS Ë°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul></li></ul><hr><h3 id="dml" tabindex="-1"><a class="header-anchor" href="#dml"><span>DML</span></a></h3><h4 id="insert" tabindex="-1"><a class="header-anchor" href="#insert"><span>INSERT</span></a></h4><ul><li><p>Êñ∞Â¢ûË°®Êï∞ÊçÆ</p><ul><li><p>Êñ∞Â¢ûÊ†ºÂºè 1ÔºöÁªôÊåáÂÆöÂàóÊ∑ªÂä†Êï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>INSERT INTO Ë°®Âêç(ÂàóÂêç1,ÂàóÂêç2...) VALUES (ÂÄº1,ÂÄº2...);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êñ∞Â¢ûÊ†ºÂºè 2ÔºöÈªòËÆ§ÁªôÂÖ®ÈÉ®ÂàóÊ∑ªÂä†Êï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>INSERT INTO Ë°®Âêç VALUES (ÂÄº1,ÂÄº2,ÂÄº3,...);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êñ∞Â¢ûÊ†ºÂºè 3ÔºöÊâπÈáèÊ∑ªÂä†Êï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÁªôÊåáÂÆöÂàóÊâπÈáèÊ∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO Ë°®Âêç(ÂàóÂêç1,ÂàóÂêç2,...) VALUES (ÂÄº1,ÂÄº2,...),(ÂÄº1,ÂÄº2,...)...;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÈªòËÆ§ÁªôÊâÄÊúâÂàóÊâπÈáèÊ∑ªÂä†Êï∞ÊçÆ </span></span>
<span class="line"><span>INSERT INTO Ë°®Âêç VALUES (ÂÄº1,ÂÄº2,ÂÄº3,...),(ÂÄº1,ÂÄº2,ÂÄº3,...)...;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>Â≠óÁ¨¶‰∏≤ÊãºÊé•</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CONCAT(string1,string2,&#39;&#39;,...)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Ê≥®ÊÑè‰∫ãÈ°π</p><ul><li>ÂàóÂêçÂíåÂÄºÁöÑÊï∞Èáè‰ª•ÂèäÊï∞ÊçÆÁ±ªÂûãË¶ÅÂØπÂ∫î</li><li>Èô§‰∫ÜÊï∞Â≠óÁ±ªÂûãÔºåÂÖ∂‰ªñÊï∞ÊçÆÁ±ªÂûãÁöÑÊï∞ÊçÆÈÉΩÈúÄË¶ÅÂä†ÂºïÂè∑(ÂçïÂºïÂèåÂºïÈÉΩÂèØ‰ª•ÔºåÊé®ËçêÂçïÂºï)</li></ul></li></ul><hr><h4 id="update" tabindex="-1"><a class="header-anchor" href="#update"><span>UPDATE</span></a></h4><ul><li><p>‰øÆÊîπË°®Êï∞ÊçÆËØ≠Ê≥ï</p><ul><li><p>Ê†áÂáÜËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>UPDATE Ë°®Âêç SET ÂàóÂêç1 = ÂÄº1,ÂàóÂêç2 = ÂÄº2,... [where Êù°‰ª∂];</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰øÆÊîπÁîµËßÜÁöÑ‰ª∑Ê†º‰∏∫1800„ÄÅÂ∫ìÂ≠ò‰∏∫36</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>UPDATE product SET price=1800,stock=36 WHERE NAME=&#39;ÁîµËßÜ&#39;;</span></span>
<span class="line"><span>SELECT * FROM product;-- Êü•ÁúãÊâÄÊúâÂïÜÂìÅ‰ø°ÊÅØ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>Ê≥®ÊÑè‰∫ãÈ°π</p><ul><li>‰øÆÊîπËØ≠Âè•‰∏≠ÂøÖÈ°ªÂä†Êù°‰ª∂</li><li>Â¶ÇÊûú‰∏çÂä†Êù°‰ª∂ÔºåÂàôÂ∞ÜÊâÄÊúâÊï∞ÊçÆÈÉΩ‰øÆÊîπ</li></ul></li></ul><hr><h4 id="delete" tabindex="-1"><a class="header-anchor" href="#delete"><span>DELETE</span></a></h4><ul><li><p>Âà†Èô§Ë°®Êï∞ÊçÆËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELETE FROM Ë°®Âêç [WHERE Êù°‰ª∂];</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Ê≥®ÊÑè‰∫ãÈ°π</p><ul><li>Âà†Èô§ËØ≠Âè•‰∏≠ÂøÖÈ°ªÂä†Êù°‰ª∂</li><li>Â¶ÇÊûú‰∏çÂä†Êù°‰ª∂ÔºåÂàôÂ∞ÜÊâÄÊúâÊï∞ÊçÆÂà†Èô§</li></ul></li></ul><p>‚Äã</p><hr><h3 id="dql" tabindex="-1"><a class="header-anchor" href="#dql"><span>DQL</span></a></h3><h4 id="Êü•ËØ¢ËØ≠Ê≥ï" tabindex="-1"><a class="header-anchor" href="#Êü•ËØ¢ËØ≠Ê≥ï"><span>Êü•ËØ¢ËØ≠Ê≥ï</span></a></h4><p>Êï∞ÊçÆÂ∫ìÊü•ËØ¢ÈÅµÂæ™Êù°‰ª∂Âú®ÂâçÁöÑÂéüÂàô</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT DISTINCT</span></span>
<span class="line"><span>	&lt;select list&gt;</span></span>
<span class="line"><span>FROM</span></span>
<span class="line"><span>	&lt;left_table&gt; &lt;join_type&gt;</span></span>
<span class="line"><span>JOIN</span></span>
<span class="line"><span>	&lt;right_table&gt; ON &lt;join_condition&gt;	-- ËøûÊé•Êü•ËØ¢Âú®Â§öË°®Êü•ËØ¢ÈÉ®ÂàÜËØ¶Ëß£</span></span>
<span class="line"><span>WHERE</span></span>
<span class="line"><span>	&lt;where_condition&gt;</span></span>
<span class="line"><span>GROUP BY</span></span>
<span class="line"><span>	&lt;group_by_list&gt;</span></span>
<span class="line"><span>HAVING</span></span>
<span class="line"><span>	&lt;having_condition&gt;</span></span>
<span class="line"><span>ORDER BY</span></span>
<span class="line"><span>	&lt;order_by_condition&gt;</span></span>
<span class="line"><span>LIMIT</span></span>
<span class="line"><span>	&lt;limit_params&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ÊâßË°åÈ°∫Â∫èÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>FROM	&lt;left_table&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ON 		&lt;join_condition&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>&lt;join_type&gt;		JOIN	&lt;right_table&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>WHERE		&lt;where_condition&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GROUP BY 	&lt;group_by_list&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>HAVING		&lt;having_condition&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>SELECT DISTINCT		&lt;select list&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ORDER BY	&lt;order_by_condition&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>LIMIT		&lt;limit_params&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>whereÂíåhavingÁöÑÂå∫Âà´Ôºö</strong></p><p>ÊâßË°åÊó∂Êú∫‰∏çÂêåÔºö whereÊòØÂàÜÁªÑ‰πãÂâçËøõË°åËøáÊª§Ôºå‰∏çÊª°Ë∂≥whereÊù°‰ª∂Ôºå‰∏çÂèÇ‰∏éÂàÜÁªÑÔºõËÄåhavingÊòØÂàÜÁªÑ‰πãÂêéÂØπÁªìÊûúËøõË°åËøáÊª§„ÄÇ</p><p>Âà§Êñ≠Êù°‰ª∂‰∏çÂêåÔºöwhere‰∏çËÉΩÂØπËÅöÂêàÂáΩÊï∞ËøõË°åÂà§Êñ≠ÔºåËÄåhavingÂèØ‰ª•„ÄÇ</p><p>ORDER BY Êúâ‰∏§‰∏™Â±ûÊÄßÔºöasc„ÄÅdesc„ÄÇÂ¶ÇÊûú‰∏çÂÜôÂ±ûÊÄßÁöÑËØùÈªòËÆ§ÊòØasc„ÄÇ</p><hr><h4 id="Êü•ËØ¢ÂÖ®ÈÉ®" tabindex="-1"><a class="header-anchor" href="#Êü•ËØ¢ÂÖ®ÈÉ®"><span>Êü•ËØ¢ÂÖ®ÈÉ®</span></a></h4><ul><li><p>Êü•ËØ¢ÂÖ®ÈÉ®ÁöÑË°®Êï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Ê†áÂáÜËØ≠Ê≥ï</span></span>
<span class="line"><span>SELECT * FROM Ë°®Âêç;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢productË°®ÊâÄÊúâÊï∞ÊçÆ(Â∏∏Áî®)ÔºåÊ≠§ÊñπÊ≥ï‰ºöÂΩ±ÂìçÊü•ËØ¢Êï∞ÊçÆÁöÑÊïàÁéáÔºåÂ¶ÇÊûúÂØπÊïàÁéáÊúâË¶ÅÊ±Ç‰∏çÂª∫ËÆÆ‰ΩøÁî®</span></span>
<span class="line"><span>SELECT * FROM product;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢ÊåáÂÆöÂ≠óÊÆµÁöÑË°®Êï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç1,ÂàóÂêç2,... FROM Ë°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>ÂéªÈô§ÈáçÂ§çÊü•ËØ¢</strong>ÔºöÂè™ÊúâÂÄºÂÖ®ÈÉ®ÈáçÂ§çÁöÑÊâçÂèØ‰ª•ÂéªÈô§ÔºåÈúÄË¶ÅÂàõÂª∫‰∏¥Êó∂Ë°®ËæÖÂä©Êü•ËØ¢</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT DISTINCT ÂàóÂêç1,ÂàóÂêç2,... FROM Ë°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ËÆ°ÁÆóÂàóÁöÑÂÄºÔºàÂõõÂàôËøêÁÆóÔºâ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç1 ËøêÁÆóÁ¨¶(+ - * /) ÂàóÂêç2 FROM Ë°®Âêç;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/*Â¶ÇÊûúÊüê‰∏ÄÂàóÂÄº‰∏∫nullÔºåÂèØ‰ª•ËøõË°åÊõøÊç¢</span></span>
<span class="line"><span>	ifnull(Ë°®ËææÂºè1,Ë°®ËææÂºè2)</span></span>
<span class="line"><span>	Ë°®ËææÂºè1ÔºöÊÉ≥ÊõøÊç¢ÁöÑÂàó</span></span>
<span class="line"><span>	Ë°®ËææÂºè2ÔºöÊÉ≥ÊõøÊç¢ÁöÑÂÄº*/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>‰æãÂ¶ÇÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Êü•ËØ¢ÂïÜÂìÅÂêçÁß∞ÂíåÂ∫ìÂ≠òÔºåÂ∫ìÂ≠òÊï∞ÈáèÂú®ÂéüÊúâÂü∫Á°Ä‰∏äÂä†10</span></span>
<span class="line"><span>SELECT NAME,stock+10 FROM product;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢ÂïÜÂìÅÂêçÁß∞ÂíåÂ∫ìÂ≠òÔºåÂ∫ìÂ≠òÊï∞ÈáèÂú®ÂéüÊúâÂü∫Á°Ä‰∏äÂä†10„ÄÇËøõË°ånullÂÄºÂà§Êñ≠</span></span>
<span class="line"><span>SELECT NAME,IFNULL(stock,0)+10 FROM product;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>Ëµ∑Âà´Âêç</strong></p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç1,ÂàóÂêç2,... AS Âà´Âêç FROM Ë°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>‰æãÂ¶ÇÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Êü•ËØ¢ÂïÜÂìÅÂêçÁß∞ÂíåÂ∫ìÂ≠òÔºåÂ∫ìÂ≠òÊï∞ÈáèÂú®ÂéüÊúâÂü∫Á°Ä‰∏äÂä†10„ÄÇËøõË°ånullÂÄºÂà§Êñ≠ÔºåËµ∑Âà´Âêç‰∏∫getSum,ASÂèØ‰ª•ÁúÅÁï•„ÄÇ</span></span>
<span class="line"><span>SELECT NAME,IFNULL(stock,0)+10 AS getsum FROM product;</span></span>
<span class="line"><span>SELECT NAME,IFNULL(stock,0)+10 getsum FROM product;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="Êù°‰ª∂Êü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#Êù°‰ª∂Êü•ËØ¢"><span>Êù°‰ª∂Êü•ËØ¢</span></a></h4><ul><li><p>Êù°‰ª∂Êü•ËØ¢ËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç WHERE Êù°‰ª∂;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êù°‰ª∂ÂàÜÁ±ª</p><table><thead><tr><th>Á¨¶Âè∑</th><th>ÂäüËÉΩ</th></tr></thead><tbody><tr><td>&gt;</td><td>Â§ß‰∫é</td></tr><tr><td>&lt;</td><td>Â∞è‰∫é</td></tr><tr><td>&gt;=</td><td>Â§ß‰∫éÁ≠â‰∫é</td></tr><tr><td>&lt;=</td><td>Â∞è‰∫éÁ≠â‰∫é</td></tr><tr><td>=</td><td>Á≠â‰∫é</td></tr><tr><td>&lt;&gt; Êàñ !=</td><td>‰∏çÁ≠â‰∫é</td></tr><tr><td>BETWEEN ... AND ...</td><td>Âú®Êüê‰∏™ËåÉÂõ¥‰πãÂÜÖ(ÈÉΩÂåÖÂê´)ÔºåÂâç‰∏Ä‰∏™Êï∞ÂøÖÈ°ªÂ∞è‰∫éÂêé‰∏Ä‰∏™Êï∞</td></tr><tr><td>IN(...)</td><td>Â§öÈÄâ‰∏Ä</td></tr><tr><td>LIKE</td><td><strong>Ê®°Á≥äÊü•ËØ¢</strong>Ôºö_Âçï‰∏™‰ªªÊÑèÂ≠óÁ¨¶„ÄÅ%‰ªªÊÑè‰∏™Â≠óÁ¨¶„ÄÅ[] ÂåπÈÖçÈõÜÂêàÂÜÖÁöÑÂ≠óÁ¨¶<br><code>LIKE &#39;[^AB]%&#39; </code>Ôºö‰∏ç‰ª• A Âíå B ÂºÄÂ§¥ÁöÑ‰ªªÊÑèÊñáÊú¨</td></tr><tr><td>IS NULL</td><td>ÊòØNULL</td></tr><tr><td>IS NOT NULL</td><td>‰∏çÊòØNULL</td></tr><tr><td>AND Êàñ &amp;&amp;</td><td>Âπ∂‰∏î</td></tr><tr><td>OR Êàñ ||</td><td>ÊàñËÄÖ</td></tr><tr><td>NOT Êàñ !</td><td>ÈùûÔºå‰∏çÊòØ</td></tr><tr><td>UNION</td><td>ÂØπ‰∏§‰∏™ÁªìÊûúÈõÜËøõË°å<strong>Âπ∂ÈõÜÊìç‰ΩúÂπ∂ËøõË°åÂéªÈáçÔºåÂêåÊó∂ËøõË°åÈªòËÆ§ËßÑÂàôÁöÑÊéíÂ∫è</strong></td></tr><tr><td>UNION ALL</td><td>ÂØπ‰∏§‰∏™ÁªìÊûúÈõÜËøõË°åÂπ∂ÈõÜÊìç‰Ωú‰∏çËøõË°åÂéªÈáçÔºå‰∏çËøõË°åÊéíÂ∫è</td></tr></tbody></table></li><li><p>‰æãÂ¶ÇÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Êü•ËØ¢Â∫ìÂ≠òÂ§ß‰∫é20ÁöÑÂïÜÂìÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT * FROM product WHERE stock &gt; 20;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢ÂìÅÁâå‰∏∫Âçé‰∏∫ÁöÑÂïÜÂìÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT * FROM product WHERE brand=&#39;Âçé‰∏∫&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢ÈáëÈ¢ùÂú®4000 ~ 6000‰πãÈó¥ÁöÑÂïÜÂìÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT * FROM product WHERE price &gt;= 4000 AND price &lt;= 6000;</span></span>
<span class="line"><span>SELECT * FROM product WHERE price BETWEEN 4000 AND 6000;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢Â∫ìÂ≠ò‰∏∫14„ÄÅ30„ÄÅ23ÁöÑÂïÜÂìÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT * FROM product WHERE stock=14 OR stock=30 OR stock=23;</span></span>
<span class="line"><span>SELECT * FROM product WHERE stock IN(14,30,23);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢Â∫ìÂ≠ò‰∏∫nullÁöÑÂïÜÂìÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT * FROM product WHERE stock IS NULL;</span></span>
<span class="line"><span>-- Êü•ËØ¢Â∫ìÂ≠ò‰∏ç‰∏∫nullÁöÑÂïÜÂìÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT * FROM product WHERE stock IS NOT NULL;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢ÂêçÁß∞‰ª•&#39;Â∞èÁ±≥&#39;‰∏∫ÂºÄÂ§¥ÁöÑÂïÜÂìÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT * FROM product WHERE NAME LIKE &#39;Â∞èÁ±≥%&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢ÂêçÁß∞Á¨¨‰∫å‰∏™Â≠óÊòØ&#39;‰∏∫&#39;ÁöÑÂïÜÂìÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT * FROM product WHERE NAME LIKE &#39;_‰∏∫%&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢ÂêçÁß∞‰∏∫Âõõ‰∏™Â≠óÁ¨¶ÁöÑÂïÜÂìÅ‰ø°ÊÅØ 4‰∏™‰∏ãÂàíÁ∫ø</span></span>
<span class="line"><span>SELECT * FROM product WHERE NAME LIKE &#39;____&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢ÂêçÁß∞‰∏≠ÂåÖÂê´ÁîµËÑëÁöÑÂïÜÂìÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT * FROM product WHERE NAME LIKE &#39;%ÁîµËÑë%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-DQLÊï∞ÊçÆÂáÜÂ§á.png" style="zoom:80%;"></li></ul><hr><h4 id="ÂáΩÊï∞Êü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#ÂáΩÊï∞Êü•ËØ¢"><span>ÂáΩÊï∞Êü•ËØ¢</span></a></h4><h5 id="ËÅöÂêàÂáΩÊï∞" tabindex="-1"><a class="header-anchor" href="#ËÅöÂêàÂáΩÊï∞"><span>ËÅöÂêàÂáΩÊï∞</span></a></h5><p>ËÅöÂêàÂáΩÊï∞ÔºöÂ∞Ü‰∏ÄÂàóÊï∞ÊçÆ‰Ωú‰∏∫‰∏Ä‰∏™Êï¥‰ΩìÔºåËøõË°åÁ∫µÂêëÁöÑËÆ°ÁÆó</p><ul><li><p>ËÅöÂêàÂáΩÊï∞ËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂáΩÊï∞Âêç(ÂàóÂêç) FROM Ë°®Âêç [WHERE Êù°‰ª∂]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ËÅöÂêàÂáΩÊï∞ÂàÜÁ±ª</p><table><thead><tr><th>ÂáΩÊï∞Âêç</th><th>ÂäüËÉΩ</th></tr></thead><tbody><tr><td>COUNT(ÂàóÂêç)</td><td>ÁªüËÆ°Êï∞ÈáèÔºà‰∏ÄËà¨ÈÄâÁî®‰∏ç‰∏∫ null ÁöÑÂàóÔºâ</td></tr><tr><td>MAX(ÂàóÂêç)</td><td>ÊúÄÂ§ßÂÄº</td></tr><tr><td>MIN(ÂàóÂêç)</td><td>ÊúÄÂ∞èÂÄº</td></tr><tr><td>SUM(ÂàóÂêç)</td><td>Ê±ÇÂíå</td></tr><tr><td>AVG(ÂàóÂêç)</td><td>Âπ≥ÂùáÂÄºÔºà‰ºöÂøΩÁï• null Ë°åÔºâ</td></tr></tbody></table></li><li><p>‰æãÂ¶Ç</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ËÆ°ÁÆóproductË°®‰∏≠ÊÄªËÆ∞ÂΩïÊù°Êï∞ 7</span></span>
<span class="line"><span>SELECT COUNT(*) FROM product;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ëé∑ÂèñÊúÄÈ´ò‰ª∑Ê†º</span></span>
<span class="line"><span>SELECT MAX(price) FROM product;</span></span>
<span class="line"><span>-- Ëé∑ÂèñÊúÄÈ´ò‰ª∑Ê†ºÁöÑÂïÜÂìÅÂêçÁß∞</span></span>
<span class="line"><span>SELECT NAME,price FROM product WHERE price = (SELECT MAX(price) FROM product);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ëé∑ÂèñÊúÄ‰ΩéÂ∫ìÂ≠ò</span></span>
<span class="line"><span>SELECT MIN(stock) FROM product;</span></span>
<span class="line"><span>-- Ëé∑ÂèñÊúÄ‰ΩéÂ∫ìÂ≠òÁöÑÂïÜÂìÅÂêçÁß∞</span></span>
<span class="line"><span>SELECT NAME,stock FROM product WHERE stock = (SELECT MIN(stock) FROM product);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ëé∑ÂèñÊÄªÂ∫ìÂ≠òÊï∞Èáè</span></span>
<span class="line"><span>SELECT SUM(stock) FROM product;</span></span>
<span class="line"><span>-- Ëé∑ÂèñÂìÅÁâå‰∏∫Â∞èÁ±≥ÁöÑÂπ≥ÂùáÂïÜÂìÅ‰ª∑Ê†º</span></span>
<span class="line"><span>SELECT AVG(price) FROM product WHERE brand=&#39;Â∞èÁ±≥&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h5 id="ÊñáÊú¨ÂáΩÊï∞" tabindex="-1"><a class="header-anchor" href="#ÊñáÊú¨ÂáΩÊï∞"><span>ÊñáÊú¨ÂáΩÊï∞</span></a></h5><p>CONCAT()ÔºöÁî®‰∫éËøûÊé•‰∏§‰∏™Â≠óÊÆµ</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> CONCAT</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">TRIM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(col1), </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;(&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">TRIM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(col2), </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> concat_col </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> mytable</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">-- ËÆ∏Â§öÊï∞ÊçÆÂ∫ì‰ºö‰ΩøÁî®Á©∫Ê†ºÊää‰∏Ä‰∏™ÂÄºÂ°´ÂÖÖ‰∏∫ÂàóÂÆΩÔºåËøûÊé•ÁöÑÁªìÊûúÂá∫Áé∞‰∏Ä‰∫õ‰∏çÂøÖË¶ÅÁöÑÁ©∫Ê†ºÔºå‰ΩøÁî®TRIM()ÂèØ‰ª•ÂéªÈô§È¶ñÂ∞æÁ©∫Ê†º</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>ÂáΩÊï∞ÂêçÁß∞</th><th>‰Ωú Áî®</th></tr></thead><tbody><tr><td>LENGTH</td><td>ËÆ°ÁÆóÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÂáΩÊï∞ÔºåËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑÂ≠óËäÇÈïøÂ∫¶</td></tr><tr><td>CONCAT(s1,s2...sn)</td><td>ÂêàÂπ∂Â≠óÁ¨¶‰∏≤ÂáΩÊï∞ÔºåËøîÂõûÁªìÊûú‰∏∫ËøûÊé•ÂèÇÊï∞‰∫ßÁîüÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂèÇÊï∞ÂèØ‰ª•‰Ωø‰∏Ä‰∏™ÊàñÂ§ö‰∏™</td></tr><tr><td>INSERT</td><td>ÊõøÊç¢Â≠óÁ¨¶‰∏≤ÂáΩÊï∞</td></tr><tr><td>LOWER</td><td>Â∞ÜÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂ≠óÊØçËΩ¨Êç¢‰∏∫Â∞èÂÜô</td></tr><tr><td>UPPER</td><td>Â∞ÜÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂ≠óÊØçËΩ¨Êç¢‰∏∫Â§ßÂÜô</td></tr><tr><td>LEFT</td><td>‰ªéÂ∑¶‰æßÂ≠óÊà™ÂèñÁ¨¶‰∏≤ÔºåËøîÂõûÂ≠óÁ¨¶‰∏≤Â∑¶ËæπÁöÑËã•Âπ≤‰∏™Â≠óÁ¨¶</td></tr><tr><td>RIGHT</td><td>‰ªéÂè≥‰æßÂ≠óÊà™ÂèñÁ¨¶‰∏≤ÔºåËøîÂõûÂ≠óÁ¨¶‰∏≤Âè≥ËæπÁöÑËã•Âπ≤‰∏™Â≠óÁ¨¶</td></tr><tr><td>TRIM</td><td>Âà†Èô§Â≠óÁ¨¶‰∏≤Â∑¶Âè≥‰∏§‰æßÁöÑÁ©∫Ê†º</td></tr><tr><td>REPLACE</td><td>Â≠óÁ¨¶‰∏≤ÊõøÊç¢ÂáΩÊï∞ÔºåËøîÂõûÊõøÊç¢ÂêéÁöÑÊñ∞Â≠óÁ¨¶‰∏≤</td></tr><tr><td>SUBSTRING(str,start,len)</td><td>Êà™ÂèñÂ≠óÁ¨¶‰∏≤ÔºåËøîÂõû‰ªéÊåáÂÆö‰ΩçÁΩÆÂºÄÂßãÁöÑÊåáÂÆöÈïøÂ∫¶ÁöÑÂ≠óÁ¨¶Êç¢</td></tr><tr><td>REVERSE</td><td>Â≠óÁ¨¶‰∏≤ÂèçËΩ¨ÔºàÈÄÜÂ∫èÔºâÂáΩÊï∞ÔºåËøîÂõû‰∏éÂéüÂßãÂ≠óÁ¨¶‰∏≤È°∫Â∫èÁõ∏ÂèçÁöÑÂ≠óÁ¨¶‰∏≤</td></tr><tr><td>LPAD(str,n,pad)</td><td>Â∑¶Â°´ÂÖÖÔºåÁî®Â≠óÁ¨¶‰∏≤padÂØπstrÁöÑÂ∑¶ËæπËøõË°åÂ°´ÂÖÖÔºåËææÂà∞n‰∏™Â≠óÁ¨¶<br>‰∏≤ÈïøÂ∫¶</td></tr><tr><td>RPAD(str,n,pad)</td><td>Âè≥Â°´ÂÖÖÔºåÁî®Â≠óÁ¨¶‰∏≤padÂØπstrÁöÑÂè≥ËæπËøõË°åÂ°´ÂÖÖÔºåËææÂà∞n‰∏™Â≠óÁ¨¶<br>‰∏≤ÈïøÂ∫¶</td></tr></tbody></table><hr><h5 id="Êï∞Â≠óÂáΩÊï∞" tabindex="-1"><a class="header-anchor" href="#Êï∞Â≠óÂáΩÊï∞"><span>Êï∞Â≠óÂáΩÊï∞</span></a></h5><table><thead><tr><th>ÂáΩÊï∞ÂêçÁß∞</th><th>‰Ωú Áî®</th></tr></thead><tbody><tr><td>ABS</td><td>Ê±ÇÁªùÂØπÂÄº</td></tr><tr><td>SQRT</td><td>Ê±Ç‰∫åÊ¨°ÊñπÊ†π</td></tr><tr><td>CEIL</td><td>Âêë‰∏äÂèñÊï¥</td></tr><tr><td>MOD(x,y)</td><td>Ê±Çx/yÁöÑ‰ΩôÊï∞</td></tr><tr><td>CEIL Âíå CEILING</td><td>‰∏§‰∏™ÂáΩÊï∞ÂäüËÉΩÁõ∏ÂêåÔºåÈÉΩÊòØËøîÂõû‰∏çÂ∞è‰∫éÂèÇÊï∞ÁöÑÊúÄÂ∞èÊï¥Êï∞ÔºåÂç≥Âêë‰∏äÂèñÊï¥</td></tr><tr><td>FLOOR</td><td>Âêë‰∏ãÂèñÊï¥ÔºåËøîÂõûÂÄºËΩ¨Âåñ‰∏∫‰∏Ä‰∏™BIGINT</td></tr><tr><td>RAND</td><td>ÁîüÊàê‰∏Ä‰∏™0~1‰πãÈó¥ÁöÑÈöèÊú∫Êï∞Ôºå‰º†ÂÖ•Êï¥Êï∞ÂèÇÊï∞ÊòØÔºåÁî®Êù•‰∫ßÁîüÈáçÂ§çÂ∫èÂàó</td></tr><tr><td>ROUND(x,y)</td><td>ÂØπÊâÄ‰º†ÂèÇÊï∞xËøõË°åÂõõËàç‰∫îÂÖ•Ôºå‰øùÁïôy‰ΩçÂ∞èÊï∞</td></tr><tr><td>SIGN</td><td>ËøîÂõûÂèÇÊï∞ÁöÑÁ¨¶Âè∑</td></tr><tr><td>POW Âíå POWER</td><td>‰∏§‰∏™ÂáΩÊï∞ÁöÑÂäüËÉΩÁõ∏ÂêåÔºåÈÉΩÊòØÊâÄ‰º†ÂèÇÊï∞ÁöÑÊ¨°ÊñπÁöÑÁªìÊûúÂÄº</td></tr><tr><td>SIN</td><td>Ê±ÇÊ≠£Âº¶ÂÄº</td></tr><tr><td>ASIN</td><td>Ê±ÇÂèçÊ≠£Âº¶ÂÄºÔºå‰∏éÂáΩÊï∞ SIN ‰∫í‰∏∫ÂèçÂáΩÊï∞</td></tr><tr><td>COS</td><td>Ê±Ç‰ΩôÂº¶ÂÄº</td></tr><tr><td>ACOS</td><td>Ê±ÇÂèç‰ΩôÂº¶ÂÄºÔºå‰∏éÂáΩÊï∞ COS ‰∫í‰∏∫ÂèçÂáΩÊï∞</td></tr><tr><td>TAN</td><td>Ê±ÇÊ≠£ÂàáÂÄº</td></tr><tr><td>ATAN</td><td>Ê±ÇÂèçÊ≠£ÂàáÂÄºÔºå‰∏éÂáΩÊï∞ TAN ‰∫í‰∏∫ÂèçÂáΩÊï∞</td></tr><tr><td>COT</td><td>Ê±Ç‰ΩôÂàáÂÄº</td></tr></tbody></table><hr><h5 id="Êó•ÊúüÂáΩÊï∞" tabindex="-1"><a class="header-anchor" href="#Êó•ÊúüÂáΩÊï∞"><span>Êó•ÊúüÂáΩÊï∞</span></a></h5><table><thead><tr><th>ÂáΩÊï∞ÂêçÁß∞</th><th>‰Ωú Áî®</th></tr></thead><tbody><tr><td>CURDATE Âíå CURRENT_DATE</td><td>‰∏§‰∏™ÂáΩÊï∞‰ΩúÁî®Áõ∏ÂêåÔºåËøîÂõûÂΩìÂâçÁ≥ªÁªüÁöÑÊó•ÊúüÂÄº</td></tr><tr><td>CURTIME Âíå CURRENT_TIME</td><td>‰∏§‰∏™ÂáΩÊï∞‰ΩúÁî®Áõ∏ÂêåÔºåËøîÂõûÂΩìÂâçÁ≥ªÁªüÁöÑÊó∂Èó¥ÂÄº</td></tr><tr><td>NOW Âíå SYSDATE</td><td>‰∏§‰∏™ÂáΩÊï∞‰ΩúÁî®Áõ∏ÂêåÔºåËøîÂõûÂΩìÂâçÁ≥ªÁªüÁöÑÊó•ÊúüÂíåÊó∂Èó¥ÂÄº</td></tr><tr><td>MONTH</td><td>Ëé∑ÂèñÊåáÂÆöÊó•Êúü‰∏≠ÁöÑÊúà‰ªΩ</td></tr><tr><td>MONTHNAME</td><td>Ëé∑ÂèñÊåáÂÆöÊó•Êúü‰∏≠ÁöÑÊúà‰ªΩËã±ÊñáÂêçÁß∞</td></tr><tr><td>DAYNAME</td><td>Ëé∑ÂèñÊåáÂÆöÊõ∞ÊúüÂØπÂ∫îÁöÑÊòüÊúüÂá†ÁöÑËã±ÊñáÂêçÁß∞</td></tr><tr><td>DAYOFWEEK</td><td>Ëé∑ÂèñÊåáÂÆöÊó•ÊúüÂØπÂ∫îÁöÑ‰∏ÄÂë®ÁöÑÁ¥¢Âºï‰ΩçÁΩÆÂÄº</td></tr><tr><td>WEEK</td><td>Ëé∑ÂèñÊåáÂÆöÊó•ÊúüÊòØ‰∏ÄÂπ¥‰∏≠ÁöÑÁ¨¨Âá†Âë®ÔºåËøîÂõûÂÄºÁöÑËåÉÂõ¥ÊòØÂê¶‰∏∫ 0„Äú52 Êàñ 1„Äú53</td></tr><tr><td>DAYOFYEAR</td><td>Ëé∑ÂèñÊåáÂÆöÊõ∞ÊúüÊòØ‰∏ÄÂπ¥‰∏≠ÁöÑÁ¨¨Âá†Â§©ÔºåËøîÂõûÂÄºËåÉÂõ¥ÊòØ1~366</td></tr><tr><td>DAYOFMONTH</td><td>Ëé∑ÂèñÊåáÂÆöÊó•ÊúüÊòØ‰∏Ä‰∏™Êúà‰∏≠ÊòØÁ¨¨Âá†Â§©ÔºåËøîÂõûÂÄºËåÉÂõ¥ÊòØ1~31</td></tr><tr><td>YEAR</td><td>Ëé∑ÂèñÂπ¥‰ªΩÔºåËøîÂõûÂÄºËåÉÂõ¥ÊòØ 1970„Äú2069</td></tr><tr><td>TIME_TO_SEC</td><td>Â∞ÜÊó∂Èó¥ÂèÇÊï∞ËΩ¨Êç¢‰∏∫ÁßíÊï∞</td></tr><tr><td>SEC_TO_TIME</td><td>Â∞ÜÁßíÊï∞ËΩ¨Êç¢‰∏∫Êó∂Èó¥Ôºå‰∏éTIME_TO_SEC ‰∫í‰∏∫ÂèçÂáΩÊï∞</td></tr><tr><td>DATE_ADD(date, INERVAL expr type) Âíå ADDDATE</td><td>‰∏§‰∏™ÂáΩÊï∞ÂäüËÉΩÁõ∏ÂêåÔºåÈÉΩÊòØÂêëÊó•ÊúüÊàñÊó∂Èó¥Ê∑ªÂä†ÊåáÂÆöÁöÑÊó∂Èó¥Èó¥Èöî,date‰ª£Ë°®ÂΩìÂâçÊó∂Èó¥Ôºåexpr‰ª£Ë°®Ë¶ÅÊ∑ªÂä†ÁöÑÊï∞Ôºåtype‰ª£Ë°®Ê∑ªÂä†Êó•ÊúüÔºàyearÔºåmonthÔºådayÔºåweek,hour,minute,second)</td></tr><tr><td>DATE_SUB Âíå SUBDATE</td><td>‰∏§‰∏™ÂáΩÊï∞ÂäüËÉΩÁõ∏ÂêåÔºåÈÉΩÊòØÂêëÊó•ÊúüÂáèÂéªÊåáÂÆöÁöÑÊó∂Èó¥Èó¥Èöî</td></tr><tr><td>ADDTIME</td><td>Êó∂Èó¥Âä†Ê≥ïËøêÁÆóÔºåÂú®ÂéüÂßãÊó∂Èó¥‰∏äÊ∑ªÂä†ÊåáÂÆöÁöÑÊó∂Èó¥</td></tr><tr><td>SUBTIME</td><td>Êó∂Èó¥ÂáèÊ≥ïËøêÁÆóÔºåÂú®ÂéüÂßãÊó∂Èó¥‰∏äÂáèÂéªÊåáÂÆöÁöÑÊó∂Èó¥</td></tr><tr><td>DATEDIFF</td><td>Ëé∑Âèñ‰∏§‰∏™Êó•Êúü‰πãÈó¥Èó¥ÈöîÔºåËøîÂõûÂèÇÊï∞ 1 ÂáèÂéªÂèÇÊï∞ 2 ÁöÑÂÄº</td></tr><tr><td>DATE_FORMAT</td><td>Ê†ºÂºèÂåñÊåáÂÆöÁöÑÊó•ÊúüÔºåÊ†πÊçÆÂèÇÊï∞ËøîÂõûÊåáÂÆöÊ†ºÂºèÁöÑÂÄº</td></tr><tr><td>WEEKDAY</td><td>Ëé∑ÂèñÊåáÂÆöÊó•ÊúüÂú®‰∏ÄÂë®ÂÜÖÁöÑÂØπÂ∫îÁöÑÂ∑•‰ΩúÊó•Á¥¢Âºï</td></tr></tbody></table><h5 id="ÊµÅÁ®ãÂáΩÊï∞" tabindex="-1"><a class="header-anchor" href="#ÊµÅÁ®ãÂáΩÊï∞"><span>ÊµÅÁ®ãÂáΩÊï∞</span></a></h5><p>ÊµÅÁ®ãÂáΩÊï∞‰πüÊòØÂæàÂ∏∏Áî®ÁöÑ‰∏ÄÁ±ªÂáΩÊï∞ÔºåÂèØ‰ª•Âú®SQLËØ≠Âè•‰∏≠ÂÆûÁé∞Êù°‰ª∂Á≠õÈÄâÔºå‰ªéËÄåÊèêÈ´òËØ≠Âè•ÁöÑÊïàÁéá„ÄÇ</p><table><thead><tr><th>ÂáΩÊï∞</th><th>ÂäüËÉΩ</th></tr></thead><tbody><tr><td>IF(value , t , f)</td><td>Â¶ÇÊûúvalue‰∏∫trueÔºåÂàôËøîÂõûtÔºåÂê¶ÂàôËøîÂõûf</td></tr><tr><td>IFNULL(value1 , value2)</td><td>Â¶ÇÊûúvalue1‰∏ç‰∏∫Á©∫ÔºåËøîÂõûvalue1ÔºåÂê¶ÂàôËøîÂõûvalue2</td></tr><tr><td>CASE WHEN [ val1 ] THEN [res1] ...ELSE [ default ] END</td><td>Â¶ÇÊûúval1‰∏∫trueÔºåËøîÂõûres1Ôºå... Âê¶ÂàôËøîÂõûdefaultÈªòËÆ§ÂÄº</td></tr><tr><td>CASE [ expr ] WHEN [ val1 ] THEN [res1] ... ELSE [ default ] END</td><td>Â¶ÇÊûúexprÁöÑÂÄºÁ≠â‰∫éval1ÔºåËøîÂõûres1ÔºåÂê¶ÂàôËøîÂõûdefaultÈªòËÆ§ÂÄº, ...‰ª£Ë°®WHEN THEN ÂèØ‰ª•ÂÜôÂ§ö‰∏™</td></tr></tbody></table><p>ÂèØ‰ª•Â∞ÜÊï¥ÊÆµÂáΩÊï∞Êã¨Ëµ∑Êù•ÂèñÂà´Âêç</p><hr><h4 id="Ê≠£ÂàôÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#Ê≠£ÂàôÊü•ËØ¢"><span>Ê≠£ÂàôÊü•ËØ¢</span></a></h4><p>Ê≠£ÂàôË°®ËææÂºèÔºàRegular ExpressionÔºâÊòØÊåá‰∏Ä‰∏™Áî®Êù•ÊèèËø∞ÊàñËÄÖÂåπÈÖç‰∏ÄÁ≥ªÂàóÁ¨¶ÂêàÊüê‰∏™Âè•Ê≥ïËßÑÂàôÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑÂçï‰∏™Â≠óÁ¨¶‰∏≤</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM emp WHERE name REGEXP &#39;^T&#39;;	-- ÂåπÈÖç‰ª•TÂºÄÂ§¥ÁöÑnameÂÄº</span></span>
<span class="line"><span>SELECT * FROM emp WHERE name REGEXP &#39;2$&#39;;	-- ÂåπÈÖç‰ª•2ÁªìÂ∞æÁöÑnameÂÄº</span></span>
<span class="line"><span>SELECT * FROM emp WHERE name REGEXP &#39;[uvw]&#39;;-- ÂåπÈÖçÂåÖÂê´ uvw ÁöÑnameÂÄº</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>Á¨¶Âè∑</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td>^</td><td>Âú®Â≠óÁ¨¶‰∏≤ÂºÄÂßãÂ§ÑËøõË°åÂåπÈÖç</td></tr><tr><td>$</td><td>Âú®Â≠óÁ¨¶‰∏≤Êú´Â∞æÂ§ÑËøõË°åÂåπÈÖç</td></tr><tr><td>.</td><td>ÂåπÈÖç‰ªªÊÑèÂçï‰∏™Â≠óÁ¨¶, ÂåÖÊã¨Êç¢Ë°åÁ¨¶</td></tr><tr><td>[...]</td><td>ÂåπÈÖçÂá∫Êã¨Âè∑ÂÜÖÁöÑ‰ªªÊÑèÂ≠óÁ¨¶</td></tr><tr><td>[^...]</td><td>ÂåπÈÖç‰∏çÂá∫Êã¨Âè∑ÂÜÖÁöÑ‰ªªÊÑèÂ≠óÁ¨¶</td></tr><tr><td>a*</td><td>ÂåπÈÖçÈõ∂‰∏™ÊàñËÄÖÂ§ö‰∏™a(ÂåÖÊã¨Á©∫‰∏≤)</td></tr><tr><td>a+</td><td>ÂåπÈÖç‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™a(‰∏çÂåÖÊã¨Á©∫‰∏≤)</td></tr><tr><td>a?</td><td>ÂåπÈÖçÈõ∂‰∏™ÊàñËÄÖ‰∏Ä‰∏™a</td></tr><tr><td>a1|a2</td><td>ÂåπÈÖça1Êàña2</td></tr><tr><td>a(m)</td><td>ÂåπÈÖçm‰∏™a</td></tr><tr><td>a(m,)</td><td>Ëá≥Â∞ëÂåπÈÖçm‰∏™a</td></tr><tr><td>a(m,n)</td><td>ÂåπÈÖçm‰∏™a Âà∞ n‰∏™a</td></tr><tr><td>a(,n)</td><td>ÂåπÈÖç0Âà∞n‰∏™a</td></tr><tr><td>(...)</td><td>Â∞ÜÊ®°ÂºèÂÖÉÁ¥†ÁªÑÊàêÂçï‰∏ÄÂÖÉÁ¥†</td></tr></tbody></table><hr><h4 id="ÊéíÂ∫èÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#ÊéíÂ∫èÊü•ËØ¢"><span>ÊéíÂ∫èÊü•ËØ¢</span></a></h4><ul><li><p>ÊéíÂ∫èÊü•ËØ¢ËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç [WHERE Êù°‰ª∂] ORDER BY ÂàóÂêç1 ÊéíÂ∫èÊñπÂºè1,ÂàóÂêç2 ÊéíÂ∫èÊñπÂºè2;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÊéíÂ∫èÊñπÂºè</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ASC:ÂçáÂ∫è</span></span>
<span class="line"><span>DESC:ÈôçÂ∫è</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Ê≥®ÊÑèÔºöÂ§ö‰∏™ÊéíÂ∫èÊù°‰ª∂ÔºåÂΩìÂâçËæπÁöÑÊù°‰ª∂ÂÄº‰∏ÄÊ†∑Êó∂ÔºåÊâç‰ºöÂà§Êñ≠Á¨¨‰∫åÊù°‰ª∂</p></li><li><p>‰æãÂ¶Ç</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÊåâÁÖßÂ∫ìÂ≠òÂçáÂ∫èÊéíÂ∫è</span></span>
<span class="line"><span>SELECT * FROM product ORDER BY stock ASC;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢ÂêçÁß∞‰∏≠ÂåÖÂê´ÊâãÊú∫ÁöÑÂïÜÂìÅ‰ø°ÊÅØ„ÄÇÊåâÁÖßÈáëÈ¢ùÈôçÂ∫èÊéíÂ∫è</span></span>
<span class="line"><span>SELECT * FROM product WHERE NAME LIKE &#39;%ÊâãÊú∫%&#39; ORDER BY price DESC;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÊåâÁÖßÈáëÈ¢ùÂçáÂ∫èÊéíÂ∫èÔºåÂ¶ÇÊûúÈáëÈ¢ùÁõ∏ÂêåÔºåÊåâÁÖßÂ∫ìÂ≠òÈôçÂ∫èÊéíÂàó</span></span>
<span class="line"><span>SELECT * FROM product ORDER BY price ASC,stock DESC;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="ÂàÜÁªÑÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#ÂàÜÁªÑÊü•ËØ¢"><span>ÂàÜÁªÑÊü•ËØ¢</span></a></h4><p>ÂàÜÁªÑÊü•ËØ¢‰ºöËøõË°åÂéªÈáç</p><ul><li><p>ÂàÜÁªÑÊü•ËØ¢ËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç [WHERE Êù°‰ª∂] GROUP BY ÂàÜÁªÑÂàóÂêç [HAVING ÂàÜÁªÑÂêéÊù°‰ª∂ËøáÊª§] [ORDER BY ÊéíÂ∫èÂàóÂêç ÊéíÂ∫èÊñπÂºè];</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>WHERE ËøáÊª§Ë°åÔºåHAVING ËøáÊª§ÂàÜÁªÑÔºåË°åËøáÊª§Â∫îÂΩìÂÖà‰∫éÂàÜÁªÑËøáÊª§</p><p>ÂàÜÁªÑËßÑÂÆöÔºö</p><ul><li>GROUP BY Â≠êÂè•Âá∫Áé∞Âú® WHERE Â≠êÂè•‰πãÂêéÔºåORDER BY Â≠êÂè•‰πãÂâç</li><li>NULL ÁöÑË°å‰ºöÂçïÁã¨ÂàÜ‰∏∫‰∏ÄÁªÑ</li><li>Â§ßÂ§öÊï∞ SQL ÂÆûÁé∞‰∏çÊîØÊåÅ GROUP BY ÂàóÂÖ∑ÊúâÂèØÂèòÈïøÂ∫¶ÁöÑÊï∞ÊçÆÁ±ªÂûã</li></ul></li><li><p>‰æãÂ¶Ç</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÊåâÁÖßÂìÅÁâåÂàÜÁªÑÔºåËé∑ÂèñÊØèÁªÑÂïÜÂìÅÁöÑÊÄªÈáëÈ¢ù</span></span>
<span class="line"><span>SELECT brand,SUM(price) FROM product GROUP BY brand;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂØπÈáëÈ¢ùÂ§ß‰∫é4000ÂÖÉÁöÑÂïÜÂìÅÔºåÊåâÁÖßÂìÅÁâåÂàÜÁªÑ,Ëé∑ÂèñÊØèÁªÑÂïÜÂìÅÁöÑÊÄªÈáëÈ¢ù</span></span>
<span class="line"><span>SELECT brand,SUM(price) FROM product WHERE price &gt; 4000 GROUP BY brand;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂØπÈáëÈ¢ùÂ§ß‰∫é4000ÂÖÉÁöÑÂïÜÂìÅÔºåÊåâÁÖßÂìÅÁâåÂàÜÁªÑÔºåËé∑ÂèñÊØèÁªÑÂïÜÂìÅÁöÑÊÄªÈáëÈ¢ùÔºåÂè™ÊòæÁ§∫ÊÄªÈáëÈ¢ùÂ§ß‰∫é7000ÂÖÉÁöÑ</span></span>
<span class="line"><span>SELECT brand,SUM(price) AS getSum FROM product WHERE price &gt; 4000 GROUP BY brand HAVING getSum &gt; 7000;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂØπÈáëÈ¢ùÂ§ß‰∫é4000ÂÖÉÁöÑÂïÜÂìÅÔºåÊåâÁÖßÂìÅÁâåÂàÜÁªÑÔºåËé∑ÂèñÊØèÁªÑÂïÜÂìÅÁöÑÊÄªÈáëÈ¢ùÔºåÂè™ÊòæÁ§∫ÊÄªÈáëÈ¢ùÂ§ß‰∫é7000ÂÖÉÁöÑ„ÄÅÂπ∂ÊåâÁÖßÊÄªÈáëÈ¢ùÁöÑÈôçÂ∫èÊéíÂàó</span></span>
<span class="line"><span>SELECT brand,SUM(price) AS getSum FROM product WHERE price &gt; 4000 GROUP BY brand HAVING getSum &gt; 7000 ORDER BY getSum DESC;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="ÂàÜÈ°µÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#ÂàÜÈ°µÊü•ËØ¢"><span>ÂàÜÈ°µÊü•ËØ¢</span></a></h4><p>ÂàÜÈ°µÊü•ËØ¢ÊòØÊï∞ÊçÆÂ∫ìÁöÑÊñπË®ÄÔºå‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ìÊúâ‰∏çÂêåÁöÑÂÆûÁé∞ÔºåMysqlÊòØLIMIT„ÄÇ</p><ul><li><p>ÂàÜÈ°µÊü•ËØ¢ËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç [WHERE Êù°‰ª∂] GROUP BY ÂàÜÁªÑÂàóÂêç [HAVING ÂàÜÁªÑÂêéÊù°‰ª∂ËøáÊª§] [ORDER BY ÊéíÂ∫èÂàóÂêç ÊéíÂ∫èÊñπÂºè] LIMIT ÂºÄÂßãÁ¥¢Âºï,Êü•ËØ¢Êù°Êï∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂÖ¨ÂºèÔºöÂºÄÂßãÁ¥¢Âºï = (ÂΩìÂâçÈ°µÁ†Å-1) * ÊØèÈ°µÊòæÁ§∫ÁöÑÊù°Êï∞</p></li><li><p>‰æãÂ¶Ç</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM product LIMIT 0,2;  -- Á¨¨‰∏ÄÈ°µ ÂºÄÂßãÁ¥¢Âºï=(1-1) * 2</span></span>
<span class="line"><span>SELECT * FROM product LIMIT 2,2;  -- Á¨¨‰∫åÈ°µ ÂºÄÂßãÁ¥¢Âºï=(2-1) * 2</span></span>
<span class="line"><span>SELECT * FROM product LIMIT 4,2;  -- Á¨¨‰∏âÈ°µ ÂºÄÂßãÁ¥¢Âºï=(3-1) * 2</span></span>
<span class="line"><span>SELECT * FROM product LIMIT 6,2;  -- Á¨¨ÂõõÈ°µ ÂºÄÂßãÁ¥¢Âºï=(4-1) * 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-DQLÂàÜÈ°µÊü•ËØ¢ÂõæËß£.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><h3 id="dcl" tabindex="-1"><a class="header-anchor" href="#dcl"><span>DCL</span></a></h3><p>DCLËã±ÊñáÂÖ®Áß∞ÊòØData Control Language(Êï∞ÊçÆÊéßÂà∂ËØ≠Ë®Ä)ÔºåÁî®Êù•ÁÆ°ÁêÜÊï∞ÊçÆÂ∫ìÁî®Êà∑„ÄÅÊéßÂà∂Êï∞ÊçÆÂ∫ìÁöÑËÆø ÈóÆÊùÉÈôê„ÄÇ</p><h4 id="Áî®Êà∑ÁÆ°ÁêÜ" tabindex="-1"><a class="header-anchor" href="#Áî®Êà∑ÁÆ°ÁêÜ"><span>Áî®Êà∑ÁÆ°ÁêÜ</span></a></h4><h5 id="Êü•ËØ¢Áî®Êà∑" tabindex="-1"><a class="header-anchor" href="#Êü•ËØ¢Áî®Êà∑"><span><strong>Êü•ËØ¢Áî®Êà∑</strong></span></a></h5><p>‚Äã USE mysql;</p><p>‚Äã SELECT * FROM user;</p><h5 id="ÂàõÂª∫Áî®Êà∑" tabindex="-1"><a class="header-anchor" href="#ÂàõÂª∫Áî®Êà∑"><span><strong>ÂàõÂª∫Áî®Êà∑</strong></span></a></h5><p>‚Äã CREATE USER &#39;Áî®Êà∑Âêç&#39;@&#39;‰∏ªÊú∫Âêç&#39; IDENTIFIED BY &#39;ÂØÜÁ†Å&#39;;</p><p>‚Äã ÂÖ∂‰∏≠‰∏ªÊú∫Âêç‰∏∫local host‰ª£Ë°®‰∏ªÊú∫ÂèØ‰ª•ËÆøÈóÆËØ•Êï∞ÊçÆÂ∫ìÔºå%Ë°®Á§∫ÂèØ‰ª•Âú®‰ªªÊÑè‰∏ªÊú∫‰∏äËÆøÈóÆËØ•Êï∞ÊçÆÂ∫ì„ÄÇ</p><h5 id="‰øÆÊîπÁî®Êà∑ÂØÜÁ†Å" tabindex="-1"><a class="header-anchor" href="#‰øÆÊîπÁî®Êà∑ÂØÜÁ†Å"><span><strong>‰øÆÊîπÁî®Êà∑ÂØÜÁ†Å</strong></span></a></h5><p>‚Äã ALTER USER &#39;Áî®Êà∑Âêç&#39;@&#39;‰∏ªÊú∫Âêç&#39; IDENTIFIED WITH mysql_native_password BY &#39;Êñ∞ÂØÜÁ†Å&#39;;</p><h5 id="Âà†Èô§Áî®Êà∑" tabindex="-1"><a class="header-anchor" href="#Âà†Èô§Áî®Êà∑"><span><strong>Âà†Èô§Áî®Êà∑</strong></span></a></h5><p>‚Äã DROP USER &#39;Áî®Êà∑Âêç&#39;@&#39;‰∏ªÊú∫Âêç&#39;;</p><h4 id="ÊùÉÈôêÊéßÂà∂" tabindex="-1"><a class="header-anchor" href="#ÊùÉÈôêÊéßÂà∂"><span>ÊùÉÈôêÊéßÂà∂</span></a></h4><p>MySQL‰∏≠ÂÆö‰πâ‰∫ÜÂæàÂ§öÁßçÊùÉÈôêÔºå‰ΩÜÊòØÂ∏∏Áî®ÁöÑÂ∞±‰ª•‰∏ãÂá†Áßç</p><table><thead><tr><th>ÊùÉÈôê</th><th>ËØ¥Êòé</th></tr></thead><tbody><tr><td>ALL, ALL PRIVILEGES</td><td>ÊâÄÊúâÊùÉÈôê</td></tr><tr><td>SELECT</td><td>Êü•ËØ¢Êï∞ÊçÆ</td></tr><tr><td>INSERT</td><td>ÊèíÂÖ•Êï∞ÊçÆ</td></tr><tr><td>UPDATE</td><td>‰øÆÊîπÊï∞ÊçÆ</td></tr><tr><td>DELETE</td><td>Âà†Èô§Êï∞ÊçÆ</td></tr><tr><td>ALTER</td><td>‰øÆÊîπË°®</td></tr><tr><td>DROP</td><td>Âà†Èô§Êï∞ÊçÆÂ∫ì/Ë°®/ËßÜÂõæ</td></tr><tr><td>CREATE</td><td>ÂàõÂª∫Êï∞ÊçÆÂ∫ì/Ë°®</td></tr></tbody></table><h5 id="Êü•ËØ¢ÊùÉÈôê" tabindex="-1"><a class="header-anchor" href="#Êü•ËØ¢ÊùÉÈôê"><span>Êü•ËØ¢ÊùÉÈôê</span></a></h5><p>SHOW GRANTS FOR &#39;Áî®Êà∑Âêç&#39;@&#39;‰∏ªÊú∫Âêç&#39; ;</p><h5 id="Êéà‰∫àÊùÉÈôê" tabindex="-1"><a class="header-anchor" href="#Êéà‰∫àÊùÉÈôê"><span>Êéà‰∫àÊùÉÈôê</span></a></h5><p>GRANT ÊùÉÈôêÂàóË°® ON Êï∞ÊçÆÂ∫ìÂêç.Ë°®Âêç TO &#39;Áî®Êà∑Âêç&#39;@&#39;‰∏ªÊú∫Âêç&#39;;</p><h5 id="Êí§ÈîÄÊùÉÈôê" tabindex="-1"><a class="header-anchor" href="#Êí§ÈîÄÊùÉÈôê"><span>Êí§ÈîÄÊùÉÈôê</span></a></h5><p>REVOKE ÊùÉÈôêÂàóË°® ON Êï∞ÊçÆÂ∫ìÂêç.Ë°®Âêç FROM &#39;Áî®Êà∑Âêç&#39;@&#39;‰∏ªÊú∫Âêç&#39;;</p><p>Ê≥®ÊÑè‰∫ãÈ°πÔºö ‚Ä¢ Â§ö‰∏™ÊùÉÈôê‰πãÈó¥Ôºå‰ΩøÁî®ÈÄóÂè∑ÂàÜÈöî ‚Ä¢ ÊéàÊùÉÊó∂Ôºå Êï∞ÊçÆÂ∫ìÂêçÂíåË°®ÂêçÂèØ‰ª•‰ΩøÁî® * ËøõË°åÈÄöÈÖçÔºå‰ª£Ë°®ÊâÄÊúâ</p><hr><h2 id="Â§öË°®Êìç‰Ωú" tabindex="-1"><a class="header-anchor" href="#Â§öË°®Êìç‰Ωú"><span>Â§öË°®Êìç‰Ωú</span></a></h2><h3 id="Á∫¶ÊùüÂàÜÁ±ª" tabindex="-1"><a class="header-anchor" href="#Á∫¶ÊùüÂàÜÁ±ª"><span>Á∫¶ÊùüÂàÜÁ±ª</span></a></h3><h4 id="Á∫¶Êùü‰ªãÁªç" tabindex="-1"><a class="header-anchor" href="#Á∫¶Êùü‰ªãÁªç"><span>Á∫¶Êùü‰ªãÁªç</span></a></h4><p>Á∫¶ÊùüÔºöÂØπË°®‰∏≠ÁöÑÊï∞ÊçÆËøõË°åÈôêÂÆöÔºå‰øùËØÅÊï∞ÊçÆÁöÑÊ≠£Á°ÆÊÄß„ÄÅÊúâÊïàÊÄß„ÄÅÂÆåÊï¥ÊÄß</p><p>Á∫¶ÊùüÁöÑÂàÜÁ±ªÔºö</p><table><thead><tr><th>Á∫¶Êùü</th><th>ËØ¥Êòé</th></tr></thead><tbody><tr><td>PRIMARY KEY</td><td>‰∏ªÈîÆÁ∫¶Êùü</td></tr><tr><td>PRIMARY KEY AUTO_INCREMENT</td><td>‰∏ªÈîÆ„ÄÅËá™Âä®Â¢ûÈïø</td></tr><tr><td>UNIQUE</td><td>ÂîØ‰∏ÄÁ∫¶Êùü</td></tr><tr><td>NOT NULL</td><td>ÈùûÁ©∫Á∫¶Êùü</td></tr><tr><td>FOREIGN KEY</td><td>Â§ñÈîÆÁ∫¶Êùü</td></tr><tr><td>FOREIGN KEY ON UPDATE CASCADE</td><td>Â§ñÈîÆÁ∫ßËÅîÊõ¥Êñ∞</td></tr><tr><td>FOREIGN KEY ON DELETE CASCADE</td><td>Â§ñÈîÆÁ∫ßËÅîÂà†Èô§</td></tr></tbody></table><hr><h4 id="‰∏ªÈîÆÁ∫¶Êùü" tabindex="-1"><a class="header-anchor" href="#‰∏ªÈîÆÁ∫¶Êùü"><span>‰∏ªÈîÆÁ∫¶Êùü</span></a></h4><ul><li><p>‰∏ªÈîÆÁ∫¶ÊùüÁâπÁÇπÔºö</p><ul><li>‰∏ªÈîÆÁ∫¶ÊùüÈªòËÆ§ÂåÖÂê´<strong>ÈùûÁ©∫ÂíåÂîØ‰∏Ä</strong>‰∏§‰∏™ÂäüËÉΩ</li><li>‰∏ÄÂº†Ë°®Âè™ËÉΩÊúâ‰∏Ä‰∏™‰∏ªÈîÆ</li><li>‰∏ªÈîÆ‰∏ÄËà¨Áî®‰∫éË°®‰∏≠Êï∞ÊçÆÁöÑÂîØ‰∏ÄÊ†áËØÜ</li></ul></li><li><p>Âª∫Ë°®Êó∂Ê∑ªÂä†‰∏ªÈîÆÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE Ë°®Âêç(</span></span>
<span class="line"><span>	ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã PRIMARY KEY,</span></span>
<span class="line"><span>    ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã,</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Âà†Èô§‰∏ªÈîÆÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç DROP PRIMARY KEY;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âª∫Ë°®ÂêéÂçïÁã¨Ê∑ªÂä†‰∏ªÈîÆÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç MODIFY ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã PRIMARY KEY;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰æãÂ¶Ç</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫studentË°®</span></span>
<span class="line"><span>CREATE TABLE student(</span></span>
<span class="line"><span>	id INT PRIMARY KEY  -- ÁªôidÊ∑ªÂä†‰∏ªÈîÆÁ∫¶Êùü</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO student VALUES (1),(2);</span></span>
<span class="line"><span>-- ‰∏ªÈîÆÈªòËÆ§ÂîØ‰∏ÄÔºåÊ∑ªÂä†ÈáçÂ§çÊï∞ÊçÆÔºå‰ºöÊä•Èîô</span></span>
<span class="line"><span>INSERT INTO student VALUES (2);</span></span>
<span class="line"><span>-- ‰∏ªÈîÆÈªòËÆ§ÈùûÁ©∫Ôºå‰∏çËÉΩÊ∑ªÂä†nullÁöÑÊï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO student VALUES (NULL);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="‰∏ªÈîÆËá™Â¢û" tabindex="-1"><a class="header-anchor" href="#‰∏ªÈîÆËá™Â¢û"><span>‰∏ªÈîÆËá™Â¢û</span></a></h4><p>‰∏ªÈîÆËá™Â¢ûÁ∫¶ÊùüÂèØ‰ª•‰∏∫Á©∫ÔºåÂπ∂Ëá™Âä®Â¢ûÈïø„ÄÇÂà†Èô§ÊüêÊù°Êï∞ÊçÆ‰∏çÂΩ±ÂìçËá™Â¢ûÁöÑ‰∏ã‰∏Ä‰∏™Êï∞ÂÄºÔºå‰æùÁÑ∂ÊåâÁÖßÂâç‰∏Ä‰∏™ÂÄºËá™Â¢û</p><ul><li><p>Âª∫Ë°®Êó∂Ê∑ªÂä†‰∏ªÈîÆËá™Â¢ûÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE Ë°®Âêç(</span></span>
<span class="line"><span>	ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã PRIMARY KEY AUTO_INCREMENT,</span></span>
<span class="line"><span>    ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã,</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Âà†Èô§‰∏ªÈîÆËá™Â¢ûÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç MODIFY ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âª∫Ë°®ÂêéÂçïÁã¨Ê∑ªÂä†‰∏ªÈîÆËá™Â¢ûÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç MODIFY ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã AUTO_INCREMENT;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰æãÂ¶Ç</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫student2Ë°®</span></span>
<span class="line"><span>CREATE TABLE student2(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT    -- ÁªôidÊ∑ªÂä†‰∏ªÈîÆËá™Â¢ûÁ∫¶Êùü</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO student2 VALUES (1),(2);</span></span>
<span class="line"><span>-- Ê∑ªÂä†nullÂÄºÔºå‰ºöËá™Âä®Â¢ûÈïø</span></span>
<span class="line"><span>INSERT INTO student2 VALUES (NULL),(NULL);-- 3Ôºå4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="ÂîØ‰∏ÄÁ∫¶Êùü" tabindex="-1"><a class="header-anchor" href="#ÂîØ‰∏ÄÁ∫¶Êùü"><span>ÂîØ‰∏ÄÁ∫¶Êùü</span></a></h4><p>ÂîØ‰∏ÄÁ∫¶ÊùüÔºöÁ∫¶Êùü‰∏çËÉΩÊúâÈáçÂ§çÁöÑÊï∞ÊçÆ</p><ul><li><p>Âª∫Ë°®Êó∂Ê∑ªÂä†ÂîØ‰∏ÄÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE Ë°®Âêç(</span></span>
<span class="line"><span>	ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã UNIQUE,</span></span>
<span class="line"><span>    ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã,</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Âà†Èô§ÂîØ‰∏ÄÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç DROP INDEX ÂàóÂêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âª∫Ë°®ÂêéÂçïÁã¨Ê∑ªÂä†ÂîØ‰∏ÄÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç MODIFY ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã UNIQUE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><hr><h4 id="ÈùûÁ©∫Á∫¶Êùü" tabindex="-1"><a class="header-anchor" href="#ÈùûÁ©∫Á∫¶Êùü"><span>ÈùûÁ©∫Á∫¶Êùü</span></a></h4><ul><li><p>Âª∫Ë°®Êó∂Ê∑ªÂä†ÈùûÁ©∫Á∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE Ë°®Âêç(</span></span>
<span class="line"><span>	ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã NOT NULL,</span></span>
<span class="line"><span>    ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã,</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Âà†Èô§ÈùûÁ©∫Á∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç MODIFY ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âª∫Ë°®ÂêéÂçïÁã¨Ê∑ªÂä†ÈùûÁ©∫Á∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç MODIFY ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã NOT NULL;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><hr><h4 id="Â§ñÈîÆÁ∫¶Êùü" tabindex="-1"><a class="header-anchor" href="#Â§ñÈîÆÁ∫¶Êùü"><span>Â§ñÈîÆÁ∫¶Êùü</span></a></h4><p>Â§ñÈîÆÁ∫¶ÊùüÔºöËÆ©Ë°®ÂíåË°®‰πãÈó¥‰∫ßÁîüÂÖ≥Á≥ªÔºå‰ªéËÄå‰øùËØÅÊï∞ÊçÆÁöÑÂáÜÁ°ÆÊÄß</p><ul><li><p>Âª∫Ë°®Êó∂Ê∑ªÂä†Â§ñÈîÆÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE Ë°®Âêç(</span></span>
<span class="line"><span>	ÂàóÂêç Êï∞ÊçÆÁ±ªÂûã Á∫¶Êùü,</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    CONSTRAINT Â§ñÈîÆÂêç FOREIGN KEY (Êú¨Ë°®Â§ñÈîÆÂàóÂêç) REFERENCES ‰∏ªË°®Âêç(‰∏ªË°®‰∏ªÈîÆÂàóÂêç)</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Âà†Èô§Â§ñÈîÆÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç DROP FOREIGN KEY Â§ñÈîÆÂêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âª∫Ë°®ÂêéÂçïÁã¨Ê∑ªÂä†Â§ñÈîÆÁ∫¶Êùü</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç ADD CONSTRAINT Â§ñÈîÆÂêç FOREIGN KEY (Êú¨Ë°®Â§ñÈîÆÂàóÂêç) REFERENCES ‰∏ªË°®Âêç(‰∏ªË°®‰∏ªÈîÆÂàóÂêç);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰æãÂ¶Ç</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫userÁî®Êà∑Ë°®</span></span>
<span class="line"><span>CREATE TABLE USER(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,    -- id</span></span>
<span class="line"><span>	name VARCHAR(20) NOT NULL             -- ÂßìÂêç</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Áî®Êà∑Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO USER VALUES (NULL,&#39;Âº†‰∏â&#39;),(NULL,&#39;ÊùéÂõõ&#39;),(NULL,&#39;Áéã‰∫î&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂàõÂª∫orderlistËÆ¢ÂçïË°®</span></span>
<span class="line"><span>CREATE TABLE orderlist(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,    -- id</span></span>
<span class="line"><span>	number VARCHAR(20) NOT NULL,          -- ËÆ¢ÂçïÁºñÂè∑</span></span>
<span class="line"><span>	uid INT,                              -- ËÆ¢ÂçïÊâÄÂ±ûÁî®Êà∑</span></span>
<span class="line"><span>	CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id)   -- Ê∑ªÂä†Â§ñÈîÆÁ∫¶Êùü</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†ËÆ¢ÂçïÊï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO orderlist VALUES (NULL,&#39;hm001&#39;,1),(NULL,&#39;hm002&#39;,1),</span></span>
<span class="line"><span>(NULL,&#39;hm003&#39;,2),(NULL,&#39;hm004&#39;,2),</span></span>
<span class="line"><span>(NULL,&#39;hm005&#39;,3),(NULL,&#39;hm006&#39;,3);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ê∑ªÂä†‰∏Ä‰∏™ËÆ¢ÂçïÔºå‰ΩÜÊòØÊ≤°ÊúâÊâÄÂ±ûÁî®Êà∑„ÄÇÊó†Ê≥ïÊ∑ªÂä†</span></span>
<span class="line"><span>INSERT INTO orderlist VALUES (NULL,&#39;hm007&#39;,8);</span></span>
<span class="line"><span>-- Âà†Èô§Áéã‰∫îËøô‰∏™Áî®Êà∑Ôºå‰ΩÜÊòØËÆ¢ÂçïË°®‰∏≠Áéã‰∫îËøòÊúâÂæàÂ§ö‰∏™ËÆ¢ÂçïÂë¢„ÄÇÊó†Ê≥ïÂà†Èô§</span></span>
<span class="line"><span>DELETE FROM USER WHERE NAME=&#39;Áéã‰∫î&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>Âà†Èô§/Êõ¥Êñ∞Ë°å‰∏∫ Ôºö Ê∑ªÂä†‰∫ÜÂ§ñÈîÆ‰πãÂêéÔºåÂÜçÂà†Èô§Áà∂Ë°®Êï∞ÊçÆÊó∂‰∫ßÁîüÁöÑÁ∫¶ÊùüË°å‰∏∫ÔºåÊàë‰ª¨Â∞±Áß∞‰∏∫Âà†Èô§/Êõ¥Êñ∞Ë°å‰∏∫„ÄÇÂÖ∑‰ΩìÁöÑÂà†Èô§/Êõ¥Êñ∞Ë°å ‰∏∫Êúâ‰ª•‰∏ãÂá†Áßç:</p><table><thead><tr><th>Ë°å‰∏∫</th><th>ËØ¥Êòé</th></tr></thead><tbody><tr><td>NO ACTION</td><td>ÂΩìÂú®Áà∂Ë°®‰∏≠Âà†Èô§/Êõ¥Êñ∞ÂØπÂ∫îËÆ∞ÂΩïÊó∂ÔºåÈ¶ñÂÖàÊ£ÄÊü•ËØ•ËÆ∞ÂΩïÊòØÂê¶ÊúâÂØπÂ∫îÂ§ñÈîÆÔºåÂ¶ÇÊûúÊúâÂàô‰∏çÂÖÅËÆ∏Âà†Èô§/Êõ¥Êñ∞„ÄÇ (‰∏é RESTRICT ‰∏ÄËá¥) ÈªòËÆ§Ë°å‰∏∫</td></tr><tr><td>RESTRICT</td><td>ÂΩìÂú®Áà∂Ë°®‰∏≠Âà†Èô§/Êõ¥Êñ∞ÂØπÂ∫îËÆ∞ÂΩïÊó∂ÔºåÈ¶ñÂÖàÊ£ÄÊü•ËØ•ËÆ∞ÂΩïÊòØÂê¶ÊúâÂØπÂ∫îÂ§ñÈîÆÔºåÂ¶ÇÊûúÊúâÂàô‰∏çÂÖÅËÆ∏Âà†Èô§/Êõ¥Êñ∞„ÄÇ (‰∏é NO ACTION ‰∏ÄËá¥) ÈªòËÆ§Ë°å‰∏∫</td></tr><tr><td>CASCADE</td><td>ÂΩìÂú®Áà∂Ë°®‰∏≠Âà†Èô§/Êõ¥Êñ∞ÂØπÂ∫îËÆ∞ÂΩïÊó∂ÔºåÈ¶ñÂÖàÊ£ÄÊü•ËØ•ËÆ∞ÂΩïÊòØÂê¶ÊúâÂØπÂ∫îÂ§ñÈîÆÔºåÂ¶ÇÊûúÊúâÔºåÂàô‰πüÂà†Èô§/Êõ¥Êñ∞Â§ñÈîÆÂú®Â≠êË°®‰∏≠ÁöÑËÆ∞ÂΩï„ÄÇ</td></tr><tr><td>SET NULL</td><td>ÂΩìÂú®Áà∂Ë°®‰∏≠Âà†Èô§ÂØπÂ∫îËÆ∞ÂΩïÊó∂ÔºåÈ¶ñÂÖàÊ£ÄÊü•ËØ•ËÆ∞ÂΩïÊòØÂê¶ÊúâÂØπÂ∫îÂ§ñÈîÆÔºåÂ¶ÇÊûúÊúâÂàôËÆæÁΩÆÂ≠êË°®‰∏≠ËØ•Â§ñÈîÆÂÄº‰∏∫nullÔºàËøôÂ∞±Ë¶ÅÊ±ÇËØ•Â§ñÈîÆÂÖÅËÆ∏ÂèñnullÔºâ„ÄÇ</td></tr><tr><td>SET DEFAULT</td><td>Áà∂Ë°®ÊúâÂèòÊõ¥Êó∂ÔºåÂ≠êË°®Â∞ÜÂ§ñÈîÆÂàóËÆæÁΩÆÊàê‰∏Ä‰∏™ÈªòËÆ§ÁöÑÂÄº (Innodb‰∏çÊîØÊåÅ)</td></tr></tbody></table><p>ÂÖ∑‰ΩìËØ≠Ê≥ï‰∏∫: ALTER TABLE Ë°®Âêç ADD CONSTRAINT Â§ñÈîÆÂêçÁß∞ FOREIGN KEY (Â§ñÈîÆÂ≠óÊÆµ) REFERENCES ‰∏ªË°®Âêç (‰∏ªË°®Â≠óÊÆµÂêç) ON UPDATE (Êõ¥Êñ∞Êó∂ÁöÑË°å‰∏∫) ON DELETE (Âà†Èô§Êó∂ÁöÑË°å‰∏∫);</p><h4 id="Ê£ÄÊü•Á∫¶Êùü" tabindex="-1"><a class="header-anchor" href="#Ê£ÄÊü•Á∫¶Êùü"><span>Ê£ÄÊü•Á∫¶Êùü</span></a></h4><p>‰æãÔºöÊ£ÄÊü•Âπ¥ÈæÑÂú®0Âà∞120‰πãÈó¥</p><p>age int check (age &gt; 0 &amp;&amp; age &lt;=120)</p><hr><h4 id="Â§ñÈîÆÁ∫ßËÅî" tabindex="-1"><a class="header-anchor" href="#Â§ñÈîÆÁ∫ßËÅî"><span>Â§ñÈîÆÁ∫ßËÅî</span></a></h4><p>Á∫ßËÅîÊìç‰ΩúÔºöÂΩìÊää‰∏ªË°®‰∏≠ÁöÑÊï∞ÊçÆËøõË°åÂà†Èô§ÊàñÊõ¥Êñ∞Êó∂Ôºå‰ªéË°®‰∏≠ÊúâÂÖ≥ËÅîÁöÑÊï∞ÊçÆÁöÑÁõ∏Â∫îÊìç‰ΩúÔºåÂåÖÊã¨ RESTRICT„ÄÅCASCADE„ÄÅSET NULL Âíå NO ACTION</p><ul><li>RESTRICT Âíå NO ACTIONÁõ∏ÂêåÔºå ÊòØÊåáÈôêÂà∂Âú®Â≠êË°®ÊúâÂÖ≥ËÅîËÆ∞ÂΩïÁöÑÊÉÖÂÜµ‰∏ãÔºå Áà∂Ë°®‰∏çËÉΩÊõ¥Êñ∞</li><li>CASCADE Ë°®Á§∫Áà∂Ë°®Âú®Êõ¥Êñ∞ÊàñËÄÖÂà†Èô§Êó∂ÔºåÊõ¥Êñ∞ÊàñËÄÖÂà†Èô§Â≠êË°®ÂØπÂ∫îÁöÑËÆ∞ÂΩï</li><li>SET NULL ÂàôË°®Á§∫Áà∂Ë°®Âú®Êõ¥Êñ∞ÊàñËÄÖÂà†Èô§ÁöÑÊó∂ÂÄôÔºåÂ≠êË°®ÁöÑÂØπÂ∫îÂ≠óÊÆµË¢´SET NULL</li></ul><p>Á∫ßËÅîÊìç‰ΩúÔºö</p><ul><li><p>Ê∑ªÂä†Á∫ßËÅîÊõ¥Êñ∞</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç ADD CONSTRAINT Â§ñÈîÆÂêç FOREIGN KEY (Êú¨Ë°®Â§ñÈîÆÂàóÂêç) REFERENCES ‰∏ªË°®Âêç(‰∏ªË°®‰∏ªÈîÆÂàóÂêç) ON UPDATE [CASCADE | RESTRICT | SET NULL];</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Ê∑ªÂä†Á∫ßËÅîÂà†Èô§</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç ADD CONSTRAINT Â§ñÈîÆÂêç FOREIGN KEY (Êú¨Ë°®Â§ñÈîÆÂàóÂêç) REFERENCES ‰∏ªË°®Âêç(‰∏ªË°®‰∏ªÈîÆÂàóÂêç) ON DELETE CASCADE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂêåÊó∂Ê∑ªÂä†Á∫ßËÅîÊõ¥Êñ∞ÂíåÁ∫ßËÅîÂà†Èô§</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç ADD CONSTRAINT Â§ñÈîÆÂêç FOREIGN KEY (Êú¨Ë°®Â§ñÈîÆÂàóÂêç) REFERENCES ‰∏ªË°®Âêç(‰∏ªË°®‰∏ªÈîÆÂàóÂêç) ON UPDATE CASCADE ON DELETE CASCADE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><hr><h3 id="Â§öË°®ËÆæËÆ°" tabindex="-1"><a class="header-anchor" href="#Â§öË°®ËÆæËÆ°"><span>Â§öË°®ËÆæËÆ°</span></a></h3><h4 id="‰∏ÄÂØπ‰∏Ä" tabindex="-1"><a class="header-anchor" href="#‰∏ÄÂØπ‰∏Ä"><span>‰∏ÄÂØπ‰∏Ä</span></a></h4><p>Â§öË°®ÔºöÊúâÂ§öÂº†Êï∞ÊçÆË°®ÔºåËÄåË°®‰∏éË°®‰πãÈó¥Êúâ‰∏ÄÂÆöÁöÑÂÖ≥ËÅîÂÖ≥Á≥ªÔºåÈÄöËøáÂ§ñÈîÆÁ∫¶ÊùüÂÆûÁé∞ÔºåÂàÜ‰∏∫‰∏ÄÂØπ‰∏Ä„ÄÅ‰∏ÄÂØπÂ§ö„ÄÅÂ§öÂØπÂ§ö‰∏âÁ±ª</p><p>‰∏æ‰æãÔºö‰∫∫ÂíåË∫´‰ªΩËØÅ</p><p>ÂÆûÁé∞ÂéüÂàôÔºöÂú®‰ªªÊÑè‰∏Ä‰∏™Ë°®Âª∫Á´ãÂ§ñÈîÆÔºåÂéªÂÖ≥ËÅîÂè¶Â§ñ‰∏Ä‰∏™Ë°®ÁöÑ‰∏ªÈîÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫personË°®</span></span>
<span class="line"><span>CREATE TABLE person(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- ‰∏ªÈîÆid</span></span>
<span class="line"><span>	NAME VARCHAR(20)                        -- ÂßìÂêç</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO person VALUES (NULL,&#39;Âº†‰∏â&#39;),(NULL,&#39;ÊùéÂõõ&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂàõÂª∫cardË°®</span></span>
<span class="line"><span>CREATE TABLE card(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- ‰∏ªÈîÆid</span></span>
<span class="line"><span>	number VARCHAR(20) UNIQUE NOT NULL,	-- Ë∫´‰ªΩËØÅÂè∑</span></span>
<span class="line"><span>	pid INT UNIQUE,                         -- Â§ñÈîÆÂàó</span></span>
<span class="line"><span>	CONSTRAINT cp_fk1 FOREIGN KEY (pid) REFERENCES person(id)</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO card VALUES (NULL,&#39;12345&#39;,1),(NULL,&#39;56789&#39;,2);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Â§öË°®ËÆæËÆ°‰∏ÄÂØπ‰∏Ä.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h4 id="‰∏ÄÂØπÂ§ö" tabindex="-1"><a class="header-anchor" href="#‰∏ÄÂØπÂ§ö"><span>‰∏ÄÂØπÂ§ö</span></a></h4><p>‰∏æ‰æãÔºöÁî®Êà∑ÂíåËÆ¢Âçï„ÄÅÂïÜÂìÅÂàÜÁ±ªÂíåÂïÜÂìÅ</p><p>ÂÆûÁé∞ÂéüÂàôÔºöÂú®Â§öÁöÑ‰∏ÄÊñπÔºåÂª∫Á´ãÂ§ñÈîÆÁ∫¶ÊùüÔºåÊù•ÂÖ≥ËÅî‰∏ÄÁöÑ‰∏ÄÊñπ‰∏ªÈîÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫userË°®</span></span>
<span class="line"><span>CREATE TABLE USER(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- ‰∏ªÈîÆid</span></span>
<span class="line"><span>	NAME VARCHAR(20)                        -- ÂßìÂêç</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO USER VALUES (NULL,&#39;Âº†‰∏â&#39;),(NULL,&#39;ÊùéÂõõ&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂàõÂª∫orderlistË°®</span></span>
<span class="line"><span>CREATE TABLE orderlist(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- ‰∏ªÈîÆid</span></span>
<span class="line"><span>	number VARCHAR(20),                     -- ËÆ¢ÂçïÁºñÂè∑</span></span>
<span class="line"><span>	uid INT,				-- Â§ñÈîÆÂàó</span></span>
<span class="line"><span>	CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id)</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO orderlist VALUES (NULL,&#39;hm001&#39;,1),(NULL,&#39;hm002&#39;,1),(NULL,&#39;hm003&#39;,2),(NULL,&#39;hm004&#39;,2);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Â§öË°®ËÆæËÆ°‰∏ÄÂØπÂ§ö.png" alt="Â§öË°®ËÆæËÆ°‰∏ÄÂØπÂ§ö" tabindex="0" loading="lazy"><figcaption>Â§öË°®ËÆæËÆ°‰∏ÄÂØπÂ§ö</figcaption></figure><hr><h4 id="Â§öÂØπÂ§ö" tabindex="-1"><a class="header-anchor" href="#Â§öÂØπÂ§ö"><span>Â§öÂØπÂ§ö</span></a></h4><p>‰∏æ‰æãÔºöÂ≠¶ÁîüÂíåËØæÁ®ã„ÄÇ‰∏Ä‰∏™Â≠¶ÁîüÂèØ‰ª•ÈÄâÊã©Â§ö‰∏™ËØæÁ®ãÔºå‰∏Ä‰∏™ËØæÁ®ã‰πüÂèØ‰ª•Ë¢´Â§ö‰∏™Â≠¶ÁîüÈÄâÊã©</p><p>ÂÆûÁé∞ÂéüÂàôÔºöÂÄüÂä©Á¨¨‰∏âÂº†Ë°®‰∏≠Èó¥Ë°®Ôºå‰∏≠Èó¥Ë°®Ëá≥Â∞ëÂåÖÂê´‰∏§‰∏™ÂàóÔºåËøô‰∏§‰∏™Âàó‰Ωú‰∏∫‰∏≠Èó¥Ë°®ÁöÑÂ§ñÈîÆÔºåÂàÜÂà´ÂÖ≥ËÅî‰∏§Âº†Ë°®ÁöÑ‰∏ªÈîÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫studentË°®</span></span>
<span class="line"><span>CREATE TABLE student(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- ‰∏ªÈîÆid</span></span>
<span class="line"><span>	NAME VARCHAR(20)			-- Â≠¶ÁîüÂßìÂêç</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO student VALUES (NULL,&#39;Âº†‰∏â&#39;),(NULL,&#39;ÊùéÂõõ&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂàõÂª∫courseË°®</span></span>
<span class="line"><span>CREATE TABLE course(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- ‰∏ªÈîÆid</span></span>
<span class="line"><span>	NAME VARCHAR(10)			-- ËØæÁ®ãÂêçÁß∞</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO course VALUES (NULL,&#39;ËØ≠Êñá&#39;),(NULL,&#39;Êï∞Â≠¶&#39;);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂàõÂª∫‰∏≠Èó¥Ë°®</span></span>
<span class="line"><span>CREATE TABLE stu_course(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- ‰∏ªÈîÆid</span></span>
<span class="line"><span>	sid INT,  -- Áî®‰∫éÂíåstudentË°®‰∏≠ÁöÑidËøõË°åÂ§ñÈîÆÂÖ≥ËÅî</span></span>
<span class="line"><span>	cid INT,  -- Áî®‰∫éÂíåcourseË°®‰∏≠ÁöÑidËøõË°åÂ§ñÈîÆÂÖ≥ËÅî</span></span>
<span class="line"><span>	CONSTRAINT sc_fk1 FOREIGN KEY (sid) REFERENCES student(id), -- Ê∑ªÂä†Â§ñÈîÆÁ∫¶Êùü</span></span>
<span class="line"><span>	CONSTRAINT sc_fk2 FOREIGN KEY (cid) REFERENCES course(id)   -- Ê∑ªÂä†Â§ñÈîÆÁ∫¶Êùü</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO stu_course VALUES (NULL,1,1),(NULL,1,2),(NULL,2,1),(NULL,2,2);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Â§öË°®ËÆæËÆ°Â§öÂØπÂ§ö.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h3 id="ËøûÊé•Êü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#ËøûÊé•Êü•ËØ¢"><span>ËøûÊé•Êü•ËØ¢</span></a></h3><h4 id="ÂÜÖÂ§ñËøûÊé•" tabindex="-1"><a class="header-anchor" href="#ÂÜÖÂ§ñËøûÊé•"><span>ÂÜÖÂ§ñËøûÊé•</span></a></h4><h5 id="ÂÜÖËøûÊé•" tabindex="-1"><a class="header-anchor" href="#ÂÜÖËøûÊé•"><span>ÂÜÖËøûÊé•</span></a></h5><p>ËøûÊé•Êü•ËØ¢ÁöÑÊòØ‰∏§Âº†Ë°®Êúâ‰∫§ÈõÜÁöÑÈÉ®ÂàÜÊï∞ÊçÆÔºå‰∏§Âº†Ë°®ÂàÜ‰∏∫<strong>È©±Âä®Ë°®ÂíåË¢´È©±Âä®Ë°®</strong>ÔºåÂ¶ÇÊûúÁªìÊûúÈõÜ‰∏≠ÁöÑÊØèÊù°ËÆ∞ÂΩïÈÉΩÊòØ‰∏§‰∏™Ë°®Áõ∏‰∫íÂåπÈÖçÁöÑÁªÑÂêàÔºåÂàôÁß∞ËøôÊ†∑ÁöÑÁªìÊûúÈõÜ‰∏∫Á¨õÂç°Â∞îÁßØ</p><p>ÂÜÖËøûÊé•Êü•ËØ¢ÔºåËã•È©±Âä®Ë°®‰∏≠ÁöÑËÆ∞ÂΩïÂú®Ë¢´È©±Âä®Ë°®‰∏≠Êâæ‰∏çÂà∞ÂåπÈÖçÁöÑËÆ∞ÂΩïÊó∂ÔºåÂàôËØ•ËÆ∞ÂΩï‰∏ç‰ºöÂä†Âà∞ÊúÄÂêéÁöÑÁªìÊûúÈõÜ</p><ul><li><p>ÊòæÂºèÂÜÖËøûÊé•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç1 [INNER] JOIN Ë°®Âêç2 ON Êù°‰ª∂;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÈöêÂºèÂÜÖËøûÊé•ÔºöÂÜÖËøûÊé•‰∏≠ WHERE Â≠êÂè•Âíå ON Â≠êÂè•ÊòØÁ≠â‰ª∑ÁöÑ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç1,Ë°®Âêç2 WHERE Êù°‰ª∂;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>STRAIGHT_JOIN‰∏é JOIN Á±ª‰ººÔºåÂè™‰∏çËøáÂ∑¶Ë°®ÂßãÁªàÂú®Âè≥Ë°®‰πãÂâçËØªÂèñÔºåÂè™ÈÄÇÁî®‰∫éÂÜÖËøûÊé•</p><hr><h5 id="Â§ñËøûÊé•" tabindex="-1"><a class="header-anchor" href="#Â§ñËøûÊé•"><span>Â§ñËøûÊé•</span></a></h5><p>Â§ñËøûÊé•Êü•ËØ¢ÔºåËã•È©±Âä®Ë°®‰∏≠ÁöÑËÆ∞ÂΩïÂú®Ë¢´È©±Âä®Ë°®‰∏≠Êâæ‰∏çÂà∞ÂåπÈÖçÁöÑËÆ∞ÂΩïÊó∂ÔºåÂàôËØ•ËÆ∞ÂΩï‰πü‰ºöÂä†Âà∞ÊúÄÂêéÁöÑÁªìÊûúÈõÜÔºåÂè™ÊòØÂØπ‰∫éË¢´È©±Âä®Ë°®‰∏≠<strong>‰∏çÂåπÈÖçËøáÊª§Êù°‰ª∂</strong>ÁöÑËÆ∞ÂΩïÔºåÂêÑ‰∏™Â≠óÊÆµ‰ΩøÁî® NULL Â°´ÂÖÖ</p><p>Â∫îÁî®ÂÆû‰æãÔºöÊü•Â≠¶ÁîüÊàêÁª©Ôºå‰πüÊÉ≥Â±ïÁ§∫Âá∫Áº∫ËÄÉÁöÑ‰∫∫ÁöÑÊàêÁª©</p><ul><li><p>Â∑¶Â§ñËøûÊé•ÔºöÈÄâÊã©Â∑¶‰æßÁöÑË°®‰∏∫È©±Âä®Ë°®ÔºåÊü•ËØ¢Â∑¶Ë°®ÁöÑÂÖ®ÈÉ®Êï∞ÊçÆÔºåÂíåÂ∑¶Âè≥‰∏§Âº†Ë°®Êúâ‰∫§ÈõÜÈÉ®ÂàÜÁöÑÊï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç1 LEFT [OUTER] JOIN Ë°®Âêç2 ON Êù°‰ª∂;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âè≥Â§ñËøûÊé•ÔºöÈÄâÊã©Âè≥‰æßÁöÑË°®‰∏∫È©±Âä®Ë°®ÔºåÊü•ËØ¢Âè≥Ë°®ÁöÑÂÖ®ÈÉ®Êï∞ÊçÆÔºåÂíåÂ∑¶Âè≥‰∏§Âº†Ë°®Êúâ‰∫§ÈõÜÈÉ®ÂàÜÁöÑÊï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç1 RIGHT [OUTER] JOIN Ë°®Âêç2 ON Êù°‰ª∂;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-JOINÊü•ËØ¢Âõæ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="Ëá™ËøûÊé•" tabindex="-1"><a class="header-anchor" href="#Ëá™ËøûÊé•"><span>Ëá™ËøûÊé•</span></a></h4><p>Ëá™ËøûÊé•Êü•ËØ¢ÔºåÈ°æÂêçÊÄù‰πâÔºåÂ∞±ÊòØËá™Â∑±ËøûÊé•Ëá™Â∑±Ôºå‰πüÂ∞±ÊòØÊää‰∏ÄÂº†Ë°®ËøûÊé•Êü•ËØ¢Â§öÊ¨°„ÄÇÊàë‰ª¨ÂÖàÊù•Â≠¶‰π†‰∏Ä‰∏ãËá™ËøûÊé• ÁöÑÊü•ËØ¢ËØ≠Ê≥ïÔºö</p><p>SELECT Â≠óÊÆµÂàóË°® FROM Ë°®A Âà´ÂêçA JOIN Ë°®A Âà´ÂêçB ON Êù°‰ª∂ ... ;</p><p>ËÄåÂØπ‰∫éËá™ËøûÊé•Êü•ËØ¢ÔºåÂèØ‰ª•ÊòØÂÜÖËøûÊé•Êü•ËØ¢Ôºå‰πüÂèØ‰ª•ÊòØÂ§ñËøûÊé•Êü•ËØ¢„ÄÇ</p><p>Ê≥®ÊÑè‰∫ãÈ°π: Âú®Ëá™ËøûÊé•Êü•ËØ¢‰∏≠ÔºåÂøÖÈ°ªË¶Å‰∏∫Ë°®Ëµ∑Âà´ÂêçÔºåË¶Å‰∏çÁÑ∂Êàë‰ª¨‰∏çÊ∏ÖÊ•öÊâÄÊåáÂÆöÁöÑÊù°‰ª∂„ÄÅËøîÂõûÁöÑÂ≠óÊÆµÔºåÂà∞Â∫ï ÊòØÂì™‰∏ÄÂº†Ë°®ÁöÑÂ≠óÊÆµ„ÄÇ</p><hr><h4 id="ÂÖ≥ËÅîÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#ÂÖ≥ËÅîÊü•ËØ¢"><span>ÂÖ≥ËÅîÊü•ËØ¢</span></a></h4><p>Ëá™ÂÖ≥ËÅîÊü•ËØ¢ÔºöÂêå‰∏ÄÂº†Ë°®‰∏≠ÊúâÊï∞ÊçÆÂÖ≥ËÅîÔºåÂèØ‰ª•Â§öÊ¨°Êü•ËØ¢ËøôÂêå‰∏Ä‰∏™Ë°®</p><ul><li><p>Êï∞ÊçÆÂáÜÂ§á</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫ÂëòÂ∑•Ë°®</span></span>
<span class="line"><span>CREATE TABLE employee(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- ÂëòÂ∑•ÁºñÂè∑</span></span>
<span class="line"><span>	NAME VARCHAR(20),					-- ÂëòÂ∑•ÂßìÂêç</span></span>
<span class="line"><span>	mgr INT,							-- ‰∏äÁ∫ßÁºñÂè∑</span></span>
<span class="line"><span>	salary DOUBLE						-- ÂëòÂ∑•Â∑•ËµÑ</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO employee VALUES (1001,&#39;Â≠ôÊÇüÁ©∫&#39;,1005,9000.00),..,(1009,&#39;ÂÆãÊ±ü&#39;,NULL,16000.00);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Ëá™ÂÖ≥ËÅîÊü•ËØ¢Êï∞ÊçÆÂáÜÂ§á.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Êï∞ÊçÆÊü•ËØ¢</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Êü•ËØ¢ÊâÄÊúâÂëòÂ∑•ÁöÑÂßìÂêçÂèäÂÖ∂Áõ¥Êé•‰∏äÁ∫ßÁöÑÂßìÂêçÔºåÊ≤°Êúâ‰∏äÁ∫ßÁöÑÂëòÂ∑•‰πüÈúÄË¶ÅÊü•ËØ¢</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span>ÂàÜÊûê</span></span>
<span class="line"><span>	ÂëòÂ∑•‰ø°ÊÅØ employeeË°®</span></span>
<span class="line"><span>	Êù°‰ª∂Ôºöemployee.mgr = employee.id</span></span>
<span class="line"><span>	Êü•ËØ¢Â∑¶Ë°®ÁöÑÂÖ®ÈÉ®Êï∞ÊçÆÔºåÂíåÂ∑¶Âè≥‰∏§Âº†Ë°®Êúâ‰∫§ÈõÜÈÉ®ÂàÜÊï∞ÊçÆÔºåÂ∑¶Â§ñËøûÊé•</span></span>
<span class="line"><span>*/</span></span>
<span class="line"><span>SELECT</span></span>
<span class="line"><span>	e1.id,</span></span>
<span class="line"><span>	e1.name,</span></span>
<span class="line"><span>	e1.mgr,</span></span>
<span class="line"><span>	e2.id,</span></span>
<span class="line"><span>	e2.name</span></span>
<span class="line"><span>FROM</span></span>
<span class="line"><span>	employee e1</span></span>
<span class="line"><span>LEFT OUTER JOIN</span></span>
<span class="line"><span>	employee e2</span></span>
<span class="line"><span>ON</span></span>
<span class="line"><span>	e1.mgr = e2.id;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢ÁªìÊûú</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>id		name	mgr	   id	  name</span></span>
<span class="line"><span>1001	Â≠ôÊÇüÁ©∫	  1005	1005	ÂîêÂÉß</span></span>
<span class="line"><span>1002	Áå™ÂÖ´Êàí	  1005	1005	ÂîêÂÉß</span></span>
<span class="line"><span>1003	Ê≤ôÂíåÂ∞ö	  1005	1005	ÂîêÂÉß</span></span>
<span class="line"><span>1004	Â∞èÁôΩÈæô	  1005	1005	ÂîêÂÉß</span></span>
<span class="line"><span>1005	ÂîêÂÉß	   NULL	 NULL	 NULL</span></span>
<span class="line"><span>1006	Ê≠¶Êùæ	   1009	 1009	 ÂÆãÊ±ü</span></span>
<span class="line"><span>1007	ÊùéÈÄµ	   1009	 1009	 ÂÆãÊ±ü</span></span>
<span class="line"><span>1008	ÊûóÂÜ≤	   1009	 1009	 ÂÆãÊ±ü</span></span>
<span class="line"><span>1009	ÂÆãÊ±ü	   NULL	 NULL	 NULL</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="ËøûÊé•ÂéüÁêÜ" tabindex="-1"><a class="header-anchor" href="#ËøûÊé•ÂéüÁêÜ"><span>ËøûÊé•ÂéüÁêÜ</span></a></h4><p>Index Nested-Loop Join ÁÆóÊ≥ïÔºöÊü•ËØ¢È©±Âä®Ë°®ÂæóÂà∞<strong>Êï∞ÊçÆÈõÜ</strong>ÔºåÁÑ∂ÂêéÊ†πÊçÆÊï∞ÊçÆÈõÜ‰∏≠ÁöÑÊØè‰∏ÄÊù°ËÆ∞ÂΩïÁöÑ<strong>ÂÖ≥ËÅîÂ≠óÊÆµÂÜçÂàÜÂà´</strong>Âà∞Ë¢´È©±Âä®Ë°®‰∏≠Êü•ÊâæÂåπÈÖçÔºà<strong>Ëµ∞Á¥¢Âºï</strong>ÔºâÔºåÊâÄ‰ª•È©±Âä®Ë°®Âè™ÈúÄË¶ÅËÆøÈóÆ‰∏ÄÊ¨°ÔºåË¢´È©±Âä®Ë°®Ë¶ÅËÆøÈóÆÂ§öÊ¨°</p><p>MySQL Â∞ÜÊü•ËØ¢È©±Âä®Ë°®ÂêéÂæóÂà∞ÁöÑËÆ∞ÂΩïÊàê‰∏∫È©±Âä®Ë°®ÁöÑÊâáÂá∫ÔºåËøûÊé•Êü•ËØ¢ÁöÑÊàêÊú¨ÔºöÂçïÊ¨°ËÆøÈóÆÈ©±Âä®Ë°®ÁöÑÊàêÊú¨ + ÊâáÂá∫ÂÄº * ÂçïÊ¨°ËÆøÈóÆË¢´È©±Âä®Ë°®ÁöÑÊàêÊú¨Ôºå‰ºòÂåñÂô®‰ºöÈÄâÊã©ÊàêÊú¨ÊúÄÂ∞èÁöÑË°®ËøûÊé•È°∫Â∫èÔºàÁ°ÆÂÆöË∞ÅÊòØÈ©±Âä®Ë°®ÔºåË∞ÅÊòØË¢´È©±Âä®Ë°®ÔºâÁîüÊàêÊâßË°åËÆ°ÂàíÔºåËøõË°åËøûÊé•Êü•ËØ¢Ôºå‰ºòÂåñÊñπÂºèÔºö</p><ul><li>ÂáèÂ∞ëÈ©±Âä®Ë°®ÁöÑÊâáÂá∫ÔºàËÆ©Êï∞ÊçÆÈáèÂ∞èÁöÑË°®Êù•ÂÅöÈ©±Âä®Ë°®Ôºâ</li><li>Èôç‰ΩéËÆøÈóÆË¢´È©±Âä®Ë°®ÁöÑÊàêÊú¨</li></ul><p>ËØ¥ÊòéÔºöSTRAIGHT_JOIN ÊòØÊü•‰∏ÄÊù°È©±Âä®Ë°®ÔºåÁÑ∂ÂêéÊ†πÊçÆÂÖ≥ËÅîÂ≠óÊÆµÂéªÊü•Ë¢´È©±Âä®Ë°®ÔºåË¶ÅËÆøÈóÆÂ§öÊ¨°È©±Âä®Ë°®ÔºåÊâÄ‰ª•ÈúÄË¶Å‰ºòÂåñ‰∏∫ INL ÁÆóÊ≥ï</p><p>Block Nested-Loop Join ÁÆóÊ≥ïÔºö‰∏ÄÁßç<strong>Á©∫Èó¥Êç¢Êó∂Èó¥</strong>ÁöÑ‰ºòÂåñÊñπÂºèÔºåÂü∫‰∫éÂùóÁöÑÂæ™ÁéØËøûÊé•ÔºåÊâßË°åËøûÊé•Êü•ËØ¢ÂâçÁî≥ËØ∑‰∏ÄÂùóÂõ∫ÂÆöÂ§ßÂ∞èÁöÑÂÜÖÂ≠ò‰Ωú‰∏∫ËøûÊé•ÁºìÂÜ≤Âå∫ Join BufferÔºåÂÖàÊääËã•Âπ≤Êù°È©±Âä®Ë°®‰∏≠ÁöÑÊâáÂá∫ÊöÇÂ≠òÂú®ÁºìÂÜ≤Âå∫ÔºåÊØè‰∏ÄÊù°Ë¢´È©±Âä®Ë°®‰∏≠ÁöÑËÆ∞ÂΩï‰∏ÄÊ¨°ÊÄßÁöÑ‰∏é Buffer ‰∏≠Â§öÊù°ËÆ∞ÂΩïËøõË°åÂåπÈÖçÔºàÊâ´ÊèèÂÖ®ÈÉ®Êï∞ÊçÆÔºå‰∏ÄÊù°‰∏ÄÊù°ÁöÑÂåπÈÖçÔºâÔºåÂõ†‰∏∫ÊòØÂú®ÂÜÖÂ≠ò‰∏≠ÂÆåÊàêÔºåÊâÄ‰ª•ÈÄüÂ∫¶Âø´ÔºåÂπ∂‰∏îÈôç‰Ωé‰∫Ü I/O ÊàêÊú¨</p><p>Join Buffer ÂèØ‰ª•ÈÄöËøáÂèÇÊï∞ <code>join_buffer_size</code> ËøõË°åÈÖçÁΩÆÔºåÈªòËÆ§Â§ßÂ∞èÊòØ 256 KB</p><p>Âú®ÊàêÊú¨ÂàÜÊûêÊó∂ÔºåÂØπ‰∫éÂæàÂ§öÂº†Ë°®ÁöÑËøûÊé•Êü•ËØ¢ÔºåËøûÊé•È°∫Â∫èÊúâÈùûÂ∏∏Â§öÔºåMySQL Â¶ÇÊûúÊå®ÁùÄËøõË°åÈÅçÂéÜËÆ°ÁÆóÊàêÊú¨Ôºå‰ºöÊ∂àËÄóÂæàÂ§öËµÑÊ∫ê</p><ul><li>ÊèêÂâçÁªìÊùüÊüêÁßçËøûÊé•È°∫Â∫èÁöÑÊàêÊú¨ËØÑ‰º∞ÔºöÁª¥Êä§‰∏Ä‰∏™ÂÖ®Â±ÄÂèòÈáèËÆ∞ÂΩïÂΩìÂâçÊàêÊú¨ÊúÄÂ∞èÁöÑËøûÊé•ÊñπÂºèÔºåÂ¶ÇÊûú‰∏ÄÁßçÈ°∫Â∫èÂè™ËÆ°ÁÆó‰∫Ü‰∏ÄÈÉ®ÂàÜÂ∞±Â∑≤ÁªèË∂ÖËøá‰∫ÜÊúÄÂ∞èÊàêÊú¨ÔºåÂèØ‰ª•ÊèêÂâçÁªìÊùüËÆ°ÁÆó</li><li>Á≥ªÁªüÂèòÈáè optimizer_search_depthÔºöÂ¶ÇÊûúËøûÊé•Ë°®ÁöÑ‰∏™Êï∞Â∞è‰∫éËØ•ÂèòÈáèÔºåÂ∞±ÁªßÁª≠Á©∑‰∏æÂàÜÊûêÊØè‰∏ÄÁßçËøûÊé•Êï∞ÈáèÔºåÂèç‰πãÂè™ÂØπÊï∞Èáè‰∏é depth ÂÄºÁõ∏ÂêåÁöÑË°®ËøõË°åÂàÜÊûêÔºåËØ•ÂÄºË∂äÂ§ßÊàêÊú¨ÂàÜÊûêÁöÑË∂äÁ≤æÁ°Æ</li><li>Á≥ªÁªüÂèòÈáè optimizer_prune_levelÔºöÊéßÂà∂ÂêØÂèëÂºèËßÑÂàôÁöÑÂêØÁî®ÔºåËøô‰∫õËßÑÂàôÂ∞±ÊòØÊ†πÊçÆ‰ª•ÂæÄÁªèÈ™åÊåáÂÆöÁöÑÔºå‰∏çÊª°Ë∂≥ËßÑÂàôÁöÑËøûÊé•È°∫Â∫è‰∏çÂàÜÊûêÊàêÊú¨</li></ul><hr><h4 id="ËøûÊé•‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#ËøûÊé•‰ºòÂåñ"><span>ËøûÊé•‰ºòÂåñ</span></a></h4><h5 id="bka" tabindex="-1"><a class="header-anchor" href="#bka"><span>BKA</span></a></h5><p>Batched Key Access ÁÆóÊ≥ïÊòØÂØπ NLJ ÁÆóÊ≥ïÁöÑ‰ºòÂåñÔºåÂú®ËØªÂèñË¢´È©±Âä®Ë°®ÁöÑËÆ∞ÂΩïÊó∂‰ΩøÁî®È°∫Â∫è IOÔºåExtra ‰ø°ÊÅØ‰∏≠‰ºöÊúâ Batched Key Access ‰ø°ÊÅØ</p><p>‰ΩøÁî® BKA ÁöÑË°®ÁöÑ JOIN ËøáÁ®ãÂ¶Ç‰∏ãÔºö</p><ul><li>ËøûÊé•È©±Âä®Ë°®Â∞ÜÊª°Ë∂≥Êù°‰ª∂ÁöÑËÆ∞ÂΩïÊîæÂÖ• Join BufferÔºåÂπ∂Â∞Ü‰∏§Ë°®ËøûÊé•ÁöÑÂ≠óÊÆµÊîæÂÖ•‰∏Ä‰∏™ DYNAMIC_ARRAY ranges ‰∏≠</li><li>Âú®ËøõË°åË°®ÁöÑËøáÊé•ËøáÁ®ã‰∏≠Ôºå‰ºöÂ∞Ü ranges Áõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØ‰º†ÂÖ• Buffer ‰∏≠ÔºåËøõË°åË¢´È©±Âä®Ë°®‰∏ªÂª∫ÁöÑÊü•ÊâæÂèäÊéíÂ∫èÊìç‰Ωú</li><li>Ë∞ÉÁî®Ê≠•È™§ 2 ‰∏≠‰∫ßÁîüÁöÑÊúâÂ∫è‰∏ªÂª∫Ôºå<strong>È°∫Â∫èËØªÂèñË¢´È©±Âä®Ë°®ÁöÑÊï∞ÊçÆ</strong></li><li>ÂΩìÁºìÂÜ≤Âå∫ÁöÑÊï∞ÊçÆË¢´ËØªÂÆåÂêéÔºå‰ºöÈáçÂ§çËøõË°åÊ≠•È™§ 2„ÄÅ3ÔºåÁõ¥Âà∞ËÆ∞ÂΩïË¢´ËØªÂèñÂÆå</li></ul><p>‰ΩøÁî® BKA ‰ºòÂåñÈúÄË¶ÅËÆæËøõË°åËÆæÁΩÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET optimizer_switch=&#39;mrr=on,mrr_cost_based=off,batched_key_access=on&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ËØ¥ÊòéÔºöÂâç‰∏§‰∏™ÂèÇÊï∞ÁöÑ‰ΩúÁî®ÊòØÂêØÁî® MRRÔºåÂõ†‰∏∫ BKA ÁÆóÊ≥ïÁöÑ‰ºòÂåñË¶Å‰æùËµñ‰∫é MRRÔºàÁ≥ªÁªü‰ºòÂåñ ‚Üí ÂÜÖÂ≠ò‰ºòÂåñ ‚Üí Read ËØ¶Ëß£Ôºâ</p><hr><h5 id="bnl" tabindex="-1"><a class="header-anchor" href="#bnl"><span>BNL</span></a></h5><h6 id="ÈóÆÈ¢ò" tabindex="-1"><a class="header-anchor" href="#ÈóÆÈ¢ò"><span>ÈóÆÈ¢ò</span></a></h6><p>BNL Âç≥ Block Nested-Loop Join ÁÆóÊ≥ïÔºåÁî±‰∫éË¶ÅËÆøÈóÆÂ§öÊ¨°Ë¢´È©±Âä®Ë°®Ôºå‰ºö‰∫ßÁîü‰∏§‰∏™ÈóÆÈ¢òÔºö</p><ul><li><p>Join ËØ≠Âè•Â§öÊ¨°Êâ´Êèè‰∏Ä‰∏™ÂÜ∑Ë°®ÔºåÂπ∂‰∏îËØ≠Âè•ÊâßË°åÊó∂Èó¥Â∞è‰∫é 1 ÁßíÔºåÂ∞±‰ºöÂú®ÂÜçÊ¨°Êâ´ÊèèÂÜ∑Ë°®Êó∂ÔºåÊääÂÜ∑Ë°®ÁöÑÊï∞ÊçÆÈ°µÁßªÂà∞ LRU ÈìæË°®Â§¥ÈÉ®ÔºåÂØºËá¥ÁÉ≠Êï∞ÊçÆË¢´Ê∑òÊ±∞ÔºåÂΩ±Âìç‰∏öÂä°ÁöÑÊ≠£Â∏∏ËøêË°å</p><p>ËøôÁßçÊÉÖÂÜµÂÜ∑Ë°®ÁöÑÊï∞ÊçÆÈáèË¶ÅÂ∞è‰∫éÊï¥‰∏™ Buffer Pool ÁöÑ old Âå∫ÂüüÔºåËÉΩÂ§üÂÆåÂÖ®ÊîæÂÖ• old Âå∫ÔºåÊâç‰ºöÂÜçÊ¨°Ë¢´ËØªÊó∂Âä†Âà∞ youngÔºåÂê¶ÂàôËØªÂèñ‰∏ã‰∏ÄÊÆµÊó∂Â∞±Â∑≤ÁªèÊää‰∏ä‰∏ÄÊÆµÊ∑òÊ±∞</p></li><li><p>Join ËØ≠Âè•Âú®Âæ™ÁéØËØªÁ£ÅÁõòÂíåÊ∑òÊ±∞ÂÜÖÂ≠òÈ°µÔºåËøõÂÖ• old Âå∫ÂüüÁöÑÊï∞ÊçÆÈ°µÂæàÂèØËÉΩÂú® 1 Áßí‰πãÂÜÖÂ∞±Ë¢´Ê∑òÊ±∞ÔºåÂ∞±‰ºöÂØºËá¥ MySQL ÂÆû‰æãÁöÑ Buffer Pool Âú®ËøôÊÆµÊó∂Èó¥ÂÜÖ young Âå∫ÂüüÁöÑÊï∞ÊçÆÈ°µÊ≤°ÊúâË¢´ÂêàÁêÜÂú∞Ê∑òÊ±∞</p></li></ul><p>Â§ßË°® Join Êìç‰ΩúËôΩÁÑ∂ÂØπ IO ÊúâÂΩ±ÂìçÔºå‰ΩÜÊòØÂú®ËØ≠Âè•ÊâßË°åÁªìÊùüÂêéÂØπ IO ÁöÑÂΩ±ÂìçÈöè‰πãÁªìÊùü„ÄÇ‰ΩÜÊòØÂØπ Buffer Pool ÁöÑÂΩ±ÂìçÂ∞±ÊòØÊåÅÁª≠ÊÄßÁöÑÔºåÈúÄË¶Å‰æùÈù†ÂêéÁª≠ÁöÑÊü•ËØ¢ËØ∑Ê±ÇÊÖ¢ÊÖ¢ÊÅ¢Â§çÂÜÖÂ≠òÂëΩ‰∏≠Áéá</p><h6 id="‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#‰ºòÂåñ"><span>‰ºòÂåñ</span></a></h6><p>Â∞Ü BNL ÁÆóÊ≥ïËΩ¨Êàê BKA ÁÆóÊ≥ïÔºå‰ºòÂåñÊñπÂêëÔºö</p><ul><li>Âú®Ë¢´È©±Âä®Ë°®‰∏äÂª∫Á¥¢ÂºïÔºåËøôÊ†∑Â∞±ÂèØ‰ª•Ê†πÊçÆÁ¥¢ÂºïËøõË°åÈ°∫Â∫è IO</li><li>‰ΩøÁî®‰∏¥Êó∂Ë°®Ôºå<strong>Âú®‰∏¥Êó∂Ë°®‰∏äÂª∫Á´ãÁ¥¢Âºï</strong>ÔºåÂ∞ÜË¢´È©±Âä®Ë°®Âíå‰∏¥Êó∂Ë°®ËøõË°åËøûÊé•Êü•ËØ¢</li></ul><p>È©±Âä®Ë°® t1ÔºåË¢´È©±Âä®Ë°® t2Ôºå‰ΩøÁî®‰∏¥Êó∂Ë°®ÁöÑÂ∑•‰ΩúÊµÅÁ®ãÔºö</p><ul><li>ÊääË°® t1 ‰∏≠Êª°Ë∂≥Êù°‰ª∂ÁöÑÊï∞ÊçÆÊîæÂú®‰∏¥Êó∂Ë°® tmp_t ‰∏≠</li><li>Áªô‰∏¥Êó∂Ë°® tmp_t ÁöÑÂÖ≥ËÅîÂ≠óÊÆµÂä†‰∏äÁ¥¢ÂºïÔºå‰ΩøÁî® BKA ÁÆóÊ≥ï</li><li>ËÆ©Ë°® t2 Âíå tmp_t ÂÅö Join Êìç‰ΩúÔºà‰∏¥Êó∂Ë°®ÊòØË¢´È©±Âä®Ë°®Ôºâ</li></ul><p>Ë°•ÂÖÖÔºöMySQL 8.0 ÊîØÊåÅ hash joinÔºåjoin_buffer Áª¥Êä§ÁöÑ‰∏çÂÜçÊòØ‰∏Ä‰∏™Êó†Â∫èÊï∞ÁªÑÔºåËÄåÊòØ‰∏Ä‰∏™ÂìàÂ∏åË°®ÔºåÊü•ËØ¢ÊïàÁéáÊõ¥È´òÔºåÊâßË°åÊïàÁéáÊØî‰∏¥Êó∂Ë°®Êõ¥È´ò</p><hr><h3 id="ÂµåÂ•óÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#ÂµåÂ•óÊü•ËØ¢"><span>ÂµåÂ•óÊü•ËØ¢</span></a></h3><h4 id="Êü•ËØ¢ÂàÜÁ±ª" tabindex="-1"><a class="header-anchor" href="#Êü•ËØ¢ÂàÜÁ±ª"><span>Êü•ËØ¢ÂàÜÁ±ª</span></a></h4><p>Êü•ËØ¢ËØ≠Âè•‰∏≠ÂµåÂ•ó‰∫ÜÊü•ËØ¢ËØ≠Âè•Ôºå<strong>Â∞ÜÂµåÂ•óÊü•ËØ¢Áß∞‰∏∫Â≠êÊü•ËØ¢</strong>ÔºåFROM Â≠êÂè•ÂêéÈù¢ÁöÑÂ≠êÊü•ËØ¢ÁöÑÁªìÊûúÈõÜÁß∞‰∏∫Ê¥æÁîüË°®</p><p>Ê†πÊçÆÁªìÊûúÂàÜÁ±ªÔºö</p><h5 id="Ê†áÈáèÂ≠êÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#Ê†áÈáèÂ≠êÊü•ËØ¢"><span>Ê†áÈáèÂ≠êÊü•ËØ¢</span></a></h5><ul><li><p>ÁªìÊûúÊòØÂçïË°åÂçïÂàóÔºöÂèØ‰ª•Â∞ÜÊü•ËØ¢ÁöÑÁªìÊûú‰Ωú‰∏∫Âè¶‰∏ÄÊù°ËØ≠Âè•ÁöÑÊü•ËØ¢Êù°‰ª∂Ôºå‰ΩøÁî®ËøêÁÆóÁ¨¶Âà§Êñ≠ÔºåÂ∏∏Áî®ÁöÑÊìç‰ΩúÁ¨¶Ôºö= &lt;&gt; &gt; &gt;= &lt; &lt;=</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç WHERE ÂàóÂêç=(SELECT ÂàóÂêç/ËÅöÂêàÂáΩÊï∞(ÂàóÂêç) FROM Ë°®Âêç [WHERE Êù°‰ª∂]);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="ÂàóÂ≠êÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#ÂàóÂ≠êÊü•ËØ¢"><span>ÂàóÂ≠êÊü•ËØ¢</span></a></h5></li><li><p>ÁªìÊûúÊòØÂ§öË°åÂçïÂàóÔºöÂèØ‰ª•‰Ωú‰∏∫Êù°‰ª∂Ôºå‰ΩøÁî®ËøêÁÆóÁ¨¶ IN Êàñ NOT IN ËøõË°åÂà§Êñ≠</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç WHERE ÂàóÂêç [NOT] IN (SELECT ÂàóÂêç FROM Ë°®Âêç [WHERE Êù°‰ª∂]);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><table><thead><tr><th>Êìç‰ΩúÁ¨¶</th><th>ÊèèËø∞</th></tr></thead><tbody><tr><td>IN</td><td>Âú®ÊåáÂÆöÁöÑÈõÜÂêàËåÉÂõ¥‰πãÂÜÖÔºåÂ§öÈÄâ‰∏Ä</td></tr><tr><td>NOT IN</td><td>‰∏çÂú®ÊåáÂÆöÁöÑÈõÜÂêàËåÉÂõ¥‰πãÂÜÖ</td></tr><tr><td>ANY</td><td>Â≠êÊü•ËØ¢ËøîÂõûÂàóË°®‰∏≠ÔºåÊúâ‰ªªÊÑè‰∏Ä‰∏™Êª°Ë∂≥Âç≥ÂèØ</td></tr><tr><td>SOME</td><td>‰∏éANYÁ≠âÂêåÔºå‰ΩøÁî®SOMEÁöÑÂú∞ÊñπÈÉΩÂèØ‰ª•‰ΩøÁî®ANY</td></tr><tr><td>ALL</td><td>Â≠êÊü•ËØ¢ËøîÂõûÂàóË°®ÁöÑÊâÄÊúâÂÄºÈÉΩÂøÖÈ°ªÊª°Ë∂≥</td></tr></tbody></table><h5 id="Ë°åÂ≠êÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#Ë°åÂ≠êÊü•ËØ¢"><span>Ë°åÂ≠êÊü•ËØ¢</span></a></h5><p>Â≠êÊü•ËØ¢ËøîÂõûÁöÑÁªìÊûúÊòØ‰∏ÄË°åÔºàÂèØ‰ª•ÊòØÂ§öÂàóÔºâÔºåËøôÁßçÂ≠êÊü•ËØ¢Áß∞‰∏∫Ë°åÂ≠êÊü•ËØ¢„ÄÇ Â∏∏Áî®ÁöÑÊìç‰ΩúÁ¨¶Ôºö= „ÄÅ&lt;&gt; „ÄÅIN „ÄÅNOT IN</p><p>Ê°à‰æã: A. Êü•ËØ¢‰∏é &quot;Âº†Êó†Âøå&quot; ÁöÑËñ™ËµÑÂèäÁõ¥Â±ûÈ¢ÜÂØºÁõ∏ÂêåÁöÑÂëòÂ∑•‰ø°ÊÅØ Ëøô‰∏™ÈúÄÊ±ÇÂêåÊ†∑ÂèØ‰ª•ÊãÜËß£‰∏∫‰∏§Ê≠•ËøõË°å: ‚ë†. Êü•ËØ¢ &quot;Âº†Êó†Âøå&quot; ÁöÑËñ™ËµÑÂèäÁõ¥Â±ûÈ¢ÜÂØº select salary, managerid from emp where name = &#39;Âº†Êó†Âøå&#39;;</p><p>‚ë°. Êü•ËØ¢‰∏é &quot;Âº†Êó†Âøå&quot; ÁöÑËñ™ËµÑÂèäÁõ¥Â±ûÈ¢ÜÂØºÁõ∏ÂêåÁöÑÂëòÂ∑•‰ø°ÊÅØ ; select * from emp where (salary,managerid) = (select salary, managerid from emp where name = &#39;Âº†Êó†Âøå&#39;);</p><h5 id="Ë°®Â≠êÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#Ë°®Â≠êÊü•ËØ¢"><span>Ë°®Â≠êÊü•ËØ¢</span></a></h5></li><li><p>ÁªìÊûúÊòØÂ§öË°åÂ§öÂàóÔºöÊü•ËØ¢ÁöÑÁªìÊûúÂèØ‰ª•‰Ωú‰∏∫‰∏ÄÂº†ËôöÊãüË°®ÂèÇ‰∏éÊü•ËØ¢</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂàóÂêç FROM Ë°®Âêç [Âà´Âêç],(SELECT ÂàóÂêç FROM Ë°®Âêç [WHERE Êù°‰ª∂]) [Âà´Âêç] [WHERE Êù°‰ª∂];</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢ËÆ¢ÂçïË°®orderlist‰∏≠idÂ§ß‰∫é4ÁöÑËÆ¢Âçï‰ø°ÊÅØÂíåÊâÄÂ±ûÁî®Êà∑USER‰ø°ÊÅØ</span></span>
<span class="line"><span>SELECT </span></span>
<span class="line"><span>	* </span></span>
<span class="line"><span>FROM </span></span>
<span class="line"><span>	USER u,</span></span>
<span class="line"><span>	(SELECT * FROM orderlist WHERE id&gt;4) o </span></span>
<span class="line"><span>WHERE </span></span>
<span class="line"><span>	u.id=o.uid;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>Áõ∏ÂÖ≥ÊÄßÂàÜÁ±ªÔºö</p><ul><li>‰∏çÁõ∏ÂÖ≥Â≠êÊü•ËØ¢ÔºöÂ≠êÊü•ËØ¢‰∏ç‰æùËµñÂ§ñÂ±ÇÊü•ËØ¢ÁöÑÂÄºÔºåÂèØ‰ª•ÂçïÁã¨ËøêË°åÂá∫ÁªìÊûú</li><li>Áõ∏ÂÖ≥Â≠êÊü•ËØ¢ÔºöÂ≠êÊü•ËØ¢ÁöÑÊâßË°åÈúÄË¶Å‰æùËµñÂ§ñÂ±ÇÊü•ËØ¢ÁöÑÂÄº</li></ul><hr><h4 id="Êü•ËØ¢‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#Êü•ËØ¢‰ºòÂåñ"><span>Êü•ËØ¢‰ºòÂåñ</span></a></h4><p>‰∏çÁõ∏ÂÖ≥Â≠êÊü•ËØ¢ÁöÑÁªìÊûúÈõÜ‰ºöË¢´ÂÜôÂÖ•‰∏Ä‰∏™‰∏¥Êó∂Ë°®ÔºåÂπ∂‰∏îÂú®ÂÜôÂÖ•Êó∂<strong>ÂéªÈáç</strong>ÔºåËØ•ËøáÁ®ãÁß∞‰∏∫<strong>Áâ©Âåñ</strong>ÔºåÂ≠òÂÇ®ÁªìÊûúÈõÜÁöÑ‰∏¥Êó∂Ë°®Áß∞‰∏∫Áâ©ÂåñË°®</p><p>Á≥ªÁªüÂèòÈáè tmp_table_size ÊàñËÄÖ max_heap_table_size ‰∏∫Ë°®ÁöÑÊúÄÂÄº</p><ul><li>Â∞è‰∫éÁ≥ªÁªüÂèòÈáèÊó∂ÔºåÂÜÖÂ≠ò‰∏≠ÂèØ‰ª•‰øùÂ≠òÔºå‰ºö‰∏∫Âª∫Á´ã<strong>Âü∫‰∫éÂÜÖÂ≠ò</strong>ÁöÑ MEMORY Â≠òÂÇ®ÂºïÊìéÁöÑ‰∏¥Êó∂Ë°®ÔºåÂπ∂Âª∫Á´ãÂìàÂ∏åÁ¥¢Âºï</li><li>Â§ß‰∫é‰ªªÊÑè‰∏Ä‰∏™Á≥ªÁªüÂèòÈáèÊó∂ÔºåÁâ©ÂåñË°®‰ºö‰ΩøÁî®<strong>Âü∫‰∫éÁ£ÅÁõò</strong>ÁöÑ InnoDB Â≠òÂÇ®ÂºïÊìéÊù•‰øùÂ≠òÁªìÊûúÈõÜ‰∏≠ÁöÑËÆ∞ÂΩïÔºåÁ¥¢ÂºïÁ±ªÂûã‰∏∫ B+ Ê†ë</li></ul><p>Áâ©ÂåñÂêéÔºåÂµåÂ•óÊü•ËØ¢Â∞±Áõ∏ÂΩì‰∫éÂ§ñÂ±ÇÊü•ËØ¢ÁöÑË°®ÂíåÁâ©ÂåñË°®ËøõË°åÂÜÖËøûÊé•Êü•ËØ¢ÔºåÁÑ∂ÂêéÁªèËøá‰ºòÂåñÂô®ÈÄâÊã©ÊàêÊú¨ÊúÄÂ∞èÁöÑË°®ËøûÊé•È°∫Â∫èÊâßË°åÊü•ËØ¢</p><p>Â≠êÊü•ËØ¢Áâ©Âåñ‰ºö‰∫ßÁîüÂª∫Á´ã‰∏¥Êó∂Ë°®ÁöÑÊàêÊú¨Ôºå‰ΩÜÊòØÂ∞ÜÂ≠êÊü•ËØ¢ËΩ¨Âåñ‰∏∫ËøûÊé•Êü•ËØ¢ÂèØ‰ª•ÂÖÖÂàÜÂèëÊå•‰ºòÂåñÂô®ÁöÑ‰ΩúÁî®ÔºåÊâÄ‰ª•ÂºïÂÖ•ÔºöÂçäËøûÊé•</p><ul><li>t1 Âíå t2 Ë°®ËøõË°åÂçäËøûÊé•ÔºåÂØπ‰∫é t1 Ë°®‰∏≠ÁöÑÊüêÊù°ËÆ∞ÂΩïÔºåÂè™ÈúÄË¶ÅÂÖ≥ÂøÉÂú® t2 Ë°®‰∏≠ÊòØÂê¶Â≠òÂú®ÔºåËÄå‰∏çÈúÄË¶ÅÂÖ≥ÂøÉÊúâÂ§öÂ∞ëÊù°ËÆ∞ÂΩï‰∏é‰πãÂåπÈÖçÔºåÊúÄÁªàÁªìÊûúÈõÜÂè™‰øùÁïô t1 ÁöÑËÆ∞ÂΩï</li><li>ÂçäËøûÊé•Âè™ÊòØÊâßË°åÂ≠êÊü•ËØ¢ÁöÑ‰∏ÄÁßçÊñπÂºèÔºåMySQL Âπ∂Ê≤°ÊúâÊèê‰æõÈù¢ÂêëÁî®Êà∑ÁöÑÂçäËøûÊé•ËØ≠Ê≥ï</li></ul><p>ÂèÇËÄÉ‰π¶Á±çÔºöhttps://book.douban.com/subject/35231266/</p><hr><h4 id="ËÅîÂêàÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#ËÅîÂêàÊü•ËØ¢"><span>ËÅîÂêàÊü•ËØ¢</span></a></h4><p>UNION ÊòØÂèñËøô‰∏§‰∏™Â≠êÊü•ËØ¢ÁªìÊûúÁöÑÂπ∂ÈõÜÔºåÂπ∂ËøõË°åÂéªÈáçÔºåÂêåÊó∂ËøõË°åÈªòËÆ§ËßÑÂàôÁöÑÊéíÂ∫èÔºàunion ÊòØË°åÂä†Ëµ∑Êù•Ôºåjoin ÊòØÂàóÂä†Ëµ∑Êù•Ôºâ</p><p>UNION ALL ÊòØÂØπ‰∏§‰∏™ÁªìÊûúÈõÜËøõË°åÂπ∂ÈõÜÊìç‰Ωú‰∏çËøõË°åÂéªÈáçÔºå‰∏çËøõË°åÊéíÂ∫è</p><p>‰∏§ËÄÖÈÉΩÂèØ‰ª•‰∏çÂä†Êã¨Âè∑</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>(select 1000 as f) union (select id from t1 order by id desc limit 2); #t1Ë°®‰∏≠ÂåÖÂê´id ‰∏∫ 1-1000 ÁöÑÊï∞ÊçÆ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ËØ≠Âè•ÁöÑÊâßË°åÊµÅÁ®ãÔºö</p><ul><li>ÂàõÂª∫‰∏Ä‰∏™ÂÜÖÂ≠ò‰∏¥Êó∂Ë°®ÔºåËøô‰∏™‰∏¥Êó∂Ë°®Âè™Êúâ‰∏Ä‰∏™Êï¥ÂûãÂ≠óÊÆµ fÔºåÂπ∂‰∏î f ÊòØ‰∏ªÈîÆÂ≠óÊÆµ</li><li>ÊâßË°åÁ¨¨‰∏Ä‰∏™Â≠êÊü•ËØ¢ÔºåÂæóÂà∞ 1000 Ëøô‰∏™ÂÄºÔºåÂπ∂Â≠òÂÖ•‰∏¥Êó∂Ë°®‰∏≠</li><li>ÊâßË°åÁ¨¨‰∫å‰∏™Â≠êÊü•ËØ¢ÔºåÊãøÂà∞Á¨¨‰∏ÄË°å id=1000ÔºåËØïÂõæÊèíÂÖ•‰∏¥Êó∂Ë°®‰∏≠Ôºå‰ΩÜÁî±‰∫é 1000 Ëøô‰∏™ÂÄºÂ∑≤ÁªèÂ≠òÂú®‰∫é‰∏¥Êó∂Ë°®‰∫ÜÔºåËøùÂèç‰∫ÜÂîØ‰∏ÄÊÄßÁ∫¶ÊùüÔºåÊâÄ‰ª•ÊèíÂÖ•Â§±Ë¥•ÔºåÁÑ∂ÂêéÁªßÁª≠ÊâßË°å</li><li>ÂèñÂà∞Á¨¨‰∫åË°å id=999ÔºåÊèíÂÖ•‰∏¥Êó∂Ë°®ÊàêÂäü</li><li>‰ªé‰∏¥Êó∂Ë°®‰∏≠ÊåâË°åÂèñÂá∫Êï∞ÊçÆÔºåËøîÂõûÁªìÊûúÂπ∂Âà†Èô§‰∏¥Êó∂Ë°®ÔºåÁªìÊûú‰∏≠ÂåÖÂê´‰∏§Ë°åÊï∞ÊçÆÂàÜÂà´ÊòØ 1000 Âíå 999</li></ul><hr><h3 id="Êü•ËØ¢ÁªÉ‰π†" tabindex="-1"><a class="header-anchor" href="#Êü•ËØ¢ÁªÉ‰π†"><span>Êü•ËØ¢ÁªÉ‰π†</span></a></h3><p>Êï∞ÊçÆÂáÜÂ§áÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫db4Êï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span>CREATE DATABASE db4;</span></span>
<span class="line"><span>-- ‰ΩøÁî®db4Êï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span>USE db4;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂàõÂª∫userË°®</span></span>
<span class="line"><span>CREATE TABLE USER(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- Áî®Êà∑id</span></span>
<span class="line"><span>	NAME VARCHAR(20),					-- Áî®Êà∑ÂßìÂêç</span></span>
<span class="line"><span>	age INT                             -- Áî®Êà∑Âπ¥ÈæÑ</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ËÆ¢ÂçïË°®</span></span>
<span class="line"><span>CREATE TABLE orderlist(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- ËÆ¢Âçïid</span></span>
<span class="line"><span>	number VARCHAR(30),					-- ËÆ¢ÂçïÁºñÂè∑</span></span>
<span class="line"><span>	uid INT,   							-- Â§ñÈîÆÂ≠óÊÆµ</span></span>
<span class="line"><span>	CONSTRAINT ou_fk1 FOREIGN KEY (uid) REFERENCES USER(id)</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂïÜÂìÅÂàÜÁ±ªË°®</span></span>
<span class="line"><span>CREATE TABLE category(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,  -- ÂïÜÂìÅÂàÜÁ±ªid</span></span>
<span class="line"><span>	NAME VARCHAR(10)                    -- ÂïÜÂìÅÂàÜÁ±ªÂêçÁß∞</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂïÜÂìÅË°®</span></span>
<span class="line"><span>CREATE TABLE product(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,   -- ÂïÜÂìÅid</span></span>
<span class="line"><span>	NAME VARCHAR(30),                    -- ÂïÜÂìÅÂêçÁß∞</span></span>
<span class="line"><span>	cid INT, -- Â§ñÈîÆÂ≠óÊÆµ</span></span>
<span class="line"><span>	CONSTRAINT cp_fk1 FOREIGN KEY (cid) REFERENCES category(id)</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ‰∏≠Èó¥Ë°®</span></span>
<span class="line"><span>CREATE TABLE us_pro(</span></span>
<span class="line"><span>	upid INT PRIMARY KEY AUTO_INCREMENT,  -- ‰∏≠Èó¥Ë°®id</span></span>
<span class="line"><span>	uid INT, 							  -- Â§ñÈîÆÂ≠óÊÆµ„ÄÇÈúÄË¶ÅÂíåÁî®Êà∑Ë°®ÁöÑ‰∏ªÈîÆ‰∫ßÁîüÂÖ≥ËÅî</span></span>
<span class="line"><span>	pid INT,							  -- Â§ñÈîÆÂ≠óÊÆµ„ÄÇÈúÄË¶ÅÂíåÂïÜÂìÅË°®ÁöÑ‰∏ªÈîÆ‰∫ßÁîüÂÖ≥ËÅî</span></span>
<span class="line"><span>	CONSTRAINT up_fk1 FOREIGN KEY (uid) REFERENCES USER(id),</span></span>
<span class="line"><span>	CONSTRAINT up_fk2 FOREIGN KEY (pid) REFERENCES product(id)</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Â§öË°®ÁªÉ‰π†Êû∂ÊûÑËÆæËÆ°.png" alt="Â§öË°®ÁªÉ‰π†Êû∂ÊûÑËÆæËÆ°" tabindex="0" loading="lazy"><figcaption>Â§öË°®ÁªÉ‰π†Êû∂ÊûÑËÆæËÆ°</figcaption></figure><p><strong>Êï∞ÊçÆÊü•ËØ¢Ôºö</strong></p><ol><li><p>Êü•ËØ¢Áî®Êà∑ÁöÑÁºñÂè∑„ÄÅÂßìÂêç„ÄÅÂπ¥ÈæÑ„ÄÅËÆ¢ÂçïÁºñÂè∑</p><p>Êï∞ÊçÆÔºöÁî®Êà∑ÁöÑÁºñÂè∑„ÄÅÂßìÂêç„ÄÅÂπ¥ÈæÑÂú® user Ë°®ÔºåËÆ¢ÂçïÁºñÂè∑Âú® orderlist Ë°®</p><p>Êù°‰ª∂Ôºöuser.id = orderlist.uid</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT</span></span>
<span class="line"><span>	u.*,</span></span>
<span class="line"><span>	o.number</span></span>
<span class="line"><span>FROM</span></span>
<span class="line"><span>	USER u,</span></span>
<span class="line"><span>	orderlist o</span></span>
<span class="line"><span>WHERE</span></span>
<span class="line"><span>	u.id = o.uid;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢ÊâÄÊúâÁöÑÁî®Êà∑ÔºåÊòæÁ§∫Áî®Êà∑ÁöÑÁºñÂè∑„ÄÅÂßìÂêç„ÄÅÂπ¥ÈæÑ„ÄÅËÆ¢ÂçïÁºñÂè∑„ÄÇ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT</span></span>
<span class="line"><span>	u.*,</span></span>
<span class="line"><span>	o.number</span></span>
<span class="line"><span>FROM</span></span>
<span class="line"><span>	USER u</span></span>
<span class="line"><span>LEFT OUTER JOIN</span></span>
<span class="line"><span>	orderlist o</span></span>
<span class="line"><span>ON</span></span>
<span class="line"><span>	u.id = o.uid;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Áî®Êà∑Âπ¥ÈæÑÂ§ß‰∫é 23 Â≤ÅÁöÑ‰ø°ÊÅØÔºåÊòæÁ§∫Áî®Êà∑ÁöÑÁºñÂè∑„ÄÅÂßìÂêç„ÄÅÂπ¥ÈæÑ„ÄÅËÆ¢ÂçïÁºñÂè∑</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT</span></span>
<span class="line"><span>	u.*,</span></span>
<span class="line"><span>	o.number</span></span>
<span class="line"><span>FROM</span></span>
<span class="line"><span>	USER u,</span></span>
<span class="line"><span>	orderlist o</span></span>
<span class="line"><span>WHERE</span></span>
<span class="line"><span>	u.id = o.uid</span></span>
<span class="line"><span>	AND</span></span>
<span class="line"><span>	u.age &gt; 23;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT</span></span>
<span class="line"><span>	u.*,</span></span>
<span class="line"><span>	o.number</span></span>
<span class="line"><span>FROM</span></span>
<span class="line"><span>	(SELECT * FROM USER WHERE age &gt; 23) u,-- ÂµåÂ•óÊü•ËØ¢</span></span>
<span class="line"><span>	orderlist o</span></span>
<span class="line"><span>WHERE</span></span>
<span class="line"><span>	u.id = o.uid;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Âº†‰∏âÂíåÊùéÂõõÁî®Êà∑ÁöÑ‰ø°ÊÅØÔºåÊòæÁ§∫Áî®Êà∑ÁöÑÁºñÂè∑„ÄÅÂßìÂêç„ÄÅÂπ¥ÈæÑ„ÄÅËÆ¢ÂçïÁºñÂè∑„ÄÇ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT</span></span>
<span class="line"><span>	u.*,</span></span>
<span class="line"><span>	o.number</span></span>
<span class="line"><span>FROM</span></span>
<span class="line"><span>	USER u,</span></span>
<span class="line"><span>	orderlist o</span></span>
<span class="line"><span>WHERE</span></span>
<span class="line"><span>	u.id=o.uid</span></span>
<span class="line"><span>	AND</span></span>
<span class="line"><span>	u.name IN (&#39;Âº†‰∏â&#39;,&#39;ÊùéÂõõ&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢ÊâÄÊúâÁöÑÁî®Êà∑ÂíåËØ•Áî®Êà∑ËÉΩÊü•ÁúãÁöÑÊâÄÊúâÁöÑÂïÜÂìÅÔºåÊòæÁ§∫Áî®Êà∑ÁöÑÁºñÂè∑„ÄÅÂßìÂêç„ÄÅÂπ¥ÈæÑ„ÄÅÂïÜÂìÅÂêçÁß∞</p><p>Êï∞ÊçÆÔºöÁî®Êà∑ÁöÑÁºñÂè∑„ÄÅÂßìÂêç„ÄÅÂπ¥ÈæÑÂú® user Ë°®ÔºåÂïÜÂìÅÂêçÁß∞Âú® product Ë°®Ôºå‰∏≠Èó¥Ë°® us_pro</p><p>Êù°‰ª∂Ôºöus_pro.uid = user.id AND us_pro.pid = product.id</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT</span></span>
<span class="line"><span>	u.id,</span></span>
<span class="line"><span>	u.name,</span></span>
<span class="line"><span>	u.age,</span></span>
<span class="line"><span>	p.name</span></span>
<span class="line"><span>FROM</span></span>
<span class="line"><span>	USER u,</span></span>
<span class="line"><span>	product p,</span></span>
<span class="line"><span>	us_pro up</span></span>
<span class="line"><span>WHERE</span></span>
<span class="line"><span>	up.uid = u.id</span></span>
<span class="line"><span>	AND</span></span>
<span class="line"><span>	up.pid=p.id;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Âº†‰∏âÂíåÊùéÂõõËøô‰∏§‰∏™Áî®Êà∑ÂèØ‰ª•ÁúãÂà∞ÁöÑÂïÜÂìÅÔºåÊòæÁ§∫Áî®Êà∑ÁöÑÁºñÂè∑„ÄÅÂßìÂêç„ÄÅÂπ¥ÈæÑ„ÄÅÂïÜÂìÅÂêçÁß∞„ÄÇ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT</span></span>
<span class="line"><span>	u.id,</span></span>
<span class="line"><span>	u.name,</span></span>
<span class="line"><span>	u.age,</span></span>
<span class="line"><span>	p.name</span></span>
<span class="line"><span>FROM</span></span>
<span class="line"><span>	USER u,</span></span>
<span class="line"><span>	product p,</span></span>
<span class="line"><span>	us_pro up</span></span>
<span class="line"><span>WHERE</span></span>
<span class="line"><span>	up.uid=u.id</span></span>
<span class="line"><span>	AND</span></span>
<span class="line"><span>	up.pid=p.id</span></span>
<span class="line"><span>	AND</span></span>
<span class="line"><span>	u.name IN (&#39;Âº†‰∏â&#39;,&#39;ÊùéÂõõ&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><hr><h2 id="È´òÁ∫ßÁªìÊûÑ" tabindex="-1"><a class="header-anchor" href="#È´òÁ∫ßÁªìÊûÑ"><span>È´òÁ∫ßÁªìÊûÑ</span></a></h2><h3 id="ËßÜÂõæ" tabindex="-1"><a class="header-anchor" href="#ËßÜÂõæ"><span>ËßÜÂõæ</span></a></h3><h4 id="Âü∫Êú¨‰ªãÁªç" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç"><span>Âü∫Êú¨‰ªãÁªç</span></a></h4><p>ËßÜÂõæÊ¶ÇÂøµÔºöËßÜÂõæÊòØ‰∏ÄÁßçËôöÊãüÂ≠òÂú®ÁöÑÊï∞ÊçÆË°®ÔºåËøô‰∏™ËôöÊãüÁöÑË°®Âπ∂‰∏çÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÂÆûÈôÖÂ≠òÂú®</p><p>Êú¨Ë¥®ÔºöÂ∞Ü‰∏ÄÊù° SELECT Êü•ËØ¢ËØ≠Âè•ÁöÑÁªìÊûúÂ∞ÅË£ÖÂà∞‰∫Ü‰∏Ä‰∏™ËôöÊãüË°®‰∏≠ÔºåÊâÄ‰ª•Âú®ÂàõÂª∫ËßÜÂõæÁöÑÊó∂ÂÄôÔºåÂ∑•‰ΩúÈáçÂøÉË¶ÅÊîæÂú®ËøôÊù° SELECT Êü•ËØ¢ËØ≠Âè•‰∏ä</p><p>‰ΩúÁî®ÔºöÂ∞Ü‰∏Ä‰∫õÊØîËæÉÂ§çÊùÇÁöÑÊü•ËØ¢ËØ≠Âè•ÁöÑÁªìÊûúÔºåÂ∞ÅË£ÖÂà∞‰∏Ä‰∏™ËôöÊãüË°®‰∏≠ÔºåÂÜçÊúâÁõ∏ÂêåÊü•ËØ¢ÈúÄÊ±ÇÊó∂ÔºåÁõ¥Êé•Êü•ËØ¢ËØ•ËôöÊãüË°®</p><p>‰ºòÁÇπÔºö</p><ul><li>ÁÆÄÂçïÔºö‰ΩøÁî®ËßÜÂõæÁöÑÁî®Êà∑‰∏çÈúÄË¶ÅÂÖ≥ÂøÉË°®ÁöÑÁªìÊûÑ„ÄÅÂÖ≥ËÅîÊù°‰ª∂ÂíåÁ≠õÈÄâÊù°‰ª∂ÔºåÂõ†‰∏∫ËôöÊãüË°®‰∏≠Â∑≤ÁªèÊòØËøáÊª§Â•ΩÁöÑÁªìÊûúÈõÜ</li><li>ÂÆâÂÖ®Ôºö‰ΩøÁî®ËßÜÂõæÁöÑÁî®Êà∑Âè™ËÉΩËÆøÈóÆÊü•ËØ¢ÁöÑÁªìÊûúÈõÜÔºåÂØπË°®ÁöÑÊùÉÈôêÁÆ°ÁêÜÂπ∂‰∏çËÉΩÈôêÂà∂Âà∞Êüê‰∏™Ë°åÊüê‰∏™Âàó</li><li>Êï∞ÊçÆÁã¨Á´ãÔºå‰∏ÄÊó¶ËßÜÂõæÁöÑÁªìÊûÑÁ°ÆÂÆöÔºåÂèØ‰ª•Â±èËîΩË°®ÁªìÊûÑÂèòÂåñÂØπÁî®Êà∑ÁöÑÂΩ±ÂìçÔºåÊ∫êË°®Â¢ûÂä†ÂàóÂØπËßÜÂõæÊ≤°ÊúâÂΩ±ÂìçÔºõÊ∫êË°®‰øÆÊîπÂàóÂêçÔºåÂàôÂèØ‰ª•ÈÄöËøá‰øÆÊîπËßÜÂõæÊù•Ëß£ÂÜ≥Ôºå‰∏ç‰ºöÈÄ†ÊàêÂØπËÆøÈóÆËÄÖÁöÑÂΩ±Âìç</li></ul><hr><h4 id="ËßÜÂõæÂàõÂª∫" tabindex="-1"><a class="header-anchor" href="#ËßÜÂõæÂàõÂª∫"><span>ËßÜÂõæÂàõÂª∫</span></a></h4><ul><li><p>ÂàõÂª∫ËßÜÂõæ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE [OR REPLACE] </span></span>
<span class="line"><span>VIEW ËßÜÂõæÂêçÁß∞ [(ÂàóÂêçÂàóË°®)] </span></span>
<span class="line"><span>AS Êü•ËØ¢ËØ≠Âè•</span></span>
<span class="line"><span>[WITH [CASCADED | LOCAL] CHECK OPTION];</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Ê≥®Ôºö[OR REPLACE] ÊòØÊõøÊç¢ÁöÑÊÑèÊÄù</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>WITH [CASCADED | LOCAL] CHECK OPTION</code> ÂÜ≥ÂÆö‰∫ÜÊòØÂê¶ÂÖÅËÆ∏Êõ¥Êñ∞Êï∞ÊçÆ‰ΩøËÆ∞ÂΩï‰∏çÂÜçÊª°Ë∂≥ËßÜÂõæÁöÑÊù°‰ª∂Ôºö</p><ul><li><p>LOCALÔºàÊú¨Âú∞ÔºâÔºöÂè™Ë¶ÅÊª°Ë∂≥Êú¨ËßÜÂõæÁöÑÊù°‰ª∂Â∞±ÂèØ‰ª•Êõ¥Êñ∞ÔºåÊØîÂ¶ÇÔºåv2ËßÜÂõæÊòØÂü∫‰∫év1ËßÜÂõæÁöÑÔºåÂ¶ÇÊûúÂú®v2ËßÜÂõæÂàõÂª∫ÁöÑÊó∂ÂÄôÊåáÂÆö‰∫ÜÊ£ÄÊü•ÈÄâÈ°π‰∏∫ local Ôºå‰ΩÜÊòØv1ËßÜÂõæÂàõ Âª∫Êó∂Êú™ÊåáÂÆöÊ£ÄÊü•ÈÄâÈ°π„ÄÇ ÂàôÂú®ÊâßË°åÊ£ÄÊü•Êó∂ÔºåÂè™‰ºöÊ£ÄÊü•v2Ôºå‰∏ç‰ºöÊ£ÄÊü•v2ÁöÑÂÖ≥ËÅîËßÜÂõæv1„ÄÇ<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687067490344.png" alt="1687067490344" loading="lazy"></p></li><li><p>CASCADEDÔºàÁ∫ßËÅîÔºâÔºöÂøÖÈ°ªÊª°Ë∂≥ÊâÄÊúâÈíàÂØπËØ•ËßÜÂõæÁöÑÊâÄÊúâËßÜÂõæÁöÑÊù°‰ª∂ÊâçÂèØ‰ª•Êõ¥Êñ∞Ôºå ÈªòËÆ§ÂÄºÔºåÊØîÂ¶ÇÔºåv2ËßÜÂõæÊòØÂü∫‰∫év1ËßÜÂõæÁöÑÔºåÂ¶ÇÊûúÂú®v2ËßÜÂõæÂàõÂª∫ÁöÑÊó∂ÂÄôÊåáÂÆö‰∫ÜÊ£ÄÊü•ÈÄâÈ°π‰∏∫ cascadedÔºå‰ΩÜÊòØv1ËßÜÂõæ ÂàõÂª∫Êó∂Êú™ÊåáÂÆöÊ£ÄÊü•ÈÄâÈ°π„ÄÇ ÂàôÂú®ÊâßË°åÊ£ÄÊü•Êó∂Ôºå‰∏ç‰ªÖ‰ºöÊ£ÄÊü•v2ÔºåËøò‰ºöÁ∫ßËÅîÊ£ÄÊü•v2ÁöÑÂÖ≥ËÅîËßÜÂõæv1„ÄÇ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687067452908.png" alt="1687067452908" tabindex="0" loading="lazy"><figcaption>1687067452908</figcaption></figure></li></ul></li><li><p>‰æãÂ¶Ç</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Êï∞ÊçÆÂáÜÂ§á city</span></span>
<span class="line"><span>id	NAME	cid</span></span>
<span class="line"><span>1	Ê∑±Âú≥	 	1</span></span>
<span class="line"><span>2	‰∏äÊµ∑		1</span></span>
<span class="line"><span>3	Á∫ΩÁ∫¶		2</span></span>
<span class="line"><span>4	Ëé´ÊñØÁßë	    3</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êï∞ÊçÆÂáÜÂ§á country</span></span>
<span class="line"><span>id	NAME</span></span>
<span class="line"><span>1	‰∏≠ÂõΩ</span></span>
<span class="line"><span>2	ÁæéÂõΩ</span></span>
<span class="line"><span>3	‰øÑÁΩóÊñØ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂàõÂª∫city_countryËßÜÂõæÔºå‰øùÂ≠òÂüéÂ∏ÇÂíåÂõΩÂÆ∂ÁöÑ‰ø°ÊÅØ(‰ΩøÁî®ÊåáÂÆöÂàóÂêç)</span></span>
<span class="line"><span>CREATE </span></span>
<span class="line"><span>VIEW </span></span>
<span class="line"><span>	city_country (city_id,city_name,country_name)</span></span>
<span class="line"><span>AS</span></span>
<span class="line"><span>    SELECT</span></span>
<span class="line"><span>        c1.id,</span></span>
<span class="line"><span>        c1.name,</span></span>
<span class="line"><span>        c2.name</span></span>
<span class="line"><span>    FROM</span></span>
<span class="line"><span>        city c1,</span></span>
<span class="line"><span>        country c2</span></span>
<span class="line"><span>    WHERE</span></span>
<span class="line"><span>        c1.cid=c2.id;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ê≥®ÔºöËßÜÂõæÈªòËÆ§‰∏ç‰ºöÂä†ÂâçÈù¢ÁöÑË°®ÂêçÔºåÊúÄÂ•ΩÂèñ‰∏™Âà´ÂêçÈò≤Ê≠¢Êä•Èîô</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢ËßÜÂõæ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM ËßÜÂõæÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Êüê‰∏™ËßÜÂõæÂàõÂª∫</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW CREATE VIEW ËßÜÂõæÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><hr><h4 id="ËßÜÂõæ‰øÆÊîπ" tabindex="-1"><a class="header-anchor" href="#ËßÜÂõæ‰øÆÊîπ"><span>ËßÜÂõæ‰øÆÊîπ</span></a></h4><p>ËßÜÂõæË°®Êï∞ÊçÆ‰øÆÊîπÔºå‰ºö<strong>Ëá™Âä®‰øÆÊîπÊ∫êË°®‰∏≠ÁöÑÊï∞ÊçÆ</strong>ÔºåÂõ†‰∏∫Êõ¥Êñ∞ÁöÑÊòØËßÜÂõæ‰∏≠ÁöÑÂü∫Ë°®‰∏≠ÁöÑÊï∞ÊçÆ</p><ul><li><p>‰øÆÊîπËßÜÂõæË°®‰∏≠ÁöÑÊï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>UPDATE ËßÜÂõæÂêçÁß∞ SET ÂàóÂêç = ÂÄº WHERE Êù°‰ª∂;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰øÆÊîπËßÜÂõæÁöÑÁªìÊûÑ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]</span></span>
<span class="line"><span>VIEW ËßÜÂõæÂêçÁß∞ [(ÂàóÂêçÂàóË°®)] </span></span>
<span class="line"><span>AS Êü•ËØ¢ËØ≠Âè•</span></span>
<span class="line"><span>[WITH [CASCADED | LOCAL] CHECK OPTION]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Â∞ÜËßÜÂõæ‰∏≠ÁöÑcountry_name‰øÆÊîπ‰∏∫name</span></span>
<span class="line"><span>ALTER </span></span>
<span class="line"><span>VIEW </span></span>
<span class="line"><span>	city_country (city_id,city_name,name) </span></span>
<span class="line"><span>AS</span></span>
<span class="line"><span>    SELECT</span></span>
<span class="line"><span>        c1.id,</span></span>
<span class="line"><span>        c1.name,</span></span>
<span class="line"><span>        c2.name</span></span>
<span class="line"><span>    FROM</span></span>
<span class="line"><span>        city c1,</span></span>
<span class="line"><span>        country c2</span></span>
<span class="line"><span>    WHERE</span></span>
<span class="line"><span>        c1.cid=c2.id;</span></span>
<span class="line"><span>-- Ê≥®ÔºöËßÜÂõæÊúÄÂ•ΩÁªôË°®ÂèñÂà´ÂêçÔºåÂõ†‰∏∫ËßÜÂõæÂè™‰ºöËÆ∞ÂΩïÂ±ûÊÄßÂêçÔºåÂÆπÊòìÊä•Èîô</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="ËßÜÂõæÂà†Èô§" tabindex="-1"><a class="header-anchor" href="#ËßÜÂõæÂà†Èô§"><span>ËßÜÂõæÂà†Èô§</span></a></h4><ul><li><p>Âà†Èô§ËßÜÂõæ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP VIEW ËßÜÂõæÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Â¶ÇÊûúÂ≠òÂú®ÂàôÂà†Èô§</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP VIEW IF EXISTS ËßÜÂõæÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="ËßÜÂõæÊõ¥Êñ∞" tabindex="-1"><a class="header-anchor" href="#ËßÜÂõæÊõ¥Êñ∞"><span>ËßÜÂõæÊõ¥Êñ∞</span></a></h4><p>Ë¶Å‰ΩøËßÜÂõæÂèØÊõ¥Êñ∞ÔºåËßÜÂõæ‰∏≠ÁöÑË°å‰∏éÂü∫Á°ÄË°®‰∏≠ÁöÑË°å‰πãÈó¥ÂøÖÈ°ªÂ≠òÂú®‰∏ÄÂØπ‰∏ÄÁöÑÂÖ≥Á≥ª„ÄÇÂ¶ÇÊûúËßÜÂõæÂåÖÂê´‰ª•‰∏ã‰ªª‰Ωï‰∏Ä È°πÔºåÂàôËØ•ËßÜÂõæ‰∏çÂèØÊõ¥Êñ∞Ôºö A. ËÅöÂêàÂáΩÊï∞ÊàñÁ™óÂè£ÂáΩÊï∞ÔºàSUM()„ÄÅ MIN()„ÄÅ MAX()„ÄÅ COUNT()Á≠âÔºâ B. DISTINCT C. GROUP BY D. HAVING E. UNION ÊàñËÄÖ UNION ALL Á§∫‰æãÊºîÁ§∫:</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>create view stu_v_count as select count(*) from student;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>‰∏äËø∞ÁöÑËßÜÂõæ‰∏≠ÔºåÂ∞±Âè™Êúâ‰∏Ä‰∏™ÂçïË°åÂçïÂàóÁöÑÊï∞ÊçÆÔºåÂ¶ÇÊûúÊàë‰ª¨ÂØπËøô‰∏™ËßÜÂõæËøõË°åÊõ¥Êñ∞ÊàñÊèíÂÖ•ÁöÑÔºåÂ∞Ü‰ºöÊä•Èîô„ÄÇ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>insert into stu_v_count values(10);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687068663823.png" alt="1687068663823" tabindex="0" loading="lazy"><figcaption>1687068663823</figcaption></figure><p>‰∏äËø∞ÁöÑËßÜÂõæ‰∏≠ÔºåÂ∞±Âè™Êúâ‰∏Ä‰∏™ÂçïË°åÂçïÂàóÁöÑÊï∞ÊçÆÔºåÂ¶ÇÊûúÊàë‰ª¨ÂØπËøô‰∏™ËßÜÂõæËøõË°åÊõ¥Êñ∞ÊàñÊèíÂÖ•ÁöÑÔºåÂ∞Ü‰ºöÊä•Èîô„ÄÇ insert into stu_v_count values(10);</p><hr><h3 id="Â≠òÂÇ®ËøáÁ®ã" tabindex="-1"><a class="header-anchor" href="#Â≠òÂÇ®ËøáÁ®ã"><span>Â≠òÂÇ®ËøáÁ®ã</span></a></h3><h4 id="Âü∫Êú¨‰ªãÁªç-1" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-1"><span>Âü∫Êú¨‰ªãÁªç</span></a></h4><p>Â≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞ÔºöÂ≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞ÊòØ‰∫ãÂÖàÁªèËøáÁºñËØëÂπ∂Â≠òÂÇ®Âú®Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑ‰∏ÄÊÆµ SQL ËØ≠Âè•ÁöÑÈõÜÂêà</p><p>Â≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞ÁöÑÂ•ΩÂ§ÑÔºö</p><ul><li>ÊèêÈ´ò‰ª£Á†ÅÁöÑÂ§çÁî®ÊÄß</li><li>ÂáèÂ∞ëÊï∞ÊçÆÂú®Êï∞ÊçÆÂ∫ìÂíåÂ∫îÁî®ÊúçÂä°Âô®‰πãÈó¥ÁöÑ‰º†ËæìÔºåÊèêÈ´ò‰º†ËæìÊïàÁéá</li><li>ÂáèÂ∞ë‰ª£Á†ÅÂ±ÇÈù¢ÁöÑ‰∏öÂä°Â§ÑÁêÜ</li><li><strong>‰∏ÄÊ¨°ÁºñËØëÊ∞∏‰πÖÊúâÊïà</strong></li></ul><p>Â≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞ÁöÑÂå∫Âà´Ôºö</p><ul><li>Â≠òÂÇ®ÂáΩÊï∞ÂøÖÈ°ªÊúâËøîÂõûÂÄº</li><li>Â≠òÂÇ®ËøáÁ®ãÂèØ‰ª•Ê≤°ÊúâËøîÂõûÂÄº</li></ul><hr><h4 id="Âü∫Êú¨Êìç‰Ωú" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨Êìç‰Ωú"><span>Âü∫Êú¨Êìç‰Ωú</span></a></h4><p>DELIMITERÔºö</p><ul><li><p>DELIMITER ÂÖ≥ÈîÆÂ≠óÁî®Êù•Â£∞Êòé sql ËØ≠Âè•ÁöÑÂàÜÈöîÁ¨¶ÔºåÂëäËØâ MySQL ËØ•ÊÆµÂëΩ‰ª§Â∑≤ÁªèÁªìÊùü</p></li><li><p>MySQL ËØ≠Âè•ÈªòËÆ§ÁöÑÂàÜÈöîÁ¨¶ÊòØÂàÜÂè∑Ôºå‰ΩÜÊòØÊúâÊó∂ÈúÄË¶Å‰∏ÄÊù°ÂäüËÉΩ sql ËØ≠Âè•‰∏≠ÂåÖÂê´ÂàÜÂè∑Ôºå‰ΩÜÊòØÂπ∂‰∏ç‰Ωú‰∏∫ÁªìÊùüÊ†áËØÜÔºåËøôÊó∂‰ΩøÁî® DELIMITER Êù•ÊåáÂÆöÂàÜÈöîÁ¨¶Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER ÂàÜÈöîÁ¨¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>Â≠òÂÇ®ËøáÁ®ãÁöÑÂàõÂª∫Ë∞ÉÁî®Êü•ÁúãÂíåÂà†Èô§Ôºö</p><ul><li><p>ÂàõÂª∫Â≠òÂÇ®ËøáÁ®ã</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ‰øÆÊîπÂàÜÈöîÁ¨¶‰∏∫$</span></span>
<span class="line"><span>DELIMITER $</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ê†áÂáÜËØ≠Ê≥ï</span></span>
<span class="line"><span>CREATE PROCEDURE Â≠òÂÇ®ËøáÁ®ãÂêçÁß∞(ÂèÇÊï∞...)</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	sqlËØ≠Âè•;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ‰øÆÊîπÂàÜÈöîÁ¨¶‰∏∫ÂàÜÂè∑</span></span>
<span class="line"><span>DELIMITER ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Ë∞ÉÁî®Â≠òÂÇ®ËøáÁ®ã</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CALL Â≠òÂÇ®ËøáÁ®ãÂêçÁß∞(ÂÆûÈôÖÂèÇÊï∞);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ÁúãÂ≠òÂÇ®ËøáÁ®ã</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM mysql.proc WHERE db=&#39;Êï∞ÊçÆÂ∫ìÂêçÁß∞&#39;;</span></span>
<span class="line"><span>SELECT * FROM INFORMATION_SCHEMA.ROUTINES WHERE ROUTINE_SCHEMA = &#39;xxx&#39;;  -- Êü•ËØ¢Êåá</span></span>
<span class="line"><span>ÂÆöÊï∞ÊçÆÂ∫ìÁöÑÂ≠òÂÇ®ËøáÁ®ãÂèäÁä∂ÊÄÅ‰ø°ÊÅØ</span></span>
<span class="line"><span>SHOW  CREATE  PROCEDURE   Â≠òÂÇ®ËøáÁ®ãÂêçÁß∞ ;  -- Êü•ËØ¢Êüê‰∏™Â≠òÂÇ®ËøáÁ®ãÁöÑÂÆö‰πâ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Âà†Èô§Â≠òÂÇ®ËøáÁ®ã</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP PROCEDURE [IF EXISTS] Â≠òÂÇ®ËøáÁ®ãÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>ÁªÉ‰π†Ôºö</p><ul><li><p>Êï∞ÊçÆÂáÜÂ§á</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>id	NAME	age		gender	score</span></span>
<span class="line"><span>1	Âº†‰∏â		23		Áî∑		95</span></span>
<span class="line"><span>2	ÊùéÂõõ		24		Áî∑		98</span></span>
<span class="line"><span>3	Áéã‰∫î		25		Â•≥		100</span></span>
<span class="line"><span>4	ËµµÂÖ≠		26		Â•≥		90</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂàõÂª∫ stu_group() Â≠òÂÇ®ËøáÁ®ãÔºåÂ∞ÅË£ÖÂàÜÁªÑÊü•ËØ¢ÊÄªÊàêÁª©ÔºåÂπ∂ÊåâÁÖßÊÄªÊàêÁª©ÂçáÂ∫èÊéíÂ∫èÁöÑÂäüËÉΩ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE PROCEDURE stu_group()</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	SELECT gender,SUM(score) getSum FROM student GROUP BY gender ORDER BY getSum ASC; </span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ë∞ÉÁî®Â≠òÂÇ®ËøáÁ®ã</span></span>
<span class="line"><span>CALL stu_group();</span></span>
<span class="line"><span>-- Âà†Èô§Â≠òÂÇ®ËøáÁ®ã</span></span>
<span class="line"><span>DROP PROCEDURE IF EXISTS stu_group;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="Â≠òÂÇ®ËØ≠Ê≥ï" tabindex="-1"><a class="header-anchor" href="#Â≠òÂÇ®ËØ≠Ê≥ï"><span>Â≠òÂÇ®ËØ≠Ê≥ï</span></a></h4><h5 id="ÂèòÈáè" tabindex="-1"><a class="header-anchor" href="#ÂèòÈáè"><span>ÂèòÈáè</span></a></h5><p>Âú®MySQL‰∏≠ÂèòÈáèÂàÜ‰∏∫‰∏âÁßçÁ±ªÂûã: Á≥ªÁªüÂèòÈáè„ÄÅÁî®Êà∑ÂÆö‰πâÂèòÈáè„ÄÅÂ±ÄÈÉ®ÂèòÈáè„ÄÇ</p><p>‚Äã Á≥ªÁªüÂèòÈáèÔºö Á≥ªÁªüÂèòÈáè ÊòØMySQLÊúçÂä°Âô®Êèê‰æõÔºå‰∏çÊòØÁî®Êà∑ÂÆö‰πâÁöÑÔºåÂ±û‰∫éÊúçÂä°Âô®Â±ÇÈù¢„ÄÇÂàÜ‰∏∫ÂÖ®Â±ÄÂèòÈáèÔºàGLOBALÔºâ„ÄÅ‰ºöËØù ÂèòÈáèÔºàSESSIONÔºâ„ÄÇ Êü•ÁúãÁ≥ªÁªüÂèòÈáè</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW [ SESSION | GLOBAL ] VARIABLES ; -- Êü•ÁúãÊâÄÊúâÁ≥ªÁªüÂèòÈáè</span></span>
<span class="line"><span>SHOW [ SESSION | GLOBAL ] VARIABLES LIKE &#39;......&#39;; -- ÂèØ‰ª•ÈÄöËøáLIKEÊ®°Á≥äÂåπÈÖçÊñπ</span></span>
<span class="line"><span>ÂºèÊü•ÊâæÂèòÈáè</span></span>
<span class="line"><span>SELECT @@[SESSION | GLOBAL] Á≥ªÁªüÂèòÈáèÂêç; -- Êü•ÁúãÊåáÂÆöÂèòÈáèÁöÑÂÄº</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ËÆæÁΩÆÁ≥ªÁªüÂèòÈáè</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET [ SESSION | GLOBAL ] Á≥ªÁªüÂèòÈáèÂêç = ÂÄº ;</span></span>
<span class="line"><span>SET @@[SESSION | GLOBAL]Á≥ªÁªüÂèòÈáèÂêç = ÂÄº ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Ê≥®ÊÑè:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Â¶ÇÊûúÊ≤°ÊúâÊåáÂÆöSESSION/GLOBALÔºåÈªòËÆ§ÊòØSESSIONÔºå‰ºöËØùÂèòÈáè„ÄÇ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>mysqlÊúçÂä°ÈáçÊñ∞ÂêØÂä®‰πãÂêéÔºåÊâÄËÆæÁΩÆÁöÑÂÖ®Â±ÄÂèÇÊï∞‰ºöÂ§±ÊïàÔºåË¶ÅÊÉ≥‰∏çÂ§±ÊïàÔºåÂèØ‰ª•Âú® /etc/my.cnf ‰∏≠ÈÖçÁΩÆ„ÄÇ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>A. ÂÖ®Â±ÄÂèòÈáè(GLOBAL): ÂÖ®Â±ÄÂèòÈáèÈíàÂØπ‰∫éÊâÄÊúâÁöÑ‰ºöËØù„ÄÇ B. ‰ºöËØùÂèòÈáè(SESSION): ‰ºöËØùÂèòÈáèÈíàÂØπ‰∫éÂçï‰∏™‰ºöËØùÔºåÂú®Âè¶Â§ñ‰∏Ä‰∏™‰ºöËØùÁ™óÂè£Â∞±‰∏çÁîüÊïà‰∫Ü„ÄÇ</p><p>ÊºîÁ§∫Á§∫‰æã:</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Êü•ÁúãÁ≥ªÁªüÂèòÈáè</span></span>
<span class="line"><span>show session variables ;</span></span>
<span class="line"><span>show session variables like &#39;auto%&#39;;</span></span>
<span class="line"><span>show global variables like &#39;auto%&#39;;</span></span>
<span class="line"><span>select @@global.autocommit;</span></span>
<span class="line"><span>select @@session.autocommit;</span></span>
<span class="line"><span>-- ËÆæÁΩÆÁ≥ªÁªüÂèòÈáè</span></span>
<span class="line"><span>set session autocommit = 1;</span></span>
<span class="line"><span>insert into course(id, name) VALUES (6, &#39;ES&#39;);</span></span>
<span class="line"><span>set global autocommit = 0;</span></span>
<span class="line"><span>select @@global.autocommit;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Áî®Êà∑ÂÆö‰πâÂèòÈáè</strong></p><p>Áî®Êà∑ÂÆö‰πâÂèòÈáè ÊòØÁî®Êà∑Ê†πÊçÆÈúÄË¶ÅËá™Â∑±ÂÆö‰πâÁöÑÂèòÈáèÔºåÁî®Êà∑ÂèòÈáè‰∏çÁî®ÊèêÂâçÂ£∞ÊòéÔºåÂú®Áî®ÁöÑÊó∂ÂÄôÁõ¥Êé•Áî® &quot;@ÂèòÈáè Âêç&quot; ‰ΩøÁî®Â∞±ÂèØ‰ª•„ÄÇÂÖ∂‰ΩúÁî®Âüü‰∏∫ÂΩìÂâçËøûÊé•„ÄÇ</p><p>ËµãÂÄº</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÊñπÂºè‰∏ÄÔºö</span></span>
<span class="line"><span>SET @var_name = expr [, @var_name = expr] ... ;</span></span>
<span class="line"><span>SET @var_name := expr [, @var_name := expr] ... ;</span></span>
<span class="line"><span>-- ÊñπÂºè‰∫åÔºö</span></span>
<span class="line"><span>SELECT @var_name := expr [, @var_name := expr] ... ;</span></span>
<span class="line"><span>SELECT Â≠óÊÆµÂêç INTO @var_name FROM Ë°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>‰ΩøÁî®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT @var_name ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Ê≥®ÊÑè: Áî®Êà∑ÂÆö‰πâÁöÑÂèòÈáèÊó†ÈúÄÂØπÂÖ∂ËøõË°åÂ£∞ÊòéÊàñÂàùÂßãÂåñÔºåÂè™‰∏çËøáËé∑ÂèñÂà∞ÁöÑÂÄº‰∏∫NULL„ÄÇ</p><p>ÊºîÁ§∫Á§∫‰æã:</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ËµãÂÄº</span></span>
<span class="line"><span>set @myname = &#39;itcast&#39;;</span></span>
<span class="line"><span>set @myage := 10;</span></span>
<span class="line"><span>set @mygender := &#39;Áî∑&#39;,@myhobby := &#39;java&#39;;</span></span>
<span class="line"><span>select @mycolor := &#39;red&#39;;</span></span>
<span class="line"><span>select count(*) into @mycount from tb_user;</span></span>
<span class="line"><span>-- ‰ΩøÁî®</span></span>
<span class="line"><span>select @myname,@myage,@mygender,@myhobby;</span></span>
<span class="line"><span>select @mycolor , @mycount;</span></span>
<span class="line"><span>select @abc;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Â±ÄÈÉ®ÂèòÈáèÔºö</p><p>Â±ÄÈÉ®ÂèòÈáè ÊòØÊ†πÊçÆÈúÄË¶ÅÂÆö‰πâÁöÑÂú®Â±ÄÈÉ®ÁîüÊïàÁöÑÂèòÈáèÔºåËÆøÈóÆ‰πãÂâçÔºåÈúÄË¶ÅDECLAREÂ£∞Êòé„ÄÇÂèØÁî®‰ΩúÂ≠òÂÇ®ËøáÁ®ãÂÜÖÁöÑ Â±ÄÈÉ®ÂèòÈáèÂíåËæìÂÖ•ÂèÇÊï∞Ôºå<strong>Â±ÄÈÉ®ÂèòÈáèÁöÑËåÉÂõ¥ÊòØÂú®ÂÖ∂ÂÜÖÂ£∞ÊòéÁöÑBEGIN ... ENDÂùó</strong>„ÄÇ</p><p>Â£∞Êòé</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DECLARE ÂèòÈáèÂêç ÂèòÈáèÁ±ªÂûã [DEFAULT ... ] ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ÂèòÈáèÁ±ªÂûãÂ∞±ÊòØÊï∞ÊçÆÂ∫ìÂ≠óÊÆµÁ±ªÂûãÔºöINT„ÄÅBIGINT„ÄÅCHAR„ÄÅVARCHAR„ÄÅDATE„ÄÅTIMEÁ≠â„ÄÇ</p><p>ËµãÂÄº</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET ÂèòÈáèÂêç = ÂÄº ;</span></span>
<span class="line"><span>SET ÂèòÈáèÂêç := ÂÄº ;</span></span>
<span class="line"><span>SELECT Â≠óÊÆµÂêç INTO ÂèòÈáèÂêç FROM Ë°®Âêç ... ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ÊºîÁ§∫Á§∫‰æã:</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Â£∞ÊòéÂ±ÄÈÉ®ÂèòÈáè - declare</span></span>
<span class="line"><span>-- ËµãÂÄº</span></span>
<span class="line"><span>create procedure p2()</span></span>
<span class="line"><span>begin</span></span>
<span class="line"><span>declare stu_count int default 0;</span></span>
<span class="line"><span>select count(*) into stu_count from student;</span></span>
<span class="line"><span>select stu_count;</span></span>
<span class="line"><span>end;</span></span>
<span class="line"><span>call p2();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h5 id="ifËØ≠Âè•" tabindex="-1"><a class="header-anchor" href="#ifËØ≠Âè•"><span>IFËØ≠Âè•</span></a></h5><ul><li><p>if ËØ≠Âè•Ê†áÂáÜËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>IF Âà§Êñ≠Êù°‰ª∂1 THEN ÊâßË°åÁöÑsqlËØ≠Âè•1;</span></span>
<span class="line"><span>[ELSEIF Âà§Êñ≠Êù°‰ª∂2 THEN ÊâßË°åÁöÑsqlËØ≠Âè•2;]</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>[ELSE ÊâßË°åÁöÑsqlËØ≠Âè•n;]</span></span>
<span class="line"><span>END IF;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êï∞ÊçÆÂáÜÂ§áÔºöË°® student</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>id	NAME	age		gender	score</span></span>
<span class="line"><span>1	Âº†‰∏â		23		Áî∑		95</span></span>
<span class="line"><span>2	ÊùéÂõõ		24		Áî∑		98</span></span>
<span class="line"><span>3	Áéã‰∫î		25		Â•≥		100</span></span>
<span class="line"><span>4	ËµµÂÖ≠		26		Â•≥		90</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Ê†πÊçÆÊÄªÊàêÁª©Âà§Êñ≠ÔºöÂÖ®Áè≠ 380 ÂàÜÂèä‰ª•‰∏äÂ≠¶‰π†‰ºòÁßÄ„ÄÅ320 ~ 380 Â≠¶‰π†ËâØÂ•Ω„ÄÅ320 ‰ª•‰∏ãÂ≠¶‰π†‰∏ÄËà¨</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span>CREATE PROCEDURE pro_test4()</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	DECLARE total INT;							-- ÂÆö‰πâÊÄªÂàÜÊï∞ÂèòÈáè</span></span>
<span class="line"><span>	DECLARE description VARCHAR(10);			-- ÂÆö‰πâÂàÜÊï∞ÊèèËø∞ÂèòÈáè</span></span>
<span class="line"><span>	SELECT SUM(score) INTO total FROM student; 	-- ‰∏∫ÊÄªÂàÜÊï∞ÂèòÈáèËµãÂÄº</span></span>
<span class="line"><span>	-- Âà§Êñ≠ÊÄªÂàÜÊï∞</span></span>
<span class="line"><span>	IF total &gt;= 380 THEN</span></span>
<span class="line"><span>		SET description = &#39;Â≠¶‰π†‰ºòÁßÄ&#39;;</span></span>
<span class="line"><span>	ELSEIF total &gt;=320 AND total &lt; 380 THEN</span></span>
<span class="line"><span>		SET description = &#39;Â≠¶‰π†ËâØÂ•Ω&#39;;</span></span>
<span class="line"><span>	ELSE</span></span>
<span class="line"><span>		SET description = &#39;Â≠¶‰π†‰∏ÄËà¨&#39;;</span></span>
<span class="line"><span>	END IF;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span>-- Ë∞ÉÁî®pro_test4Â≠òÂÇ®ËøáÁ®ã</span></span>
<span class="line"><span>CALL pro_test4();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h5 id="ÂèÇÊï∞‰º†ÈÄí" tabindex="-1"><a class="header-anchor" href="#ÂèÇÊï∞‰º†ÈÄí"><span>ÂèÇÊï∞‰º†ÈÄí</span></a></h5><ul><li><p>ÂèÇÊï∞‰º†ÈÄíÁöÑËØ≠Ê≥ï</p><p>INÔºö‰ª£Ë°®ËæìÂÖ•ÂèÇÊï∞ÔºåÈúÄË¶ÅÁî±Ë∞ÉÁî®ËÄÖ‰º†ÈÄíÂÆûÈôÖÊï∞ÊçÆÔºåÈªòËÆ§ÁöÑ OUTÔºö‰ª£Ë°®ËæìÂá∫ÂèÇÊï∞ÔºåËØ•ÂèÇÊï∞ÂèØ‰ª•‰Ωú‰∏∫ËøîÂõûÂÄº INOUTÔºö‰ª£Ë°®Êó¢ÂèØ‰ª•‰Ωú‰∏∫ËæìÂÖ•ÂèÇÊï∞Ôºå‰πüÂèØ‰ª•‰Ωú‰∏∫ËæìÂá∫ÂèÇÊï∞</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ê†áÂáÜËØ≠Ê≥ï</span></span>
<span class="line"><span>CREATE PROCEDURE Â≠òÂÇ®ËøáÁ®ãÂêçÁß∞([IN|OUT|INOUT] ÂèÇÊï∞Âêç Êï∞ÊçÆÁ±ªÂûã)</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	ÊâßË°åÁöÑsqlËØ≠Âè•;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ËæìÂÖ•ÊÄªÊàêÁª©ÂèòÈáèÔºå‰ª£Ë°®Â≠¶ÁîüÊÄªÊàêÁª©ÔºåËæìÂá∫ÂàÜÊï∞ÊèèËø∞ÂèòÈáèÔºå‰ª£Ë°®Â≠¶ÁîüÊÄªÊàêÁª©ÁöÑÊèèËø∞</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE PROCEDURE pro_test6(IN total INT, OUT description VARCHAR(10))</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	-- Âà§Êñ≠ÊÄªÂàÜÊï∞</span></span>
<span class="line"><span>	IF total &gt;= 380 THEN </span></span>
<span class="line"><span>		SET description = &#39;Â≠¶‰π†‰ºòÁßÄ&#39;;</span></span>
<span class="line"><span>	ELSEIF total &gt;= 320 AND total &lt; 380 THEN </span></span>
<span class="line"><span>		SET description = &#39;Â≠¶‰π†‰∏çÈîô&#39;;</span></span>
<span class="line"><span>	ELSE </span></span>
<span class="line"><span>		SET description = &#39;Â≠¶‰π†‰∏ÄËà¨&#39;;</span></span>
<span class="line"><span>	END IF;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span>-- Ë∞ÉÁî®pro_test6Â≠òÂÇ®ËøáÁ®ã</span></span>
<span class="line"><span>CALL pro_test6(310,@description);</span></span>
<span class="line"><span>CALL pro_test6((SELECT SUM(score) FROM student), @description);</span></span>
<span class="line"><span>-- Êü•ËØ¢ÊÄªÊàêÁª©ÊèèËø∞</span></span>
<span class="line"><span>SELECT @description;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ÁúãÂèÇÊï∞ÊñπÊ≥ï</p><ul><li>@ÂèòÈáèÂêç : <strong>Áî®Êà∑‰ºöËØùÂèòÈáè</strong>Ôºå‰ª£Ë°®Êï¥‰∏™‰ºöËØùËøáÁ®ã‰ªñÈÉΩÊòØÊúâ‰ΩúÁî®ÁöÑÔºåÁ±ª‰ºº‰∫éÂÖ®Â±ÄÂèòÈáè</li><li>@@ÂèòÈáèÂêç : <strong>Á≥ªÁªüÂèòÈáè</strong></li></ul></li></ul><hr><h5 id="case" tabindex="-1"><a class="header-anchor" href="#case"><span>CASE</span></a></h5><ul><li><p>Ê†áÂáÜËØ≠Ê≥ï 1</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CASE Ë°®ËææÂºè</span></span>
<span class="line"><span>    WHEN ÂÄº1 THEN ÊâßË°åsqlËØ≠Âè•1;</span></span>
<span class="line"><span>    [WHEN ÂÄº2 THEN ÊâßË°åsqlËØ≠Âè•2;]</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    [ELSE ÊâßË°åsqlËØ≠Âè•n;]</span></span>
<span class="line"><span>END CASE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Ê†áÂáÜËØ≠Ê≥ï 2</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>sCASE</span></span>
<span class="line"><span>    WHEN Âà§Êñ≠Êù°‰ª∂1 THEN ÊâßË°åsqlËØ≠Âè•1;</span></span>
<span class="line"><span>    [WHEN Âà§Êñ≠Êù°‰ª∂2 THEN ÊâßË°åsqlËØ≠Âè•2;]</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    [ELSE ÊâßË°åsqlËØ≠Âè•n;]</span></span>
<span class="line"><span>END CASE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÊºîÁ§∫</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span>CREATE PROCEDURE pro_test7(IN total INT)</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	-- ÂÆö‰πâÂèòÈáè</span></span>
<span class="line"><span>	DECLARE description VARCHAR(10);</span></span>
<span class="line"><span>	-- ‰ΩøÁî®caseÂà§Êñ≠</span></span>
<span class="line"><span>	CASE</span></span>
<span class="line"><span>	WHEN total &gt;= 380 THEN</span></span>
<span class="line"><span>		SET description = &#39;Â≠¶‰π†‰ºòÁßÄ&#39;;</span></span>
<span class="line"><span>	WHEN total &gt;= 320 AND total &lt; 380 THEN</span></span>
<span class="line"><span>		SET description = &#39;Â≠¶‰π†‰∏çÈîô&#39;;</span></span>
<span class="line"><span>	ELSE </span></span>
<span class="line"><span>		SET description = &#39;Â≠¶‰π†‰∏ÄËà¨&#39;;</span></span>
<span class="line"><span>	END CASE;</span></span>
<span class="line"><span>	</span></span>
<span class="line"><span>	-- Êü•ËØ¢ÂàÜÊï∞ÊèèËø∞‰ø°ÊÅØ</span></span>
<span class="line"><span>	SELECT description;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span>-- Ë∞ÉÁî®pro_test7Â≠òÂÇ®ËøáÁ®ã</span></span>
<span class="line"><span>CALL pro_test7(390);</span></span>
<span class="line"><span>CALL pro_test7((SELECT SUM(score) FROM student));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h5 id="while" tabindex="-1"><a class="header-anchor" href="#while"><span>WHILE</span></a></h5><ul><li><p>while Âæ™ÁéØËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>WHILE Êù°‰ª∂Âà§Êñ≠ËØ≠Âè• DO</span></span>
<span class="line"><span>	Âæ™ÁéØ‰ΩìËØ≠Âè•;</span></span>
<span class="line"><span>	Êù°‰ª∂ÊéßÂà∂ËØ≠Âè•;</span></span>
<span class="line"><span>END WHILE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ËÆ°ÁÆó 1~100 ‰πãÈó¥ÁöÑÂÅ∂Êï∞Âíå</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span>CREATE PROCEDURE pro_test6()</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	-- ÂÆö‰πâÊ±ÇÂíåÂèòÈáè</span></span>
<span class="line"><span>	DECLARE result INT DEFAULT 0;</span></span>
<span class="line"><span>	-- ÂÆö‰πâÂàùÂßãÂåñÂèòÈáè</span></span>
<span class="line"><span>	DECLARE num INT DEFAULT 1;</span></span>
<span class="line"><span>	-- whileÂæ™ÁéØ</span></span>
<span class="line"><span>	WHILE num &lt;= 100 DO</span></span>
<span class="line"><span>		IF num % 2 = 0 THEN</span></span>
<span class="line"><span>			SET result = result + num;</span></span>
<span class="line"><span>		END IF;</span></span>
<span class="line"><span>		SET num = num + 1;</span></span>
<span class="line"><span>	END WHILE;</span></span>
<span class="line"><span>	-- Êü•ËØ¢Ê±ÇÂíåÁªìÊûú</span></span>
<span class="line"><span>	SELECT result;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ë∞ÉÁî®pro_test6Â≠òÂÇ®ËøáÁ®ã</span></span>
<span class="line"><span>CALL pro_test6();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h5 id="repeat" tabindex="-1"><a class="header-anchor" href="#repeat"><span>REPEAT</span></a></h5><ul><li><p>repeat Âæ™ÁéØÊ†áÂáÜËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ÂàùÂßãÂåñËØ≠Âè•;</span></span>
<span class="line"><span>REPEAT</span></span>
<span class="line"><span>	Âæ™ÁéØ‰ΩìËØ≠Âè•;</span></span>
<span class="line"><span>	Êù°‰ª∂ÊéßÂà∂ËØ≠Âè•;</span></span>
<span class="line"><span>	UNTIL Êù°‰ª∂Âà§Êñ≠ËØ≠Âè•</span></span>
<span class="line"><span>END REPEAT;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ËÆ°ÁÆó 1~10 ‰πãÈó¥ÁöÑÂíå</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span>CREATE PROCEDURE pro_test9()</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	-- ÂÆö‰πâÊ±ÇÂíåÂèòÈáè</span></span>
<span class="line"><span>	DECLARE result INT DEFAULT 0;</span></span>
<span class="line"><span>	-- ÂÆö‰πâÂàùÂßãÂåñÂèòÈáè</span></span>
<span class="line"><span>	DECLARE num INT DEFAULT 1;</span></span>
<span class="line"><span>	-- repeatÂæ™ÁéØ</span></span>
<span class="line"><span>	REPEAT</span></span>
<span class="line"><span>		-- Á¥ØÂä†</span></span>
<span class="line"><span>		SET result = result + num;</span></span>
<span class="line"><span>		-- ËÆ©num+1</span></span>
<span class="line"><span>		SET num = num + 1;</span></span>
<span class="line"><span>		-- ÂÅúÊ≠¢Âæ™ÁéØ</span></span>
<span class="line"><span>		UNTIL num &gt; 10</span></span>
<span class="line"><span>	END REPEAT;</span></span>
<span class="line"><span>	-- Êü•ËØ¢Ê±ÇÂíåÁªìÊûú</span></span>
<span class="line"><span>	SELECT result;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span>-- Ë∞ÉÁî®pro_test9Â≠òÂÇ®ËøáÁ®ã</span></span>
<span class="line"><span>CALL pro_test9();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h5 id="loop" tabindex="-1"><a class="header-anchor" href="#loop"><span>LOOP</span></a></h5><p>LOOP ÂÆûÁé∞ÁÆÄÂçïÁöÑÂæ™ÁéØÔºåÈÄÄÂá∫Âæ™ÁéØÁöÑÊù°‰ª∂ÈúÄË¶Å‰ΩøÁî®ÂÖ∂‰ªñÁöÑËØ≠Âè•ÂÆö‰πâÔºåÈÄöÂ∏∏ÂèØ‰ª•‰ΩøÁî® LEAVE ËØ≠Âè•ÂÆûÁé∞ÔºåÂ¶ÇÊûú‰∏çÂä†ÈÄÄÂá∫Âæ™ÁéØÁöÑËØ≠Âè•ÔºåÈÇ£‰πàÂ∞±ÂèòÊàê‰∫ÜÊ≠ªÂæ™ÁéØ</p><p>LEAVE ÔºöÈÖçÂêàÂæ™ÁéØ‰ΩøÁî®ÔºåÈÄÄÂá∫Âæ™ÁéØ„ÄÇ ITERATEÔºöÂøÖÈ°ªÁî®Âú®Âæ™ÁéØ‰∏≠Ôºå‰ΩúÁî®ÊòØË∑≥ËøáÂΩìÂâçÂæ™ÁéØÂâ©‰∏ãÁöÑËØ≠Âè•ÔºåÁõ¥Êé•ËøõÂÖ•‰∏ã‰∏ÄÊ¨°Âæ™ÁéØ„ÄÇ</p><ul><li><p>loop Âæ™ÁéØÊ†áÂáÜËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>[Âæ™ÁéØÂêçÁß∞:] LOOP</span></span>
<span class="line"><span>	Êù°‰ª∂Âà§Êñ≠ËØ≠Âè•</span></span>
<span class="line"><span>		[LEAVE Âæ™ÁéØÂêçÁß∞;]</span></span>
<span class="line"><span>	Âæ™ÁéØ‰ΩìËØ≠Âè•;</span></span>
<span class="line"><span>	Êù°‰ª∂ÊéßÂà∂ËØ≠Âè•;</span></span>
<span class="line"><span>END LOOP Âæ™ÁéØÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ËÆ°ÁÆó 1~10 ‰πãÈó¥ÁöÑÂíå</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span>CREATE PROCEDURE pro_test10()</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	-- ÂÆö‰πâÊ±ÇÂíåÂèòÈáè</span></span>
<span class="line"><span>	DECLARE result INT DEFAULT 0;</span></span>
<span class="line"><span>	-- ÂÆö‰πâÂàùÂßãÂåñÂèòÈáè</span></span>
<span class="line"><span>	DECLARE num INT DEFAULT 1;</span></span>
<span class="line"><span>	-- loopÂæ™ÁéØ</span></span>
<span class="line"><span>	l:LOOP</span></span>
<span class="line"><span>		-- Êù°‰ª∂ÊàêÁ´ãÔºåÂÅúÊ≠¢Âæ™ÁéØ</span></span>
<span class="line"><span>		IF num &gt; 10 THEN</span></span>
<span class="line"><span>			LEAVE l;</span></span>
<span class="line"><span>		END IF;</span></span>
<span class="line"><span>		-- Á¥ØÂä†</span></span>
<span class="line"><span>		SET result = result + num;</span></span>
<span class="line"><span>		-- ËÆ©num+1</span></span>
<span class="line"><span>		SET num = num + 1;</span></span>
<span class="line"><span>	END LOOP l;</span></span>
<span class="line"><span>	-- Êü•ËØ¢Ê±ÇÂíåÁªìÊûú</span></span>
<span class="line"><span>	SELECT result;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span>-- Ë∞ÉÁî®pro_test10Â≠òÂÇ®ËøáÁ®ã</span></span>
<span class="line"><span>CALL pro_test10();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h5 id="Ê∏∏Ê†á" tabindex="-1"><a class="header-anchor" href="#Ê∏∏Ê†á"><span>Ê∏∏Ê†á</span></a></h5><p>Ê∏∏Ê†áÊòØÁî®Êù•Â≠òÂÇ®Êü•ËØ¢ÁªìÊûúÈõÜÁöÑÊï∞ÊçÆÁ±ªÂûãÔºåÂú®Â≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞‰∏≠ÂèØ‰ª•‰ΩøÁî®ÂÖâÊ†áÂØπÁªìÊûúÈõÜËøõË°åÂæ™ÁéØÁöÑÂ§ÑÁêÜ</p><ul><li>Ê∏∏Ê†áÂèØ‰ª•ÈÅçÂéÜËøîÂõûÁöÑÂ§öË°åÁªìÊûúÔºåÊØèÊ¨°ÊãøÂà∞‰∏ÄÊï¥Ë°åÊï∞ÊçÆ</li><li>ÁÆÄÂçïÊù•ËØ¥Ê∏∏Ê†áÂ∞±Á±ª‰ºº‰∫éÈõÜÂêàÁöÑËø≠‰ª£Âô®ÈÅçÂéÜ</li><li>MySQL ‰∏≠ÁöÑÊ∏∏Ê†áÂè™ËÉΩÁî®Âú®Â≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞‰∏≠</li></ul><p>Ê∏∏Ê†áÁöÑËØ≠Ê≥ï</p><ul><li><p>ÂàõÂª∫Ê∏∏Ê†á</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DECLARE Ê∏∏Ê†áÂêçÁß∞ CURSOR FOR Êü•ËØ¢sqlËØ≠Âè•;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÊâìÂºÄÊ∏∏Ê†á</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>OPEN Ê∏∏Ê†áÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰ΩøÁî®Ê∏∏Ê†áËé∑ÂèñÊï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>FETCH Ê∏∏Ê†áÂêçÁß∞ INTO ÂèòÈáèÂêç1,ÂèòÈáèÂêç2,...;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂÖ≥Èó≠Ê∏∏Ê†á</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CLOSE Ê∏∏Ê†áÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Mysql ÈÄöËøá‰∏Ä‰∏™ Error handler Â£∞ÊòéÊù•Âà§Êñ≠ÊåáÈíàÊòØÂê¶Âà∞Â∞æÈÉ®ÔºåÂπ∂‰∏îÂøÖÈ°ªÂíåÂàõÂª∫Ê∏∏Ê†áÁöÑ SQL ËØ≠Âè•Â£∞ÊòéÂú®‰∏ÄËµ∑Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DECLARE EXIT HANDLER FOR NOT FOUND (do some actionÔºå‰∏ÄËà¨ÊòØËÆæÁΩÆÊ†áÂøóÂèòÈáè)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>Ê∏∏Ê†áÁöÑÂü∫Êú¨‰ΩøÁî®</p><ul><li><p>Êï∞ÊçÆÂáÜÂ§áÔºöË°® student</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>id	NAME	age		gender	score</span></span>
<span class="line"><span>1	Âº†‰∏â		23		Áî∑		95</span></span>
<span class="line"><span>2	ÊùéÂõõ		24		Áî∑		98</span></span>
<span class="line"><span>3	Áéã‰∫î		25		Â•≥		100</span></span>
<span class="line"><span>4	ËµµÂÖ≠		26		Â•≥		90</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂàõÂª∫ stu_score Ë°®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE stu_score(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,</span></span>
<span class="line"><span>	score INT</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Â∞ÜstudentË°®‰∏≠ÊâÄÊúâÁöÑÊàêÁª©‰øùÂ≠òÂà∞stu_scoreË°®‰∏≠</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE PROCEDURE pro_test12()</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	-- ÂÆö‰πâÊàêÁª©ÂèòÈáè</span></span>
<span class="line"><span>	DECLARE s_score INT;</span></span>
<span class="line"><span>	-- ÂÆö‰πâÊ†áËÆ∞ÂèòÈáè</span></span>
<span class="line"><span>	DECLARE flag INT DEFAULT 0;</span></span>
<span class="line"><span>	</span></span>
<span class="line"><span>	-- ÂàõÂª∫Ê∏∏Ê†áÔºåÊü•ËØ¢ÊâÄÊúâÂ≠¶ÁîüÊàêÁª©Êï∞ÊçÆ</span></span>
<span class="line"><span>	DECLARE stu_result CURSOR FOR SELECT score FROM student;</span></span>
<span class="line"><span>	-- Ê∏∏Ê†áÁªìÊùüÂêéÔºåÂ∞ÜÊ†áËÆ∞ÂèòÈáèÊîπ‰∏∫1  Ëøô‰∏§‰∏™ÂøÖÈ°ªÂ£∞ÊòéÂú®‰∏ÄËµ∑</span></span>
<span class="line"><span>	DECLARE EXIT HAND SET flag = 1;</span></span>
<span class="line"><span>	</span></span>
<span class="line"><span>	-- ÂºÄÂêØÊ∏∏Ê†á</span></span>
<span class="line"><span>	OPEN stu_result;</span></span>
<span class="line"><span>	-- Âæ™ÁéØ‰ΩøÁî®Ê∏∏Ê†á</span></span>
<span class="line"><span>	REPEAT</span></span>
<span class="line"><span>		-- ‰ΩøÁî®Ê∏∏Ê†áÔºåÈÅçÂéÜÁªìÊûú,ÊãøÂà∞Êï∞ÊçÆ</span></span>
<span class="line"><span>		FETCH stu_result INTO s_score;</span></span>
<span class="line"><span>		-- Â∞ÜÊï∞ÊçÆ‰øùÂ≠òÂà∞stu_scoreË°®‰∏≠</span></span>
<span class="line"><span>		INSERT INTO stu_score VALUES (NULL,s_score);</span></span>
<span class="line"><span>	UNTIL flag=1</span></span>
<span class="line"><span>	END REPEAT;</span></span>
<span class="line"><span>	-- ÂÖ≥Èó≠Ê∏∏Ê†á</span></span>
<span class="line"><span>	CLOSE stu_result;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ë∞ÉÁî®pro_test12Â≠òÂÇ®ËøáÁ®ã</span></span>
<span class="line"><span>CALL pro_test12();</span></span>
<span class="line"><span>-- Êü•ËØ¢stu_scoreË°®</span></span>
<span class="line"><span>SELECT * FROM stu_score;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h5 id="Êù°‰ª∂Â§ÑÁêÜÁ®ãÂ∫è" tabindex="-1"><a class="header-anchor" href="#Êù°‰ª∂Â§ÑÁêÜÁ®ãÂ∫è"><span>Êù°‰ª∂Â§ÑÁêÜÁ®ãÂ∫è</span></a></h5><p>Êù°‰ª∂Â§ÑÁêÜÁ®ãÂ∫èÔºàHandlerÔºâÂèØ‰ª•Áî®Êù•ÂÆö‰πâÂú®ÊµÅÁ®ãÊéßÂà∂ÁªìÊûÑÊâßË°åËøáÁ®ã‰∏≠ÈÅáÂà∞ÈóÆÈ¢òÊó∂Áõ∏Â∫îÁöÑÂ§ÑÁêÜÊ≠•È™§„ÄÇÂÖ∑‰Ωì ËØ≠Ê≥ï‰∏∫</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DECLARE handler_action HANDLER FOR condition_value [, condition_value]... statement ;</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>handler_action ÁöÑÂèñÂÄºÔºö</span></span>
<span class="line"><span>	CONTINUE: ÁªßÁª≠ÊâßË°åÂΩìÂâçÁ®ãÂ∫è</span></span>
<span class="line"><span>	EXIT: ÁªàÊ≠¢ÊâßË°åÂΩìÂâçÁ®ãÂ∫è</span></span>
<span class="line"><span>condition_value ÁöÑÂèñÂÄºÔºö</span></span>
<span class="line"><span>	SQLSTATE sqlstate_value: Áä∂ÊÄÅÁ†ÅÔºåÂ¶Ç 02000</span></span>
<span class="line"><span>	SQLWARNING: ÊâÄÊúâ‰ª•01ÂºÄÂ§¥ÁöÑSQLSTATE‰ª£Á†ÅÁöÑÁÆÄÂÜô</span></span>
<span class="line"><span>	NOT FOUND: ÊâÄÊúâ‰ª•02ÂºÄÂ§¥ÁöÑSQLSTATE‰ª£Á†ÅÁöÑÁÆÄÂÜô</span></span>
<span class="line"><span>	SQLEXCEPTION: ÊâÄÊúâÊ≤°ÊúâË¢´SQLWARNING Êàñ NOT FOUNDÊçïËé∑ÁöÑSQLSTATE‰ª£Á†ÅÁöÑÁÆÄÂÜô</span></span>
<span class="line"><span>statementÁöÑÂê´‰πâÔºö</span></span>
<span class="line"><span>	sqlËØ≠Âè•</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="Â≠òÂÇ®ÂáΩÊï∞" tabindex="-1"><a class="header-anchor" href="#Â≠òÂÇ®ÂáΩÊï∞"><span>Â≠òÂÇ®ÂáΩÊï∞</span></a></h3><p>Â≠òÂÇ®ÂáΩÊï∞ÂíåÂ≠òÂÇ®ËøáÁ®ãÊòØÈùûÂ∏∏Áõ∏‰ººÁöÑÔºåÂ≠òÂÇ®ÂáΩÊï∞ÂèØ‰ª•ÂÅöÁöÑ‰∫ãÊÉÖÔºåÂ≠òÂÇ®ËøáÁ®ã‰πüÂèØ‰ª•ÂÅöÂà∞</p><p>Â≠òÂÇ®ÂáΩÊï∞ÊúâËøîÂõûÂÄºÔºåÂ≠òÂÇ®ËøáÁ®ãÊ≤°ÊúâËøîÂõûÂÄºÔºàÂèÇÊï∞ÁöÑ out ÂÖ∂ÂÆû‰πüÁõ∏ÂΩì‰∫éÊòØËøîÂõûÊï∞ÊçÆ‰∫ÜÔºâ</p><ul><li><p>ÂàõÂª∫Â≠òÂÇ®ÂáΩÊï∞</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span>-- Ê†áÂáÜËØ≠Ê≥ï</span></span>
<span class="line"><span>CREATE FUNCTION ÂáΩÊï∞ÂêçÁß∞(ÂèÇÊï∞ Êï∞ÊçÆÁ±ªÂûã)</span></span>
<span class="line"><span>RETURNS type [characteristic...]</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	ÊâßË°åÁöÑsqlËØ≠Âè•;</span></span>
<span class="line"><span>	RETURN ÁªìÊûú;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>characteristicËØ¥ÊòéÔºö</span></span>
<span class="line"><span>	DETERMINISTICÔºöÁõ∏ÂêåÁöÑËæìÂÖ•ÂèÇÊï∞ÊÄªÊòØ‰∫ßÁîüÁõ∏ÂêåÁöÑÁªìÊûú</span></span>
<span class="line"><span>	NO SQL Ôºö‰∏çÂåÖÂê´ SQL ËØ≠Âè•„ÄÇ</span></span>
<span class="line"><span>	READS SQL DATAÔºöÂåÖÂê´ËØªÂèñÊï∞ÊçÆÁöÑËØ≠Âè•Ôºå‰ΩÜ‰∏çÂåÖÂê´ÂÜôÂÖ•Êï∞ÊçÆÁöÑËØ≠Âè•„ÄÇ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Ë∞ÉÁî®Â≠òÂÇ®ÂáΩÊï∞ÔºåÂõ†‰∏∫ÊúâËøîÂõûÂÄºÔºåÊâÄ‰ª•‰ΩøÁî® SELECT Ë∞ÉÁî®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT ÂáΩÊï∞ÂêçÁß∞(ÂÆûÈôÖÂèÇÊï∞);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âà†Èô§Â≠òÂÇ®ÂáΩÊï∞</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP FUNCTION ÂáΩÊï∞ÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂÆö‰πâÂ≠òÂÇ®ÂáΩÊï∞ÔºåËé∑ÂèñÂ≠¶ÁîüË°®‰∏≠ÊàêÁª©Â§ß‰∫é95ÂàÜÁöÑÂ≠¶ÁîüÊï∞Èáè</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span>CREATE FUNCTION fun_test()</span></span>
<span class="line"><span>RETURN INT</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	-- ÂÆö‰πâÁªüËÆ°ÂèòÈáè</span></span>
<span class="line"><span>	DECLARE result INT;</span></span>
<span class="line"><span>	-- Êü•ËØ¢ÊàêÁª©Â§ß‰∫é95ÂàÜÁöÑÂ≠¶ÁîüÊï∞ÈáèÔºåÁªôÁªüËÆ°ÂèòÈáèËµãÂÄº</span></span>
<span class="line"><span>	SELECT COUNT(score) INTO result FROM student WHERE score &gt; 95;</span></span>
<span class="line"><span>	-- ËøîÂõûÁªüËÆ°ÁªìÊûú</span></span>
<span class="line"><span>	SELECT result;</span></span>
<span class="line"><span>END</span></span>
<span class="line"><span>DELIMITER ;</span></span>
<span class="line"><span>-- Ë∞ÉÁî®fun_testÂ≠òÂÇ®ÂáΩÊï∞</span></span>
<span class="line"><span>SELECT fun_test();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h3 id="Ëß¶ÂèëÂô®" tabindex="-1"><a class="header-anchor" href="#Ëß¶ÂèëÂô®"><span>Ëß¶ÂèëÂô®</span></a></h3><h4 id="Âü∫Êú¨‰ªãÁªç-2" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-2"><span>Âü∫Êú¨‰ªãÁªç</span></a></h4><p>Ëß¶ÂèëÂô®ÊòØ‰∏éË°®ÊúâÂÖ≥ÁöÑÊï∞ÊçÆÂ∫ìÂØπË±°ÔºåÂú® insert/update/delete ‰πãÂâçÊàñ‰πãÂêéËß¶ÂèëÂπ∂ÊâßË°åËß¶ÂèëÂô®‰∏≠ÂÆö‰πâÁöÑ SQL ËØ≠Âè•</p><ul><li><p>Ëß¶ÂèëÂô®ÁöÑËøôÁßçÁâπÊÄßÂèØ‰ª•ÂçèÂä©Â∫îÁî®Âú®Êï∞ÊçÆÂ∫ìÁ´ØÁ°Æ‰øùÊï∞ÊçÆÁöÑÂÆåÊï¥ÊÄß „ÄÅÊó•ÂøóËÆ∞ÂΩï „ÄÅÊï∞ÊçÆÊ†°È™åÁ≠âÊìç‰Ωú</p></li><li><p>‰ΩøÁî®Âà´Âêç NEW Âíå OLD Êù•ÂºïÁî®Ëß¶ÂèëÂô®‰∏≠ÂèëÁîüÂèòÂåñÁöÑËÆ∞ÂΩïÂÜÖÂÆπÔºåËøô‰∏éÂÖ∂‰ªñÁöÑÊï∞ÊçÆÂ∫ìÊòØÁõ∏‰ººÁöÑ</p></li><li><p>Áé∞Âú®Ëß¶ÂèëÂô®ËøòÂè™ÊîØÊåÅË°åÁ∫ßËß¶ÂèëÔºå‰∏çÊîØÊåÅËØ≠Âè•Á∫ßËß¶Âèë</p></li></ul><table><thead><tr><th>Ëß¶ÂèëÂô®Á±ªÂûã</th><th>OLDÁöÑÂê´‰πâ</th><th>NEWÁöÑÂê´‰πâ</th></tr></thead><tbody><tr><td>INSERT ÂûãËß¶ÂèëÂô®</td><td>Êó† (Âõ†‰∏∫ÊèíÂÖ•ÂâçÁä∂ÊÄÅÊó†Êï∞ÊçÆ)</td><td>NEW Ë°®Á§∫Â∞ÜË¶ÅÊàñËÄÖÂ∑≤ÁªèÊñ∞Â¢ûÁöÑÊï∞ÊçÆ</td></tr><tr><td>UPDATE ÂûãËß¶ÂèëÂô®</td><td>OLD Ë°®Á§∫‰øÆÊîπ‰πãÂâçÁöÑÊï∞ÊçÆ</td><td>NEW Ë°®Á§∫Â∞ÜË¶ÅÊàñÂ∑≤Áªè‰øÆÊîπÂêéÁöÑÊï∞ÊçÆ</td></tr><tr><td>DELETE ÂûãËß¶ÂèëÂô®</td><td>OLD Ë°®Á§∫Â∞ÜË¶ÅÊàñËÄÖÂ∑≤ÁªèÂà†Èô§ÁöÑÊï∞ÊçÆ</td><td>Êó† (Âõ†‰∏∫Âà†Èô§ÂêéÁä∂ÊÄÅÊó†Êï∞ÊçÆ)</td></tr></tbody></table><hr><h4 id="Âü∫Êú¨Êìç‰Ωú-1" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨Êìç‰Ωú-1"><span>Âü∫Êú¨Êìç‰Ωú</span></a></h4><ul><li><p>ÂàõÂª∫Ëß¶ÂèëÂô®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE TRIGGER Ëß¶ÂèëÂô®ÂêçÁß∞</span></span>
<span class="line"><span>BEFORE|AFTER  INSERT|UPDATE|DELETE</span></span>
<span class="line"><span>ON Ë°®Âêç</span></span>
<span class="line"><span>[FOR EACH ROW]  -- Ë°åÁ∫ßËß¶ÂèëÂô®</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	Ëß¶ÂèëÂô®Ë¶ÅÊâßË°åÁöÑÂäüËÉΩ;</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ÁúãËß¶ÂèëÂô®ÁöÑÁä∂ÊÄÅ„ÄÅËØ≠Ê≥ïÁ≠â‰ø°ÊÅØ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW TRIGGERS;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Âà†Èô§Ëß¶ÂèëÂô®ÔºåÂ¶ÇÊûúÊ≤°ÊúâÊåáÂÆö schema_nameÔºåÈªòËÆ§‰∏∫ÂΩìÂâçÊï∞ÊçÆÂ∫ì</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP TRIGGER [schema_name.]trigger_name;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><hr><h4 id="Ëß¶ÂèëÊºîÁ§∫" tabindex="-1"><a class="header-anchor" href="#Ëß¶ÂèëÊºîÁ§∫"><span>Ëß¶ÂèëÊºîÁ§∫</span></a></h4><p>ÈÄöËøáËß¶ÂèëÂô®ËÆ∞ÂΩïË¥¶Êà∑Ë°®ÁöÑÊï∞ÊçÆÂèòÊõ¥Êó•Âøó„ÄÇÂåÖÂê´ÔºöÂ¢ûÂä†„ÄÅ‰øÆÊîπ„ÄÅÂà†Èô§</p><ul><li><p>Êï∞ÊçÆÂáÜÂ§á</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫db9Êï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span>CREATE DATABASE db9;</span></span>
<span class="line"><span>-- ‰ΩøÁî®db9Êï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span>USE db9;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫Ë¥¶Êà∑Ë°®account</span></span>
<span class="line"><span>CREATE TABLE account(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- Ë¥¶Êà∑id</span></span>
<span class="line"><span>	NAME VARCHAR(20),					-- ÂßìÂêç</span></span>
<span class="line"><span>	money DOUBLE						-- ‰ΩôÈ¢ù</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO account VALUES (NULL,&#39;Âº†‰∏â&#39;,1000),(NULL,&#39;ÊùéÂõõ&#39;,2000);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫Êó•ÂøóË°®account_log</span></span>
<span class="line"><span>CREATE TABLE account_log(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,	-- Êó•Âøóid</span></span>
<span class="line"><span>	operation VARCHAR(20),				-- Êìç‰ΩúÁ±ªÂûã (insert update delete)</span></span>
<span class="line"><span>	operation_time DATETIME,			-- Êìç‰ΩúÊó∂Èó¥</span></span>
<span class="line"><span>	operation_id INT,					-- Êìç‰ΩúË°®ÁöÑid</span></span>
<span class="line"><span>	operation_params VARCHAR(200)       -- Êìç‰ΩúÂèÇÊï∞</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂàõÂª∫ INSERT ÂûãËß¶ÂèëÂô®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE TRIGGER account_insert</span></span>
<span class="line"><span>AFTER INSERT</span></span>
<span class="line"><span>ON account</span></span>
<span class="line"><span>FOR EACH ROW</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	INSERT INTO account_log VALUES (NULL,&#39;INSERT&#39;,NOW(),new.id,CONCAT(&#39;ÊèíÂÖ•Âêé{id=&#39;,new.id,&#39;,name=&#39;,new.name,&#39;,money=&#39;,new.money,&#39;}&#39;));</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂêëaccountË°®Ê∑ªÂä†ËÆ∞ÂΩï</span></span>
<span class="line"><span>INSERT INTO account VALUES (NULL,&#39;Áéã‰∫î&#39;,3000);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢Êó•ÂøóË°®</span></span>
<span class="line"><span>SELECT * FROM account_log;</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span>id	operation	operation_time		operation_id	operation_params</span></span>
<span class="line"><span>1	INSERT	   	2021-01-26 19:51:11		3	     ÊèíÂÖ•Âêé{id=3,name=Áéã‰∫îmoney=2000}</span></span>
<span class="line"><span>*/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂàõÂª∫ UPDATE ÂûãËß¶ÂèëÂô®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE TRIGGER account_update</span></span>
<span class="line"><span>AFTER UPDATE</span></span>
<span class="line"><span>ON account</span></span>
<span class="line"><span>FOR EACH ROW</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	INSERT INTO account_log VALUES (NULL,&#39;UPDATE&#39;,NOW(),new.id,CONCAT(&#39;‰øÆÊîπÂâç{id=&#39;,old.id,&#39;,name=&#39;,old.name,&#39;,money=&#39;,old.money,&#39;}&#39;,&#39;‰øÆÊîπÂêé{id=&#39;,new.id,&#39;,name=&#39;,new.name,&#39;,money=&#39;,new.money,&#39;}&#39;));</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ‰øÆÊîπaccountË°®</span></span>
<span class="line"><span>UPDATE account SET money=3500 WHERE id=3;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢Êó•ÂøóË°®</span></span>
<span class="line"><span>SELECT * FROM account_log;</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span>id	operation	operation_time		operation_id	  operation_params</span></span>
<span class="line"><span>2	UPDATE	   	2021-01-26 19:58:54		2		 Êõ¥Êñ∞Ââç{id=2,name=ÊùéÂõõmoney=1000}</span></span>
<span class="line"><span>												 Êõ¥Êñ∞Âêé{id=2,name=ÊùéÂõõmoney=200}</span></span>
<span class="line"><span>*/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂàõÂª∫ DELETE ÂûãËß¶ÂèëÂô®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DELIMITER $</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE TRIGGER account_delete</span></span>
<span class="line"><span>AFTER DELETE</span></span>
<span class="line"><span>ON account</span></span>
<span class="line"><span>FOR EACH ROW</span></span>
<span class="line"><span>BEGIN</span></span>
<span class="line"><span>	INSERT INTO account_log VALUES (NULL,&#39;DELETE&#39;,NOW(),old.id,CONCAT(&#39;Âà†Èô§Ââç{id=&#39;,old.id,&#39;,name=&#39;,old.name,&#39;,money=&#39;,old.money,&#39;}&#39;));</span></span>
<span class="line"><span>END$</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DELIMITER ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Âà†Èô§accountË°®Êï∞ÊçÆ</span></span>
<span class="line"><span>DELETE FROM account WHERE id=3;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êü•ËØ¢Êó•ÂøóË°®</span></span>
<span class="line"><span>SELECT * FROM account_log;</span></span>
<span class="line"><span>/*</span></span>
<span class="line"><span>id	operation	operation_time		operation_id	operation_params</span></span>
<span class="line"><span>3	DELETE		2021-01-26 20:02:48		3	    Âà†Èô§Ââç{id=3,name=Áéã‰∫îmoney=2000}</span></span>
<span class="line"><span>*/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h2 id="Â≠òÂÇ®ÂºïÊìé" tabindex="-1"><a class="header-anchor" href="#Â≠òÂÇ®ÂºïÊìé"><span>Â≠òÂÇ®ÂºïÊìé</span></a></h2><h3 id="Âü∫Êú¨‰ªãÁªç-3" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-3"><span>Âü∫Êú¨‰ªãÁªç</span></a></h3><p>ÂØπÊØîÂÖ∂‰ªñÊï∞ÊçÆÂ∫ìÔºåMySQL ÁöÑÊû∂ÊûÑÂèØ‰ª•Âú®‰∏çÂêåÂú∫ÊôØÂ∫îÁî®Âπ∂ÂèëÊå•ËâØÂ•Ω‰ΩúÁî®Ôºå‰∏ªË¶Å‰ΩìÁé∞Âú®Â≠òÂÇ®ÂºïÊìéÔºåÊèí‰ª∂ÂºèÁöÑÂ≠òÂÇ®ÂºïÊìéÊû∂ÊûÑÂ∞ÜÊü•ËØ¢Â§ÑÁêÜÂíåÂÖ∂‰ªñÁöÑÁ≥ªÁªü‰ªªÂä°‰ª•ÂèäÊï∞ÊçÆÁöÑÂ≠òÂÇ®ÊèêÂèñÂàÜÁ¶ªÔºåÂèØ‰ª•ÈíàÂØπ‰∏çÂêåÁöÑÂ≠òÂÇ®ÈúÄÊ±ÇÂèØ‰ª•ÈÄâÊã©ÊúÄ‰ºòÁöÑÂ≠òÂÇ®ÂºïÊìé</p><p>Â≠òÂÇ®ÂºïÊìéÁöÑ‰ªãÁªçÔºö</p><ul><li>MySQL Êï∞ÊçÆÂ∫ì‰ΩøÁî®‰∏çÂêåÁöÑÊú∫Âà∂Â≠òÂèñË°®Êñá‰ª∂ , Êú∫Âà∂ÁöÑÂ∑ÆÂà´Âú®‰∫é‰∏çÂêåÁöÑÂ≠òÂÇ®ÊñπÂºè„ÄÅÁ¥¢ÂºïÊäÄÂ∑ß„ÄÅÈîÅÂÆöÊ∞¥Âπ≥Á≠â‰∏çÂêåÁöÑÂäüËÉΩÂíåËÉΩÂäõÔºåÂú® MySQL ‰∏≠ÔºåÂ∞ÜËøô‰∫õ‰∏çÂêåÁöÑÊäÄÊúØÂèäÈÖçÂ•óÁöÑÂäüËÉΩÁß∞‰∏∫Â≠òÂÇ®ÂºïÊìé</li><li>Oracle„ÄÅSqlServer Á≠âÊï∞ÊçÆÂ∫ìÂè™Êúâ‰∏ÄÁßçÂ≠òÂÇ®ÂºïÊìéÔºåMySQL <strong>Êèê‰æõ‰∫ÜÊèí‰ª∂ÂºèÁöÑÂ≠òÂÇ®ÂºïÊìéÊû∂ÊûÑ</strong>ÔºåÊâÄ‰ª• MySQL Â≠òÂú®Â§öÁßçÂ≠òÂÇ®ÂºïÊìé , Â∞±‰ºöËÆ©Êï∞ÊçÆÂ∫ìÈááÂèñ‰∫Ü‰∏çÂêåÁöÑÂ§ÑÁêÜÊï∞ÊçÆÁöÑÊñπÂºèÂíåÊâ©Â±ïÂäüËÉΩ</li><li>Âú®ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ì‰∏≠Êï∞ÊçÆÁöÑÂ≠òÂÇ®ÊòØ‰ª•Ë°®ÁöÑÂΩ¢ÂºèÂ≠òËøõË°åÔºåÊâÄ‰ª•Â≠òÂÇ®ÂºïÊìé‰πüÁß∞‰∏∫Ë°®Á±ªÂûãÔºàÂ≠òÂÇ®ÂíåÊìç‰ΩúÊ≠§Ë°®ÁöÑÁ±ªÂûãÔºâ</li><li>ÈÄöËøáÈÄâÊã©‰∏çÂêåÁöÑÂºïÊìéÔºåËÉΩÂ§üËé∑ÂèñÊúÄ‰Ω≥ÁöÑÊñπÊ°à, ‰πüËÉΩÂ§üËé∑ÂæóÈ¢ùÂ§ñÁöÑÈÄüÂ∫¶ÊàñËÄÖÂäüËÉΩÔºåÊèêÈ´òÁ®ãÂ∫èÁöÑÊï¥‰ΩìÊïàÊûú„ÄÇ</li></ul><p>MySQL ÊîØÊåÅÁöÑÂ≠òÂÇ®ÂºïÊìéÔºö</p><ul><li>MySQL ÊîØÊåÅÁöÑÂºïÊìéÂåÖÊã¨ÔºöInnoDB„ÄÅMyISAM„ÄÅMEMORY„ÄÅArchive„ÄÅFederate„ÄÅCSV„ÄÅBLACKHOLE Á≠â</li><li>MySQL5.5 ‰πãÂâçÁöÑÈªòËÆ§Â≠òÂÇ®ÂºïÊìéÊòØ MyISAMÔºå5.5 ‰πãÂêéÂ∞±Êîπ‰∏∫‰∫Ü InnoDB</li></ul><h4 id="innodbÂºïÊìé" tabindex="-1"><a class="header-anchor" href="#innodbÂºïÊìé"><span>InnoDBÂºïÊìé</span></a></h4><p>MySQL5.5 ÁâàÊú¨ÂºÄÂßãÔºåÈªòËÆ§‰ΩøÁî®InnoDBÂ≠òÂÇ®ÂºïÊìéÔºåÂÆÉÊìÖÈïø‰∫ãÂä°Â§ÑÁêÜÔºåÂÖ∑ÊúâÂ¥©Ê∫ÉÊÅ¢Â§çÁâπÊÄßÔºåÂú®Êó•Â∏∏ÂºÄÂèë‰∏≠‰ΩøÁî®ÈùûÂ∏∏ÂπøÊ≥õ„ÄÇ‰∏ãÈù¢ÊòØInnoDBÊû∂ÊûÑÂõæÔºåÂ∑¶‰æß‰∏∫ÂÜÖÂ≠òÁªìÊûÑÔºåÂè≥‰æß‰∏∫Á£ÅÁõòÁªìÊûÑ„ÄÇ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687222999294.png" alt="1687222999294" tabindex="0" loading="lazy"><figcaption>1687222999294</figcaption></figure><p>Âú®Â∑¶‰æßÁöÑÂÜÖÂ≠òÁªìÊûÑ‰∏≠Ôºå‰∏ªË¶ÅÂàÜ‰∏∫Ëøô‰πàÂõõÂ§ßÂùóÂÑøÔºö Buffer Pool„ÄÅChange Buffer„ÄÅAdaptive Hash Index„ÄÅLog Buffer„ÄÇ Êé•‰∏ãÊù•‰ªãÁªç‰∏Ä‰∏ãËøôÂõõ‰∏™ÈÉ®ÂàÜ„ÄÇ</p><p>1). <strong>Buffer Pool</strong></p><p>InnoDBÂ≠òÂÇ®ÂºïÊìéÂü∫‰∫éÁ£ÅÁõòÊñá‰ª∂Â≠òÂÇ®ÔºåËÆøÈóÆÁâ©ÁêÜÁ°¨ÁõòÂíåÂú®ÂÜÖÂ≠ò‰∏≠ËøõË°åËÆøÈóÆÔºåÈÄüÂ∫¶Áõ∏Â∑ÆÂæàÂ§ßÔºå‰∏∫‰∫ÜÂ∞ΩÂèØËÉΩÂº•Ë°•Ëøô‰∏§ËÄÖ‰πãÈó¥ÁöÑI/OÊïàÁéáÁöÑÂ∑ÆÂÄºÔºåÂ∞±ÈúÄË¶ÅÊääÁªèÂ∏∏‰ΩøÁî®ÁöÑÊï∞ÊçÆÂä†ËΩΩÂà∞ÁºìÂÜ≤Ê±†‰∏≠ÔºåÈÅøÂÖçÊØèÊ¨°ËÆøÈóÆÈÉΩËøõË°åÁ£ÅÁõòI/O„ÄÇ</p><p>Âú®InnoDBÁöÑÁºìÂÜ≤Ê±†‰∏≠‰∏ç‰ªÖÁºìÂ≠ò‰∫ÜÁ¥¢ÂºïÈ°µÂíåÊï∞ÊçÆÈ°µÔºåËøòÂåÖÂê´‰∫ÜundoÈ°µ„ÄÅÊèíÂÖ•ÁºìÂ≠ò„ÄÅËá™ÈÄÇÂ∫îÂìàÂ∏åÁ¥¢Âºï‰ª•Âèä InnoDBÁöÑÈîÅ‰ø°ÊÅØÁ≠âÁ≠â„ÄÇ</p><p>ÁºìÂÜ≤Ê±† Buffer PoolÔºåÊòØ‰∏ªÂÜÖÂ≠ò‰∏≠ÁöÑ‰∏Ä‰∏™Âå∫ÂüüÔºåÈáåÈù¢ÂèØ‰ª•ÁºìÂ≠òÁ£ÅÁõò‰∏äÁªèÂ∏∏Êìç‰ΩúÁöÑÁúüÂÆûÊï∞ÊçÆÔºåÂú®ÊâßË°åÂ¢ûÂà†ÊîπÊü•Êìç‰ΩúÊó∂ÔºåÂÖàÊìç‰ΩúÁºìÂÜ≤Ê±†‰∏≠ÁöÑÊï∞ÊçÆÔºàËã•ÁºìÂÜ≤Ê±†Ê≤°ÊúâÊï∞ÊçÆÔºåÂàô‰ªéÁ£ÅÁõòÂä†ËΩΩÂπ∂ÁºìÂ≠òÔºâÔºåÁÑ∂ÂêéÂÜç‰ª•‰∏ÄÂÆöÈ¢ëÁéáÂà∑Êñ∞Âà∞Á£ÅÁõòÔºå‰ªéËÄåÂáèÂ∞ëÁ£ÅÁõòIOÔºåÂä†Âø´Â§ÑÁêÜÈÄüÂ∫¶„ÄÇ</p><p>ÁºìÂÜ≤Ê±†‰ª•PageÈ°µ‰∏∫Âçï‰ΩçÔºåÂ∫ïÂ±ÇÈááÁî®ÈìæË°®Êï∞ÊçÆÁªìÊûÑÁÆ°ÁêÜPage„ÄÇÊ†πÊçÆÁä∂ÊÄÅÔºåÂ∞ÜPageÂàÜ‰∏∫‰∏âÁßçÁ±ªÂûãÔºö ‚Ä¢ free pageÔºöÁ©∫Èó≤pageÔºåÊú™Ë¢´‰ΩøÁî®„ÄÇ ‚Ä¢ clean pageÔºöË¢´‰ΩøÁî®pageÔºåÊï∞ÊçÆÊ≤°ÊúâË¢´‰øÆÊîπËøá„ÄÇ ‚Ä¢ dirty pageÔºöËÑèÈ°µÔºåË¢´‰ΩøÁî®pageÔºåÊï∞ÊçÆË¢´‰øÆÊîπËøáÔºå‰πü‰∏≠Êï∞ÊçÆ‰∏éÁ£ÅÁõòÁöÑÊï∞ÊçÆ‰∫ßÁîü‰∫Ü‰∏ç‰∏ÄËá¥„ÄÇ</p><p>Âú®‰∏ìÁî®ÊúçÂä°Âô®‰∏äÔºåÈÄöÂ∏∏Â∞ÜÂ§öËææ80ÔºÖÁöÑÁâ©ÁêÜÂÜÖÂ≠òÂàÜÈÖçÁªôÁºìÂÜ≤Ê±† „ÄÇÂèÇÊï∞ËÆæÁΩÆÔºö show variables like &#39;innodb_buffer_pool_size&#39;;</p><p>2). <strong>Change Buffer</strong> Change BufferÔºåÊõ¥ÊîπÁºìÂÜ≤Âå∫ÔºàÈíàÂØπ‰∫éÈùûÂîØ‰∏Ä‰∫åÁ∫ßÁ¥¢ÂºïÈ°µÔºâÔºåÂú®ÊâßË°åDMLËØ≠Âè•Êó∂ÔºåÂ¶ÇÊûúËøô‰∫õÊï∞ÊçÆPage Ê≤°ÊúâÂú®Buffer Pool‰∏≠Ôºå‰∏ç‰ºöÁõ¥Êé•Êìç‰ΩúÁ£ÅÁõòÔºåËÄå‰ºöÂ∞ÜÊï∞ÊçÆÂèòÊõ¥Â≠òÂú®Êõ¥ÊîπÁºìÂÜ≤Âå∫ Change Buffer ‰∏≠ÔºåÂú®Êú™Êù•Êï∞ÊçÆË¢´ËØªÂèñÊó∂ÔºåÂÜçÂ∞ÜÊï∞ÊçÆÂêàÂπ∂ÊÅ¢Â§çÂà∞Buffer Pool‰∏≠ÔºåÂÜçÂ∞ÜÂêàÂπ∂ÂêéÁöÑÊï∞ÊçÆÂà∑Êñ∞Âà∞Á£ÅÁõò‰∏≠„ÄÇ Change BufferÁöÑÊÑè‰πâÊòØ‰ªÄ‰πàÂë¢? ÂÖàÊù•Áúã‰∏ÄÂπÖÂõæÔºåËøô‰∏™ÊòØ‰∫åÁ∫ßÁ¥¢ÂºïÁöÑÁªìÊûÑÂõæÔºö<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687223807376.png" alt="1687223807376" loading="lazy"></p><p>‰∏éËÅöÈõÜÁ¥¢Âºï‰∏çÂêåÔºå‰∫åÁ∫ßÁ¥¢ÂºïÈÄöÂ∏∏ÊòØÈùûÂîØ‰∏ÄÁöÑÔºåÂπ∂‰∏î‰ª•Áõ∏ÂØπÈöèÊú∫ÁöÑÈ°∫Â∫èÊèíÂÖ•‰∫åÁ∫ßÁ¥¢Âºï„ÄÇÂêåÊ†∑ÔºåÂà†Èô§ÂíåÊõ¥Êñ∞ ÂèØËÉΩ‰ºöÂΩ±ÂìçÁ¥¢ÂºïÊ†ë‰∏≠‰∏çÁõ∏ÈÇªÁöÑ‰∫åÁ∫ßÁ¥¢ÂºïÈ°µÔºåÂ¶ÇÊûúÊØè‰∏ÄÊ¨°ÈÉΩÊìç‰ΩúÁ£ÅÁõòÔºå‰ºöÈÄ†ÊàêÂ§ßÈáèÁöÑÁ£ÅÁõòIO„ÄÇÊúâ‰∫Ü ChangeBuffer‰πãÂêéÔºåÊàë‰ª¨ÂèØ‰ª•Âú®ÁºìÂÜ≤Ê±†‰∏≠ËøõË°åÂêàÂπ∂Â§ÑÁêÜÔºåÂáèÂ∞ëÁ£ÅÁõòIO„ÄÇ</p><p>3). <strong>Adaptive Hash Index</strong> Ëá™ÈÄÇÂ∫îhashÁ¥¢ÂºïÔºåÁî®‰∫é‰ºòÂåñÂØπBuffer PoolÊï∞ÊçÆÁöÑÊü•ËØ¢„ÄÇMySQLÁöÑinnoDBÂºïÊìé‰∏≠ËôΩÁÑ∂Ê≤°ÊúâÁõ¥Êé•ÊîØÊåÅhashÁ¥¢ÂºïÔºå‰ΩÜÊòØÁªôÊàë‰ª¨Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÂäüËÉΩÂ∞±ÊòØËøô‰∏™Ëá™ÈÄÇÂ∫îhashÁ¥¢Âºï„ÄÇÂõ†‰∏∫ÂâçÈù¢Êàë‰ª¨ËÆ≤Âà∞ËøáÔºåhashÁ¥¢ÂºïÂú® ËøõË°åÁ≠âÂÄºÂåπÈÖçÊó∂Ôºå‰∏ÄËà¨ÊÄßËÉΩÊòØË¶ÅÈ´ò‰∫éB+Ê†ëÁöÑÔºåÂõ†‰∏∫hashÁ¥¢Âºï‰∏ÄËà¨Âè™ÈúÄË¶Å‰∏ÄÊ¨°IOÂç≥ÂèØÔºåËÄåB+Ê†ëÔºåÂèØËÉΩÈúÄË¶ÅÂá†Ê¨°ÂåπÈÖçÔºåÊâÄ‰ª•hashÁ¥¢ÂºïÁöÑÊïàÁéáË¶ÅÈ´òÔºå‰ΩÜÊòØhashÁ¥¢ÂºïÂèà‰∏çÈÄÇÂêàÂÅöËåÉÂõ¥Êü•ËØ¢„ÄÅÊ®°Á≥äÂåπÈÖçÁ≠â„ÄÇ InnoDBÂ≠òÂÇ®ÂºïÊìé‰ºöÁõëÊéßÂØπË°®‰∏äÂêÑÁ¥¢ÂºïÈ°µÁöÑÊü•ËØ¢ÔºåÂ¶ÇÊûúËßÇÂØüÂà∞Âú®ÁâπÂÆöÁöÑÊù°‰ª∂‰∏ãhashÁ¥¢ÂºïÂèØ‰ª•ÊèêÂçáÈÄüÂ∫¶ÔºåÂàôÂª∫Á´ãhashÁ¥¢ÂºïÔºåÁß∞‰πã‰∏∫Ëá™ÈÄÇÂ∫îhashÁ¥¢Âºï„ÄÇ <strong>Ëá™ÈÄÇÂ∫îÂìàÂ∏åÁ¥¢ÂºïÔºåÊó†ÈúÄ‰∫∫Â∑•Âπ≤È¢ÑÔºåÊòØÁ≥ªÁªüÊ†πÊçÆÊÉÖÂÜµËá™Âä®ÂÆåÊàê„ÄÇ</strong> ÂèÇÊï∞Ôºö adaptive_hash_index</p><p>4). <strong>Log Buffer</strong> Log BufferÔºöÊó•ÂøóÁºìÂÜ≤Âå∫ÔºåÁî®Êù•‰øùÂ≠òË¶ÅÂÜôÂÖ•Âà∞Á£ÅÁõò‰∏≠ÁöÑlogÊó•ÂøóÊï∞ÊçÆÔºàredo log „ÄÅundo logÔºâÔºåÈªòËÆ§Â§ßÂ∞è‰∏∫ 16MBÔºåÊó•ÂøóÁºìÂÜ≤Âå∫ÁöÑÊó•Âøó‰ºöÂÆöÊúüÂà∑Êñ∞Âà∞Á£ÅÁõò‰∏≠„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÊõ¥Êñ∞„ÄÅÊèíÂÖ•ÊàñÂà†Èô§ËÆ∏Â§öË°åÁöÑ‰∫ã Âä°ÔºåÂ¢ûÂä†Êó•ÂøóÁºìÂÜ≤Âå∫ÁöÑÂ§ßÂ∞èÂèØ‰ª•ËäÇÁúÅÁ£ÅÁõò I/O„ÄÇ ÂèÇÊï∞: innodb_log_buffer_sizeÔºöÁºìÂÜ≤Âå∫Â§ßÂ∞è innodb_flush_log_at_trx_commitÔºöÊó•ÂøóÂà∑Êñ∞Âà∞Á£ÅÁõòÊó∂Êú∫ÔºåÂèñÂÄº‰∏ªË¶ÅÂåÖÂê´‰ª•‰∏ã‰∏â‰∏™Ôºö</p><p>1:Êó•ÂøóÂú®ÊØèÊ¨°‰∫ãÂä°Êèê‰∫§Êó∂ÂÜôÂÖ•Âπ∂Âà∑Êñ∞Âà∞Á£ÅÁõòÔºåÈªòËÆ§ÂÄº„ÄÇ</p><p>0:ÊØèÁßíÂ∞ÜÊó•ÂøóÂÜôÂÖ•Âπ∂Âà∑Êñ∞Âà∞Á£ÅÁõò‰∏ÄÊ¨°„ÄÇ</p><p>2:Êó•ÂøóÂú®ÊØèÊ¨°‰∫ãÂä°Êèê‰∫§ÂêéÂÜôÂÖ•ÔºåÂπ∂ÊØèÁßíÂà∑Êñ∞Âà∞Á£ÅÁõò‰∏ÄÊ¨°</p><p>Á£ÅÁõòÁªìÊûÑ Êé•‰∏ãÊù•ÔºåÂÜçÊù•ÁúãÁúãInnoDB‰ΩìÁ≥ªÁªìÊûÑÁöÑÂè≥ËæπÈÉ®ÂàÜÔºå‰πüÂ∞±ÊòØÁ£ÅÁõòÁªìÊûÑÔºö<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687224588959.png" alt="1687224588959" loading="lazy">1). <strong>System Tablespace</strong> Á≥ªÁªüË°®Á©∫Èó¥ÊòØÊõ¥ÊîπÁºìÂÜ≤Âå∫ÁöÑÂ≠òÂÇ®Âå∫Âüü„ÄÇÂ¶ÇÊûúË°®ÊòØÂú®Á≥ªÁªüË°®Á©∫Èó¥ËÄå‰∏çÊòØÊØè‰∏™Ë°®Êñá‰ª∂ÊàñÈÄöÁî®Ë°®Á©∫Èó¥‰∏≠ÂàõÂª∫ÁöÑÔºåÂÆÉ‰πüÂèØËÉΩÂåÖÂê´Ë°®ÂíåÁ¥¢ÂºïÊï∞ÊçÆ„ÄÇ(Âú®MySQL5.xÁâàÊú¨‰∏≠ËøòÂåÖÂê´InnoDBÊï∞ÊçÆÂ≠óÂÖ∏„ÄÅundologÁ≠â) ÂèÇÊï∞Ôºöinnodb_data_file_path Á≥ªÁªüË°®Á©∫Èó¥ÔºåÈªòËÆ§ÁöÑÊñá‰ª∂ÂêçÂè´ ibdata1„ÄÇ</p><p>2). <strong>File-Per-Table Tablespaces</strong> Â¶ÇÊûúÂºÄÂêØ‰∫Üinnodb_file_per_tableÂºÄÂÖ≥ ÔºåÂàôÊØè‰∏™Ë°®ÁöÑÊñá‰ª∂Ë°®Á©∫Èó¥ÂåÖÂê´Âçï‰∏™InnoDBË°®ÁöÑÊï∞ÊçÆÂíåÁ¥¢Âºï ÔºåÂπ∂Â≠òÂÇ®Âú®Êñá‰ª∂Á≥ªÁªü‰∏äÁöÑÂçï‰∏™Êï∞ÊçÆÊñá‰ª∂‰∏≠„ÄÇ ÂºÄÂÖ≥ÂèÇÊï∞Ôºöinnodb_file_per_table ÔºåËØ•ÂèÇÊï∞ÈªòËÆ§ÂºÄÂêØ„ÄÇ ÈÇ£‰πüÂ∞±ÊòØËØ¥ÔºåÊàë‰ª¨Ê≤°ÂàõÂª∫‰∏Ä‰∏™Ë°®ÔºåÈÉΩ‰ºö‰∫ßÁîü‰∏Ä‰∏™Ë°®Á©∫Èó¥Êñá‰ª∂ÔºåÂ¶ÇÂõæÔºö 3). <strong>General Tablespaces</strong> ÈÄöÁî®Ë°®Á©∫Èó¥ÔºåÈúÄË¶ÅÈÄöËøá CREATE TABLESPACE ËØ≠Ê≥ïÂàõÂª∫ÈÄöÁî®Ë°®Á©∫Èó¥ÔºåÂú®ÂàõÂª∫Ë°®Êó∂ÔºåÂèØ‰ª•ÊåáÂÆöËØ•Ë°®Á©∫Èó¥„ÄÇ A. ÂàõÂª∫Ë°®Á©∫Èó¥</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLESPACE ts_name  ADD  DATAFILE  &#39;file_name&#39; ENGINE = engine_name;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>B. ÂàõÂª∫Ë°®Êó∂ÊåáÂÆöË°®Á©∫Èó¥</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE  TABLE  xxx ...  TABLESPACE  ts_name;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>4). <strong>Undo Tablespaces</strong> Êí§ÈîÄË°®Á©∫Èó¥ÔºåMySQLÂÆû‰æãÂú®ÂàùÂßãÂåñÊó∂‰ºöËá™Âä®ÂàõÂª∫‰∏§‰∏™ÈªòËÆ§ÁöÑundoË°®Á©∫Èó¥ÔºàÂàùÂßãÂ§ßÂ∞è16MÔºâÔºåÁî®‰∫éÂ≠òÂÇ® undo logÊó•Âøó„ÄÇ 5). <strong>Temporary Tablespaces</strong> InnoDB ‰ΩøÁî®‰ºöËØù‰∏¥Êó∂Ë°®Á©∫Èó¥ÂíåÂÖ®Â±Ä‰∏¥Êó∂Ë°®Á©∫Èó¥„ÄÇÂ≠òÂÇ®Áî®Êà∑ÂàõÂª∫ÁöÑ‰∏¥Êó∂Ë°®Á≠âÊï∞ÊçÆ„ÄÇ 6). <strong>Doublewrite Buffer Files</strong> ÂèåÂÜôÁºìÂÜ≤Âå∫ÔºåinnoDBÂºïÊìéÂ∞ÜÊï∞ÊçÆÈ°µ‰ªéBuffer PoolÂà∑Êñ∞Âà∞Á£ÅÁõòÂâçÔºåÂÖàÂ∞ÜÊï∞ÊçÆÈ°µÂÜôÂÖ•ÂèåÂÜôÁºìÂÜ≤Âå∫Êñá‰ª∂‰∏≠Ôºå‰æø‰∫éÁ≥ªÁªüÂºÇÂ∏∏Êó∂ÊÅ¢Â§çÊï∞ÊçÆ„ÄÇ<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687224857362.png" alt="1687224857362" loading="lazy"></p><p>7). <strong>Redo Log</strong> ÈáçÂÅöÊó•ÂøóÔºåÊòØÁî®Êù•ÂÆûÁé∞‰∫ãÂä°ÁöÑÊåÅ‰πÖÊÄß„ÄÇËØ•Êó•ÂøóÊñá‰ª∂Áî±‰∏§ÈÉ®ÂàÜÁªÑÊàêÔºöÈáçÂÅöÊó•ÂøóÁºìÂÜ≤Ôºàredo log bufferÔºâ‰ª•ÂèäÈáçÂÅöÊó•ÂøóÊñá‰ª∂Ôºàredo logÔºâ,ÂâçËÄÖÊòØÂú®ÂÜÖÂ≠ò‰∏≠ÔºåÂêéËÄÖÂú®Á£ÅÁõò‰∏≠„ÄÇÂΩì‰∫ãÂä°Êèê‰∫§‰πãÂêé‰ºöÊääÊâÄ Êúâ‰øÆÊîπ‰ø°ÊÅØÈÉΩ‰ºöÂ≠òÂà∞ËØ•Êó•Âøó‰∏≠, Áî®‰∫éÂú®Âà∑Êñ∞ËÑèÈ°µÂà∞Á£ÅÁõòÊó∂,ÂèëÁîüÈîôËØØÊó∂, ËøõË°åÊï∞ÊçÆÊÅ¢Â§ç‰ΩøÁî®„ÄÇ ‰ª•Âæ™ÁéØÊñπÂºèÂÜôÂÖ•ÈáçÂÅöÊó•ÂøóÊñá‰ª∂ÔºåÊ∂âÂèä‰∏§‰∏™Êñá‰ª∂Ôºö ÂâçÈù¢Êàë‰ª¨‰ªãÁªç‰∫ÜInnoDBÁöÑÂÜÖÂ≠òÁªìÊûÑÔºå‰ª•ÂèäÁ£ÅÁõòÁªìÊûÑÔºåÈÇ£‰πàÂÜÖÂ≠ò‰∏≠Êàë‰ª¨ÊâÄÊõ¥Êñ∞ÁöÑÊï∞ÊçÆÔºåÂèàÊòØÂ¶Ç‰ΩïÂà∞Á£ÅÁõò‰∏≠ÁöÑÂë¢Ôºü Ê≠§Êó∂ÔºåÂ∞±Ê∂âÂèäÂà∞‰∏ÄÁªÑÂêéÂè∞Á∫øÁ®ãÔºåÊé•‰∏ãÊù•ÔºåÂ∞±Êù•‰ªãÁªç‰∏Ä‰∫õInnoDB‰∏≠Ê∂âÂèäÂà∞ÁöÑÂêéÂè∞Á∫øÁ®ã„ÄÇ</p><h5 id="ÂêéÂè∞Á∫øÁ®ã" tabindex="-1"><a class="header-anchor" href="#ÂêéÂè∞Á∫øÁ®ã"><span>ÂêéÂè∞Á∫øÁ®ã<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687225707609.png" alt="1687225707609" loading="lazy"></span></a></h5><p>Âú®InnoDBÁöÑÂêéÂè∞Á∫øÁ®ã‰∏≠ÔºåÂàÜ‰∏∫4Á±ªÔºåÂàÜÂà´ÊòØÔºöMaster Thread „ÄÅIO Thread„ÄÅPurge Thread„ÄÅPage Cleaner Thread„ÄÇ 1). Master Thread Ê†∏ÂøÉÂêéÂè∞Á∫øÁ®ãÔºåË¥üË¥£Ë∞ÉÂ∫¶ÂÖ∂‰ªñÁ∫øÁ®ãÔºåËøòË¥üË¥£Â∞ÜÁºìÂÜ≤Ê±†‰∏≠ÁöÑÊï∞ÊçÆÂºÇÊ≠•Âà∑Êñ∞Âà∞Á£ÅÁõò‰∏≠, ‰øùÊåÅÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÔºå ËøòÂåÖÊã¨ËÑèÈ°µÁöÑÂà∑Êñ∞„ÄÅÂêàÂπ∂ÊèíÂÖ•ÁºìÂ≠ò„ÄÅundoÈ°µÁöÑÂõûÊî∂ „ÄÇ 2). IO Thread Âú®InnoDBÂ≠òÂÇ®ÂºïÊìé‰∏≠Â§ßÈáè‰ΩøÁî®‰∫ÜAIOÊù•Â§ÑÁêÜIOËØ∑Ê±Ç, ËøôÊ†∑ÂèØ‰ª•ÊûÅÂ§ßÂú∞ÊèêÈ´òÊï∞ÊçÆÂ∫ìÁöÑÊÄßËÉΩÔºåËÄåIO Thread‰∏ªË¶ÅË¥üË¥£Ëøô‰∫õIOËØ∑Ê±ÇÁöÑÂõûË∞É„ÄÇ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687225756413.png" alt="1687225756413" tabindex="0" loading="lazy"><figcaption>1687225756413</figcaption></figure><p>Êü•ÁúãÂà∞InnoDBÁöÑÁä∂ÊÄÅ‰ø°ÊÅØ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>show engine innodb status \G;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>3). Purge Thread ‰∏ªË¶ÅÁî®‰∫éÂõûÊî∂‰∫ãÂä°Â∑≤ÁªèÊèê‰∫§‰∫ÜÁöÑundo logÔºåÂú®‰∫ãÂä°Êèê‰∫§‰πãÂêéÔºåundo logÂèØËÉΩ‰∏çÁî®‰∫ÜÔºåÂ∞±Áî®ÂÆÉÊù•ÂõûÊî∂„ÄÇ 4). Page Cleaner Thread ÂçèÂä© Master Thread Âà∑Êñ∞ËÑèÈ°µÂà∞Á£ÅÁõòÁöÑÁ∫øÁ®ãÔºåÂÆÉÂèØ‰ª•ÂáèËΩª Master Thread ÁöÑÂ∑•‰ΩúÂéãÂäõÔºåÂáèÂ∞ëÈòªÂ°û„ÄÇ</p><hr><h3 id="ÂºïÊìéÂØπÊØî" tabindex="-1"><a class="header-anchor" href="#ÂºïÊìéÂØπÊØî"><span>ÂºïÊìéÂØπÊØî</span></a></h3><p>MyISAM Â≠òÂÇ®ÂºïÊìéÔºö</p><ul><li>ÁâπÁÇπÔºö‰∏çÊîØÊåÅ‰∫ãÂä°ÂíåÂ§ñÈîÆÔºåËØªÂèñÈÄüÂ∫¶Âø´ÔºåËäÇÁ∫¶ËµÑÊ∫ê</li><li>Â∫îÁî®Âú∫ÊôØÔºö<strong>ÈÄÇÁî®‰∫éËØªÂ§öÂÜôÂ∞ëÁöÑÂú∫ÊôØ</strong>ÔºåÂØπ‰∫ãÂä°ÁöÑÂÆåÊï¥ÊÄßË¶ÅÊ±Ç‰∏çÈ´òÔºåÊØîÂ¶Ç‰∏Ä‰∫õÊï∞‰ªì„ÄÅÁ¶ªÁ∫øÊï∞ÊçÆ„ÄÅÊîØ‰ªòÂÆùÁöÑÂπ¥Â∫¶ÊÄªÁªì‰πãÁ±ªÁöÑÂú∫ÊôØÔºå‰∏öÂä°ËøõË°åÂè™ËØªÊìç‰ΩúÔºåÊü•ËØ¢Ëµ∑Êù•‰ºöÊõ¥Âø´</li><li>Â≠òÂÇ®ÊñπÂºèÔºö <ul><li>ÊØè‰∏™ MyISAM Âú®Á£ÅÁõò‰∏äÂ≠òÂÇ®Êàê 3 ‰∏™Êñá‰ª∂ÔºåÂÖ∂Êñá‰ª∂ÂêçÈÉΩÂíåË°®ÂêçÁõ∏ÂêåÔºåÊãìÂ±ïÂêç‰∏çÂêå</li><li>Ë°®ÁöÑÂÆö‰πâ‰øùÂ≠òÂú® .frm ÊàñËÄÖsdiÊñá‰ª∂ÔºåË°®Êï∞ÊçÆ‰øùÂ≠òÂú® .MYD (MYData) Êñá‰ª∂‰∏≠ÔºåÁ¥¢Âºï‰øùÂ≠òÂú® .MYI (MYIndex) Êñá‰ª∂‰∏≠</li></ul></li></ul><p>InnoDB Â≠òÂÇ®ÂºïÊìéÔºö(MySQL5.5 ÁâàÊú¨ÂêéÈªòËÆ§ÁöÑÂ≠òÂÇ®ÂºïÊìé)</p><ul><li>ÁâπÁÇπÔºö<strong>ÊîØÊåÅ‰∫ãÂä°</strong>ÂíåÂ§ñÈîÆÊìç‰ΩúÔºåÊîØÊåÅÂπ∂ÂèëÊéßÂà∂„ÄÇÂØπÊØî MyISAM ÁöÑÂ≠òÂÇ®ÂºïÊìéÔºåInnoDB ÂÜôÁöÑÂ§ÑÁêÜÊïàÁéáÂ∑Æ‰∏Ä‰∫õÔºåÂπ∂‰∏î‰ºöÂç†Áî®Êõ¥Â§öÁöÑÁ£ÅÁõòÁ©∫Èó¥‰ª•‰øùÁïôÊï∞ÊçÆÂíåÁ¥¢Âºï</li><li>Â∫îÁî®Âú∫ÊôØÔºöÂØπ‰∫ãÂä°ÁöÑÂÆåÊï¥ÊÄßÊúâÊØîËæÉÈ´òÁöÑË¶ÅÊ±ÇÔºåÂú®Âπ∂ÂèëÊù°‰ª∂‰∏ãË¶ÅÊ±ÇÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÔºåËØªÂÜôÈ¢ëÁπÅÁöÑÊìç‰Ωú</li><li>Â≠òÂÇ®ÊñπÂºèÔºö <ul><li>‰ΩøÁî®ÂÖ±‰∫´Ë°®Á©∫Èó¥Â≠òÂÇ®Ôºå ËøôÁßçÊñπÂºèÂàõÂª∫ÁöÑË°®ÁöÑË°®ÁªìÊûÑ‰øùÂ≠òÂú® .frm ÂíåsdiÊñá‰ª∂‰∏≠Ôºå Êï∞ÊçÆÂíåÁ¥¢Âºï‰øùÂ≠òÂú® innodb_data_home_dir Âíå innodb_data_file_path ÂÆö‰πâÁöÑË°®Á©∫Èó¥‰∏≠ÔºåÂèØ‰ª•ÊòØÂ§ö‰∏™Êñá‰ª∂</li><li>‰ΩøÁî®Â§öË°®Á©∫Èó¥Â≠òÂÇ®ÔºåÂàõÂª∫ÁöÑË°®ÁöÑË°®ÁªìÊûÑÂ≠òÂú® .frm Êñá‰ª∂‰∏≠ÔºåÊØè‰∏™Ë°®ÁöÑÊï∞ÊçÆÂíåÁ¥¢ÂºïÂçïÁã¨‰øùÂ≠òÂú® .ibd ‰∏≠</li></ul></li></ul><p>‚Äã ÈÄªËæëÂ≠òÂÇ®ÁªìÊûÑ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1686905882743.png" alt="1686905882743" tabindex="0" loading="lazy"><figcaption>1686905882743</figcaption></figure><ul><li><p>Ë°®Á©∫Èó¥ : InnoDBÂ≠òÂÇ®ÂºïÊìéÈÄªËæëÁªìÊûÑÁöÑÊúÄÈ´òÂ±ÇÔºåibdÊñá‰ª∂ÂÖ∂ÂÆûÂ∞±ÊòØË°®Á©∫Èó¥Êñá‰ª∂ÔºåÂú®Ë°®Á©∫Èó¥‰∏≠ÂèØ‰ª• ÂåÖÂê´Â§ö‰∏™SegmentÊÆµ„ÄÇ</p></li><li><p>ÊÆµ : Ë°®Á©∫Èó¥ÊòØÁî±ÂêÑ‰∏™ÊÆµÁªÑÊàêÁöÑÔºå Â∏∏ËßÅÁöÑÊÆµÊúâÊï∞ÊçÆÊÆµ„ÄÅÁ¥¢ÂºïÊÆµ„ÄÅÂõûÊªöÊÆµÁ≠â„ÄÇInnoDB‰∏≠ÂØπ‰∫éÊÆµÁöÑÁÆ° ÁêÜÔºåÈÉΩÊòØÂºïÊìéËá™Ë∫´ÂÆåÊàêÔºå‰∏çÈúÄË¶Å‰∫∫‰∏∫ÂØπÂÖ∂ÊéßÂà∂Ôºå‰∏Ä‰∏™ÊÆµ‰∏≠ÂåÖÂê´Â§ö‰∏™Âå∫„ÄÇ</p></li><li><p>Âå∫ : Âå∫ÊòØË°®Á©∫Èó¥ÁöÑÂçïÂÖÉÁªìÊûÑÔºåÊØè‰∏™Âå∫ÁöÑÂ§ßÂ∞è‰∏∫1M„ÄÇ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå InnoDBÂ≠òÂÇ®ÂºïÊìéÈ°µÂ§ßÂ∞è‰∏∫ 16KÔºå Âç≥‰∏Ä‰∏™Âå∫‰∏≠‰∏ÄÂÖ±Êúâ64‰∏™ËøûÁª≠ÁöÑÈ°µ„ÄÇ</p></li><li><p>È°µ : È°µÊòØÁªÑÊàêÂå∫ÁöÑÊúÄÂ∞èÂçïÂÖÉÔºåÈ°µ‰πüÊòØInnoDB Â≠òÂÇ®ÂºïÊìéÁ£ÅÁõòÁÆ°ÁêÜÁöÑÊúÄÂ∞èÂçïÂÖÉÔºåÊØè‰∏™È°µÁöÑÂ§ßÂ∞èÈªò ËÆ§‰∏∫ 16KB„ÄÇ‰∏∫‰∫Ü‰øùËØÅÈ°µÁöÑËøûÁª≠ÊÄßÔºåInnoDB Â≠òÂÇ®ÂºïÊìéÊØèÊ¨°‰ªéÁ£ÅÁõòÁî≥ËØ∑ 4-5 ‰∏™Âå∫„ÄÇ</p></li><li><p>Ë°å : InnoDB Â≠òÂÇ®ÂºïÊìéÊòØÈù¢ÂêëË°åÁöÑÔºå‰πüÂ∞±ÊòØËØ¥Êï∞ÊçÆÊòØÊåâË°åËøõË°åÂ≠òÊîæÁöÑÔºåÂú®ÊØè‰∏ÄË°å‰∏≠Èô§‰∫ÜÂÆö‰πâË°®Êó∂ ÊâÄÊåáÂÆöÁöÑÂ≠óÊÆµ‰ª•Â§ñÔºåËøòÂåÖÂê´‰∏§‰∏™ÈöêËóèÂ≠óÊÆµ:</p><p>Trx_idÔºöÊØèÊ¨°ÂØπÊüêÊù°ËÆ∞ÂΩïËøõË°åÊîπÂä®Êó∂ÔºåÈÉΩ‰ºöÊääÂØπÂ∫îÁöÑ‰∫ãÂä°idËµãÂÄºÁªôtrx_idÈöêËóèÂàó„ÄÇ Roll_pointerÔºöÊØèÊ¨°ÂØπÊüêÊù°ÂºïËÆ∞ÂΩïËøõË°åÊîπÂä®Êó∂ÔºåÈÉΩ‰ºöÊääÊóßÁöÑÁâàÊú¨ÂÜôÂÖ•Âà∞undoÊó•Âøó‰∏≠ÔºåÁÑ∂ÂêéËøô‰∏™ÈöêËóèÂàóÂ∞±Áõ∏ÂΩì‰∫é‰∏Ä‰∏™ÊåáÈíàÔºåÂèØ‰ª•ÈÄöËøáÂÆÉÊù•ÊâæÂà∞ËØ•ËÆ∞ÂΩï‰øÆÊîπÂâçÁöÑ‰ø°ÊÅØ„ÄÇ</p></li></ul><p>MEMORY Â≠òÂÇ®ÂºïÊìéÔºö</p><ul><li>ÁâπÁÇπÔºöÊØè‰∏™ MEMORY Ë°®ÂÆûÈôÖÂØπÂ∫î‰∏Ä‰∏™Á£ÅÁõòÊñá‰ª∂ ÔºåËØ•Êñá‰ª∂‰∏≠Âè™Â≠òÂÇ®Ë°®ÁöÑÁªìÊûÑÔºåË°®Êï∞ÊçÆ‰øùÂ≠òÂú®ÂÜÖÂ≠ò‰∏≠Ôºå‰∏îÈªòËÆ§<strong>‰ΩøÁî® HASH Á¥¢Âºï</strong>ÔºåÊâÄ‰ª•Êï∞ÊçÆÈªòËÆ§Â∞±ÊòØÊó†Â∫èÁöÑÔºå‰ΩÜÊòØÂú®ÈúÄË¶ÅÂø´ÈÄüÂÆö‰ΩçËÆ∞ÂΩïÂèØ‰ª•Êèê‰æõÊõ¥Âø´ÁöÑËÆøÈóÆÔºå<strong>ÊúçÂä°‰∏ÄÊó¶ÂÖ≥Èó≠ÔºåË°®‰∏≠ÁöÑÊï∞ÊçÆÂ∞±‰ºö‰∏¢Â§±</strong>ÔºåÂ≠òÂÇ®‰∏çÂÆâÂÖ®</li><li>Â∫îÁî®Âú∫ÊôØÔºö<strong>ÁºìÂ≠òÂûãÂ≠òÂÇ®ÂºïÊìé</strong>ÔºåÈÄöÂ∏∏Áî®‰∫éÊõ¥Êñ∞‰∏çÂ§™È¢ëÁπÅÁöÑÂ∞èË°®ÔºåÁî®‰ª•Âø´ÈÄüÂæóÂà∞ËÆøÈóÆÁªìÊûú</li><li>Â≠òÂÇ®ÊñπÂºèÔºöË°®ÁªìÊûÑ‰øùÂ≠òÂú® .frm ‰∏≠</li></ul><p>MERGE Â≠òÂÇ®ÂºïÊìéÔºö</p><ul><li><p>ÁâπÁÇπÔºö</p><ul><li>ÊòØ‰∏ÄÁªÑ MyISAM Ë°®ÁöÑÁªÑÂêàÔºåËøô‰∫õ MyISAM Ë°®ÂøÖÈ°ªÁªìÊûÑÂÆåÂÖ®Áõ∏ÂêåÔºåÈÄöËøáÂ∞Ü‰∏çÂêåÁöÑË°®ÂàÜÂ∏ÉÂú®Â§ö‰∏™Á£ÅÁõò‰∏ä</li><li>MERGE Ë°®Êú¨Ë∫´Âπ∂Ê≤°ÊúâÂ≠òÂÇ®Êï∞ÊçÆÔºåÂØπ MERGE Á±ªÂûãÁöÑË°®ÂèØ‰ª•ËøõË°åÊü•ËØ¢„ÄÅÊõ¥Êñ∞„ÄÅÂà†Èô§Êìç‰ΩúÔºåËøô‰∫õÊìç‰ΩúÂÆûÈôÖ‰∏äÊòØÂØπÂÜÖÈÉ®ÁöÑ MyISAM Ë°®ËøõË°åÁöÑ</li></ul></li><li><p>Â∫îÁî®Âú∫ÊôØÔºöÂ∞Ü‰∏ÄÁ≥ªÂàóÁ≠âÂêåÁöÑ MyISAM Ë°®‰ª•ÈÄªËæëÊñπÂºèÁªÑÂêàÂú®‰∏ÄËµ∑ÔºåÂπ∂‰Ωú‰∏∫‰∏Ä‰∏™ÂØπË±°ÂºïÁî®‰ªñ‰ª¨ÔºåÈÄÇÂêàÂÅöÊï∞ÊçÆ‰ªìÂ∫ì</p></li><li><p>Êìç‰ΩúÊñπÂºèÔºö</p><ul><li>ÊèíÂÖ•Êìç‰ΩúÊòØÈÄöËøá INSERT_METHOD Â≠êÂè•ÂÆö‰πâÊèíÂÖ•ÁöÑË°®Ôºå‰ΩøÁî® FIRST Êàñ LAST ÂÄº‰ΩøÂæóÊèíÂÖ•Êìç‰ΩúË¢´Áõ∏Â∫îÂú∞‰ΩúÁî®Âú®Á¨¨‰∏ÄÊàñËÄÖÊúÄÂêé‰∏Ä‰∏™Ë°®‰∏äÔºõ‰∏çÂÆö‰πâËøô‰∏™Â≠êÂè•ÊàñËÄÖÂÆö‰πâ‰∏∫ NOÔºåË°®Á§∫‰∏çËÉΩÂØπ MERGE Ë°®ÊâßË°åÊèíÂÖ•Êìç‰Ωú</li><li>ÂØπ MERGE Ë°®ËøõË°å DROP Êìç‰ΩúÔºå‰ΩÜÊòØËøô‰∏™Êìç‰ΩúÂè™ÊòØÂà†Èô§ MERGE Ë°®ÁöÑÂÆö‰πâÔºåÂØπÂÜÖÈÉ®ÁöÑË°®ÊòØÊ≤°Êúâ‰ªª‰ΩïÂΩ±ÂìçÁöÑ</li></ul><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE order_1(</span></span>
<span class="line"><span>)ENGINE = MyISAM DEFAULT CHARSET=utf8;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE TABLE order_2(</span></span>
<span class="line"><span>)ENGINE = MyISAM DEFAULT CHARSET=utf8;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE TABLE order_all(</span></span>
<span class="line"><span>	-- ÁªìÊûÑ‰∏éMyISAMË°®Áõ∏Âêå</span></span>
<span class="line"><span>)ENGINE = MERGE UNION = (order_1,order_2) INSERT_METHOD=LAST DEFAULT CHARSET=utf8;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MERGE.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><table><thead><tr><th>ÁâπÊÄß</th><th>MyISAM</th><th>InnoDB</th><th>MEMORY</th></tr></thead><tbody><tr><td>Â≠òÂÇ®ÈôêÂà∂</td><td>ÊúâÔºàÂπ≥Âè∞ÂØπÊñá‰ª∂Á≥ªÁªüÂ§ßÂ∞èÁöÑÈôêÂà∂Ôºâ</td><td>64TB</td><td>ÊúâÔºàÂπ≥Âè∞ÁöÑÂÜÖÂ≠òÈôêÂà∂Ôºâ</td></tr><tr><td><strong>‰∫ãÂä°ÂÆâÂÖ®</strong></td><td><strong>‰∏çÊîØÊåÅ</strong></td><td><strong>ÊîØÊåÅ</strong></td><td><strong>‰∏çÊîØÊåÅ</strong></td></tr><tr><td><strong>ÈîÅÊú∫Âà∂</strong></td><td><strong>Ë°®ÈîÅ</strong></td><td><strong>Ë°®ÈîÅ/Ë°åÈîÅ</strong></td><td><strong>Ë°®ÈîÅ</strong></td></tr><tr><td>B+Tree Á¥¢Âºï</td><td>ÊîØÊåÅ</td><td>ÊîØÊåÅ</td><td>ÊîØÊåÅ</td></tr><tr><td>ÂìàÂ∏åÁ¥¢Âºï</td><td>‰∏çÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td><td>ÊîØÊåÅ</td></tr><tr><td>ÂÖ®ÊñáÁ¥¢Âºï</td><td>ÊîØÊåÅ</td><td>ÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td></tr><tr><td>ÈõÜÁæ§Á¥¢Âºï</td><td>‰∏çÊîØÊåÅ</td><td>ÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td></tr><tr><td>Êï∞ÊçÆÁ¥¢Âºï</td><td>‰∏çÊîØÊåÅ</td><td>ÊîØÊåÅ</td><td>ÊîØÊåÅ</td></tr><tr><td>Êï∞ÊçÆÁºìÂ≠ò</td><td>‰∏çÊîØÊåÅ</td><td>ÊîØÊåÅ</td><td>N/A</td></tr><tr><td>Á¥¢ÂºïÁºìÂ≠ò</td><td>ÊîØÊåÅ</td><td>ÊîØÊåÅ</td><td>N/A</td></tr><tr><td>Êï∞ÊçÆÂèØÂéãÁº©</td><td>ÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td></tr><tr><td>Á©∫Èó¥‰ΩøÁî®</td><td>‰Ωé</td><td>È´ò</td><td>N/A</td></tr><tr><td>ÂÜÖÂ≠ò‰ΩøÁî®</td><td>‰Ωé</td><td>È´ò</td><td>‰∏≠Á≠â</td></tr><tr><td>ÊâπÈáèÊèíÂÖ•ÈÄüÂ∫¶</td><td>È´ò</td><td>‰Ωé</td><td>È´ò</td></tr><tr><td><strong>Â§ñÈîÆ</strong></td><td><strong>‰∏çÊîØÊåÅ</strong></td><td><strong>ÊîØÊåÅ</strong></td><td><strong>‰∏çÊîØÊåÅ</strong></td></tr></tbody></table><p>Âè™ËØªÂú∫ÊôØ MyISAM ÊØî InnoDB Êõ¥Âø´Ôºö</p><ul><li>Â∫ïÂ±ÇÂ≠òÂÇ®ÁªìÊûÑÊúâÂ∑ÆÂà´ÔºåMyISAM ÊòØÈùûËÅöÁ∞áÁ¥¢ÂºïÔºåÂè∂Â≠êËäÇÁÇπ‰øùÂ≠òÁöÑÊòØÊï∞ÊçÆÁöÑÂÖ∑‰ΩìÂú∞ÂùÄÔºå‰∏çÁî®ÂõûË°®Êü•ËØ¢</li><li>InnoDB ÊØèÊ¨°Êü•ËØ¢ÈúÄË¶ÅÁª¥Êä§ MVCC ÁâàÊú¨Áä∂ÊÄÅÔºå‰øùËØÅÂπ∂ÂèëÁä∂ÊÄÅ‰∏ãÁöÑËØªÂÜôÂÜ≤Á™ÅÈóÆÈ¢ò</li></ul><hr><h3 id="ÂºïÊìéÊìç‰Ωú" tabindex="-1"><a class="header-anchor" href="#ÂºïÊìéÊìç‰Ωú"><span>ÂºïÊìéÊìç‰Ωú</span></a></h3><ul><li><p>Êü•ËØ¢Êï∞ÊçÆÂ∫ìÊîØÊåÅÁöÑÂ≠òÂÇ®ÂºïÊìé</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW ENGINES;</span></span>
<span class="line"><span>SHOW VARIABLES LIKE &#39;%storage_engine%&#39;; -- Êü•ÁúãMysqlÊï∞ÊçÆÂ∫ìÈªòËÆ§ÁöÑÂ≠òÂÇ®ÂºïÊìé</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Êüê‰∏™Êï∞ÊçÆÂ∫ì‰∏≠ÊâÄÊúâÊï∞ÊçÆË°®ÁöÑÂ≠òÂÇ®ÂºïÊìé</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW TABLE STATUS FROM Êï∞ÊçÆÂ∫ìÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Êüê‰∏™Êï∞ÊçÆÂ∫ì‰∏≠Êüê‰∏™Êï∞ÊçÆË°®ÁöÑÂ≠òÂÇ®ÂºïÊìé</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW TABLE STATUS FROM Êï∞ÊçÆÂ∫ìÂêçÁß∞ WHERE NAME = &#39;Êï∞ÊçÆË°®ÂêçÁß∞&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂàõÂª∫Êï∞ÊçÆË°®ÔºåÊåáÂÆöÂ≠òÂÇ®ÂºïÊìé</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE Ë°®Âêç(</span></span>
<span class="line"><span>	ÂàóÂêç,Êï∞ÊçÆÁ±ªÂûã,</span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>)ENGINE = ÂºïÊìéÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>‰øÆÊîπÊï∞ÊçÆË°®ÁöÑÂ≠òÂÇ®ÂºïÊìé</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE Ë°®Âêç ENGINE = ÂºïÊìéÂêçÁß∞;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><hr><h2 id="Á¥¢ÂºïÊú∫Âà∂" tabindex="-1"><a class="header-anchor" href="#Á¥¢ÂºïÊú∫Âà∂"><span>Á¥¢ÂºïÊú∫Âà∂</span></a></h2><h3 id="Á¥¢Âºï‰ªãÁªç" tabindex="-1"><a class="header-anchor" href="#Á¥¢Âºï‰ªãÁªç"><span>Á¥¢Âºï‰ªãÁªç</span></a></h3><h4 id="Âü∫Êú¨‰ªãÁªç-4" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-4"><span>Âü∫Êú¨‰ªãÁªç</span></a></h4><p>MySQL ÂÆòÊñπÂØπÁ¥¢ÂºïÁöÑÂÆö‰πâ‰∏∫ÔºöÁ¥¢ÂºïÔºàindexÔºâÊòØÂ∏ÆÂä© MySQL È´òÊïàËé∑ÂèñÊï∞ÊçÆÁöÑ‰∏ÄÁßçÊï∞ÊçÆÁªìÊûÑÔºå**Êú¨Ë¥®ÊòØÊéíÂ•ΩÂ∫èÁöÑÂø´ÈÄüÊü•ÊâæÊï∞ÊçÆÁªìÊûÑ„ÄÇ**Âú®Ë°®Êï∞ÊçÆ‰πãÂ§ñÔºåÊï∞ÊçÆÂ∫ìÁ≥ªÁªüËøòÁª¥Êä§ÁùÄÊª°Ë∂≥ÁâπÂÆöÊü•ÊâæÁÆóÊ≥ïÁöÑÊï∞ÊçÆÁªìÊûÑÔºåËøô‰∫õÊï∞ÊçÆÁªìÊûÑ‰ª•ÊüêÁßçÊñπÂºèÊåáÂêëÊï∞ÊçÆÔºå ËøôÊ†∑Â∞±ÂèØ‰ª•Âú®Ëøô‰∫õÊï∞ÊçÆÁªìÊûÑ‰∏äÂÆûÁé∞È´òÁ∫ßÊü•ÊâæÁÆóÊ≥ïÔºåËøôÁßçÊï∞ÊçÆÁªìÊûÑÂ∞±ÊòØÁ¥¢Âºï</p><p><strong>Á¥¢ÂºïÊòØÂú®Â≠òÂÇ®ÂºïÊìéÂ±ÇÂÆûÁé∞ÁöÑ</strong>ÔºåÊâÄ‰ª•Âπ∂Ê≤°ÊúâÁªü‰∏ÄÁöÑÁ¥¢ÂºïÊ†áÂáÜÔºåÂç≥‰∏çÂêåÂ≠òÂÇ®ÂºïÊìéÁöÑÁ¥¢ÂºïÁöÑÂ∑•‰ΩúÊñπÂºèÂπ∂‰∏ç‰∏ÄÊ†∑</p><p>Á¥¢Âºï‰ΩøÁî®Ôºö‰∏ÄÂº†Êï∞ÊçÆË°®ÔºåÁî®‰∫é‰øùÂ≠òÊï∞ÊçÆÔºõ‰∏Ä‰∏™Á¥¢ÂºïÈÖçÁΩÆÊñá‰ª∂ÔºåÁî®‰∫é‰øùÂ≠òÁ¥¢ÂºïÔºõÊØè‰∏™Á¥¢ÂºïÈÉΩÊåáÂêë‰∫ÜÊüê‰∏Ä‰∏™Êï∞ÊçÆ <img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Á¥¢ÂºïÁöÑ‰ªãÁªç.png" alt="" loading="lazy"></p><p>Â∑¶ËæπÊòØÊï∞ÊçÆË°®Ôºå‰∏ÄÂÖ±Êúâ‰∏§Âàó‰∏ÉÊù°ËÆ∞ÂΩïÔºåÊúÄÂ∑¶ËæπÁöÑÊòØÊï∞ÊçÆËÆ∞ÂΩïÁöÑÁâ©ÁêÜÂú∞ÂùÄÔºàÊ≥®ÊÑèÈÄªËæë‰∏äÁõ∏ÈÇªÁöÑËÆ∞ÂΩïÂú®Á£ÅÁõò‰∏ä‰πüÂπ∂‰∏çÊòØ‰∏ÄÂÆöÁâ©ÁêÜÁõ∏ÈÇªÁöÑÔºâ„ÄÇ‰∏∫‰∫ÜÂä†Âø´ Col2 ÁöÑÊü•ÊâæÔºåÂèØ‰ª•Áª¥Êä§‰∏Ä‰∏™Âè≥ËæπÊâÄÁ§∫ÁöÑ‰∫åÂèâÊü•ÊâæÊ†ëÔºåÊØè‰∏™ËäÇÁÇπÂàÜÂà´ÂåÖÂê´Á¥¢ÂºïÈîÆÂÄºÂíå‰∏Ä‰∏™ÊåáÂêëÂØπÂ∫îÊï∞ÊçÆÁöÑÁâ©ÁêÜÂú∞ÂùÄÁöÑÊåáÈíàÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ËøêÁî®‰∫åÂèâÊü•ÊâæÂø´ÈÄüËé∑ÂèñÂà∞Áõ∏Â∫îÊï∞ÊçÆ</p><p>Á¥¢ÂºïÁöÑ‰ºòÁÇπÔºö</p><ul><li>Á±ª‰ºº‰∫é‰π¶Á±çÁöÑÁõÆÂΩïÁ¥¢ÂºïÔºåÊèêÈ´òÊï∞ÊçÆÊ£ÄÁ¥¢ÁöÑÊïàÁéáÔºåÈôç‰ΩéÊï∞ÊçÆÂ∫ìÁöÑ IO ÊàêÊú¨</li><li>ÈÄöËøáÁ¥¢ÂºïÂàóÂØπÊï∞ÊçÆËøõË°åÊéíÂ∫èÔºåÈôç‰ΩéÊï∞ÊçÆÊéíÂ∫èÁöÑÊàêÊú¨ÔºåÈôç‰Ωé CPU ÁöÑÊ∂àËÄó</li></ul><p>Á¥¢ÂºïÁöÑÁº∫ÁÇπÔºö</p><ul><li>‰∏ÄËà¨Êù•ËØ¥Á¥¢ÂºïÊú¨Ë∫´‰πüÂæàÂ§ßÔºå‰∏çÂèØËÉΩÂÖ®ÈÉ®Â≠òÂÇ®Âú®ÂÜÖÂ≠ò‰∏≠ÔºåÂõ†Ê≠§Á¥¢ÂºïÂæÄÂæÄ‰ª•Á¥¢ÂºïÊñá‰ª∂ÁöÑÂΩ¢Âºè<strong>Â≠òÂÇ®Âú®Á£ÅÁõò</strong>‰∏ä</li><li>ËôΩÁÑ∂Á¥¢ÂºïÂ§ßÂ§ßÊèêÈ´ò‰∫ÜÊü•ËØ¢ÊïàÁéáÔºåÂêåÊó∂Âç¥‰πüÈôç‰ΩéÊõ¥Êñ∞Ë°®ÁöÑÈÄüÂ∫¶„ÄÇÂØπË°®ËøõË°å INSERT„ÄÅUPDATE„ÄÅDELETE Êìç‰ΩúÔºåMySQL ‰∏ç‰ªÖË¶Å‰øùÂ≠òÊï∞ÊçÆÔºåËøòË¶Å‰øùÂ≠ò‰∏Ä‰∏ãÁ¥¢ÂºïÊñá‰ª∂ÊØèÊ¨°Êõ¥Êñ∞Ê∑ªÂä†‰∫ÜÁ¥¢ÂºïÂàóÁöÑÂ≠óÊÆµÔºåËøò‰ºöË∞ÉÊï¥Âõ†‰∏∫Êõ¥Êñ∞ÊâÄÂ∏¶Êù•ÁöÑÈîÆÂÄºÂèòÂåñÂêéÁöÑÁ¥¢Âºï‰ø°ÊÅØÔºå<strong>‰ΩÜÊòØÊõ¥Êñ∞Êï∞ÊçÆ‰πüÈúÄË¶ÅÂÖà‰ªéÊï∞ÊçÆÂ∫ì‰∏≠Ëé∑Âèñ</strong>ÔºåÁ¥¢ÂºïÂä†Âø´‰∫ÜËé∑ÂèñÈÄüÂ∫¶ÔºåÊâÄ‰ª•ÂèØ‰ª•Áõ∏‰∫íÊäµÊ∂à‰∏Ä‰∏ã„ÄÇ</li><li>Á¥¢Âºï‰ºöÂΩ±ÂìçÂà∞ WHERE ÁöÑÊü•ËØ¢Êù°‰ª∂ÂíåÊéíÂ∫è ORDER BY ‰∏§Â§ßÂäüËÉΩ</li></ul><hr><h4 id="Á¥¢ÂºïÂàÜÁ±ª" tabindex="-1"><a class="header-anchor" href="#Á¥¢ÂºïÂàÜÁ±ª"><span>Á¥¢ÂºïÂàÜÁ±ª</span></a></h4><p>Á¥¢Âºï‰∏ÄËà¨ÁöÑÂàÜÁ±ªÂ¶Ç‰∏ãÔºö</p><ul><li><p>ÂäüËÉΩÂàÜÁ±ª</p><ul><li>‰∏ªÈîÆÁ¥¢ÂºïÔºö‰∏ÄÁßçÁâπÊÆäÁöÑÂîØ‰∏ÄÁ¥¢ÂºïÔºå‰∏çÂÖÅËÆ∏ÊúâÁ©∫ÂÄºÔºå‰∏ÄËà¨Âú®Âª∫Ë°®Êó∂ÂêåÊó∂ÂàõÂª∫‰∏ªÈîÆÁ¥¢Âºï</li><li>ÂçïÂàóÁ¥¢ÂºïÔºö‰∏Ä‰∏™Á¥¢ÂºïÂè™ÂåÖÂê´Âçï‰∏™ÂàóÔºå‰∏Ä‰∏™Ë°®ÂèØ‰ª•ÊúâÂ§ö‰∏™ÂçïÂàóÁ¥¢ÂºïÔºàÊôÆÈÄöÁ¥¢ÂºïÔºâ</li><li>ËÅîÂêàÁ¥¢ÂºïÔºöÈ°æÂêçÊÄù‰πâÔºåÂ∞±ÊòØÂ∞ÜÂçïÂàóÁ¥¢ÂºïËøõË°åÁªÑÂêà</li><li>ÂîØ‰∏ÄÁ¥¢ÂºïÔºöÁ¥¢ÂºïÂàóÁöÑÂÄºÂøÖÈ°ªÂîØ‰∏ÄÔºå<strong>ÂÖÅËÆ∏ÊúâÁ©∫ÂÄº</strong>ÔºåÂ¶ÇÊûúÊòØËÅîÂêàÁ¥¢ÂºïÔºåÂàôÂàóÂÄºÁªÑÂêàÂøÖÈ°ªÂîØ‰∏Ä <ul><li>NULL ÂÄºÂèØ‰ª•Âá∫Áé∞Â§öÊ¨°ÔºåÂõ†‰∏∫‰∏§‰∏™ NULL ÊØîËæÉÁöÑÁªìÊûúÊó¢‰∏çÁõ∏Á≠âÔºå‰πü‰∏ç‰∏çÁ≠âÔºåÁªìÊûú‰ªçÁÑ∂ÊòØÊú™Áü•</li><li>ÂèØ‰ª•Â£∞Êòé‰∏çÂÖÅËÆ∏Â≠òÂÇ® NULL ÂÄºÁöÑÈùûÁ©∫ÂîØ‰∏ÄÁ¥¢Âºï</li></ul></li><li>Â§ñÈîÆÁ¥¢ÂºïÔºöÂè™Êúâ InnoDB ÂºïÊìéÊîØÊåÅÂ§ñÈîÆÁ¥¢ÂºïÔºåÁî®Êù•‰øùËØÅÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄß„ÄÅÂÆåÊï¥ÊÄßÂíåÂÆûÁé∞Á∫ßËÅîÊìç‰Ωú</li></ul></li><li><p>ÁªìÊûÑÂàÜÁ±ª</p><ul><li>BTree Á¥¢ÂºïÔºöMySQL ‰ΩøÁî®ÊúÄÈ¢ëÁπÅÁöÑ‰∏Ä‰∏™Á¥¢ÂºïÊï∞ÊçÆÁªìÊûÑÔºåÊòØ InnoDB Âíå MyISAM Â≠òÂÇ®ÂºïÊìéÈªòËÆ§ÁöÑÁ¥¢ÂºïÁ±ªÂûãÔºåÂ∫ïÂ±ÇÂü∫‰∫é B+Tree</li><li>Hash Á¥¢ÂºïÔºöMySQL‰∏≠ Memory Â≠òÂÇ®ÂºïÊìéÈªòËÆ§ÊîØÊåÅÁöÑÁ¥¢ÂºïÁ±ªÂûã</li><li>R-tree Á¥¢ÂºïÔºàÁ©∫Èó¥Á¥¢ÂºïÔºâÔºöÁ©∫Èó¥Á¥¢ÂºïÊòØ MyISAM ÂºïÊìéÁöÑ‰∏Ä‰∏™ÁâπÊÆäÁ¥¢ÂºïÁ±ªÂûãÔºå‰∏ªË¶ÅÁî®‰∫éÂú∞ÁêÜÁ©∫Èó¥Êï∞ÊçÆÁ±ªÂûã</li><li>Full-text Á¥¢ÂºïÔºàÂÖ®ÊñáÁ¥¢ÂºïÔºâÔºöÂø´ÈÄüÂåπÈÖçÂÖ®ÈÉ®ÊñáÊ°£ÁöÑÊñπÂºè„ÄÇMyISAM ÊîØÊåÅÔºå InnoDB ‰∏çÊîØÊåÅ FULLTEXT Á±ªÂûãÁöÑÁ¥¢ÂºïÔºå‰ΩÜÊòØ InnoDB ÂèØ‰ª•‰ΩøÁî® sphinx Êèí‰ª∂ÊîØÊåÅÂÖ®ÊñáÁ¥¢ÂºïÔºåMEMORY ÂºïÊìé‰∏çÊîØÊåÅ</li></ul><table><thead><tr><th>Á¥¢Âºï</th><th>InnoDB</th><th>MyISAM</th><th>Memory</th></tr></thead><tbody><tr><td>BTREE</td><td>ÊîØÊåÅ</td><td>ÊîØÊåÅ</td><td>ÊîØÊåÅ</td></tr><tr><td>HASH</td><td>‰∏çÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td><td>ÊîØÊåÅ</td></tr><tr><td>R-tree</td><td>‰∏çÊîØÊåÅ</td><td>ÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td></tr><tr><td>Full-text</td><td>5.6 ÁâàÊú¨‰πãÂêéÊîØÊåÅ</td><td>ÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td></tr></tbody></table></li></ul><p>ËÅîÂêàÁ¥¢ÂºïÂõæÁ§∫ÔºöÊ†πÊçÆË∫´È´òÂπ¥ÈæÑÂª∫Á´ãÁöÑÁªÑÂêàÁ¥¢ÂºïÔºàheight„ÄÅageÔºâ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ÁªÑÂêàÁ¥¢ÂºïÂõæ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h3 id="Á¥¢ÂºïÊìç‰Ωú" tabindex="-1"><a class="header-anchor" href="#Á¥¢ÂºïÊìç‰Ωú"><span>Á¥¢ÂºïÊìç‰Ωú</span></a></h3><p>Á¥¢ÂºïÂú®ÂàõÂª∫Ë°®ÁöÑÊó∂ÂÄôÂèØ‰ª•ÂêåÊó∂ÂàõÂª∫Ôºå ‰πüÂèØ‰ª•ÈöèÊó∂Â¢ûÂä†Êñ∞ÁöÑÁ¥¢Âºï</p><ul><li><p>ÂàõÂª∫Á¥¢ÂºïÔºöÂ¶ÇÊûú‰∏Ä‰∏™Ë°®‰∏≠Êúâ‰∏ÄÂàóÊòØ‰∏ªÈîÆÔºåÈÇ£‰πà‰ºö<strong>ÈªòËÆ§‰∏∫ÂÖ∂ÂàõÂª∫‰∏ªÈîÆÁ¥¢Âºï</strong>Ôºà‰∏ªÈîÆÂàó‰∏çÈúÄË¶ÅÂçïÁã¨ÂàõÂª∫Á¥¢ÂºïÔºâ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE [UNIQUE|FULLTEXT] INDEX Á¥¢ÂºïÂêçÁß∞ [USING Á¥¢ÂºïÁ±ªÂûã] ON Ë°®Âêç(ÂàóÂêç...);</span></span>
<span class="line"><span>-- Á¥¢ÂºïÁ±ªÂûãÈªòËÆ§ÊòØ B+TREE</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ÁúãÁ¥¢Âºï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW INDEX FROM Ë°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Ê∑ªÂä†Á¥¢Âºï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂçïÂàóÁ¥¢Âºï</span></span>
<span class="line"><span>ALTER TABLE Ë°®Âêç ADD INDEX Á¥¢ÂºïÂêçÁß∞(ÂàóÂêç);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÁªÑÂêàÁ¥¢Âºï</span></span>
<span class="line"><span>ALTER TABLE Ë°®Âêç ADD INDEX Á¥¢ÂºïÂêçÁß∞(ÂàóÂêç1,ÂàóÂêç2,...);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ‰∏ªÈîÆÁ¥¢Âºï</span></span>
<span class="line"><span>ALTER TABLE Ë°®Âêç ADD PRIMARY KEY(‰∏ªÈîÆÂàóÂêç); </span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Â§ñÈîÆÁ¥¢Âºï(Ê∑ªÂä†Â§ñÈîÆÁ∫¶ÊùüÔºåÂ∞±ÊòØÂ§ñÈîÆÁ¥¢Âºï)</span></span>
<span class="line"><span>ALTER TABLE Ë°®Âêç ADD CONSTRAINT Â§ñÈîÆÂêç FOREIGN KEY (Êú¨Ë°®Â§ñÈîÆÂàóÂêç) REFERENCES ‰∏ªË°®Âêç(‰∏ªÈîÆÂàóÂêç);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂîØ‰∏ÄÁ¥¢Âºï</span></span>
<span class="line"><span>ALTER TABLE Ë°®Âêç ADD UNIQUE Á¥¢ÂºïÂêçÁß∞(ÂàóÂêç);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂÖ®ÊñáÁ¥¢Âºï(mysqlÂè™ÊîØÊåÅÊñáÊú¨Á±ªÂûã)</span></span>
<span class="line"><span>ALTER TABLE Ë°®Âêç ADD FULLTEXT Á¥¢ÂºïÂêçÁß∞(ÂàóÂêç);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Âà†Èô§Á¥¢Âºï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP INDEX Á¥¢ÂºïÂêçÁß∞ ON Ë°®Âêç;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Ê°à‰æãÁªÉ‰π†</p><p>Êï∞ÊçÆÂáÜÂ§áÔºöstudent</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>id	NAME	 age	score</span></span>
<span class="line"><span>1	Âº†‰∏â		23		99</span></span>
<span class="line"><span>2	ÊùéÂõõ		24		95</span></span>
<span class="line"><span>3	Áéã‰∫î		25		98</span></span>
<span class="line"><span>4	ËµµÂÖ≠		26		97</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Á¥¢ÂºïÊìç‰ΩúÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ‰∏∫studentË°®‰∏≠ÂßìÂêçÂàóÂàõÂª∫‰∏Ä‰∏™ÊôÆÈÄöÁ¥¢Âºï</span></span>
<span class="line"><span>CREATE INDEX idx_name ON student(NAME);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ‰∏∫studentË°®‰∏≠Âπ¥ÈæÑÂàóÂàõÂª∫‰∏Ä‰∏™ÂîØ‰∏ÄÁ¥¢Âºï</span></span>
<span class="line"><span>CREATE UNIQUE INDEX idx_age ON student(age);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h3 id="ËÅöÁ∞áÁ¥¢Âºï" tabindex="-1"><a class="header-anchor" href="#ËÅöÁ∞áÁ¥¢Âºï"><span>ËÅöÁ∞áÁ¥¢Âºï</span></a></h3><h4 id="Á¥¢ÂºïÂØπÊØî" tabindex="-1"><a class="header-anchor" href="#Á¥¢ÂºïÂØπÊØî"><span>Á¥¢ÂºïÂØπÊØî</span></a></h4><p>ËÅöÁ∞áÁ¥¢ÂºïÊòØ‰∏ÄÁßçÊï∞ÊçÆÂ≠òÂÇ®ÊñπÂºèÔºåÂπ∂‰∏çÊòØ‰∏ÄÁßçÂçïÁã¨ÁöÑÁ¥¢ÂºïÁ±ªÂûã</p><ul><li>ËÅöÁ∞áÁ¥¢ÂºïÁöÑÂè∂Â≠êËäÇÁÇπÂ≠òÊîæÁöÑÊòØ‰∏ªÈîÆÂÄºÂíåÊï∞ÊçÆË°åÔºåÊîØÊåÅË¶ÜÁõñÁ¥¢Âºï</li><li>ÈùûËÅöÁ∞áÁ¥¢ÂºïÁöÑÂè∂Â≠êËäÇÁÇπÂ≠òÊîæÁöÑÊòØ‰∏ªÈîÆÂÄºÊàñÊåáÂêëÊï∞ÊçÆË°åÁöÑÊåáÈíàÔºàÁî±Â≠òÂÇ®ÂºïÊìéÂÜ≥ÂÆöÔºâ</li></ul><p>Âú® Innodb ‰∏ã‰∏ªÈîÆÁ¥¢ÂºïÊòØËÅöÁ∞áÁ¥¢ÂºïÔºåÂú® MyISAM ‰∏ã‰∏ªÈîÆÁ¥¢ÂºïÊòØÈùûËÅöÁ∞áÁ¥¢Âºï</p><hr><h4 id="innodb" tabindex="-1"><a class="header-anchor" href="#innodb"><span>Innodb</span></a></h4><h5 id="ËÅöÁ∞áÁ¥¢Âºï-1" tabindex="-1"><a class="header-anchor" href="#ËÅöÁ∞áÁ¥¢Âºï-1"><span>ËÅöÁ∞áÁ¥¢Âºï</span></a></h5><p>Âú® Innodb Â≠òÂÇ®ÂºïÊìéÔºåB+ Ê†ëÁ¥¢ÂºïÂèØ‰ª•ÂàÜ‰∏∫ËÅöÁ∞áÁ¥¢ÂºïÔºà‰πüÁß∞ËÅöÈõÜÁ¥¢Âºï„ÄÅclustered indexÔºâÂíåËæÖÂä©Á¥¢ÂºïÔºà‰πüÁß∞ÈùûËÅöÁ∞áÁ¥¢ÂºïÊàñ‰∫åÁ∫ßÁ¥¢Âºï„ÄÅsecondary index„ÄÅnon-clustered indexÔºâ</p><p>InnoDB ‰∏≠ÔºåËÅöÁ∞áÁ¥¢ÂºïÊòØÊåâÁÖßÊØèÂº†Ë°®ÁöÑ‰∏ªÈîÆÊûÑÈÄ†‰∏ÄÈ¢ó B+ Ê†ëÔºåÂè∂Â≠êËäÇÁÇπ‰∏≠Â≠òÊîæÁöÑÂ∞±ÊòØÊï¥Âº†Ë°®ÁöÑÊï∞ÊçÆÔºåÂ∞ÜËÅöÁ∞áÁ¥¢ÂºïÁöÑÂè∂Â≠êËäÇÁÇπÁß∞‰∏∫Êï∞ÊçÆÈ°µ</p><ul><li>Ëøô‰∏™ÁâπÊÄßÂÜ≥ÂÆö‰∫Ü<strong>Êï∞ÊçÆ‰πüÊòØÁ¥¢ÂºïÁöÑ‰∏ÄÈÉ®ÂàÜ</strong>ÔºåÊâÄ‰ª•‰∏ÄÂº†Ë°®Âè™ËÉΩÊúâ‰∏Ä‰∏™ËÅöÁ∞áÁ¥¢Âºï</li><li>ËæÖÂä©Á¥¢ÂºïÁöÑÂ≠òÂú®‰∏çÂΩ±ÂìçËÅöÁ∞áÁ¥¢Âºï‰∏≠Êï∞ÊçÆÁöÑÁªÑÁªáÔºåÊâÄ‰ª•‰∏ÄÂº†Ë°®ÂèØ‰ª•ÊúâÂ§ö‰∏™ËæÖÂä©Á¥¢Âºï</li></ul><p>ËÅöÁ∞áÁ¥¢ÂºïÁöÑ‰ºòÁÇπÔºö</p><ul><li>Êï∞ÊçÆËÆøÈóÆÊõ¥Âø´ÔºåËÅöÁ∞áÁ¥¢ÂºïÂ∞ÜÁ¥¢ÂºïÂíåÊï∞ÊçÆ‰øùÂ≠òÂú®Âêå‰∏Ä‰∏™ B+ Ê†ë‰∏≠ÔºåÂõ†Ê≠§‰ªéËÅöÁ∞áÁ¥¢Âºï‰∏≠Ëé∑ÂèñÊï∞ÊçÆÊØîÈùûËÅöÁ∞áÁ¥¢ÂºïÊõ¥Âø´</li><li>ËÅöÁ∞áÁ¥¢ÂºïÂØπ‰∫é‰∏ªÈîÆÁöÑÊéíÂ∫èÊü•ÊâæÂíåËåÉÂõ¥Êü•ÊâæÈÄüÂ∫¶ÈùûÂ∏∏Âø´</li></ul><p>ËÅöÁ∞áÁ¥¢ÂºïÁöÑÁº∫ÁÇπÔºö</p><ul><li>ÊèíÂÖ•ÈÄüÂ∫¶‰∏•Èáç‰æùËµñ‰∫éÊèíÂÖ•È°∫Â∫èÔºåÊåâÁÖß‰∏ªÈîÆÁöÑÈ°∫Â∫èÔºàÈÄíÂ¢ûÔºâÊèíÂÖ•ÊòØÊúÄÂø´ÁöÑÊñπÂºèÔºåÂê¶ÂàôÂ∞Ü‰ºöÂá∫Áé∞È°µÂàÜË£ÇÔºå‰∏•ÈáçÂΩ±ÂìçÊÄßËÉΩÔºåÊâÄ‰ª•ÂØπ‰∫é InnoDB Ë°®Ôºå‰∏ÄËà¨ÈÉΩ‰ºöÂÆö‰πâ‰∏Ä‰∏™Ëá™Â¢ûÁöÑ ID Âàó‰∏∫‰∏ªÈîÆ</li><li>Êõ¥Êñ∞‰∏ªÈîÆÁöÑ‰ª£‰ª∑ÂæàÈ´òÔºåÂ∞Ü‰ºöÂØºËá¥Ë¢´Êõ¥Êñ∞ÁöÑË°åÁßªÂä®ÔºåÊâÄ‰ª•ÂØπ‰∫é InnoDB Ë°®Ôºå‰∏ÄËà¨ÂÆö‰πâ‰∏ªÈîÆ‰∏∫‰∏çÂèØÊõ¥Êñ∞</li><li>‰∫åÁ∫ßÁ¥¢ÂºïËÆøÈóÆÈúÄË¶Å‰∏§Ê¨°Á¥¢ÂºïÊü•ÊâæÔºåÁ¨¨‰∏ÄÊ¨°ÊâæÂà∞‰∏ªÈîÆÂÄºÔºåÁ¨¨‰∫åÊ¨°Ê†πÊçÆ‰∏ªÈîÆÂÄºÊâæÂà∞Ë°åÊï∞ÊçÆ</li></ul><hr><h5 id="ËæÖÂä©Á¥¢Âºï" tabindex="-1"><a class="header-anchor" href="#ËæÖÂä©Á¥¢Âºï"><span>ËæÖÂä©Á¥¢Âºï</span></a></h5><p>Âú®ËÅöÁ∞áÁ¥¢Âºï‰πã‰∏äÂàõÂª∫ÁöÑÁ¥¢ÂºïÁß∞‰πã‰∏∫ËæÖÂä©Á¥¢ÂºïÔºåÈùûËÅöÁ∞áÁ¥¢ÂºïÈÉΩÊòØËæÖÂä©Á¥¢ÂºïÔºåÂÉèÂ§çÂêàÁ¥¢Âºï„ÄÅÂâçÁºÄÁ¥¢Âºï„ÄÅÂîØ‰∏ÄÁ¥¢ÂºïÁ≠â</p><p>ËæÖÂä©Á¥¢ÂºïÂè∂Â≠êËäÇÁÇπÂ≠òÂÇ®ÁöÑÊòØ‰∏ªÈîÆÂÄºÔºåËÄå‰∏çÊòØÊï∞ÊçÆÁöÑÁâ©ÁêÜÂú∞ÂùÄÔºåÊâÄ‰ª•ËÆøÈóÆÊï∞ÊçÆÈúÄË¶Å‰∫åÊ¨°Êü•ÊâæÔºåÊé®Ëçê‰ΩøÁî®Ë¶ÜÁõñÁ¥¢ÂºïÔºåÂèØ‰ª•ÂáèÂ∞ëÂõûË°®Êü•ËØ¢</p><p><strong>Ê£ÄÁ¥¢ËøáÁ®ã</strong>ÔºöËæÖÂä©Á¥¢ÂºïÊâæÂà∞‰∏ªÈîÆÂÄºÔºåÂÜçÈÄöËøáËÅöÁ∞áÁ¥¢ÂºïÔºà‰∫åÂàÜÔºâÊâæÂà∞Êï∞ÊçÆÈ°µÔºåÊúÄÂêéÈÄöËøáÊï∞ÊçÆÈ°µ‰∏≠ÁöÑ Page DirectoryÔºà‰∫åÂàÜÔºâÊâæÂà∞ÂØπÂ∫îÁöÑÊï∞ÊçÆÂàÜÁªÑÔºåÈÅçÂéÜÁªÑÂÜÖÊâÄÊâÄÊúâÁöÑÊï∞ÊçÆÊâæÂà∞Êï∞ÊçÆË°å</p><p>Ë°•ÂÖÖÔºöÊó†Á¥¢ÂºïËµ∞ÂÖ®Ë°®Êü•ËØ¢ÔºåÊü•Âà∞Êï∞ÊçÆÈ°µÂêéÂíå‰∏äËø∞Ê≠•È™§‰∏ÄËá¥</p><hr><h5 id="Á¥¢ÂºïÂÆûÁé∞" tabindex="-1"><a class="header-anchor" href="#Á¥¢ÂºïÂÆûÁé∞"><span>Á¥¢ÂºïÂÆûÁé∞</span></a></h5><p>InnoDB ‰ΩøÁî® B+Tree ‰Ωú‰∏∫Á¥¢ÂºïÁªìÊûÑÔºåÂπ∂‰∏î InnoDB ‰∏ÄÂÆöÊúâÁ¥¢Âºï</p><p>‰∏ªÈîÆÁ¥¢ÂºïÔºö</p><ul><li>Âú® InnoDB ‰∏≠ÔºåË°®Êï∞ÊçÆÊñá‰ª∂Êú¨Ë∫´Â∞±ÊòØÊåâ B+Tree ÁªÑÁªáÁöÑ‰∏Ä‰∏™Á¥¢ÂºïÁªìÊûÑÔºåËøô‰∏™Á¥¢ÂºïÁöÑ key ÊòØÊï∞ÊçÆË°®ÁöÑ‰∏ªÈîÆÔºåÂè∂Â≠êËäÇÁÇπ data Âüü‰øùÂ≠ò‰∫ÜÂÆåÊï¥ÁöÑÊï∞ÊçÆËÆ∞ÂΩï</li><li>InnoDB ÁöÑË°®Êï∞ÊçÆÊñá‰ª∂<strong>ÈÄöËøá‰∏ªÈîÆËÅöÈõÜÊï∞ÊçÆ</strong>ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÆö‰πâ‰∏ªÈîÆÔºå‰ºöÈÄâÊã©ÈùûÁ©∫ÂîØ‰∏ÄÁ¥¢Âºï‰ª£ÊõøÔºåÂ¶ÇÊûú‰πüÊ≤°ÊúâËøôÊ†∑ÁöÑÂàóÔºåMySQL ‰ºöËá™Âä®‰∏∫ InnoDB Ë°®ÁîüÊàê‰∏Ä‰∏™<strong>ÈöêÂê´Â≠óÊÆµ row_id</strong> ‰Ωú‰∏∫‰∏ªÈîÆÔºåËøô‰∏™Â≠óÊÆµÈïøÂ∫¶‰∏∫ 6 ‰∏™Â≠óËäÇÔºåÁ±ªÂûã‰∏∫ÈïøÊï¥ÂΩ¢</li></ul><p>ËæÖÂä©Á¥¢ÂºïÔºö</p><ul><li>InnoDB ÁöÑÊâÄÊúâËæÖÂä©Á¥¢ÂºïÔºà‰∫åÁ∫ßÁ¥¢ÂºïÔºâÈÉΩÂºïÁî®‰∏ªÈîÆ‰Ωú‰∏∫ data Âüü</li><li>InnoDB Ë°®ÊòØÂü∫‰∫éËÅöÁ∞áÁ¥¢ÂºïÂª∫Á´ãÁöÑÔºåÂõ†Ê≠§ InnoDB ÁöÑÁ¥¢ÂºïËÉΩÊèê‰æõ‰∏ÄÁßçÈùûÂ∏∏Âø´ÈÄüÁöÑ‰∏ªÈîÆÊü•ÊâæÊÄßËÉΩ„ÄÇ‰∏çËøáËæÖÂä©Á¥¢Âºï‰πü‰ºöÂåÖÂê´‰∏ªÈîÆÂàóÔºåÊâÄ‰ª•‰∏çÂª∫ËÆÆ‰ΩøÁî®ËøáÈïøÁöÑÂ≠óÊÆµ‰Ωú‰∏∫‰∏ªÈîÆÔºå<strong>ËøáÈïøÁöÑ‰∏ªÁ¥¢Âºï‰ºö‰ª§ËæÖÂä©Á¥¢ÂºïÂèòÂæóËøáÂ§ß</strong></li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDBËÅöÁ∞áÂíåËæÖÂä©Á¥¢ÂºïÁªìÊûÑ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h4 id="myisam" tabindex="-1"><a class="header-anchor" href="#myisam"><span>MyISAM</span></a></h4><h5 id="ÈùûËÅöÁ∞á" tabindex="-1"><a class="header-anchor" href="#ÈùûËÅöÁ∞á"><span>ÈùûËÅöÁ∞á</span></a></h5><p>MyISAM ÁöÑ‰∏ªÈîÆÁ¥¢Âºï‰ΩøÁî®ÁöÑÊòØÈùûËÅöÁ∞áÁ¥¢ÂºïÔºåÁ¥¢ÂºïÊñá‰ª∂ÂíåÊï∞ÊçÆÊñá‰ª∂ÊòØÂàÜÁ¶ªÁöÑÔºå<strong>Á¥¢ÂºïÊñá‰ª∂‰ªÖ‰øùÂ≠òÊï∞ÊçÆÁöÑÂú∞ÂùÄ</strong></p><ul><li>‰∏ªÈîÆÁ¥¢Âºï B+ Ê†ëÁöÑËäÇÁÇπÂ≠òÂÇ®‰∫Ü‰∏ªÈîÆÔºåËæÖÂä©ÈîÆÁ¥¢Âºï B+ Ê†ëÂ≠òÂÇ®‰∫ÜËæÖÂä©ÈîÆÔºåË°®Êï∞ÊçÆÂ≠òÂÇ®Âú®Áã¨Á´ãÁöÑÂú∞ÊñπÔºåËøô‰∏§È¢ó B+ Ê†ëÁöÑÂè∂Â≠êËäÇÁÇπÈÉΩ‰ΩøÁî®‰∏Ä‰∏™Âú∞ÂùÄÊåáÂêëÁúüÊ≠£ÁöÑË°®Êï∞ÊçÆÔºåÂØπ‰∫éË°®Êï∞ÊçÆÊù•ËØ¥ÔºåËøô‰∏§‰∏™ÈîÆÊ≤°Êúâ‰ªª‰ΩïÂ∑ÆÂà´</li><li>Áî±‰∫éÁ¥¢ÂºïÊ†ëÊòØÁã¨Á´ãÁöÑÔºåÈÄöËøáËæÖÂä©Á¥¢ÂºïÊ£ÄÁ¥¢<strong>Êó†ÈúÄÂõûË°®Êü•ËØ¢</strong>ËÆøÈóÆ‰∏ªÈîÆÁöÑÁ¥¢ÂºïÊ†ë</li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ËÅöÁ∞áÁ¥¢ÂºïÂíåËæÖÂä©Á¥¢ÂºïÊ£ÄÈîÅÊï∞ÊçÆÂõæ.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h5 id="Á¥¢ÂºïÂÆûÁé∞-1" tabindex="-1"><a class="header-anchor" href="#Á¥¢ÂºïÂÆûÁé∞-1"><span>Á¥¢ÂºïÂÆûÁé∞</span></a></h5><p>MyISAM ÁöÑÁ¥¢ÂºïÊñπÂºè‰πüÂè´ÂÅöÈùûËÅöÈõÜÁöÑÔºå‰πãÊâÄ‰ª•Ëøô‰πàÁß∞ÂëºÊòØ‰∏∫‰∫Ü‰∏é InnoDB ÁöÑËÅöÈõÜÁ¥¢ÂºïÂå∫ÂàÜ</p><p>‰∏ªÈîÆÁ¥¢ÂºïÔºöMyISAM ÂºïÊìé‰ΩøÁî® B+Tree ‰Ωú‰∏∫Á¥¢ÂºïÁªìÊûÑÔºåÂè∂ËäÇÁÇπÁöÑ data ÂüüÂ≠òÊîæÁöÑÊòØÊï∞ÊçÆËÆ∞ÂΩïÁöÑÂú∞ÂùÄ</p><p>ËæÖÂä©Á¥¢ÂºïÔºöMyISAM ‰∏≠‰∏ªÁ¥¢ÂºïÂíåËæÖÂä©Á¥¢ÂºïÔºàSecondary keyÔºâÂú®ÁªìÊûÑ‰∏äÊ≤°Êúâ‰ªª‰ΩïÂå∫Âà´ÔºåÂè™ÊòØ‰∏ªÁ¥¢ÂºïË¶ÅÊ±Ç key ÊòØÂîØ‰∏ÄÁöÑÔºåËÄåËæÖÂä©Á¥¢ÂºïÁöÑ key ÂèØ‰ª•ÈáçÂ§ç</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM‰∏ªÈîÆÂíåËæÖÂä©Á¥¢ÂºïÁªìÊûÑ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://blog.csdn.net/lm1060891265/article/details/81482136</p><hr><h3 id="Á¥¢ÂºïÁªìÊûÑ" tabindex="-1"><a class="header-anchor" href="#Á¥¢ÂºïÁªìÊûÑ"><span>Á¥¢ÂºïÁªìÊûÑ</span></a></h3><h4 id="Êï∞ÊçÆÈ°µ" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÈ°µ"><span>Êï∞ÊçÆÈ°µ</span></a></h4><p>Êñá‰ª∂Á≥ªÁªüÁöÑÊúÄÂ∞èÂçïÂÖÉÊòØÂùóÔºàblockÔºâÔºå‰∏Ä‰∏™ÂùóÁöÑÂ§ßÂ∞èÊòØ 4KÔºåÁ≥ªÁªü‰ªéÁ£ÅÁõòËØªÂèñÊï∞ÊçÆÂà∞ÂÜÖÂ≠òÊó∂ÊòØ‰ª•Á£ÅÁõòÂùó‰∏∫Âü∫Êú¨Âçï‰ΩçÁöÑÔºå‰Ωç‰∫éÂêå‰∏Ä‰∏™Á£ÅÁõòÂùó‰∏≠ÁöÑÊï∞ÊçÆ‰ºöË¢´‰∏ÄÊ¨°ÊÄßËØªÂèñÂá∫Êù•ÔºåËÄå‰∏çÊòØÈúÄË¶Å‰ªÄ‰πàÂèñ‰ªÄ‰πà</p><p>InnoDB Â≠òÂÇ®ÂºïÊìé‰∏≠ÊúâÈ°µÔºàPageÔºâÁöÑÊ¶ÇÂøµÔºåÈ°µÊòØ MySQL Á£ÅÁõòÁÆ°ÁêÜÁöÑÊúÄÂ∞èÂçï‰Ωç</p><ul><li><strong>InnoDB Â≠òÂÇ®ÂºïÊìé‰∏≠ÈªòËÆ§ÊØè‰∏™È°µÁöÑÂ§ßÂ∞è‰∏∫ 16KBÔºåÁ¥¢Âºï‰∏≠‰∏Ä‰∏™ËäÇÁÇπÂ∞±ÊòØ‰∏Ä‰∏™Êï∞ÊçÆÈ°µ</strong>ÔºåÊâÄ‰ª•‰ºö‰∏ÄÊ¨°ÊÄßËØªÂèñ 16KB ÁöÑÊï∞ÊçÆÂà∞ÂÜÖÂ≠ò</li><li>InnoDB ÂºïÊìéÂ∞ÜËã•Âπ≤‰∏™Âú∞ÂùÄËøûÊé•Á£ÅÁõòÂùóÔºå‰ª•Ê≠§Êù•ËææÂà∞È°µÁöÑÂ§ßÂ∞è 16KB</li><li>Âú®Êü•ËØ¢Êï∞ÊçÆÊó∂Â¶ÇÊûú‰∏Ä‰∏™È°µ‰∏≠ÁöÑÊØèÊù°Êï∞ÊçÆÈÉΩËÉΩÊúâÂä©‰∫éÂÆö‰ΩçÊï∞ÊçÆËÆ∞ÂΩïÁöÑ‰ΩçÁΩÆÔºåËøôÂ∞Ü‰ºöÂáèÂ∞ëÁ£ÅÁõò I/O Ê¨°Êï∞ÔºåÊèêÈ´òÊü•ËØ¢ÊïàÁéá</li></ul><p>Ë∂ÖËøá 16KB ÁöÑ‰∏ÄÊù°ËÆ∞ÂΩïÔºå‰∏ªÈîÆÁ¥¢ÂºïÈ°µÂè™‰ºöÂ≠òÂÇ®ÈÉ®ÂàÜÊï∞ÊçÆÂíåÊåáÂêë<strong>Ê∫¢Âá∫È°µ</strong>ÁöÑÊåáÈíàÔºåÂâ©‰ΩôÊï∞ÊçÆÈÉΩ‰ºöÂàÜÊï£Â≠òÂÇ®Âú®Ê∫¢Âá∫È°µ‰∏≠</p><p>Êï∞ÊçÆÈ°µÁâ©ÁêÜÁªìÊûÑÔºå‰ªé‰∏äÂà∞‰∏ãÔºö</p><ul><li>File HeaderÔºö‰∏ä‰∏ÄÈ°µÂíå‰∏ã‰∏ÄÈ°µÁöÑÊåáÈíà„ÄÅËØ•È°µÁöÑÁ±ªÂûãÔºàÁ¥¢ÂºïÈ°µ„ÄÅÊï∞ÊçÆÈ°µ„ÄÅÊó•ÂøóÈ°µÁ≠âÔºâ„ÄÅ<strong>Ê†°È™åÂíå</strong>„ÄÅLSNÔºàÊúÄËøë‰∏ÄÊ¨°‰øÆÊîπÂΩìÂâçÈ°µÈù¢Êó∂ÁöÑÁ≥ªÁªü lsn ÂÄºÔºå‰∫ãÂä°ÊåÅ‰πÖÊÄßÈÉ®ÂàÜËØ¶Ëß£ÔºâÁ≠â‰ø°ÊÅØ</li><li>Page HeaderÔºöËÆ∞ÂΩïÁä∂ÊÄÅ‰ø°ÊÅØ</li><li>Infimum + SupremumÔºöÂΩìÂâçÈ°µÁöÑÊúÄÂ∞èËÆ∞ÂΩïÂíåÊúÄÂ§ßËÆ∞ÂΩïÔºàÂ§¥Â∞æÊåáÈíàÔºâÔºåInfimum ÊâÄÂú®ÂàÜÁªÑÂè™Êúâ‰∏ÄÊù°ËÆ∞ÂΩïÔºåSupremum ÊâÄÂú®ÂàÜÁªÑÂèØ‰ª•Êúâ 1 ~ 8 Êù°ËÆ∞ÂΩïÔºåÂâ©‰ΩôÁöÑÂàÜÁªÑÂèØ‰ª•Êúâ 4 ~ 8 Êù°ËÆ∞ÂΩï</li><li>User RecordsÔºöÂ≠òÂÇ®Êï∞ÊçÆÁöÑËÆ∞ÂΩï</li><li>Free SpaceÔºöÂ∞öÊú™‰ΩøÁî®ÁöÑÂ≠òÂÇ®Á©∫Èó¥</li><li>Page DirectoryÔºöÂàÜÁªÑÁöÑÁõÆÂΩïÔºåÂèØ‰ª•ÈÄöËøáÁõÆÂΩïÂø´ÈÄüÂÆö‰ΩçÔºà‰∫åÂàÜÊ≥ïÔºâÊï∞ÊçÆÁöÑÂàÜÁªÑ</li><li>File TrailerÔºöÊ£ÄÈ™åÂíåÂ≠óÊÆµÔºåÂú®Âà∑ËÑèËøáÁ®ã‰∏≠ÔºåÈ°µÈ¶ñÂíåÈ°µÂ∞æÁöÑÊ†°È™åÂíå‰∏ÄËá¥ÊâçËÉΩËØ¥ÊòéÈ°µÈù¢Âà∑Êñ∞ÊàêÂäüÔºå‰∫åËÄÖ‰∏çÂêåËØ¥ÊòéÂà∑Êñ∞ÊúüÈó¥ÂèëÁîü‰∫ÜÈîôËØØÔºõLSN Â≠óÊÆµÔºå‰πüÊòØÁî®Êù•Ê†°È™åÈ°µÈù¢ÁöÑÂÆåÊï¥ÊÄß</li></ul><p>Êï∞ÊçÆÈ°µ‰∏≠ÂåÖÂê´Êï∞ÊçÆË°åÔºåÊï∞ÊçÆÁöÑÂ≠òÂÇ®ÊòØÂü∫‰∫éÊï∞ÊçÆË°åÁöÑÔºåÊï∞ÊçÆË°åÊúâ next_record Â±ûÊÄßÊåáÂêë‰∏ã‰∏Ä‰∏™Ë°åÊï∞ÊçÆÔºåÊâÄ‰ª•ÊòØÂèØ‰ª•ÈÅçÂéÜÁöÑÔºå‰ΩÜÊòØ‰∏ÄÁªÑÊï∞ÊçÆËá≥Â§ö 8 ‰∏™Ë°åÔºåÈÄöËøá Page Directory ÂÖàÂÆö‰ΩçÂà∞ÁªÑÔºåÁÑ∂ÂêéÈÅçÂéÜËé∑ÂèñÊâÄÈúÄÁöÑÊï∞ÊçÆË°åÂç≥ÂèØ</p><p>Êï∞ÊçÆË°å‰∏≠Êúâ‰∏â‰∏™ÈöêËóèÂ≠óÊÆµÔºötrx_id„ÄÅroll_pointer„ÄÅrow_idÔºàÂú®‰∫ãÂä°Á´†ËäÇ‰ºöËØ¶ÁªÜ‰ªãÁªçÂÆÉ‰ª¨ÁöÑ‰ΩúÁî®Ôºâ</p><hr><h4 id="btree" tabindex="-1"><a class="header-anchor" href="#btree"><span>BTree</span></a></h4><p>BTree ÁöÑÁ¥¢ÂºïÁ±ªÂûãÊòØÂü∫‰∫é B+Tree Ê†ëÂûãÊï∞ÊçÆÁªìÊûÑÁöÑÔºåB+Tree ÂèàÊòØ BTree Êï∞ÊçÆÁªìÊûÑÁöÑÂèòÁßçÔºåÁî®Âú®Êï∞ÊçÆÂ∫ìÂíåÊìç‰ΩúÁ≥ªÁªü‰∏≠ÁöÑÊñá‰ª∂Á≥ªÁªüÔºåÁâπÁÇπÊòØËÉΩÂ§ü‰øùÊåÅÊï∞ÊçÆÁ®≥ÂÆöÊúâÂ∫è</p><p>BTree ÂèàÂè´Â§öË∑ØÂπ≥Ë°°ÊêúÁ¥¢Ê†ëÔºå‰∏ÄÈ¢ó m ÂèâÁöÑ BTree ÁâπÊÄßÂ¶Ç‰∏ãÔºö</p><ul><li>Ê†ë‰∏≠ÊØè‰∏™ËäÇÁÇπÊúÄÂ§öÂåÖÂê´ m ‰∏™Â≠©Â≠ê</li><li>Èô§Ê†πËäÇÁÇπ‰∏éÂè∂Â≠êËäÇÁÇπÂ§ñÔºåÊØè‰∏™ËäÇÁÇπËá≥Â∞ëÊúâ [ceil(m/2)] ‰∏™Â≠©Â≠ê</li><li>Ëã•Ê†πËäÇÁÇπ‰∏çÊòØÂè∂Â≠êËäÇÁÇπÔºåÂàôËá≥Â∞ëÊúâ‰∏§‰∏™Â≠©Â≠ê</li><li>ÊâÄÊúâÁöÑÂè∂Â≠êËäÇÁÇπÈÉΩÂú®Âêå‰∏ÄÂ±Ç</li><li>ÊØè‰∏™ÈùûÂè∂Â≠êËäÇÁÇπÁî± n ‰∏™ key ‰∏é n+1 ‰∏™ÊåáÈíàÁªÑÊàêÔºåÂÖ∂‰∏≠ [ceil(m/2)-1] &lt;= n &lt;= m-1</li></ul><p>5 ÂèâÔºåkey ÁöÑÊï∞Èáè [ceil(m/2)-1] &lt;= n &lt;= m-1 ‰∏∫ 2 &lt;= n &lt;=4 ÔºåÂΩì n&gt;4 Êó∂‰∏≠Èó¥ËäÇÁÇπÂàÜË£ÇÂà∞Áà∂ËäÇÁÇπÔºå‰∏§ËæπËäÇÁÇπÂàÜË£Ç</p><p>ÊèíÂÖ• C N G A H E K Q M F W L T Z D P R X Y S Êï∞ÊçÆÁöÑÂ∑•‰ΩúÊµÅÁ®ãÔºö</p><ul><li><p>ÊèíÂÖ•Ââç 4 ‰∏™Â≠óÊØç C N G A</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTreeÂ∑•‰ΩúÊµÅÁ®ã1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>ÊèíÂÖ• HÔºån&gt;4Ôºå‰∏≠Èó¥ÂÖÉÁ¥† G Â≠óÊØçÂêë‰∏äÂàÜË£ÇÂà∞Êñ∞ÁöÑËäÇÁÇπ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTreeÂ∑•‰ΩúÊµÅÁ®ã2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>ÊèíÂÖ• E„ÄÅK„ÄÅQ ‰∏çÈúÄË¶ÅÂàÜË£Ç</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTreeÂ∑•‰ΩúÊµÅÁ®ã3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>ÊèíÂÖ• MÔºå‰∏≠Èó¥ÂÖÉÁ¥† M Â≠óÊØçÂêë‰∏äÂàÜË£ÇÂà∞Áà∂ËäÇÁÇπ G</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTreeÂ∑•‰ΩúÊµÅÁ®ã4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>ÊèíÂÖ• FÔºåWÔºåLÔºåT ‰∏çÈúÄË¶ÅÂàÜË£Ç</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTreeÂ∑•‰ΩúÊµÅÁ®ã5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>ÊèíÂÖ• ZÔºå‰∏≠Èó¥ÂÖÉÁ¥† T Âêë‰∏äÂàÜË£ÇÂà∞Áà∂ËäÇÁÇπ‰∏≠</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTreeÂ∑•‰ΩúÊµÅÁ®ã6.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>ÊèíÂÖ• DÔºå‰∏≠Èó¥ÂÖÉÁ¥† D Âêë‰∏äÂàÜË£ÇÂà∞Áà∂ËäÇÁÇπ‰∏≠ÔºåÁÑ∂ÂêéÊèíÂÖ• PÔºåRÔºåXÔºåY ‰∏çÈúÄË¶ÅÂàÜË£Ç</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTreeÂ∑•‰ΩúÊµÅÁ®ã7.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>ÊúÄÂêéÊèíÂÖ• SÔºåNPQR ËäÇÁÇπ n&gt;5Ôºå‰∏≠Èó¥ËäÇÁÇπ Q Âêë‰∏äÂàÜË£ÇÔºå‰ΩÜÂàÜË£ÇÂêéÁà∂ËäÇÁÇπ DGMT ÁöÑ n&gt;5Ôºå‰∏≠Èó¥ËäÇÁÇπ M Âêë‰∏äÂàÜË£Ç</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BTreeÂ∑•‰ΩúÊµÅÁ®ã8.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><p>BTree Ê†ëÂ∞±Â∑≤ÁªèÊûÑÂª∫ÂÆåÊàê‰∫ÜÔºåBTree Ê†ëÂíå‰∫åÂèâÊ†ëÁõ∏ÊØîÔºå Êü•ËØ¢Êï∞ÊçÆÁöÑÊïàÁéáÊõ¥È´òÔºå Âõ†‰∏∫ÂØπ‰∫éÁõ∏ÂêåÁöÑÊï∞ÊçÆÈáèÊù•ËØ¥Ôºå<strong>BTree ÁöÑÂ±ÇÁ∫ßÁªìÊûÑÊØî‰∫åÂèâÊ†ëÂ∞ë</strong>ÔºåÊâÄ‰ª•ÊêúÁ¥¢ÈÄüÂ∫¶Âø´</p><p>BTree ÁªìÊûÑÁöÑÊï∞ÊçÆÂèØ‰ª•ËÆ©Á≥ªÁªüÈ´òÊïàÁöÑÊâæÂà∞Êï∞ÊçÆÊâÄÂú®ÁöÑÁ£ÅÁõòÂùóÔºåÂÆö‰πâ‰∏ÄÊù°ËÆ∞ÂΩï‰∏∫‰∏Ä‰∏™‰∫åÂÖÉÁªÑ [key, data] Ôºåkey ‰∏∫ËÆ∞ÂΩïÁöÑÈîÆÂÄºÔºåÂØπÂ∫îË°®‰∏≠ÁöÑ‰∏ªÈîÆÂÄºÔºådata ‰∏∫‰∏ÄË°åËÆ∞ÂΩï‰∏≠Èô§‰∏ªÈîÆÂ§ñÁöÑÊï∞ÊçÆ„ÄÇÂØπ‰∫é‰∏çÂêåÁöÑËÆ∞ÂΩïÔºåkey ÂÄº‰∫í‰∏çÁõ∏ÂêåÔºåBTree ‰∏≠ÁöÑÊØè‰∏™ËäÇÁÇπÊ†πÊçÆÂÆûÈôÖÊÉÖÂÜµÂèØ‰ª•ÂåÖÂê´Â§ßÈáèÁöÑÂÖ≥ÈîÆÂ≠ó‰ø°ÊÅØÂíåÂàÜÊîØ <img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Á¥¢ÂºïÁöÑÂéüÁêÜ1.png" alt="" loading="lazy"></p><p>Áº∫ÁÇπÔºöÂΩìËøõË°åËåÉÂõ¥Êü•ÊâæÊó∂‰ºöÂá∫Áé∞ÂõûÊóãÊü•Êâæ</p><hr><h4 id="b-tree" tabindex="-1"><a class="header-anchor" href="#b-tree"><span>B+Tree</span></a></h4><h5 id="Êï∞ÊçÆÁªìÊûÑ" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÁªìÊûÑ"><span>Êï∞ÊçÆÁªìÊûÑ</span></a></h5><p>BTree Êï∞ÊçÆÁªìÊûÑ‰∏≠ÊØè‰∏™ËäÇÁÇπ‰∏≠‰∏ç‰ªÖÂåÖÂê´Êï∞ÊçÆÁöÑ key ÂÄºÔºåËøòÊúâ data ÂÄº„ÄÇÁ£ÅÁõò‰∏≠ÊØè‰∏ÄÈ°µÁöÑÂ≠òÂÇ®Á©∫Èó¥ÊòØÊúâÈôêÁöÑÔºåÂ¶ÇÊûú data Êï∞ÊçÆËæÉÂ§ßÊó∂Â∞Ü‰ºöÂØºËá¥ÊØè‰∏™ËäÇÁÇπÔºàÂç≥‰∏Ä‰∏™È°µÔºâËÉΩÂ≠òÂÇ®ÁöÑ key ÁöÑÊï∞ÈáèÂæàÂ∞èÔºåÂΩìÂ≠òÂÇ®ÁöÑÊï∞ÊçÆÈáèÂæàÂ§ßÊó∂ÂêåÊ†∑‰ºöÂØºËá¥ B-Tree ÁöÑÊ∑±Â∫¶ËæÉÂ§ßÔºåÂ¢ûÂ§ßÊü•ËØ¢Êó∂ÁöÑÁ£ÅÁõò I/O Ê¨°Êï∞ÔºåËøõËÄåÂΩ±ÂìçÊü•ËØ¢ÊïàÁéáÔºåÊâÄ‰ª•ÂºïÂÖ• B+Tree</p><p>B+Tree ‰∏∫ BTree ÁöÑÂèòÁßçÔºåB+Tree ‰∏é BTree ÁöÑÂå∫Âà´‰∏∫Ôºö</p><ul><li><p>n Âèâ B+Tree ÊúÄÂ§öÂê´Êúâ n ‰∏™ keyÔºàÂìàÂ∏åÂÄºÔºâÔºåËÄå BTree ÊúÄÂ§öÂê´Êúâ n-1 ‰∏™ key</p></li><li><p>ÊâÄÊúâ<strong>ÈùûÂè∂Â≠êËäÇÁÇπÂè™Â≠òÂÇ®ÈîÆÂÄº key</strong> ‰ø°ÊÅØÔºåÂè™ËøõË°åÊï∞ÊçÆÁ¥¢ÂºïÔºå‰ΩøÊØè‰∏™ÈùûÂè∂Â≠êËäÇÁÇπÊâÄËÉΩ‰øùÂ≠òÁöÑÂÖ≥ÈîÆÂ≠óÂ§ßÂ§ßÂ¢ûÂä†</p></li><li><p>ÊâÄÊúâ<strong>Êï∞ÊçÆÈÉΩÂ≠òÂÇ®Âú®Âè∂Â≠êËäÇÁÇπ</strong>ÔºåÊâÄ‰ª•ÊØèÊ¨°Êï∞ÊçÆÊü•ËØ¢ÁöÑÊ¨°Êï∞ÈÉΩ‰∏ÄÊ†∑</p></li><li><p><strong>Âè∂Â≠êËäÇÁÇπÊåâÁÖß key Â§ßÂ∞èÈ°∫Â∫èÊéíÂàóÔºåÂ∑¶ËæπÁªìÂ∞æÊï∞ÊçÆÈÉΩ‰ºö‰øùÂ≠òÂè≥ËæπËäÇÁÇπÂºÄÂßãÊï∞ÊçÆÁöÑÊåáÈíàÔºåÂΩ¢Êàê‰∏Ä‰∏™ÈìæË°®</strong></p></li><li><p>ÊâÄÊúâËäÇÁÇπ‰∏≠ÁöÑ key Âú®Âè∂Â≠êËäÇÁÇπ‰∏≠‰πüÂ≠òÂú®ÔºàÊØîÂ¶Ç 5)Ôºå<strong>key ÂÖÅËÆ∏ÈáçÂ§ç</strong>ÔºåB Ê†ë‰∏çÂêåËäÇÁÇπ‰∏çÂ≠òÂú®ÈáçÂ§çÁöÑ key</p></li></ul><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-BÂä†TreeÊï∞ÊçÆÁªìÊûÑ.png" style="zoom:67%;"><p>B* Ê†ëÔºöÊòØ B+ Ê†ëÁöÑÂèò‰ΩìÔºåÂú® B+ Ê†ëÁöÑÈùûÊ†πÂíåÈùûÂè∂Â≠êÁªìÁÇπÂÜçÂ¢ûÂä†ÊåáÂêëÂÖÑÂºüÁöÑÊåáÈíà</p><hr><h5 id="‰ºòÂåñÁªìÊûÑ" tabindex="-1"><a class="header-anchor" href="#‰ºòÂåñÁªìÊûÑ"><span>‰ºòÂåñÁªìÊûÑ</span></a></h5><p>MySQL Á¥¢ÂºïÊï∞ÊçÆÁªìÊûÑÂØπÁªèÂÖ∏ÁöÑ B+Tree ËøõË°å‰∫Ü‰ºòÂåñÔºåÂú®Âéü B+Tree ÁöÑÂü∫Á°Ä‰∏äÔºåÂ¢ûÂä†‰∏Ä‰∏™ÊåáÂêëÁõ∏ÈÇªÂè∂Â≠êËäÇÁÇπÁöÑÈìæË°®ÊåáÈíàÔºåÂ∞±ÂΩ¢Êàê‰∫ÜÂ∏¶ÊúâÈ°∫Â∫èÊåáÈíàÁöÑ B+TreeÔºå<strong>ÊèêÈ´òÂå∫Èó¥ËÆøÈóÆÁöÑÊÄßËÉΩÔºåÈò≤Ê≠¢ÂõûÊóãÊü•Êâæ</strong></p><p>Âå∫Èó¥ËÆøÈóÆÁöÑÊÑèÊÄùÊòØËÆøÈóÆÁ¥¢Âºï‰∏∫ 5 - 15 ÁöÑÊï∞ÊçÆÔºåÂèØ‰ª•Áõ¥Êé•Ê†πÊçÆÁõ∏ÈÇªËäÇÁÇπÁöÑÊåáÈíàÈÅçÂéÜ</p><p>B+ Ê†ëÁöÑ<strong>Âè∂Â≠êËäÇÁÇπÊòØÊï∞ÊçÆÈ°µ</strong>ÔºàpageÔºâÔºå‰∏Ä‰∏™È°µÈáåÈù¢ÂèØ‰ª•Â≠òÂ§ö‰∏™Êï∞ÊçÆË°å</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Á¥¢ÂºïÁöÑÂéüÁêÜ2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ÈÄöÂ∏∏Âú® B+Tree ‰∏äÊúâ‰∏§‰∏™Â§¥ÊåáÈíàÔºå<strong>‰∏Ä‰∏™ÊåáÂêëÊ†πËäÇÁÇπÔºåÂè¶‰∏Ä‰∏™ÊåáÂêëÂÖ≥ÈîÆÂ≠óÊúÄÂ∞èÁöÑÂè∂Â≠êËäÇÁÇπ</strong>ÔºåËÄå‰∏îÊâÄÊúâÂè∂Â≠êËäÇÁÇπÔºàÂç≥Êï∞ÊçÆËäÇÁÇπÔºâ‰πãÈó¥ÊòØ‰∏ÄÁßçÈìæÂºèÁéØÁªìÊûÑ„ÄÇÂèØ‰ª•ÂØπ B+Tree ËøõË°å‰∏§ÁßçÊü•ÊâæËøêÁÆóÔºö</p><ul><li>ÊúâËåÉÂõ¥ÔºöÂØπ‰∫é‰∏ªÈîÆÁöÑËåÉÂõ¥Êü•ÊâæÂíåÂàÜÈ°µÊü•Êâæ</li><li>ÊúâÈ°∫Â∫èÔºö‰ªéÊ†πËäÇÁÇπÂºÄÂßãÔºåËøõË°åÈöèÊú∫Êü•ÊâæÔºåÈ°∫Â∫èÊü•Êâæ</li></ul><p>InnoDB ‰∏≠ÊØè‰∏™Êï∞ÊçÆÈ°µÁöÑÂ§ßÂ∞èÈªòËÆ§ÊòØ 16KBÔºå</p><ul><li>Á¥¢ÂºïË°åÔºö‰∏ÄËà¨Ë°®ÁöÑ‰∏ªÈîÆÁ±ªÂûã‰∏∫ INTÔºà4 Â≠óËäÇÔºâÊàñ BIGINTÔºà8 Â≠óËäÇÔºâÔºåÊåáÈíàÂ§ßÂ∞èÂú® InnoDB ‰∏≠ËÆæÁΩÆ‰∏∫ 6 Â≠óËäÇËäÇÔºå‰πüÂ∞±ÊòØËØ¥‰∏Ä‰∏™È°µÂ§ßÊ¶ÇÂ≠òÂÇ® 16KB/(8B+6B)=1K ‰∏™ÈîÆÂÄºÔºà‰º∞ÂÄºÔºâ„ÄÇÂàô‰∏Ä‰∏™Ê∑±Â∫¶‰∏∫ 3 ÁöÑ B+Tree Á¥¢ÂºïÂèØ‰ª•Áª¥Êä§ <code>10^3 * 10^3 * 10^3 = 10‰∫ø</code> Êù°ËÆ∞ÂΩï</li><li>Êï∞ÊçÆË°åÔºö‰∏ÄË°åÊï∞ÊçÆÁöÑÂ§ßÂ∞èÂèØËÉΩÊòØ 1kÔºå‰∏Ä‰∏™Êï∞ÊçÆÈ°µÂèØ‰ª•Â≠òÂÇ® 16 Ë°å</li></ul><p>ÂÆûÈôÖÊÉÖÂÜµ‰∏≠ÊØè‰∏™ËäÇÁÇπÂèØËÉΩ‰∏çËÉΩÂ°´ÂÖÖÊª°ÔºåÂõ†Ê≠§Âú®Êï∞ÊçÆÂ∫ì‰∏≠ÔºåB+Tree ÁöÑÈ´òÂ∫¶‰∏ÄËà¨ÈÉΩÂú® 2-4 Â±Ç„ÄÇMySQL ÁöÑ InnoDB Â≠òÂÇ®ÂºïÊìéÂú®ËÆæËÆ°Êó∂ÊòØ<strong>Â∞ÜÊ†πËäÇÁÇπÂ∏∏È©ªÂÜÖÂ≠òÁöÑ</strong>Ôºå‰πüÂ∞±ÊòØËØ¥Êü•ÊâæÊüê‰∏ÄÈîÆÂÄºÁöÑË°åËÆ∞ÂΩïÊó∂ÊúÄÂ§öÂè™ÈúÄË¶Å 1~3 Ê¨°Á£ÅÁõò I/O Êìç‰Ωú</p><p>B+Tree ‰ºòÁÇπÔºöÊèêÈ´òÊü•ËØ¢ÈÄüÂ∫¶ÔºåÂáèÂ∞ëÁ£ÅÁõòÁöÑ IO Ê¨°Êï∞ÔºåÊ†ëÂΩ¢ÁªìÊûÑËæÉÂ∞è</p><hr><h5 id="Á¥¢ÂºïÁª¥Êä§" tabindex="-1"><a class="header-anchor" href="#Á¥¢ÂºïÁª¥Êä§"><span>Á¥¢ÂºïÁª¥Êä§</span></a></h5><p>B+ Ê†ë‰∏∫‰∫Ü‰øùÊåÅÁ¥¢ÂºïÁöÑÊúâÂ∫èÊÄßÔºåÂú®ÊèíÂÖ•Êñ∞ÂÄºÁöÑÊó∂ÂÄôÈúÄË¶ÅÂÅöÁõ∏Â∫îÁöÑÁª¥Êä§</p><p>ÊØè‰∏™Á¥¢Âºï‰∏≠ÊØè‰∏™ÂùóÂ≠òÂÇ®Âú®Á£ÅÁõòÈ°µ‰∏≠ÔºåÂèØËÉΩ‰ºöÂá∫Áé∞‰ª•‰∏ã‰∏§ÁßçÊÉÖÂÜµÔºö</p><ul><li>Â¶ÇÊûúÊâÄÂú®ÁöÑÊï∞ÊçÆÈ°µÂ∑≤ÁªèÊª°‰∫ÜÔºåËøôÊó∂ÂÄôÈúÄË¶ÅÁî≥ËØ∑‰∏Ä‰∏™Êñ∞ÁöÑÊï∞ÊçÆÈ°µÔºåÁÑ∂ÂêéÊå™Âä®ÈÉ®ÂàÜÊï∞ÊçÆËøáÂéªÔºåËøô‰∏™ËøáÁ®ãÁß∞‰∏∫<strong>È°µÂàÜË£Ç</strong>ÔºåÂéüÊú¨ÊîæÂú®‰∏Ä‰∏™È°µÁöÑÊï∞ÊçÆÁé∞Âú®ÂàÜÂà∞‰∏§‰∏™È°µ‰∏≠ÔºåÈôç‰Ωé‰∫ÜÁ©∫Èó¥Âà©Áî®Áéá</li><li>ÂΩìÁõ∏ÈÇª‰∏§‰∏™È°µÁî±‰∫éÂà†Èô§‰∫ÜÊï∞ÊçÆÔºåÂà©Áî®ÁéáÂæà‰Ωé‰πãÂêéÔºå‰ºöÂ∞ÜÊï∞ÊçÆÈ°µÂÅö<strong>È°µÂêàÂπ∂</strong>ÔºåÂêàÂπ∂ÁöÑËøáÁ®ãÂèØ‰ª•ËÆ§‰∏∫ÊòØÂàÜË£ÇËøáÁ®ãÁöÑÈÄÜËøáÁ®ã</li><li>Ëøô‰∏§‰∏™ÊÉÖÂÜµÈÉΩÊòØÁî± B+ Ê†ëÁöÑÁªìÊûÑÂÜ≥ÂÆöÁöÑ</li></ul><p>‰∏ÄËà¨ÈÄâÁî®Êï∞ÊçÆÂ∞èÁöÑÂ≠óÊÆµÂÅöÁ¥¢ÂºïÔºåÂ≠óÊÆµÈïøÂ∫¶Ë∂äÂ∞èÔºåÊôÆÈÄöÁ¥¢ÂºïÁöÑÂè∂Â≠êËäÇÁÇπÂ∞±Ë∂äÂ∞èÔºåÊôÆÈÄöÁ¥¢ÂºïÂç†Áî®ÁöÑÁ©∫Èó¥‰πüÂ∞±Ë∂äÂ∞è</p><p>Ëá™Â¢û‰∏ªÈîÆÁöÑÊèíÂÖ•Êï∞ÊçÆÊ®°ÂºèÔºåÂèØ‰ª•ËÆ©‰∏ªÈîÆÁ¥¢ÂºïÂ∞ΩÈáèÂú∞‰øùÊåÅÈÄíÂ¢ûÈ°∫Â∫èÊèíÂÖ•Ôºå‰∏çÊ∂âÂèäÂà∞Êå™Âä®ÂÖ∂‰ªñËÆ∞ÂΩïÔºå<strong>ÈÅøÂÖç‰∫ÜÈ°µÂàÜË£Ç</strong>ÔºåÈ°µÂàÜË£ÇÁöÑÁõÆÁöÑÂ∞±ÊòØ‰øùËØÅÂêé‰∏Ä‰∏™Êï∞ÊçÆÈ°µ‰∏≠ÁöÑÊâÄÊúâË°å‰∏ªÈîÆÂÄºÊØîÂâç‰∏Ä‰∏™Êï∞ÊçÆÈ°µ‰∏≠‰∏ªÈîÆÂÄºÂ§ß</p><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://developer.aliyun.com/article/919861</p><hr><h3 id="ËÆæËÆ°ÂéüÂàô" tabindex="-1"><a class="header-anchor" href="#ËÆæËÆ°ÂéüÂàô"><span>ËÆæËÆ°ÂéüÂàô</span></a></h3><p>Á¥¢ÂºïÁöÑËÆæËÆ°ÂèØ‰ª•ÈÅµÂæ™‰∏Ä‰∫õÂ∑≤ÊúâÁöÑÂéüÂàôÔºåÂàõÂª∫Á¥¢ÂºïÁöÑÊó∂ÂÄôËØ∑Â∞ΩÈáèËÄÉËôëÁ¨¶ÂêàËøô‰∫õÂéüÂàôÔºå‰æø‰∫éÊèêÂçáÁ¥¢ÂºïÁöÑ‰ΩøÁî®ÊïàÁéá</p><p>ÂàõÂª∫Á¥¢ÂºïÊó∂ÁöÑÂéüÂàôÔºö</p><ul><li><p>ÂØπÊü•ËØ¢È¢ëÊ¨°ËæÉÈ´òÔºå‰∏îÊï∞ÊçÆÈáèÊØîËæÉÂ§ßÁöÑË°®Âª∫Á´ãÁ¥¢Âºï</p></li><li><p>‰ΩøÁî®ÂîØ‰∏ÄÁ¥¢ÂºïÔºåÂå∫ÂàÜÂ∫¶Ë∂äÈ´òÔºå‰ΩøÁî®Á¥¢ÂºïÁöÑÊïàÁéáË∂äÈ´ò</p></li><li><p>Á¥¢ÂºïÂ≠óÊÆµÁöÑÈÄâÊã©ÔºåÊúÄ‰Ω≥ÂÄôÈÄâÂàóÂ∫îÂΩì‰ªé where Â≠êÂè•ÁöÑÊù°‰ª∂‰∏≠ÊèêÂèñÔºå‰ΩøÁî®Ë¶ÜÁõñÁ¥¢Âºï</p></li><li><p>‰ΩøÁî®Áü≠Á¥¢ÂºïÔºåÁ¥¢ÂºïÂàõÂª∫‰πãÂêé‰πüÊòØ‰ΩøÁî®Á°¨ÁõòÊù•Â≠òÂÇ®ÁöÑÔºåÂõ†Ê≠§ÊèêÂçáÁ¥¢ÂºïËÆøÈóÆÁöÑ I/O ÊïàÁéáÔºå‰πüÂèØ‰ª•ÊèêÂçáÊÄª‰ΩìÁöÑËÆøÈóÆÊïàÁéá„ÄÇÂÅáÂ¶ÇÊûÑÊàêÁ¥¢ÂºïÁöÑÂ≠óÊÆµÊÄªÈïøÂ∫¶ÊØîËæÉÁü≠ÔºåÈÇ£‰πàÂú®ÁªôÂÆöÂ§ßÂ∞èÁöÑÂ≠òÂÇ®ÂùóÂÜÖÂèØ‰ª•Â≠òÂÇ®Êõ¥Â§öÁöÑÁ¥¢ÂºïÂÄºÔºåÁõ∏Â∫îÁöÑÂèØ‰ª•ÊúâÊïàÁöÑÊèêÂçá MySQL ËÆøÈóÆÁ¥¢ÂºïÁöÑ I/O ÊïàÁéá</p></li><li><p>Á¥¢ÂºïÂèØ‰ª•ÊúâÊïàÁöÑÊèêÂçáÊü•ËØ¢Êï∞ÊçÆÁöÑÊïàÁéáÔºå‰ΩÜÁ¥¢ÂºïÊï∞Èáè‰∏çÊòØÂ§öÂ§öÁõäÂñÑÔºåÁ¥¢ÂºïË∂äÂ§öÔºåÁª¥Êä§Á¥¢ÂºïÁöÑ‰ª£‰ª∑Ë∂äÈ´ò„ÄÇÂØπ‰∫éÊèíÂÖ•„ÄÅÊõ¥Êñ∞„ÄÅÂà†Èô§Á≠â DML Êìç‰ΩúÊØîËæÉÈ¢ëÁπÅÁöÑË°®Êù•ËØ¥ÔºåÁ¥¢ÂºïËøáÂ§öÔºå‰ºöÂºïÂÖ•Áõ∏ÂΩìÈ´òÁöÑÁª¥Êä§‰ª£‰ª∑ÔºåÈôç‰Ωé DML Êìç‰ΩúÁöÑÊïàÁéáÔºåÂ¢ûÂä†Áõ∏Â∫îÊìç‰ΩúÁöÑÊó∂Èó¥Ê∂àËÄóÔºõÂè¶Â§ñÁ¥¢ÂºïËøáÂ§öÁöÑËØùÔºåMySQL ‰πü‰ºöÁäØÈÄâÊã©Âõ∞ÈöæÁóÖÔºåËôΩÁÑ∂ÊúÄÁªà‰ªçÁÑ∂‰ºöÊâæÂà∞‰∏Ä‰∏™ÂèØÁî®ÁöÑÁ¥¢ÂºïÔºå‰ΩÜÊèêÈ´ò‰∫ÜÈÄâÊã©ÁöÑ‰ª£‰ª∑</p></li><li><p>MySQL Âª∫Á´ãËÅîÂêàÁ¥¢ÂºïÊó∂‰ºöÈÅµÂÆà<strong>ÊúÄÂ∑¶ÂâçÁºÄÂåπÈÖçÂéüÂàô</strong>ÔºåÂç≥ÊúÄÂ∑¶‰ºòÂÖàÔºåÂú®Ê£ÄÁ¥¢Êï∞ÊçÆÊó∂‰ªéËÅîÂêàÁ¥¢ÂºïÁöÑÊúÄÂ∑¶ËæπÂºÄÂßãÂåπÈÖç</p><p>N ‰∏™ÂàóÁªÑÂêàËÄåÊàêÁöÑÁªÑÂêàÁ¥¢ÂºïÔºåÁõ∏ÂΩì‰∫éÂàõÂª∫‰∫Ü N ‰∏™Á¥¢ÂºïÔºåÂ¶ÇÊûúÊü•ËØ¢Êó∂ where Âè•‰∏≠‰ΩøÁî®‰∫ÜÁªÑÊàêËØ•Á¥¢ÂºïÁöÑ<strong>Ââç</strong>Âá†‰∏™Â≠óÊÆµÔºåÈÇ£‰πàËøôÊù°Êü•ËØ¢ SQL ÂèØ‰ª•Âà©Áî®ÁªÑÂêàÁ¥¢ÂºïÊù•ÊèêÂçáÊü•ËØ¢ÊïàÁéá</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂØπname„ÄÅaddress„ÄÅphoneÂàóÂª∫‰∏Ä‰∏™ËÅîÂêàÁ¥¢Âºï</span></span>
<span class="line"><span>ALTER TABLE user ADD INDEX index_three(name,address,phone);</span></span>
<span class="line"><span>-- Êü•ËØ¢ËØ≠Âè•ÊâßË°åÊó∂‰ºö‰æùÁÖßÊúÄÂ∑¶ÂâçÁºÄÂåπÈÖçÂéüÂàôÔºåÊ£ÄÁ¥¢Êó∂ÂàÜÂà´‰ºö‰ΩøÁî®Á¥¢ÂºïËøõË°åÊï∞ÊçÆÂåπÈÖç„ÄÇ</span></span>
<span class="line"><span>(name,address,phone)</span></span>
<span class="line"><span>(name,address)</span></span>
<span class="line"><span>(name,phone)	-- Âè™ÊúânameÂ≠óÊÆµËµ∞‰∫ÜÁ¥¢Âºï</span></span>
<span class="line"><span>(name)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Á¥¢ÂºïÁöÑÂ≠óÊÆµÂèØ‰ª•ÊòØ‰ªªÊÑèÈ°∫Â∫èÁöÑÔºå‰ºòÂåñÂô®‰ºöÂ∏ÆÂä©Êàë‰ª¨Ë∞ÉÊï¥È°∫Â∫èÔºå‰∏ãÈù¢ÁöÑSQLËØ≠Âè•ÂèØ‰ª•ÂëΩ‰∏≠Á¥¢Âºï</span></span>
<span class="line"><span>SELECT * FROM user WHERE address = &#39;Âåó‰∫¨&#39; AND phone = &#39;12345&#39; AND name = &#39;Âº†‰∏â&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Â¶ÇÊûúËÅîÂêàÁ¥¢Âºï‰∏≠ÊúÄÂ∑¶ËæπÁöÑÂàó‰∏çÂåÖÂê´Âú®Êù°‰ª∂Êü•ËØ¢‰∏≠ÔºåSQLËØ≠Âè•Â∞±‰∏ç‰ºöÂëΩ‰∏≠Á¥¢ÂºïÔºåÊØîÂ¶ÇÔºö</span></span>
<span class="line"><span>SELECT * FROM user WHERE address = &#39;Âåó‰∫¨&#39; AND phone = &#39;12345&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>Âì™‰∫õÊÉÖÂÜµ‰∏çË¶ÅÂª∫Á´ãÁ¥¢ÂºïÔºö</p><ul><li>ËÆ∞ÂΩïÂ§™Â∞ëÁöÑË°®</li><li>ÁªèÂ∏∏Â¢ûÂà†ÊîπÁöÑË°®</li><li>È¢ëÁπÅÊõ¥Êñ∞ÁöÑÂ≠óÊÆµ‰∏çÈÄÇÂêàÂàõÂª∫Á¥¢Âºï</li><li>where Êù°‰ª∂ÈáåÁî®‰∏çÂà∞ÁöÑÂ≠óÊÆµ‰∏çÂàõÂª∫Á¥¢Âºï</li></ul><hr><h3 id="Á¥¢Âºï‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#Á¥¢Âºï‰ºòÂåñ"><span>Á¥¢Âºï‰ºòÂåñ</span></a></h3><h4 id="Ë¶ÜÁõñÁ¥¢Âºï" tabindex="-1"><a class="header-anchor" href="#Ë¶ÜÁõñÁ¥¢Âºï"><span>Ë¶ÜÁõñÁ¥¢Âºï</span></a></h4><p>Ë¶ÜÁõñÁ¥¢ÂºïÔºöÂåÖÂê´ÊâÄÊúâÊª°Ë∂≥Êü•ËØ¢ÈúÄË¶ÅÁöÑÊï∞ÊçÆÁöÑÁ¥¢ÂºïÔºàSELECT ÂêéÈù¢ÁöÑÂ≠óÊÆµÂàöÂ•ΩÊòØÁ¥¢ÂºïÂ≠óÊÆµÔºâÔºåÂèØ‰ª•Âà©Áî®ËØ•Á¥¢ÂºïËøîÂõû SELECT ÂàóË°®ÁöÑÂ≠óÊÆµÔºåËÄå‰∏çÂøÖÊ†πÊçÆÁ¥¢ÂºïÂéªËÅöÁ∞áÁ¥¢Âºï‰∏äËØªÂèñÊï∞ÊçÆÊñá‰ª∂</p><p>ÂõûË°®Êü•ËØ¢ÔºöË¶ÅÊü•ÊâæÁöÑÂ≠óÊÆµ‰∏çÂú®Èùû‰∏ªÈîÆÁ¥¢ÂºïÊ†ë‰∏äÊó∂ÔºåÈúÄË¶ÅÈÄöËøáÂè∂Â≠êËäÇÁÇπÁöÑ‰∏ªÈîÆÂÄºÂéª‰∏ªÈîÆÁ¥¢Âºï‰∏äËé∑ÂèñÂØπÂ∫îÁöÑË°åÊï∞ÊçÆ</p><p>‰ΩøÁî®Ë¶ÜÁõñÁ¥¢ÂºïÔºåÈò≤Ê≠¢ÂõûË°®Êü•ËØ¢Ôºö</p><ul><li><p>Ë°® user ‰∏ªÈîÆ‰∏∫ idÔºåÊôÆÈÄöÁ¥¢Âºï‰∏∫ ageÔºåÊü•ËØ¢ËØ≠Âè•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM user WHERE age = 30;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Êü•ËØ¢ËøáÁ®ãÔºöÂÖàÈÄöËøáÊôÆÈÄöÁ¥¢Âºï age=30 ÂÆö‰ΩçÂà∞‰∏ªÈîÆÂÄº id=1ÔºåÂÜçÈÄöËøáËÅöÈõÜÁ¥¢Âºï id=1 ÂÆö‰ΩçÂà∞Ë°åËÆ∞ÂΩïÊï∞ÊçÆÔºåÈúÄË¶Å‰∏§Ê¨°Êâ´Êèè B+ Ê†ë</p></li><li><p>‰ΩøÁî®Ë¶ÜÁõñÁ¥¢ÂºïÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP INDEX idx_age ON user;</span></span>
<span class="line"><span>CREATE INDEX idx_age_name ON user(age,name);</span></span>
<span class="line"><span>SELECT id,age FROM user WHERE age = 30;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Âú®‰∏ÄÊ£µÁ¥¢ÂºïÊ†ë‰∏äÂ∞±ËÉΩËé∑ÂèñÊü•ËØ¢ÊâÄÈúÄÁöÑÊï∞ÊçÆÔºåÊó†ÈúÄÂõûË°®ÈÄüÂ∫¶Êõ¥Âø´</p></li></ul><p>‰ΩøÁî®Ë¶ÜÁõñÁ¥¢ÂºïÔºåË¶ÅÊ≥®ÊÑè SELECT ÂàóË°®‰∏≠Âè™ÂèñÂá∫ÈúÄË¶ÅÁöÑÂàóÔºå‰∏çÂèØÁî® SELECT *ÔºåÊâÄÊúâÂ≠óÊÆµ‰∏ÄËµ∑ÂÅöÁ¥¢Âºï‰ºöÂØºËá¥Á¥¢ÂºïÊñá‰ª∂ËøáÂ§ßÔºåÊü•ËØ¢ÊÄßËÉΩ‰∏ãÈôç</p><hr><h4 id="Á¥¢Âºï‰∏ãÊé®" tabindex="-1"><a class="header-anchor" href="#Á¥¢Âºï‰∏ãÊé®"><span>Á¥¢Âºï‰∏ãÊé®</span></a></h4><p>Á¥¢ÂºïÊù°‰ª∂‰∏ãÊé®‰ºòÂåñÔºàIndex Condition PushdownÔºåICPÔºâÊòØ MySQL5.6 Ê∑ªÂä†ÔºåÂèØ‰ª•Âú®Á¥¢ÂºïÈÅçÂéÜËøáÁ®ã‰∏≠ÔºåÂØπÁ¥¢Âºï‰∏≠ÂåÖÂê´ÁöÑÂ≠óÊÆµÂÖàÂÅöÂà§Êñ≠ÔºåÁõ¥Êé•ËøáÊª§Êéâ‰∏çÊª°Ë∂≥Êù°‰ª∂ÁöÑËÆ∞ÂΩïÔºåÂáèÂ∞ëÂõûË°®Ê¨°Êï∞</p><p>Á¥¢Âºï‰∏ãÊé®ÂÖÖÂàÜÂà©Áî®‰∫ÜÁ¥¢Âºï‰∏≠ÁöÑÊï∞ÊçÆÔºåÂú®Êü•ËØ¢Âá∫Êï¥Ë°åÊï∞ÊçÆ‰πãÂâçËøáÊª§ÊéâÊó†ÊïàÁöÑÊï∞ÊçÆÔºåÂÜçÂéª‰∏ªÈîÆÁ¥¢ÂºïÊ†ë‰∏äÊü•Êâæ</p><ul><li><p>‰∏ç‰ΩøÁî®Á¥¢Âºï‰∏ãÊé®‰ºòÂåñÊó∂Â≠òÂÇ®ÂºïÊìéÈÄöËøáÁ¥¢ÂºïÊ£ÄÁ¥¢Âà∞Êï∞ÊçÆÔºåÁÑ∂ÂêéÂõûË°®Êü•ËØ¢ËÆ∞ÂΩïËøîÂõûÁªô Server Â±ÇÔºå<strong>ÊúçÂä°Âô®Âà§Êñ≠Êï∞ÊçÆÊòØÂê¶Á¨¶ÂêàÊù°‰ª∂</strong></p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰∏ç‰ΩøÁî®Á¥¢Âºï‰∏ãÊé®.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>‰ΩøÁî®Á¥¢Âºï‰∏ãÊé®‰ºòÂåñÊó∂ÔºåÂ¶ÇÊûú<strong>Â≠òÂú®Êüê‰∫õË¢´Á¥¢ÂºïÁöÑÂàóÁöÑÂà§Êñ≠Êù°‰ª∂</strong>Êó∂ÔºåÁî±Â≠òÂÇ®ÂºïÊìéÂú®Á¥¢ÂºïÈÅçÂéÜÁöÑËøáÁ®ã‰∏≠Âà§Êñ≠Êï∞ÊçÆÊòØÂê¶Á¨¶Âêà‰º†ÈÄíÁöÑÊù°‰ª∂ÔºåÂ∞ÜÁ¨¶ÂêàÊù°‰ª∂ÁöÑÊï∞ÊçÆËøõË°åÂõûË°®ÔºåÊ£ÄÁ¥¢Âá∫Êù•ËøîÂõûÁªôÊúçÂä°Âô®ÔºåÁî±Ê≠§ÂáèÂ∞ë IO Ê¨°Êï∞</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ΩøÁî®Á¥¢Âºï‰∏ãÊé®.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><p><strong>ÈÄÇÁî®Êù°‰ª∂</strong>Ôºö</p><ul><li>ÈúÄË¶ÅÂ≠òÂÇ®ÂºïÊìéÂ∞ÜÁ¥¢Âºï‰∏≠ÁöÑÊï∞ÊçÆ‰∏éÊù°‰ª∂ËøõË°åÂà§Êñ≠ÔºàÊâÄ‰ª•<strong>Êù°‰ª∂ÂàóÂøÖÈ°ªÈÉΩÂú®Âêå‰∏Ä‰∏™Á¥¢Âºï‰∏≠</strong>ÔºâÔºåÊâÄ‰ª•‰ºòÂåñÊòØÂü∫‰∫éÂ≠òÂÇ®ÂºïÊìéÁöÑÔºåÂè™ÊúâÁâπÂÆöÂºïÊìéÂèØ‰ª•‰ΩøÁî®ÔºåÈÄÇÁî®‰∫é InnoDB Âíå MyISAM</li><li>Â≠òÂÇ®ÂºïÊìéÊ≤°ÊúâË∞ÉÁî®Ë∑®Â≠òÂÇ®ÂºïÊìéÁöÑËÉΩÂäõÔºåË∑®Â≠òÂÇ®ÂºïÊìéÁöÑÂäüËÉΩÊúâÂ≠òÂÇ®ËøáÁ®ã„ÄÅËß¶ÂèëÂô®„ÄÅËßÜÂõæÔºåÊâÄ‰ª•Ë∞ÉÁî®Ëøô‰∫õÂäüËÉΩÁöÑ‰∏çÂèØ‰ª•ËøõË°åÁ¥¢Âºï‰∏ãÊé®‰ºòÂåñ</li><li>ÂØπ‰∫é InnoDB ÂºïÊìéÂè™ÈÄÇÁî®‰∫é‰∫åÁ∫ßÁ¥¢ÂºïÔºåInnoDB ÁöÑËÅöÁ∞áÁ¥¢Âºï‰ºöÂ∞ÜÊï¥Ë°åÊï∞ÊçÆËØªÂà∞ÁºìÂÜ≤Âå∫Ôºå‰∏çÂÜçÈúÄË¶ÅÂéªÂõûË°®Êü•ËØ¢‰∫Ü</li></ul><p>Â∑•‰ΩúËøáÁ®ãÔºöÁî®Êà∑Ë°® userÔºå(name, age) ÊòØËÅîÂêàÁ¥¢Âºï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM user WHERE name LIKE &#39;Âº†%&#39; AND„ÄÄage = 10;	-- Â§¥ÈÉ®Ê®°Á≥äÂåπÈÖç‰ºöÈÄ†ÊàêÁ¥¢ÂºïÂ§±Êïà</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><p>‰ºòÂåñÂâçÔºöÂú®Èùû‰∏ªÈîÆÁ¥¢ÂºïÊ†ë‰∏äÊâæÂà∞Êª°Ë∂≥Á¨¨‰∏Ä‰∏™Êù°‰ª∂ÁöÑË°åÔºåÁÑ∂ÂêéÈÄöËøáÂè∂Â≠êËäÇÁÇπËÆ∞ÂΩïÁöÑ‰∏ªÈîÆÂÄºÂÜçÂõûÂà∞‰∏ªÈîÆÁ¥¢ÂºïÊ†ë‰∏äÊü•ÊâæÂà∞ÂØπÂ∫îÁöÑË°åÊï∞ÊçÆÔºåÂÜçÂØπÊØî AND ÂêéÁöÑÊù°‰ª∂ÊòØÂê¶Á¨¶ÂêàÔºåÁ¨¶ÂêàËøîÂõûÊï∞ÊçÆÔºåÈúÄË¶Å 4 Ê¨°ÂõûË°®</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Á¥¢Âºï‰∏ãÊé®‰ºòÂåñ1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>‰ºòÂåñÂêéÔºöÊ£ÄÊü•Á¥¢Âºï‰∏≠Â≠òÂÇ®ÁöÑÂàó‰ø°ÊÅØÊòØÂê¶Á¨¶ÂêàÁ¥¢ÂºïÊù°‰ª∂ÔºåÁÑ∂Âêé‰∫§Áî±Â≠òÂÇ®ÂºïÊìéÁî®Ââ©‰ΩôÁöÑÂà§Êñ≠Êù°‰ª∂Âà§Êñ≠Ê≠§Ë°åÊï∞ÊçÆÊòØÂê¶Á¨¶ÂêàË¶ÅÊ±ÇÔºå<strong>‰∏çÊª°Ë∂≥Êù°‰ª∂ÁöÑ‰∏çÂéªËØªÂèñË°®‰∏≠ÁöÑÊï∞ÊçÆ</strong>ÔºåÊª°Ë∂≥‰∏ãÊé®Êù°‰ª∂ÁöÑÂ∞±Ê†πÊçÆ‰∏ªÈîÆÂÄºËøõË°åÂõûË°®Êü•ËØ¢Ôºå2 Ê¨°ÂõûË°® <img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Á¥¢Âºï‰∏ãÊé®‰ºòÂåñ2.png" alt="" loading="lazy"></p></li></ul><p>ÂΩì‰ΩøÁî® EXPLAIN ËøõË°åÂàÜÊûêÊó∂ÔºåÂ¶ÇÊûú‰ΩøÁî®‰∫ÜÁ¥¢ÂºïÊù°‰ª∂‰∏ãÊé®ÔºåExtra ‰ºöÊòæÁ§∫ Using index condition</p><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://blog.csdn.net/sinat_29774479/article/details/103470244</p><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://time.geekbang.org/column/article/69636</p><hr><h4 id="ÂâçÁºÄÁ¥¢Âºï" tabindex="-1"><a class="header-anchor" href="#ÂâçÁºÄÁ¥¢Âºï"><span>ÂâçÁºÄÁ¥¢Âºï</span></a></h4><p>ÂΩìË¶ÅÁ¥¢ÂºïÁöÑÂàóÂ≠óÁ¨¶ÂæàÂ§öÊó∂ÔºåÁ¥¢Âºï‰ºöÂèòÂ§ßÂèòÊÖ¢ÔºåÂèØ‰ª•Âè™Á¥¢ÂºïÂàóÂºÄÂßãÁöÑÈÉ®ÂàÜÂ≠óÁ¨¶‰∏≤ÔºåËäÇÁ∫¶Á¥¢ÂºïÁ©∫Èó¥ÔºåÊèêÈ´òÁ¥¢ÂºïÊïàÁéá</p><p>Ê≥®ÊÑèÔºö‰ΩøÁî®ÂâçÁºÄÁ¥¢ÂºïÂ∞±Á≥ªÁªüÂ∞±ÂøΩÁï•Ë¶ÜÁõñÁ¥¢ÂºïÂØπÊü•ËØ¢ÊÄßËÉΩÁöÑ‰ºòÂåñ‰∫Ü</p><p>‰ºòÂåñÂéüÂàôÔºö<strong>Èôç‰ΩéÈáçÂ§çÁöÑÁ¥¢ÂºïÂÄº</strong></p><p>ÊØîÂ¶ÇÂú∞Âå∫Ë°®Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>area			gdp		code</span></span>
<span class="line"><span>chinaShanghai	100		aaa</span></span>
<span class="line"><span>chinaDalian		200		bbb</span></span>
<span class="line"><span>usaNewYork		300		ccc</span></span>
<span class="line"><span>chinaFuxin		400		ddd</span></span>
<span class="line"><span>chinaBeijing	500		eee</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ÂèëÁé∞ area Â≠óÊÆµÂæàÂ§öÈÉΩÊòØ‰ª• china ÂºÄÂ§¥ÁöÑÔºåÈÇ£‰πàÂ¶ÇÊûú‰ª•Ââç 1-5 ‰ΩçÂ≠óÁ¨¶ÂÅöÂâçÁºÄÁ¥¢ÂºïÂ∞±‰ºöÂá∫Áé∞Â§ßÈáèÁ¥¢ÂºïÂÄºÈáçÂ§çÁöÑÊÉÖÂÜµÔºåÁ¥¢ÂºïÂÄºÈáçÂ§çÊÄßË∂ä‰ΩéÔºåÊü•ËØ¢ÊïàÁéá‰πüÂ∞±Ë∂äÈ´òÔºåÊâÄ‰ª•ÈúÄË¶ÅÂª∫Á´ãÂâç 6 ‰ΩçÂ≠óÁ¨¶ÁöÑÁ¥¢ÂºïÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE INDEX idx_area ON table_name(area(7));</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Âú∫ÊôØÔºöÂ≠òÂÇ®Ë∫´‰ªΩËØÅ</p><ul><li>Áõ¥Êé•ÂàõÂª∫ÂÆåÊï¥Á¥¢ÂºïÔºåËøôÊ†∑ÂèØËÉΩÊØîËæÉÂç†Áî®Á©∫Èó¥</li><li>ÂàõÂª∫ÂâçÁºÄÁ¥¢ÂºïÔºåËäÇÁúÅÁ©∫Èó¥Ôºå‰ΩÜ‰ºöÂ¢ûÂä†Êü•ËØ¢Êâ´ÊèèÊ¨°Êï∞ÔºåÂπ∂‰∏î‰∏çËÉΩ‰ΩøÁî®Ë¶ÜÁõñÁ¥¢Âºï</li><li>ÂÄíÂ∫èÂ≠òÂÇ®ÔºåÂÜçÂàõÂª∫ÂâçÁºÄÁ¥¢ÂºïÔºåÁî®‰∫éÁªïËøáÂ≠óÁ¨¶‰∏≤Êú¨Ë∫´ÂâçÁºÄÁöÑÂå∫ÂàÜÂ∫¶‰∏çÂ§üÁöÑÈóÆÈ¢òÔºàÂâç 6 ‰ΩçÁõ∏ÂêåÁöÑÂæàÂ§öÔºâ</li><li>ÂàõÂª∫ hash Â≠óÊÆµÁ¥¢ÂºïÔºåÊü•ËØ¢ÊÄßËÉΩÁ®≥ÂÆöÔºåÊúâÈ¢ùÂ§ñÁöÑÂ≠òÂÇ®ÂíåËÆ°ÁÆóÊ∂àËÄóÔºåË∑üÁ¨¨‰∏âÁßçÊñπÂºè‰∏ÄÊ†∑ÔºåÈÉΩ‰∏çÊîØÊåÅËåÉÂõ¥Êâ´Êèè</li></ul><hr><h4 id="Á¥¢ÂºïÂêàÂπ∂" tabindex="-1"><a class="header-anchor" href="#Á¥¢ÂºïÂêàÂπ∂"><span>Á¥¢ÂºïÂêàÂπ∂</span></a></h4><p>‰ΩøÁî®Â§ö‰∏™Á¥¢ÂºïÊù•ÂÆåÊàê‰∏ÄÊ¨°Êü•ËØ¢ÁöÑÊâßË°åÊñπÊ≥ïÂè´ÂÅöÁ¥¢ÂºïÂêàÂπ∂ index merge</p><ul><li><p>Intersection Á¥¢ÂºïÂêàÂπ∂Ôºö</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> table_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> key1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;a&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> key3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; # key1 Âíå key3 ÂàóÈÉΩÊòØÂçïÂàóÁ¥¢Âºï„ÄÅ‰∫åÁ∫ßÁ¥¢Âºï</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>‰ªé‰∏çÂêåÁ¥¢Âºï‰∏≠Êâ´ÊèèÂà∞ÁöÑËÆ∞ÂΩïÁöÑ id ÂÄºÂèñ<strong>‰∫§ÈõÜ</strong>ÔºàÁõ∏Âêå idÔºâÔºåÁÑ∂ÂêéÊâßË°åÂõûË°®Êìç‰ΩúÔºåË¶ÅÊ±Ç‰ªéÊØè‰∏™‰∫åÁ∫ßÁ¥¢ÂºïËé∑ÂèñÂà∞ÁöÑËÆ∞ÂΩïÈÉΩÊòØÊåâÁÖß‰∏ªÈîÆÂÄºÊéíÂ∫è</p></li><li><p>Union Á¥¢ÂºïÂêàÂπ∂Ôºö</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> table_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> key1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;a&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> OR</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> key3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>‰ªé‰∏çÂêåÁ¥¢Âºï‰∏≠Êâ´ÊèèÂà∞ÁöÑËÆ∞ÂΩïÁöÑ id ÂÄºÂèñ<strong>Âπ∂ÈõÜ</strong>ÔºåÁÑ∂ÂêéÊâßË°åÂõûË°®Êìç‰ΩúÔºåË¶ÅÊ±Ç‰ªéÊØè‰∏™‰∫åÁ∫ßÁ¥¢ÂºïËé∑ÂèñÂà∞ÁöÑËÆ∞ÂΩïÈÉΩÊòØÊåâÁÖß‰∏ªÈîÆÂÄºÊéíÂ∫è</p></li><li><p>Sort-Union Á¥¢ÂºïÂêàÂπ∂</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> table_test </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> key1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;a&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> OR</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> key3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;b&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ÂÖàÂ∞Ü‰ªé‰∏çÂêåÁ¥¢Âºï‰∏≠Êâ´ÊèèÂà∞ÁöÑËÆ∞ÂΩïÁöÑ‰∏ªÈîÆÂÄºËøõË°åÊéíÂ∫èÔºåÂÜçÊåâÁÖß Union Á¥¢ÂºïÂêàÂπ∂ÁöÑÊñπÂºèËøõË°åÊü•ËØ¢</p></li></ul><p>Á¥¢ÂºïÂêàÂπ∂ÁÆóÊ≥ïÁöÑÊïàÁéáÂπ∂‰∏çÂ•ΩÔºåÈÄöËøáÂ∞ÜÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∏™Á¥¢ÂºïÊîπÊàêËÅîÂêàÁ¥¢Âºï‰ºö‰ºòÂåñÊïàÁéá</p><hr><h2 id="Á≥ªÁªü‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#Á≥ªÁªü‰ºòÂåñ"><span>Á≥ªÁªü‰ºòÂåñ</span></a></h2><h3 id="Ë°®‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#Ë°®‰ºòÂåñ"><span>Ë°®‰ºòÂåñ</span></a></h3><h4 id="ÂàÜÂå∫Ë°®" tabindex="-1"><a class="header-anchor" href="#ÂàÜÂå∫Ë°®"><span>ÂàÜÂå∫Ë°®</span></a></h4><h5 id="Âü∫Êú¨‰ªãÁªç-5" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-5"><span>Âü∫Êú¨‰ªãÁªç</span></a></h5><p>ÂàÜÂå∫Ë°®ÊòØÂ∞ÜÂ§ßË°®ÁöÑÊï∞ÊçÆÊåâÂàÜÂå∫Â≠óÊÆµÂàÜÊàêËÆ∏Â§öÂ∞èÁöÑÂ≠êÈõÜÔºåÂª∫Á´ã‰∏Ä‰∏™‰ª• ftime Âπ¥‰ªΩ‰∏∫ÂàÜÂå∫ÁöÑË°®Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `t` (</span></span>
<span class="line"><span>    `ftime` datetime NOT NULL,</span></span>
<span class="line"><span>    `c` int(11) DEFAULT NULL,</span></span>
<span class="line"><span>    KEY (`ftime`)</span></span>
<span class="line"><span>) ENGINE=InnoDB DEFAULT CHARSET=latin1</span></span>
<span class="line"><span>PARTITION BY RANGE (YEAR(ftime))</span></span>
<span class="line"><span>(PARTITION p_2017 VALUES LESS THAN (2017) ENGINE = InnoDB,</span></span>
<span class="line"><span> PARTITION p_2018 VALUES LESS THAN (2018) ENGINE = InnoDB,</span></span>
<span class="line"><span> PARTITION p_2019 VALUES LESS THAN (2019) ENGINE = InnoDB,</span></span>
<span class="line"><span> PARTITION p_others VALUES LESS THAN MAXVALUE ENGINE = InnoDB);</span></span>
<span class="line"><span>INSERT INTO t VALUES(&#39;2017-4-1&#39;,1),(&#39;2018-4-1&#39;,1);-- Ëøô‰∏§Ë°åËÆ∞ÂΩïÂàÜÂà´ËêΩÂú® p_2018 Âíå p_2019 Ëøô‰∏§‰∏™ÂàÜÂå∫‰∏ä</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Ëøô‰∏™Ë°®ÂåÖÂê´‰∫Ü‰∏Ä‰∏™.frm Êñá‰ª∂Âíå 4 ‰∏™.ibd Êñá‰ª∂ÔºåÊØè‰∏™ÂàÜÂå∫ÂØπÂ∫î‰∏Ä‰∏™.ibd Êñá‰ª∂</p><ul><li>ÂØπ‰∫éÂºïÊìéÂ±ÇÊù•ËØ¥ÔºåËøôÊòØ 4 ‰∏™Ë°®ÔºåÈíàÂØπÊØè‰∏™ÂàÜÂå∫Ë°®ÁöÑÊìç‰Ωú‰∏ç‰ºöÁõ∏‰∫íÂΩ±Âìç</li><li>ÂØπ‰∫é Server Â±ÇÊù•ËØ¥ÔºåËøôÊòØ 1 ‰∏™Ë°®</li></ul><hr><h5 id="ÂàÜÂå∫Á≠ñÁï•" tabindex="-1"><a class="header-anchor" href="#ÂàÜÂå∫Á≠ñÁï•"><span>ÂàÜÂå∫Á≠ñÁï•</span></a></h5><p>ÊâìÂºÄË°®Ë°å‰∏∫ÔºöÁ¨¨‰∏ÄÊ¨°ËÆøÈóÆ‰∏Ä‰∏™ÂàÜÂå∫Ë°®Êó∂ÔºåMySQL ÈúÄË¶Å<strong>ÊääÊâÄÊúâÁöÑÂàÜÂå∫ÈÉΩËÆøÈóÆ‰∏ÄÈÅç</strong>ÔºåÂ¶ÇÊûúÂàÜÂå∫Ë°®ÁöÑÊï∞ÈáèÂæàÂ§öÔºåË∂ÖËøá‰∫Ü open_files_limit ÂèÇÊï∞ÔºàÈªòËÆ§ÂÄº 1024ÔºâÔºåÈÇ£‰πàÂ∞±‰ºöÂú®ËÆøÈóÆËøô‰∏™Ë°®Êó∂ÊâìÂºÄÊâÄÊúâÁöÑÊñá‰ª∂ÔºåÂØºËá¥ÊâìÂºÄË°®Êñá‰ª∂ÁöÑ‰∏™Êï∞Ë∂ÖËøá‰∫Ü‰∏äÈôêËÄåÊä•Èîô</p><p>ÈÄöÁî®ÂàÜÂå∫Á≠ñÁï•ÔºöMyISAM ÂàÜÂå∫Ë°®‰ΩøÁî®ÁöÑÂàÜÂå∫Á≠ñÁï•ÔºåÊØèÊ¨°ËÆøÈóÆÂàÜÂå∫ÈÉΩÁî± Server Â±ÇÊéßÂà∂ÔºåÂú®Êñá‰ª∂ÁÆ°ÁêÜ„ÄÅË°®ÁÆ°ÁêÜÁöÑÂÆûÁé∞‰∏äÂæàÁ≤óÁ≥ôÔºåÂõ†Ê≠§ÊúâÊØîËæÉ‰∏•ÈáçÁöÑÊÄßËÉΩÈóÆÈ¢ò</p><p>Êú¨Âú∞ÂàÜÂå∫Á≠ñÁï•Ôºö‰ªé MySQL 5.7.9 ÂºÄÂßãÔºåInnoDB ÂºïÊìéÂÜÖÈÉ®Ëá™Â∑±ÁÆ°ÁêÜÊâìÂºÄÂàÜÂå∫ÁöÑË°å‰∏∫ÔºåInnoDB ÂºïÊìéÊâìÂºÄÊñá‰ª∂Ë∂ÖËøá innodb_open_files Êó∂Â∞±‰ºö<strong>ÂÖ≥Êéâ‰∏Ä‰∫õ‰πãÂâçÊâìÂºÄÁöÑÊñá‰ª∂</strong>ÔºåÊâÄ‰ª•Âç≥‰ΩøÂàÜÂå∫‰∏™Êï∞Â§ß‰∫é open_files_limitÔºå‰πü‰∏ç‰ºöÊä•Èîô</p><p>‰ªé MySQL 8.0 ÁâàÊú¨ÂºÄÂßãÔºåÂ∞±‰∏çÂÖÅËÆ∏ÂàõÂª∫ MyISAM ÂàÜÂå∫Ë°®ÔºåÂè™ÂÖÅËÆ∏ÂàõÂª∫Â∑≤ÁªèÂÆûÁé∞‰∫ÜÊú¨Âú∞ÂàÜÂå∫Á≠ñÁï•ÁöÑÂºïÊìéÔºåÁõÆÂâçÂè™Êúâ InnoDB Âíå NDB Ëøô‰∏§‰∏™ÂºïÊìéÊîØÊåÅ‰∫ÜÊú¨Âú∞ÂàÜÂå∫Á≠ñÁï•</p><hr><h5 id="server-Â±Ç" tabindex="-1"><a class="header-anchor" href="#server-Â±Ç"><span>Server Â±Ç</span></a></h5><p>‰ªé Server Â±ÇÁúã‰∏Ä‰∏™ÂàÜÂå∫Ë°®Â∞±Âè™ÊòØ‰∏Ä‰∏™Ë°®</p><ul><li><p>Session AÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM t WHERE ftime = &#39;2018-4-1&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Session BÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ALTER TABLE t TRUNCATE PARTITION p_2017; -- blocked</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>Áé∞Ë±°ÔºöSession B Âè™Êìç‰Ωú p_2017 ÂàÜÂå∫Ôºå‰ΩÜÊòØÁî±‰∫é Session A ÊåÅÊúâÊï¥‰∏™Ë°® t ÁöÑ MDL ËØªÈîÅÔºåÂ∞±ÂØºËá¥ B ÁöÑ ALTER ËØ≠Âè•Ëé∑Âèñ MDL ÂÜôÈîÅÈòªÂ°û</p><p>ÂàÜÂå∫Ë°®ÁöÑÁâπÁÇπÔºö</p><ul><li>Á¨¨‰∏ÄÊ¨°ËÆøÈóÆÁöÑÊó∂ÂÄôÈúÄË¶ÅËÆøÈóÆÊâÄÊúâÂàÜÂå∫</li><li>Âú® Server Â±ÇËÆ§‰∏∫ËøôÊòØÂêå‰∏ÄÂº†Ë°®ÔºåÂõ†Ê≠§<strong>ÊâÄÊúâÂàÜÂå∫ÂÖ±Áî®Âêå‰∏Ä‰∏™ MDL ÈîÅ</strong></li><li>Âú®ÂºïÊìéÂ±ÇËÆ§‰∏∫ËøôÊòØ‰∏çÂêåÁöÑË°®ÔºåÂõ†Ê≠§ MDL ÈîÅ‰πãÂêéÁöÑÊâßË°åËøáÁ®ãÔºå‰ºöÊ†πÊçÆÂàÜÂå∫Ë°®ËßÑÂàôÔºåÂè™ËÆøÈóÆÈúÄË¶ÅÁöÑÂàÜÂå∫</li></ul><hr><h5 id="Â∫îÁî®Âú∫ÊôØ" tabindex="-1"><a class="header-anchor" href="#Â∫îÁî®Âú∫ÊôØ"><span>Â∫îÁî®Âú∫ÊôØ</span></a></h5><p>ÂàÜÂå∫Ë°®ÁöÑ‰ºòÁÇπÔºö</p><ul><li>ÂØπ‰∏öÂä°ÈÄèÊòéÔºåÁõ∏ÂØπ‰∫éÁî®Êà∑ÂàÜË°®Êù•ËØ¥Ôºå‰ΩøÁî®ÂàÜÂå∫Ë°®ÁöÑ‰∏öÂä°‰ª£Á†ÅÊõ¥ÁÆÄÊ¥Å</li><li>ÂàÜÂå∫Ë°®ÂèØ‰ª•ÂæàÊñπ‰æøÁöÑÊ∏ÖÁêÜÂéÜÂè≤Êï∞ÊçÆ„ÄÇÊåâÁÖßÊó∂Èó¥ÂàÜÂå∫ÁöÑÂàÜÂå∫Ë°®ÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•ÈÄöËøá <code>alter table t drop partition</code> Ëøô‰∏™ËØ≠Ê≥ïÁõ¥Êé•Âà†Èô§ÂàÜÂå∫Êñá‰ª∂Ôºå‰ªéËÄåÂà†ÊéâËøáÊúüÁöÑÂéÜÂè≤Êï∞ÊçÆÔºå‰∏é‰ΩøÁî® drop ËØ≠Âè•Âà†Èô§Êï∞ÊçÆÁõ∏ÊØîÔºå‰ºòÂäøÊòØÈÄüÂ∫¶Âø´„ÄÅÂØπÁ≥ªÁªüÂΩ±ÂìçÂ∞è</li></ul><p>‰ΩøÁî®ÂàÜÂå∫Ë°®Ôºå‰∏çÂª∫ËÆÆÂàõÂª∫Â§™Â§öÁöÑÂàÜÂå∫ÔºåÊ≥®ÊÑè‰∫ãÈ°πÔºö</p><ul><li>ÂàÜÂå∫Âπ∂‰∏çÊòØË∂äÁªÜË∂äÂ•ΩÔºåÂçïË°®ÊàñËÄÖÂçïÂàÜÂå∫ÁöÑÊï∞ÊçÆ‰∏ÄÂçÉ‰∏áË°åÔºåÂè™Ë¶ÅÊ≤°ÊúâÁâπÂà´Â§ßÁöÑÁ¥¢ÂºïÔºåÂØπ‰∫éÁé∞Âú®ÁöÑÁ°¨‰ª∂ËÉΩÂäõÊù•ËØ¥ÈÉΩÂ∑≤ÁªèÊòØÂ∞èË°®</li><li>ÂàÜÂå∫‰∏çË¶ÅÊèêÂâçÈ¢ÑÁïôÂ§™Â§öÔºåÂú®‰ΩøÁî®‰πãÂâçÈ¢ÑÂÖàÂàõÂª∫Âç≥ÂèØ„ÄÇÊØîÂ¶ÇÊòØÊåâÊúàÂàÜÂå∫ÔºåÊØèÂπ¥Âπ¥Â∫ïÊó∂ÂÜçÊää‰∏ã‰∏ÄÂπ¥Â∫¶ÁöÑ 12 ‰∏™Êñ∞ÂàÜÂå∫ÂàõÂª∫‰∏äÂç≥ÂèØÔºåÂπ∂‰∏îÂØπ‰∫éÊ≤°ÊúâÊï∞ÊçÆÁöÑÂéÜÂè≤ÂàÜÂå∫ÔºåË¶ÅÂèäÊó∂ÁöÑ drop Êéâ</li></ul><p>ÂèÇËÄÉÊñáÊ°£Ôºöhttps://time.geekbang.org/column/article/82560</p><hr><h4 id="‰∏¥Êó∂Ë°®" tabindex="-1"><a class="header-anchor" href="#‰∏¥Êó∂Ë°®"><span>‰∏¥Êó∂Ë°®</span></a></h4><h5 id="Âü∫Êú¨‰ªãÁªç-6" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-6"><span>Âü∫Êú¨‰ªãÁªç</span></a></h5><p>‰∏¥Êó∂Ë°®ÂàÜ‰∏∫ÂÜÖÈÉ®‰∏¥Êó∂Ë°®ÂíåÁî®Êà∑‰∏¥Êó∂Ë°®</p><ul><li><p>ÂÜÖÈÉ®‰∏¥Êó∂Ë°®ÔºöÁ≥ªÁªüÊâßË°å SQL ËØ≠Âè•‰ºòÂåñÊó∂‰∫ßÁîüÁöÑË°®Ôºå‰æãÂ¶Ç Join ËøûÊé•Êü•ËØ¢„ÄÅÂéªÈáçÊü•ËØ¢Á≠â</p></li><li><p>Áî®Êà∑‰∏¥Êó∂Ë°®ÔºöÁî®Êà∑‰∏ªÂä®ÂàõÂª∫ÁöÑ‰∏¥Êó∂Ë°®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TEMPORARY TABLE temp_t like table_1;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>‰∏¥Êó∂Ë°®ÂèØ‰ª•ÊòØÂÜÖÂ≠òË°®Ôºå‰πüÂèØ‰ª•ÊòØÁ£ÅÁõòË°®ÔºàÂ§öË°®Êìç‰Ωú ‚Üí ÂµåÂ•óÊü•ËØ¢Á´†ËäÇÊèêÂèäÔºâ</p><ul><li>ÂÜÖÂ≠òË°®ÊåáÁöÑÊòØ‰ΩøÁî® Memory ÂºïÊìéÁöÑË°®ÔºåÂª∫Á´ãÂìàÂ∏åÁ¥¢ÂºïÔºåÂª∫Ë°®ËØ≠Ê≥ïÊòØ <code>create table ‚Ä¶ engine=memory</code>ÔºåËøôÁßçË°®ÁöÑÊï∞ÊçÆÈÉΩ‰øùÂ≠òÂú®ÂÜÖÂ≠òÈáåÔºåÁ≥ªÁªüÈáçÂêØÊó∂‰ºöË¢´Ê∏ÖÁ©∫Ôºå‰ΩÜÊòØË°®ÁªìÊûÑËøòÂú®</li><li>Á£ÅÁõòË°®ÊòØ‰ΩøÁî® InnoDB ÂºïÊìéÊàñËÄÖ MyISAM ÂºïÊìéÁöÑ‰∏¥Êó∂Ë°®ÔºåÂª∫Á´ã B+ Ê†ëÁ¥¢ÂºïÔºåÂÜôÊï∞ÊçÆÁöÑÊó∂ÂÄôÊòØÂÜôÂà∞Á£ÅÁõò‰∏äÁöÑ</li></ul><p>‰∏¥Êó∂Ë°®ÁöÑÁâπÁÇπÔºö</p><ul><li>‰∏Ä‰∏™‰∏¥Êó∂Ë°®Âè™ËÉΩË¢´ÂàõÂª∫ÂÆÉÁöÑ session ËÆøÈóÆÔºåÂØπÂÖ∂‰ªñÁ∫øÁ®ã‰∏çÂèØËßÅÔºåÊâÄ‰ª•‰∏çÂêå session ÁöÑ‰∏¥Êó∂Ë°®ÊòØ<strong>ÂèØ‰ª•ÈáçÂêç</strong>ÁöÑ</li><li>‰∏¥Êó∂Ë°®ÂèØ‰ª•‰∏éÊôÆÈÄöË°®ÂêåÂêçÔºå‰ºöËØùÂÜÖÊúâÂêåÂêçÁöÑ‰∏¥Êó∂Ë°®ÂíåÊôÆÈÄöË°®Êó∂ÔºåÊâßË°å show create ËØ≠Âè•‰ª•ÂèäÂ¢ûÂà†ÊîπÊü•ËØ≠Âè•ËÆøÈóÆÁöÑÈÉΩÊòØ‰∏¥Êó∂Ë°®</li><li>show tables ÂëΩ‰ª§‰∏çÊòæÁ§∫‰∏¥Êó∂Ë°®</li><li>Êï∞ÊçÆÂ∫ìÂèëÁîüÂºÇÂ∏∏ÈáçÂêØ‰∏çÈúÄË¶ÅÊãÖÂøÉÊï∞ÊçÆÂà†Èô§ÈóÆÈ¢òÔºå‰∏¥Êó∂Ë°®‰ºö<strong>Ëá™Âä®ÂõûÊî∂</strong></li></ul><hr><h5 id="ÈáçÂêçÂéüÁêÜ" tabindex="-1"><a class="header-anchor" href="#ÈáçÂêçÂéüÁêÜ"><span>ÈáçÂêçÂéüÁêÜ</span></a></h5><p>ÊâßË°åÂàõÂª∫‰∏¥Êó∂Ë°®ÁöÑ SQLÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>create temporary table temp_t(id int primary key)engine=innodb;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>MySQL Áªô InnoDB Ë°®ÂàõÂª∫‰∏Ä‰∏™ frm Êñá‰ª∂‰øùÂ≠òË°®ÁªìÊûÑÂÆö‰πâÔºåÂú® ibd ‰øùÂ≠òË°®Êï∞ÊçÆ„ÄÇfrm Êñá‰ª∂ÊîæÂú®‰∏¥Êó∂Êñá‰ª∂ÁõÆÂΩï‰∏ãÔºåÊñá‰ª∂ÂêçÁöÑÂêéÁºÄÊòØ .frmÔºå<strong>ÂâçÁºÄÊòØ</strong> <code>#sql{ËøõÁ®ã id}_{Á∫øÁ®ã id}_ Â∫èÂàóÂè∑</code>Ôºå‰ΩøÁî® <code>select @@tmpdir</code> ÂëΩ‰ª§ÔºåÊù•ÊòæÁ§∫ÂÆû‰æãÁöÑ‰∏¥Êó∂Êñá‰ª∂ÁõÆÂΩï</p><p>MySQL Áª¥Êä§Êï∞ÊçÆË°®ÔºåÈô§‰∫ÜÁâ©ÁêÜÁ£ÅÁõò‰∏äÁöÑÊñá‰ª∂Â§ñÔºåÂÜÖÂ≠òÈáå‰πüÊúâ‰∏ÄÂ•óÊú∫Âà∂Âå∫Âà´‰∏çÂêåÁöÑË°®ÔºåÊØè‰∏™Ë°®ÈÉΩÂØπÂ∫î‰∏Ä‰∏™ table_def_key</p><ul><li>‰∏Ä‰∏™ÊôÆÈÄöË°®ÁöÑ table_def_key ÁöÑÂÄºÊòØÁî± <code>Â∫ìÂêç + Ë°®Âêç</code> ÂæóÂà∞ÁöÑÔºåÊâÄ‰ª•Â¶ÇÊûúÂú®Âêå‰∏Ä‰∏™Â∫ì‰∏ãÂàõÂª∫‰∏§‰∏™ÂêåÂêçÁöÑÊôÆÈÄöË°®ÔºåÂàõÂª∫Á¨¨‰∫å‰∏™Ë°®ÁöÑËøáÁ®ã‰∏≠Â∞±‰ºöÂèëÁé∞ table_def_key Â∑≤ÁªèÂ≠òÂú®‰∫Ü</li><li>ÂØπ‰∫é‰∏¥Êó∂Ë°®Ôºåtable_def_key Âú® <code>Â∫ìÂêç + Ë°®Âêç</code> Âü∫Á°Ä‰∏äÔºåÂèàÂä†ÂÖ•‰∫Ü <code>server_id + thread_id</code>ÔºåÊâÄ‰ª•‰∏çÂêåÁ∫øÁ®ã‰πãÈó¥Ôºå‰∏¥Êó∂Ë°®ÂèØ‰ª•ÈáçÂêç</li></ul><p>ÂÆûÁé∞ÂéüÁêÜÔºöÊØè‰∏™Á∫øÁ®ãÈÉΩÁª¥Êä§‰∫ÜËá™Â∑±ÁöÑ‰∏¥Êó∂Ë°®ÈìæË°®ÔºåÊØèÊ¨° session ÂÜÖÊìç‰ΩúË°®Êó∂ÔºåÂÖàÈÅçÂéÜÈìæË°®ÔºåÊ£ÄÊü•ÊòØÂê¶ÊúâËøô‰∏™ÂêçÂ≠óÁöÑ‰∏¥Êó∂Ë°®ÔºåÂ¶ÇÊûúÊúâÂ∞±<strong>‰ºòÂÖàÊìç‰Ωú‰∏¥Êó∂Ë°®</strong>ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÜçÊìç‰ΩúÊôÆÈÄöË°®ÔºõÂú® session ÁªìÊùüÊó∂ÂØπÈìæË°®ÈáåÁöÑÊØè‰∏™‰∏¥Êó∂Ë°®ÔºåÊâßË°å <code>DROP TEMPORARY TABLE + Ë°®Âêç</code> Êìç‰Ωú</p><p>ÊâßË°å rename table ËØ≠Âè•Êó†Ê≥ï‰øÆÊîπ‰∏¥Êó∂Ë°®ÔºåÂõ†‰∏∫‰ºöÊåâÁÖß <code>Â∫ìÂêç / Ë°®Âêç.frm</code> ÁöÑËßÑÂàôÂéªÁ£ÅÁõòÊâæÊñá‰ª∂Ôºå‰ΩÜÊòØ‰∏¥Êó∂Ë°®Êñá‰ª∂ÂêçÁöÑËßÑÂàôÊòØ <code>#sql{ËøõÁ®ã id}_{Á∫øÁ®ã id}_ Â∫èÂàóÂè∑.frm</code>ÔºåÂõ†Ê≠§‰ºöÊä•Êâæ‰∏çÂà∞Êñá‰ª∂ÂêçÁöÑÈîôËØØ</p><hr><h5 id="‰∏ªÂ§áÂ§çÂà∂" tabindex="-1"><a class="header-anchor" href="#‰∏ªÂ§áÂ§çÂà∂"><span>‰∏ªÂ§áÂ§çÂà∂</span></a></h5><p>ÂàõÂª∫‰∏¥Êó∂Ë°®ÁöÑËØ≠Âè•‰ºö‰º†Âà∞Â§áÂ∫ìÊâßË°åÔºåÂõ†Ê≠§Â§áÂ∫ìÁöÑÂêåÊ≠•Á∫øÁ®ãÂ∞±‰ºöÂàõÂª∫Ëøô‰∏™‰∏¥Êó∂Ë°®„ÄÇ‰∏ªÂ∫ìÂú®Á∫øÁ®ãÈÄÄÂá∫Êó∂‰ºöËá™Âä®Âà†Èô§‰∏¥Êó∂Ë°®Ôºå‰ΩÜÂ§áÂ∫ìÂêåÊ≠•Á∫øÁ®ãÊòØÊåÅÁª≠Âú®ËøêË°åÁöÑÂπ∂‰∏ç‰ºöÈÄÄÂá∫ÔºåÊâÄ‰ª•ËøôÊó∂Â∞±ÈúÄË¶ÅÂú®‰∏ªÂ∫ì‰∏äÂÜçÂÜô‰∏Ä‰∏™ DROP TEMPORARY TABLE ‰º†ÁªôÂ§áÂ∫ìÊâßË°å</p><p>binlog Êó•ÂøóÂÜôÂÖ•ËßÑÂàôÔºö</p><ul><li>binlog_format=rowÔºåË∑ü‰∏¥Êó∂Ë°®ÊúâÂÖ≥ÁöÑËØ≠Âè•Â∞±‰∏ç‰ºöËÆ∞ÂΩïÂà∞ binlog</li><li>binlog_format=statment/mixedÔºåbinlog ‰∏≠Êâç‰ºöËÆ∞ÂΩï‰∏¥Êó∂Ë°®ÁöÑÊìç‰ΩúÔºå‰πüÂ∞±‰ºöËÆ∞ÂΩï <code>DROP TEMPORARY TABLE</code> ËøôÊù°ÂëΩ‰ª§</li></ul><p>‰∏ªÂ∫ì‰∏ä‰∏çÂêåÁöÑÁ∫øÁ®ãÂàõÂª∫ÂêåÂêçÁöÑ‰∏¥Êó∂Ë°®ÊòØ‰∏çÂÜ≤Á™ÅÁöÑÔºå‰ΩÜÊòØÂ§áÂ∫ìÂè™Êúâ‰∏Ä‰∏™ÊâßË°åÁ∫øÁ®ãÔºåÊâÄ‰ª• MySQL Âú®ËÆ∞ÂΩï binlog Êó∂‰ºöÊää‰∏ªÂ∫ìÊâßË°åËøô‰∏™ËØ≠Âè•ÁöÑÁ∫øÁ®ã id ÂÜôÂà∞ binlog ‰∏≠ÔºåÂú®Â§áÂ∫ìÁöÑÂ∫îÁî®Á∫øÁ®ãÂ∞±ÂèØ‰ª•Ëé∑ÂèñÊâßË°åÊØè‰∏™ËØ≠Âè•ÁöÑ‰∏ªÂ∫ìÁ∫øÁ®ã idÔºåÂπ∂Âà©Áî®Ëøô‰∏™Á∫øÁ®ã id Êù•ÊûÑÈÄ†‰∏¥Êó∂Ë°®ÁöÑ table_def_key</p><ul><li>session A ÁöÑ‰∏¥Êó∂Ë°® t1ÔºåÂú®Â§áÂ∫ìÁöÑ table_def_key Â∞±ÊòØÔºö<code>Â∫ìÂêç + t1 +‚ÄúM ÁöÑ serverid&quot; + &quot;session A ÁöÑ thread_id‚Äù</code></li><li>session B ÁöÑ‰∏¥Êó∂Ë°® t1ÔºåÂú®Â§áÂ∫ìÁöÑ table_def_key Â∞±ÊòØ Ôºö<code>Â∫ìÂêç + t1 +&quot;M ÁöÑ serverid&quot; + &quot;session B ÁöÑ thread_id&quot;</code></li></ul><p>MySQL Âú®ËÆ∞ÂΩï binlog ÁöÑÊó∂‰∏çËÆ∫ÊòØ create table ËøòÊòØ alter table ËØ≠Âè•ÈÉΩÊòØÂéüÊ†∑ËÆ∞ÂΩïÔºå‰ΩÜÊòØÂ¶ÇÊûúÊâßË°å drop tableÔºåÁ≥ªÁªüËÆ∞ÂΩï binlog Â∞±‰ºöË¢´ÊúçÂä°Á´ØÊîπÂÜô</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP TABLE `t_normal` /* generated by server */</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h5 id="Ë∑®Â∫ìÊü•ËØ¢" tabindex="-1"><a class="header-anchor" href="#Ë∑®Â∫ìÊü•ËØ¢"><span>Ë∑®Â∫ìÊü•ËØ¢</span></a></h5><p>ÂàÜÂ∫ìÂàÜË°®Á≥ªÁªüÁöÑË∑®Â∫ìÊü•ËØ¢‰ΩøÁî®‰∏¥Êó∂Ë°®‰∏çÁî®ÊãÖÂøÉÁ∫øÁ®ã‰πãÈó¥ÁöÑÈáçÂêçÂÜ≤Á™ÅÔºåÂàÜÂ∫ìÂàÜË°®Â∞±ÊòØË¶ÅÊää‰∏Ä‰∏™ÈÄªËæë‰∏äÁöÑÂ§ßË°®ÂàÜÊï£Âà∞‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ìÂÆû‰æã‰∏ä</p><p>ÊØîÂ¶ÇÂ∞Ü‰∏Ä‰∏™Â§ßË°® htÔºåÊåâÁÖßÂ≠óÊÆµ fÔºåÊãÜÂàÜÊàê 1024 ‰∏™ÂàÜË°®ÔºåÂàÜÂ∏ÉÂà∞ 32 ‰∏™Êï∞ÊçÆÂ∫ìÂÆû‰æã‰∏äÔºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÈÉΩÊúâ‰∏Ä‰∏™‰∏≠Èó¥Â±Ç proxy Ëß£Êûê SQL ËØ≠Âè•ÔºåÈÄöËøáÂàÜÂ∫ìËßÑÂàôÈÄöËøáÂàÜË°®ËßÑÂàôÔºàÊØîÂ¶Ç N%1024ÔºâÁ°ÆÂÆöÂ∞ÜËøôÊù°ËØ≠Âè•Ë∑ØÁî±Âà∞Âì™‰∏™ÂàÜË°®ÂÅöÊü•ËØ¢</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select v from ht where f=N;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Â¶ÇÊûúËøô‰∏™Ë°®‰∏äËøòÊúâÂè¶Â§ñ‰∏Ä‰∏™Á¥¢Âºï kÔºåÂπ∂‰∏îÊü•ËØ¢ËØ≠Âè•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select v from ht where k &gt;= M order by t_modified desc limit 100;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Êü•ËØ¢Êù°‰ª∂ÈáåÈù¢Ê≤°ÊúâÁî®Âà∞ÂàÜÂå∫Â≠óÊÆµ fÔºåÂè™ËÉΩ<strong>Âà∞ÊâÄÊúâÁöÑÂàÜÂå∫</strong>‰∏≠ÂéªÊü•ÊâæÊª°Ë∂≥Êù°‰ª∂ÁöÑÊâÄÊúâË°åÔºåÁÑ∂ÂêéÁªü‰∏ÄÂÅö order by Êìç‰ΩúÔºå‰∏§ÁßçÊñπÂºèÔºö</p><ul><li>Âú® proxy Â±ÇÁöÑËøõÁ®ã‰ª£Á†Å‰∏≠ÂÆûÁé∞ÊéíÂ∫èÔºåÊãøÂà∞ÂàÜÂ∫ìÁöÑÊï∞ÊçÆ‰ª•ÂêéÔºåÁõ¥Êé•Âú®ÂÜÖÂ≠ò‰∏≠ÂèÇ‰∏éËÆ°ÁÆóÔºå‰ΩÜÊòØÂØπ proxy Á´ØÁöÑÂéãÂäõÊØîËæÉÂ§ßÔºåÂæàÂÆπÊòìÂá∫Áé∞ÂÜÖÂ≠ò‰∏çÂ§üÁî®Âíå CPU Áì∂È¢àÈóÆÈ¢ò</li><li>ÊääÂêÑ‰∏™ÂàÜÂ∫ìÊãøÂà∞ÁöÑÊï∞ÊçÆÔºåÊ±áÊÄªÂà∞‰∏Ä‰∏™ MySQL ÂÆû‰æãÁöÑ‰∏Ä‰∏™Ë°®‰∏≠ÔºåÁÑ∂ÂêéÂú®Ëøô‰∏™Ê±áÊÄªÂÆû‰æã‰∏äÂÅöÈÄªËæëÊìç‰ΩúÔºåÊâßË°åÊµÅÁ®ãÔºö <ul><li>Âú®Ê±áÊÄªÂ∫ì‰∏äÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂Ë°® temp_htÔºåË°®ÈáåÂåÖÂê´‰∏â‰∏™Â≠óÊÆµ v„ÄÅk„ÄÅt_modified</li><li>Âú®ÂêÑ‰∏™ÂàÜÂ∫ìÊâßË°åÔºö<code>select v,k,t_modified from ht_x where k &gt;= M order by t_modified desc limit 100</code></li><li>ÊääÂàÜÂ∫ìÊâßË°åÁöÑÁªìÊûúÊèíÂÖ•Âà∞ temp_ht Ë°®‰∏≠</li><li>Âú®‰∏¥Êó∂Ë°®‰∏äÊâßË°åÔºö<code>select v from temp_ht order by t_modified desc limit 100</code></li></ul></li></ul><hr><h3 id="‰ºòÂåñÊ≠•È™§" tabindex="-1"><a class="header-anchor" href="#‰ºòÂåñÊ≠•È™§"><span>‰ºòÂåñÊ≠•È™§</span></a></h3><h4 id="ÊâßË°åÈ¢ëÁéá" tabindex="-1"><a class="header-anchor" href="#ÊâßË°åÈ¢ëÁéá"><span>ÊâßË°åÈ¢ëÁéá</span></a></h4><p>MySQL ÂÆ¢Êà∑Á´ØËøûÊé•ÊàêÂäüÂêéÔºåÊü•ËØ¢ÊúçÂä°Âô®Áä∂ÊÄÅ‰ø°ÊÅØÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW [SESSION|GLOBAL] STATUS LIKE &#39;&#39;;</span></span>
<span class="line"><span>-- SESSION: ÊòæÁ§∫ÂΩìÂâç‰ºöËØùËøûÊé•ÁöÑÁªüËÆ°ÁªìÊûúÔºåÈªòËÆ§ÂèÇÊï∞</span></span>
<span class="line"><span>-- GLOBAL: ÊòæÁ§∫Ëá™Êï∞ÊçÆÂ∫ì‰∏äÊ¨°ÂêØÂä®Ëá≥‰ªäÁöÑÁªüËÆ°ÁªìÊûú</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>Êü•Áúã SQL ÊâßË°åÈ¢ëÁéáÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW STATUS LIKE &#39;Com_____&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Com_xxx Ë°®Á§∫ÊØèÁßçËØ≠Âè•ÊâßË°åÁöÑÊ¨°Êï∞</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQLËØ≠Âè•ÊâßË°åÈ¢ëÁéá.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Êü•ËØ¢ SQL ËØ≠Âè•ÂΩ±ÂìçÁöÑË°åÊï∞Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW STATUS LIKE &#39;Innodb_rows_%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQLËØ≠Âè•ÂΩ±ÂìçÁöÑË°åÊï∞.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><p>Com_xxxxÔºöËøô‰∫õÂèÇÊï∞ÂØπ‰∫éÊâÄÊúâÂ≠òÂÇ®ÂºïÊìéÁöÑË°®Êìç‰ΩúÈÉΩ‰ºöËøõË°åÁ¥ØËÆ°</p><p>Innodb_xxxxÔºöËøôÂá†‰∏™ÂèÇÊï∞Âè™ÊòØÈíàÂØπ InnoDB Â≠òÂÇ®ÂºïÊìéÁöÑÔºåÁ¥ØÂä†ÁöÑÁÆóÊ≥ï‰πüÁï•Êúâ‰∏çÂêå</p><table><thead><tr><th style="text-align:left;">ÂèÇÊï∞</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td style="text-align:left;">Com_select</td><td>ÊâßË°å SELECT Êìç‰ΩúÁöÑÊ¨°Êï∞Ôºå‰∏ÄÊ¨°Êü•ËØ¢Âè™Á¥ØÂä† 1</td></tr><tr><td style="text-align:left;">Com_insert</td><td>ÊâßË°å INSERT Êìç‰ΩúÁöÑÊ¨°Êï∞ÔºåÂØπ‰∫éÊâπÈáèÊèíÂÖ•ÁöÑ INSERT Êìç‰ΩúÔºåÂè™Á¥ØÂä†‰∏ÄÊ¨°</td></tr><tr><td style="text-align:left;">Com_update</td><td>ÊâßË°å UPDATE Êìç‰ΩúÁöÑÊ¨°Êï∞</td></tr><tr><td style="text-align:left;">Com_delete</td><td>ÊâßË°å DELETE Êìç‰ΩúÁöÑÊ¨°Êï∞</td></tr><tr><td style="text-align:left;">Innodb_rows_read</td><td>ÊâßË°å SELECT Êü•ËØ¢ËøîÂõûÁöÑË°åÊï∞</td></tr><tr><td style="text-align:left;">Innodb_rows_inserted</td><td>ÊâßË°å INSERT Êìç‰ΩúÊèíÂÖ•ÁöÑË°åÊï∞</td></tr><tr><td style="text-align:left;">Innodb_rows_updated</td><td>ÊâßË°å UPDATE Êìç‰ΩúÊõ¥Êñ∞ÁöÑË°åÊï∞</td></tr><tr><td style="text-align:left;">Innodb_rows_deleted</td><td>ÊâßË°å DELETE Êìç‰ΩúÂà†Èô§ÁöÑË°åÊï∞</td></tr><tr><td style="text-align:left;">Connections</td><td>ËØïÂõæËøûÊé• MySQL ÊúçÂä°Âô®ÁöÑÊ¨°Êï∞</td></tr><tr><td style="text-align:left;">Uptime</td><td>ÊúçÂä°Âô®Â∑•‰ΩúÊó∂Èó¥</td></tr><tr><td style="text-align:left;">Slow_queries</td><td>ÊÖ¢Êü•ËØ¢ÁöÑÊ¨°Êï∞</td></tr></tbody></table><hr><h4 id="ÂÆö‰Ωç‰ΩéÊïà" tabindex="-1"><a class="header-anchor" href="#ÂÆö‰Ωç‰ΩéÊïà"><span>ÂÆö‰Ωç‰ΩéÊïà</span></a></h4><p>SQL ÊâßË°åÊÖ¢Êúâ‰∏§ÁßçÊÉÖÂÜµÔºö</p><ul><li>ÂÅ∂Â∞îÊÖ¢ÔºöDB Âú®Âà∑Êñ∞ËÑèÈ°µÔºàÂ≠¶ÂÆå‰∫ãÂä°Â∞±ÊáÇ‰∫ÜÔºâ <ul><li>redo log ÂÜôÊª°‰∫Ü</li><li>ÂÜÖÂ≠ò‰∏çÂ§üÁî®ÔºåË¶Å‰ªé LRU ÈìæË°®‰∏≠Ê∑òÊ±∞</li><li>MySQL ËÆ§‰∏∫Á≥ªÁªüÁ©∫Èó≤ÁöÑÊó∂ÂÄô</li><li>MySQL ÂÖ≥Èó≠Êó∂</li></ul></li><li>‰∏ÄÁõ¥ÊÖ¢ÁöÑÂéüÂõ†ÔºöÁ¥¢ÂºïÊ≤°ÊúâËÆæËÆ°Â•Ω„ÄÅSQL ËØ≠Âè•Ê≤°ÂÜôÂ•Ω„ÄÅMySQL ÈÄâÈîô‰∫ÜÁ¥¢Âºï</li></ul><p>ÈÄöËøá‰ª•‰∏ã‰∏§ÁßçÊñπÂºèÂÆö‰ΩçÊâßË°åÊïàÁéáËæÉ‰ΩéÁöÑ SQL ËØ≠Âè•</p><ul><li><p>ÊÖ¢Êó•ÂøóÊü•ËØ¢Ôºö ÊÖ¢Êü•ËØ¢Êó•ÂøóÂú®Êü•ËØ¢ÁªìÊùü‰ª•ÂêéÊâçËÆ∞ÂΩïÔºåÊâßË°åÊïàÁéáÂá∫Áé∞ÈóÆÈ¢òÊó∂Êü•ËØ¢Êó•ÂøóÂπ∂‰∏çËÉΩÂÆö‰ΩçÈóÆÈ¢ò</p><p>ÈÖçÁΩÆÊñá‰ª∂‰øÆÊîπÔºö‰øÆÊîπ .cnf Êñá‰ª∂ <code>vim /etc/mysql/my.cnf</code>ÔºåÈáçÂêØ MySQL ÊúçÂä°Âô®</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">slow_query_log</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ON</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">slow_query_log_file</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/usr/local/mysql/var/localhost-slow.log</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">long_query_time</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">	#ËÆ∞ÂΩïË∂ÖËøálong_query_timeÁßíÁöÑSQLËØ≠Âè•ÁöÑÊó•Âøó</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">log-queries-not-using-indexes</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>‰ΩøÁî®ÂëΩ‰ª§ÈÖçÁΩÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>mysql&gt; SET slow_query_log=ON;</span></span>
<span class="line"><span>mysql&gt; SET GLOBAL slow_query_log=ON;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Êü•ÁúãÊòØÂê¶ÈÖçÁΩÆÊàêÂäüÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW VARIABLES LIKE &#39;%query%&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>SHOW PROCESSLISTÔºö<strong>ÂÆûÊó∂Êü•Áúã</strong>ÂΩìÂâç MySQL Âú®ËøõË°åÁöÑËøûÊé•Á∫øÁ®ãÔºåÂåÖÊã¨Á∫øÁ®ãÁöÑÁä∂ÊÄÅ„ÄÅÊòØÂê¶ÈîÅË°®„ÄÅSQL ÁöÑÊâßË°åÊÉÖÂÜµÔºåÂêåÊó∂ÂØπ‰∏Ä‰∫õÈîÅË°®Êìç‰ΩúËøõË°å‰ºòÂåñ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SHOW_PROCESSLISTÂëΩ‰ª§-1720750205638-6.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><hr><h4 id="explain" tabindex="-1"><a class="header-anchor" href="#explain"><span>EXPLAIN</span></a></h4><h5 id="ÊâßË°åËÆ°Âàí" tabindex="-1"><a class="header-anchor" href="#ÊâßË°åËÆ°Âàí"><span>ÊâßË°åËÆ°Âàí</span></a></h5><p>ÈÄöËøá EXPLAIN ÂëΩ‰ª§Ëé∑ÂèñÊâßË°å SQL ËØ≠Âè•ÁöÑ‰ø°ÊÅØÔºåÂåÖÊã¨Âú® SELECT ËØ≠Âè•ÊâßË°åËøáÁ®ã‰∏≠Â¶Ç‰ΩïËøûÊé•ÂíåËøûÊé•ÁöÑÈ°∫Â∫èÔºåÊâßË°åËÆ°ÂàíÂú®‰ºòÂåñÂô®‰ºòÂåñÂÆåÊàêÂêé„ÄÅÊâßË°åÂô®‰πãÂâçÁîüÊàêÔºåÁÑ∂ÂêéÊâßË°åÂô®‰ºöË∞ÉÁî®Â≠òÂÇ®ÂºïÊìéÊ£ÄÁ¥¢Êï∞ÊçÆ</p><p>Êü•ËØ¢ SQL ËØ≠Âè•ÁöÑÊâßË°åËÆ°ÂàíÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM table_1 WHERE id = 1;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-explainÊü•ËØ¢SQLËØ≠Âè•ÁöÑÊâßË°åËÆ°Âàí.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><table><thead><tr><th>Â≠óÊÆµ</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td>id</td><td>SELECT ÁöÑÂ∫èÂàóÂè∑</td></tr><tr><td>select_type</td><td>Ë°®Á§∫ SELECT ÁöÑÁ±ªÂûã</td></tr><tr><td>table</td><td>ËÆøÈóÆÊï∞ÊçÆÂ∫ì‰∏≠Ë°®ÂêçÁß∞ÔºåÊúâÊó∂ÂèØËÉΩÊòØÁÆÄÁß∞ÊàñËÄÖ‰∏¥Êó∂Ë°®ÂêçÁß∞Ôºà&lt;table_name&gt;Ôºâ</td></tr><tr><td>type</td><td>Ë°®Á§∫Ë°®ÁöÑËøûÊé•Á±ªÂûã</td></tr><tr><td>possible_keys</td><td>Ë°®Á§∫Êü•ËØ¢Êó∂ÔºåÂèØËÉΩ‰ΩøÁî®ÁöÑÁ¥¢Âºï</td></tr><tr><td>key</td><td>Ë°®Á§∫ÂÆûÈôÖ‰ΩøÁî®ÁöÑÁ¥¢Âºï</td></tr><tr><td>key_len</td><td>Á¥¢ÂºïÂ≠óÊÆµÁöÑÈïøÂ∫¶</td></tr><tr><td>ref</td><td>Ë°®Á§∫‰∏éÁ¥¢ÂºïÂàóËøõË°åÁ≠âÂÄºÂåπÈÖçÁöÑÂØπË±°ÔºåÂ∏∏Êï∞„ÄÅÊüê‰∏™Âàó„ÄÅÂáΩÊï∞Á≠âÔºåtype ÂøÖÈ°ªÂú®Ôºàrange, const] ‰πãÈó¥ÔºåÂ∑¶Èó≠Âè≥ÂºÄ</td></tr><tr><td>rows</td><td>Êâ´ÊèèÂá∫ÁöÑË°åÊï∞ÔºåË°®Á§∫ MySQL Ê†πÊçÆË°®ÁªüËÆ°‰ø°ÊÅØÂèäÁ¥¢ÂºïÈÄâÁî®ÊÉÖÂÜµÔºå<strong>‰º∞ÁÆó</strong>ÁöÑÊâæÂà∞ÊâÄÈúÄÁöÑËÆ∞ÂΩïÊâ´ÊèèÁöÑË°åÊï∞</td></tr><tr><td>filtered</td><td>Êù°‰ª∂ËøáÊª§ÁöÑË°åÁôæÂàÜÊØîÔºåÂçïË°®Êü•ËØ¢Ê≤°ÊÑè‰πâÔºåÁî®‰∫éËøûÊé•Êü•ËØ¢‰∏≠ÂØπÈ©±Âä®Ë°®ÁöÑÊâáÂá∫ËøõË°åËøáÊª§ÔºåÊü•ËØ¢‰ºòÂåñÂô®È¢ÑÊµãÊâÄÊúâÊâáÂá∫ÂÄºÊª°Ë∂≥Ââ©‰ΩôÊü•ËØ¢Êù°‰ª∂ÁöÑÁôæÂàÜÊØîÔºåÁõ∏‰πò‰ª•ÂêéË°®Á§∫Â§öË°®Êü•ËØ¢‰∏≠ËøòË¶ÅÂØπË¢´È©±Âä®ÊâßË°åÊü•ËØ¢ÁöÑÊ¨°Êï∞</td></tr><tr><td>extra</td><td>ÊâßË°åÊÉÖÂÜµÁöÑËØ¥ÊòéÂíåÊèèËø∞</td></tr></tbody></table><p>MySQL <strong>ÊâßË°åËÆ°ÂàíÁöÑÂ±ÄÈôê</strong>Ôºö</p><ul><li>Âè™ÊòØËÆ°ÂàíÔºå‰∏çÊòØÊâßË°å SQL ËØ≠Âè•ÔºåÂèØ‰ª•ÈöèÁùÄÂ∫ïÂ±Ç‰ºòÂåñÂô®ËæìÂÖ•ÁöÑÊõ¥ÊîπËÄåÊõ¥Êîπ</li><li>EXPLAIN ‰∏ç‰ºöÂëäËØâÊòæÁ§∫ÂÖ≥‰∫éËß¶ÂèëÂô®„ÄÅÂ≠òÂÇ®ËøáÁ®ãÁöÑ‰ø°ÊÅØÂØπÊü•ËØ¢ÁöÑÂΩ±ÂìçÊÉÖÂÜµÔºå ‰∏çËÄÉËôëÂêÑÁßç Cache</li><li>EXPLAIN ‰∏çËÉΩÊòæÁ§∫ MySQL Âú®ÊâßË°åÊü•ËØ¢Êó∂ÁöÑÂä®ÊÄÅÔºåÂõ†‰∏∫ÊâßË°åËÆ°ÂàíÂú®ÊâßË°å<strong>Êü•ËØ¢‰πãÂâçÁîüÊàê</strong></li><li>EXPALIN Âè™ËÉΩËß£Èáä SELECT Êìç‰ΩúÔºåÂÖ∂‰ªñÊìç‰ΩúË¶ÅÈáçÂÜô‰∏∫ SELECT ÂêéÊü•ÁúãÊâßË°åËÆ°Âàí</li><li>EXPLAIN PLAN ÊòæÁ§∫ÁöÑÊòØÂú®Ëß£ÈáäËØ≠Âè•Êó∂Êï∞ÊçÆÂ∫ìÂ∞ÜÂ¶Ç‰ΩïËøêË°å SQL ËØ≠Âè•ÔºåÁî±‰∫éÊâßË°åÁéØÂ¢ÉÂíå EXPLAIN PLAN ÁéØÂ¢ÉÁöÑ‰∏çÂêåÔºåÊ≠§ËÆ°ÂàíÂèØËÉΩ‰∏é SQL ËØ≠Âè•<strong>ÂÆûÈôÖÁöÑÊâßË°åËÆ°Âàí‰∏çÂêå</strong>ÔºåÈÉ®ÂàÜÁªüËÆ°‰ø°ÊÅØÊòØ‰º∞ÁÆóÁöÑÔºåÂπ∂ÈùûÁ≤æÁ°ÆÂÄº</li></ul><p>SHOW WARINGSÔºöÂú®‰ΩøÁî® EXPALIN ÂëΩ‰ª§ÂêéÊâßË°åËØ•ËØ≠Âè•ÔºåÂèØ‰ª•Êü•ËØ¢‰∏éÊâßË°åËÆ°ÂàíÁõ∏ÂÖ≥ÁöÑÊãìÂ±ï‰ø°ÊÅØÔºåÂ±ïÁ§∫Âá∫ Level„ÄÅCode„ÄÅMessage ‰∏â‰∏™Â≠óÊÆµÔºåÂΩì Code ‰∏∫ 1003 Êó∂ÔºåMessage Â≠óÊÆµÂ±ïÁ§∫ÁöÑ‰ø°ÊÅØÁ±ª‰ºº‰∫éÂ∞ÜÊü•ËØ¢ËØ≠Âè•ÈáçÂÜôÂêéÁöÑ‰ø°ÊÅØÔºå‰ΩÜÊòØ‰∏çÊòØÁ≠â‰ª∑Ôºå‰∏çËÉΩÊâßË°åÂ§çÂà∂ËøáÊù•ËøêË°å</p><p>ÁéØÂ¢ÉÂáÜÂ§áÔºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ÊâßË°åËÆ°ÂàíÁéØÂ¢ÉÂáÜÂ§á.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h5 id="id" tabindex="-1"><a class="header-anchor" href="#id"><span>id</span></a></h5><p>id ‰ª£Ë°® SQL ÊâßË°åÁöÑÈ°∫Â∫èÁöÑÊ†áËØÜÔºåÊØè‰∏™ SELECT ÂÖ≥ÈîÆÂ≠óÂØπÂ∫î‰∏Ä‰∏™ÂîØ‰∏Ä idÔºåÊâÄ‰ª•Âú®Âêå‰∏Ä‰∏™ SELECT ÂÖ≥ÈîÆÂ≠ó‰∏≠ÁöÑË°®ÁöÑ id ÈÉΩÊòØÁõ∏ÂêåÁöÑ„ÄÇSELECT ÂêéÁöÑ FROM ÂèØ‰ª•Ë∑üÈöèÂ§ö‰∏™Ë°®ÔºåÊØè‰∏™Ë°®ÈÉΩ‰ºöÂØπÂ∫î‰∏ÄÊù°ËÆ∞ÂΩïÔºåËøô‰∫õËÆ∞ÂΩïÁöÑ id ÈÉΩÊòØÁõ∏ÂêåÁöÑÔºå</p><ul><li><p>id Áõ∏ÂêåÊó∂ÔºåÊâßË°åÈ°∫Â∫èÁî±‰∏äËá≥‰∏ã„ÄÇËøûÊé•Êü•ËØ¢ÁöÑÊâßË°åËÆ°ÂàíÔºåËÆ∞ÂΩïÁöÑ id ÂÄºÈÉΩÊòØÁõ∏ÂêåÁöÑÔºåÂá∫Áé∞Âú®ÂâçÈù¢ÁöÑË°®‰∏∫È©±Âä®Ë°®ÔºåÂêéÈù¢‰∏∫Ë¢´È©±Âä®Ë°®</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM t_role r, t_user u, user_role ur WHERE r.id = ur.role_id AND u.id = ur.user_id ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-explain‰πãidÁõ∏Âêå.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>id ‰∏çÂêåÊó∂Ôºåid ÂÄºË∂äÂ§ß‰ºòÂÖàÁ∫ßË∂äÈ´òÔºåË∂äÂÖàË¢´ÊâßË°å</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM t_role WHERE id = (SELECT role_id FROM user_role WHERE user_id = (SELECT id FROM t_user WHERE username = &#39;stu1&#39;))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-explain‰πãid‰∏çÂêå.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>id ÊúâÁõ∏Âêå‰πüÊúâ‰∏çÂêåÊó∂Ôºåid Áõ∏ÂêåÁöÑÂèØ‰ª•ËÆ§‰∏∫ÊòØ‰∏ÄÁªÑÔºå‰ªé‰∏äÂæÄ‰∏ãÈ°∫Â∫èÊâßË°åÔºõÂú®ÊâÄÊúâÁöÑÁªÑ‰∏≠Ôºåid ÁöÑÂÄºË∂äÂ§ßÁöÑÁªÑÔºå‰ºòÂÖàÁ∫ßË∂äÈ´òÔºåË∂äÂÖàÊâßË°å</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM t_role r , (SELECT * FROM user_role ur WHERE ur.`user_id` = &#39;2&#39;) a WHERE r.id = a.role_id ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-explain‰πãidÁõ∏ÂêåÂíå‰∏çÂêå.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>id ‰∏∫ NULL Êó∂‰ª£Ë°®ÁöÑÊòØ‰∏¥Êó∂Ë°®</p></li></ul><hr><h5 id="select" tabindex="-1"><a class="header-anchor" href="#select"><span>select</span></a></h5><p>Ë°®Á§∫Êü•ËØ¢‰∏≠ÊØè‰∏™ select Â≠êÂè•ÁöÑÁ±ªÂûãÔºàÁÆÄÂçï OR Â§çÊùÇÔºâ</p><table><thead><tr><th>select_type</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td>SIMPLE</td><td>ÁÆÄÂçïÁöÑ SELECT Êü•ËØ¢ÔºåÊü•ËØ¢‰∏≠‰∏çÂåÖÂê´Â≠êÊü•ËØ¢ÊàñËÄÖ UNION</td></tr><tr><td>PRIMARY</td><td>Êü•ËØ¢‰∏≠Ëã•ÂåÖÂê´‰ªª‰ΩïÂ§çÊùÇÁöÑÂ≠êÊü•ËØ¢ÔºåÊúÄÂ§ñÂ±ÇÔºà‰πüÂ∞±ÊòØÊúÄÂ∑¶‰æßÔºâÊü•ËØ¢Ê†áËÆ∞‰∏∫ËØ•Ê†áËØÜ</td></tr><tr><td>UNION</td><td>ÂØπ‰∫é UNION ÊàñËÄÖ UNION ALL ÁöÑÂ§çÊùÇÊü•ËØ¢ÔºåÈô§‰∫ÜÊúÄÂ∑¶‰æßÁöÑÊü•ËØ¢ÔºåÂÖ∂‰ΩôÁöÑÂ∞èÊü•ËØ¢ÈÉΩÊòØ UNION</td></tr><tr><td>UNION RESULT</td><td>UNION ÈúÄË¶Å‰ΩøÁî®‰∏¥Êó∂Ë°®ËøõË°åÂéªÈáçÔºå‰∏¥Êó∂Ë°®ÁöÑÊòØ UNION RESULT</td></tr><tr><td>DEPENDENT UNION</td><td>ÂØπ‰∫é UNION ÊàñËÄÖ UNION ALL ÁöÑÂ§çÊùÇÊü•ËØ¢ÔºåÂ¶ÇÊûúÂêÑ‰∏™Â∞èÊü•ËØ¢ÈÉΩ‰æùËµñÂ§ñÂ±ÇÊü•ËØ¢ÔºåÊòØÁõ∏ÂÖ≥Â≠êÊü•ËØ¢ÔºåÈô§‰∫ÜÊúÄÂ∑¶‰æßÁöÑÂ∞èÊü•ËØ¢‰∏∫ DEPENDENT SUBQUERYÔºåÂÖ∂‰ΩôÈÉΩÊòØ DEPENDENT UNION</td></tr><tr><td>SUBQUERY</td><td>Â≠êÊü•ËØ¢‰∏çÊòØÁõ∏ÂÖ≥Â≠êÊü•ËØ¢ÔºåËØ•Â≠êÊü•ËØ¢Á¨¨‰∏Ä‰∏™ SELECT ‰ª£Ë°®ÁöÑÊü•ËØ¢Â∞±ÊòØËøôÁßçÁ±ªÂûãÔºå‰ºöËøõË°åÁâ©ÂåñÔºàËØ•Â≠êÊü•ËØ¢Âè™ÈúÄË¶ÅÊâßË°å‰∏ÄÊ¨°Ôºâ</td></tr><tr><td>DEPENDENT SUBQUERY</td><td>Â≠êÊü•ËØ¢ÊòØÁõ∏ÂÖ≥Â≠êÊü•ËØ¢ÔºåËØ•Â≠êÊü•ËØ¢Á¨¨‰∏Ä‰∏™ SELECT ‰ª£Ë°®ÁöÑÊü•ËØ¢Â∞±ÊòØËøôÁßçÁ±ªÂûãÔºå‰∏ç‰ºöÁâ©ÂåñÔºàËØ•Â≠êÊü•ËØ¢ÈúÄË¶ÅÊâßË°åÂ§öÊ¨°Ôºâ</td></tr><tr><td>DERIVED</td><td>Âú® FROM ÂàóË°®‰∏≠ÂåÖÂê´ÁöÑÂ≠êÊü•ËØ¢ÔºåË¢´Ê†áËÆ∞‰∏∫ DERIVEDÔºàË°çÁîüÔºâÔºå‰πüÂ∞±ÊòØÁîüÊàêÁâ©ÂåñÊ¥æÁîüË°®ÁöÑËøô‰∏™Â≠êÊü•ËØ¢</td></tr><tr><td>MATERIALIZED</td><td>Â∞ÜÂ≠êÊü•ËØ¢Áâ©ÂåñÂêé‰∏é‰∏éÂ§ñÂ±ÇËøõË°åËøûÊé•Êü•ËØ¢ÔºåÁîüÊàêÁâ©ÂåñË°®ÁöÑÂ≠êÊü•ËØ¢</td></tr></tbody></table><p>Â≠êÊü•ËØ¢‰∏∫ DERIVEDÔºö<code>SELECT * FROM (SELECT key1 FROM t1) AS derived_1 WHERE key1 &gt; 10</code></p><p>Â≠êÊü•ËØ¢‰∏∫ MATERIALIZEDÔºö<code>SELECT * FROM t1 WHERE key1 IN (SELECT key1 FROM t2)</code></p><hr><h5 id="type" tabindex="-1"><a class="header-anchor" href="#type"><span>type</span></a></h5><p>ÂØπË°®ÁöÑËÆøÈóÆÊñπÂºèÔºåË°®Á§∫ MySQL Âú®Ë°®‰∏≠ÊâæÂà∞ÊâÄÈúÄË°åÁöÑÊñπÂºèÔºåÂèàÁß∞ËÆøÈóÆÁ±ªÂûã</p><table><thead><tr><th>type</th><th>Âê´‰πâ</th></tr></thead><tbody><tr><td>ALL</td><td>ÂÖ®Ë°®Êâ´ÊèèÔºåÂ¶ÇÊûúÊòØ InnoDB ÂºïÊìéÊòØÊâ´ÊèèËÅöÁ∞áÁ¥¢Âºï</td></tr><tr><td>index</td><td>ÂèØ‰ª•‰ΩøÁî®Ë¶ÜÁõñÁ¥¢ÂºïÔºå‰ΩÜÈúÄË¶ÅÊâ´ÊèèÂÖ®ÈÉ®Á¥¢Âºï</td></tr><tr><td>range</td><td>Á¥¢ÂºïËåÉÂõ¥Êâ´ÊèèÔºåÂ∏∏ËßÅ‰∫é between„ÄÅ&lt;„ÄÅ&gt; Á≠âÁöÑÊü•ËØ¢</td></tr><tr><td>index_subquery</td><td>Â≠êÊü•ËØ¢ÂèØ‰ª•ÊôÆÈÄöÁ¥¢ÂºïÔºåÂàôÂ≠êÊü•ËØ¢ÁöÑ type ‰∏∫ index_subquery</td></tr><tr><td>unique_subquery</td><td>Â≠êÊü•ËØ¢ÂèØ‰ª•‰ΩøÁî®‰∏ªÈîÆÊàñÂîØ‰∏Ä‰∫åÁ∫ßÁ¥¢ÂºïÔºåÂàôÂ≠êÊü•ËØ¢ÁöÑ type ‰∏∫ index_subquery</td></tr><tr><td>index_merge</td><td>Á¥¢ÂºïÂêàÂπ∂</td></tr><tr><td>ref_or_null</td><td>ÈùûÂîØ‰∏ÄÊÄßÁ¥¢ÂºïÔºàÊôÆÈÄö‰∫åÁ∫ßÁ¥¢ÂºïÔºâÂπ∂‰∏îÂèØ‰ª•Â≠òÂÇ® NULLÔºåËøõË°åÁ≠âÂÄºÂåπÈÖç</td></tr><tr><td>ref</td><td>ÈùûÂîØ‰∏ÄÊÄßÁ¥¢Âºï‰∏éÂ∏∏ÈáèÁ≠âÂÄºÂåπÈÖç</td></tr><tr><td>eq_ref</td><td>ÂîØ‰∏ÄÊÄßÁ¥¢ÂºïÔºà‰∏ªÈîÆÊàñ‰∏çÂ≠òÂÇ® NULL ÁöÑÂîØ‰∏Ä‰∫åÁ∫ßÁ¥¢ÂºïÔºâËøõË°åÁ≠âÂÄºÂåπÈÖçÔºåÂ¶ÇÊûú‰∫åÁ∫ßÁ¥¢ÂºïÊòØËÅîÂêàÁ¥¢ÂºïÔºåÈÇ£‰πàÊâÄÊúâËÅîÂêàÁöÑÂàóÈÉΩË¶ÅËøõË°åÁ≠âÂÄºÂåπÈÖç</td></tr><tr><td>const</td><td>ÈÄöËøá‰∏ªÈîÆÊàñËÄÖÂîØ‰∏Ä‰∫åÁ∫ßÁ¥¢Âºï‰∏éÂ∏∏ÈáèËøõË°åÁ≠âÂÄºÂåπÈÖç</td></tr><tr><td>system</td><td>system ÊòØ const Á±ªÂûãÁöÑÁâπ‰æãÔºåÂΩìÊü•ËØ¢ÁöÑË°®Âè™Êúâ‰∏ÄÊù°ËÆ∞ÂΩïÁöÑÊÉÖÂÜµ‰∏ãÔºå‰ΩøÁî® system</td></tr><tr><td>NULL</td><td>MySQL Âú®‰ºòÂåñËøáÁ®ã‰∏≠ÂàÜËß£ËØ≠Âè•ÔºåÊâßË°åÊó∂ÁîöËá≥‰∏çÁî®ËÆøÈóÆË°®ÊàñÁ¥¢Âºï</td></tr></tbody></table><p>‰ªé‰∏äÂà∞‰∏ãÔºåÊÄßËÉΩ‰ªéÂ∑ÆÂà∞Â•ΩÔºå‰∏ÄËà¨Êù•ËØ¥ÈúÄË¶Å‰øùËØÅÊü•ËØ¢Ëá≥Â∞ëËææÂà∞ range Á∫ßÂà´Ôºå ÊúÄÂ•ΩËææÂà∞ ref</p><hr><h5 id="key" tabindex="-1"><a class="header-anchor" href="#key"><span>key</span></a></h5><p>possible_keysÔºö</p><ul><li>ÊåáÂá∫ MySQL ËÉΩ‰ΩøÁî®Âì™‰∏™Á¥¢ÂºïÂú®Ë°®‰∏≠ÊâæÂà∞ËÆ∞ÂΩïÔºåÊü•ËØ¢Ê∂âÂèäÂà∞ÁöÑÂ≠óÊÆµ‰∏äËã•Â≠òÂú®Á¥¢ÂºïÔºåÂàôËØ•Á¥¢ÂºïÂ∞ÜË¢´ÂàóÂá∫Ôºå‰ΩÜ‰∏ç‰∏ÄÂÆöË¢´Êü•ËØ¢‰ΩøÁî®</li><li>Â¶ÇÊûúËØ•ÂàóÊòØ NULLÔºåÂàôÊ≤°ÊúâÁõ∏ÂÖ≥ÁöÑÁ¥¢Âºï</li></ul><p>keyÔºö</p><ul><li>ÊòæÁ§∫ MySQL Âú®Êü•ËØ¢‰∏≠ÂÆûÈôÖ‰ΩøÁî®ÁöÑÁ¥¢ÂºïÔºåËã•Ê≤°Êúâ‰ΩøÁî®Á¥¢ÂºïÔºåÊòæÁ§∫‰∏∫ NULL</li><li>Êü•ËØ¢‰∏≠Ëã•‰ΩøÁî®‰∫Ü<strong>Ë¶ÜÁõñÁ¥¢Âºï</strong>ÔºåÂàôËØ•Á¥¢ÂºïÂèØËÉΩÂá∫Áé∞Âú® key ÂàóË°®Ôºå‰∏çÂá∫Áé∞Âú® possible_keys</li></ul><p>key_lenÔºö</p><ul><li>Ë°®Á§∫Á¥¢Âºï‰∏≠‰ΩøÁî®ÁöÑÂ≠óËäÇÊï∞ÔºåÂèØÈÄöËøáËØ•ÂàóËÆ°ÁÆóÊü•ËØ¢‰∏≠‰ΩøÁî®ÁöÑÁ¥¢ÂºïÁöÑÈïøÂ∫¶</li><li>key_len ÊòæÁ§∫ÁöÑÂÄº‰∏∫Á¥¢ÂºïÂ≠óÊÆµÁöÑÊúÄÂ§ßÂèØËÉΩÈïøÂ∫¶ÔºåÂπ∂ÈùûÂÆûÈôÖ‰ΩøÁî®ÈïøÂ∫¶ÔºåÂç≥ key_len ÊòØÊ†πÊçÆË°®ÂÆö‰πâËÆ°ÁÆóËÄåÂæóÔºå‰∏çÊòØÈÄöËøáË°®ÂÜÖÊ£ÄÁ¥¢Âá∫ÁöÑ</li><li>Âú®‰∏çÊçüÂ§±Á≤æÁ°ÆÊÄßÁöÑÂâçÊèê‰∏ãÔºåÈïøÂ∫¶Ë∂äÁü≠Ë∂äÂ•Ω</li></ul><hr><h5 id="extra" tabindex="-1"><a class="header-anchor" href="#extra"><span>Extra</span></a></h5><p>ÂÖ∂‰ªñÁöÑÈ¢ùÂ§ñÁöÑÊâßË°åËÆ°Âàí‰ø°ÊÅØÔºåÂú®ËØ•ÂàóÂ±ïÁ§∫Ôºö</p><ul><li>No tables usedÔºöÊü•ËØ¢ËØ≠Âè•‰∏≠‰ΩøÁî® FROM dual ÊàñËÄÖÊ≤°Êúâ FROM ËØ≠Âè•</li><li>Impossible WHEREÔºöÊü•ËØ¢ËØ≠Âè•‰∏≠ÁöÑ WHERE Â≠êÂè•Êù°‰ª∂Ê∞∏Ëøú‰∏∫ FALSEÔºå‰ºöÂØºËá¥Ê≤°ÊúâÁ¨¶ÂêàÊù°‰ª∂ÁöÑË°å</li><li>Using indexÔºöËØ•ÂÄºË°®Á§∫Áõ∏Â∫îÁöÑ SELECT Êìç‰Ωú‰∏≠‰ΩøÁî®‰∫Ü<strong>Ë¶ÜÁõñÁ¥¢Âºï</strong>ÔºàCovering IndexÔºâ</li><li>Using index conditionÔºöÁ¨¨‰∏ÄÁßçÊÉÖÂÜµÊòØÊêúÁ¥¢Êù°‰ª∂‰∏≠ËôΩÁÑ∂Âá∫Áé∞‰∫ÜÁ¥¢ÂºïÂàóÔºå‰ΩÜÊòØÈÉ®ÂàÜÊù°‰ª∂Êó†Ê≥ïÂΩ¢ÊàêÊâ´ÊèèÂå∫Èó¥Ôºà<strong>Á¥¢ÂºïÂ§±Êïà</strong>ÔºâÔºå‰ºöÊ†πÊçÆÂèØÁî®Á¥¢ÂºïÁöÑÊù°‰ª∂ÂÖàÊêúÁ¥¢‰∏ÄÈÅçÂÜçÂåπÈÖçÊó†Ê≥ï‰ΩøÁî®Á¥¢ÂºïÁöÑÊù°‰ª∂ÔºåÂõûË°®Êü•ËØ¢Êï∞ÊçÆÔºõÁ¨¨‰∫åÁßçÊòØ‰ΩøÁî®‰∫Ü<strong>Á¥¢ÂºïÊù°‰ª∂‰∏ãÊé®</strong>‰ºòÂåñ</li><li>Using whereÔºöÊêúÁ¥¢ÁöÑÊï∞ÊçÆÈúÄË¶ÅÂú® Server Â±ÇÂà§Êñ≠ÔºåÊó†Ê≥ï‰ΩøÁî®Á¥¢Âºï‰∏ãÊé®</li><li>Using join bufferÔºöËøûÊé•Êü•ËØ¢Ë¢´È©±Âä®Ë°®Êó†Ê≥ïÂà©Áî®Á¥¢ÂºïÔºåÈúÄË¶ÅËøûÊé•ÁºìÂÜ≤Âå∫Êù•Â≠òÂÇ®‰∏≠Èó¥ÁªìÊûú</li><li>Using filesortÔºöÊó†Ê≥ïÂà©Áî®Á¥¢ÂºïÂÆåÊàêÊéíÂ∫èÔºà‰ºòÂåñÊñπÂêëÔºâÔºåÈúÄË¶ÅÂØπÊï∞ÊçÆ‰ΩøÁî®Â§ñÈÉ®ÊéíÂ∫èÁÆóÊ≥ïÔºåÂ∞ÜÂèñÂæóÁöÑÊï∞ÊçÆÂú®ÂÜÖÂ≠òÊàñÁ£ÅÁõò‰∏≠ËøõË°åÊéíÂ∫è</li><li>Using temporaryÔºöË°®Á§∫ MySQL ÈúÄË¶Å‰ΩøÁî®‰∏¥Êó∂Ë°®Êù•Â≠òÂÇ®ÁªìÊûúÈõÜÔºåÂ∏∏ËßÅ‰∫é<strong>ÊéíÂ∫è„ÄÅÂéªÈáçÔºàUNIONÔºâ„ÄÅÂàÜÁªÑ</strong>Á≠âÂú∫ÊôØ</li><li>Select tables optimized awayÔºöËØ¥Êòé‰ªÖÈÄöËøá‰ΩøÁî®Á¥¢ÂºïÔºå‰ºòÂåñÂô®ÂèØËÉΩ‰ªÖ‰ªéËÅöÂêàÂáΩÊï∞ÁªìÊûú‰∏≠ËøîÂõû‰∏ÄË°å</li><li>No tables usedÔºöQuery ËØ≠Âè•‰∏≠‰ΩøÁî® from dual Êàñ‰∏çÂê´‰ªª‰Ωï from Â≠êÂè•</li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://www.cnblogs.com/ggjucheng/archive/2012/11/11/2765237.html</p><hr><h4 id="profiles" tabindex="-1"><a class="header-anchor" href="#profiles"><span>PROFILES</span></a></h4><p>SHOW PROFILES ËÉΩÂ§üÂú®ÂÅö SQL ‰ºòÂåñÊó∂ÂàÜÊûêÂΩìÂâç‰ºöËØù‰∏≠ËØ≠Âè•ÊâßË°åÁöÑ<strong>ËµÑÊ∫êÊ∂àËÄó</strong>ÊÉÖÂÜµ</p><ul><li><p>ÈÄöËøá have_profiling ÂèÇÊï∞ÔºåËÉΩÂ§üÁúãÂà∞ÂΩìÂâç MySQL ÊòØÂê¶ÊîØÊåÅ profileÔºö <img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-have_profiling.png" alt="" loading="lazy"></p></li><li><p>ÈªòËÆ§ profiling ÊòØÂÖ≥Èó≠ÁöÑÔºåÂèØ‰ª•ÈÄöËøá set ËØ≠Âè•Âú® Session Á∫ßÂà´ÂºÄÂêØ profilingÔºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-profiling.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET profiling=1; #ÂºÄÂêØprofiling ÂºÄÂÖ≥Ôºõ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÊâßË°å SHOW PROFILES Êåá‰ª§Ôºå Êù•Êü•Áúã SQL ËØ≠Âè•ÊâßË°åÁöÑËÄóÊó∂:</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW PROFILES;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Êü•ÁúãSQLËØ≠Âè•ÊâßË°åËÄóÊó∂.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Êü•ÁúãÂà∞ËØ• SQL ÊâßË°åËøáÁ®ã‰∏≠ÊØè‰∏™Á∫øÁ®ãÁöÑÁä∂ÊÄÅÂíåÊ∂àËÄóÁöÑÊó∂Èó¥Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW PROFILE FOR QUERY query_id;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQLÊâßË°åÊØè‰∏™Áä∂ÊÄÅÊ∂àËÄóÁöÑÊó∂Èó¥.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Âú®Ëé∑ÂèñÂà∞ÊúÄÊ∂àËÄóÊó∂Èó¥ÁöÑÁ∫øÁ®ãÁä∂ÊÄÅÂêéÔºåMySQL ÊîØÊåÅÈÄâÊã© all„ÄÅcpu„ÄÅblock io „ÄÅcontext switch„ÄÅpage faults Á≠âÁ±ªÂûãÊü•Áúã MySQL Âú®‰ΩøÁî®‰ªÄ‰πàËµÑÊ∫ê‰∏äËÄóË¥π‰∫ÜËøáÈ´òÁöÑÊó∂Èó¥„ÄÇ‰æãÂ¶ÇÔºåÈÄâÊã©Êü•Áúã CPU ÁöÑËÄóË¥πÊó∂Èó¥Ôºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-SQLÊâßË°åÊØè‰∏™Áä∂ÊÄÅÊ∂àËÄóÁöÑCPU.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>StatusÔºöSQL ËØ≠Âè•ÊâßË°åÁöÑÁä∂ÊÄÅ</li><li>DurationsqlÔºöÊâßË°åËøáÁ®ã‰∏≠ÊØè‰∏Ä‰∏™Ê≠•È™§ÁöÑËÄóÊó∂</li><li>CPU_userÔºöÂΩìÂâçÁî®Êà∑Âç†ÊúâÁöÑ CPU</li><li>CPU_systemÔºöÁ≥ªÁªüÂç†ÊúâÁöÑ CPU</li></ul></li></ul><hr><h4 id="trace" tabindex="-1"><a class="header-anchor" href="#trace"><span>TRACE</span></a></h4><p>MySQL Êèê‰æõ‰∫ÜÂØπ SQL ÁöÑË∑üË∏™Ôºå ÈÄöËøá trace Êñá‰ª∂ÂèØ‰ª•Êü•Áúã‰ºòÂåñÂô®<strong>ÁîüÊàêÊâßË°åËÆ°ÂàíÁöÑËøáÁ®ã</strong></p><ul><li><p>ÊâìÂºÄ trace ÂäüËÉΩÔºåËÆæÁΩÆÊ†ºÂºè‰∏∫ JSONÔºåÂπ∂ËÆæÁΩÆ trace ÁöÑÊúÄÂ§ß‰ΩøÁî®ÂÜÖÂ≠òÔºåÈÅøÂÖçËß£ÊûêËøáÁ®ã‰∏≠Âõ†ÈªòËÆ§ÂÜÖÂ≠òËøáÂ∞èËÄå‰∏çËÉΩÂ§üÂÆåÊï¥Â±ïÁ§∫</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET optimizer_trace=&quot;enabled=on&quot;,end_markers_in_json=ON;	-- ‰ºöËØùÂÜÖÊúâÊïà</span></span>
<span class="line"><span>SET optimizer_trace_max_mem_size=1000000;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÊâßË°å SQL ËØ≠Âè•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM tb_item WHERE id &lt; 4;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Ê£ÄÊü• information_schema.optimizer_traceÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM information_schema.optimizer_trace \G; -- \G‰ª£Ë°®Á´ñÂàóÂ±ïÁ§∫</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ÊâßË°å‰ø°ÊÅØ‰∏ªË¶ÅÊúâ‰∏â‰∏™Èò∂ÊÆµÔºöprepare Èò∂ÊÆµ„ÄÅoptimize Èò∂ÊÆµÔºàÊàêÊú¨ÂàÜÊûêÔºâ„ÄÅexecute Èò∂ÊÆµÔºàÊâßË°åÔºâ</p></li></ul><hr><h3 id="Á¥¢Âºï‰ºòÂåñ-1" tabindex="-1"><a class="header-anchor" href="#Á¥¢Âºï‰ºòÂåñ-1"><span>Á¥¢Âºï‰ºòÂåñ</span></a></h3><h4 id="ÂàõÂª∫Á¥¢Âºï" tabindex="-1"><a class="header-anchor" href="#ÂàõÂª∫Á¥¢Âºï"><span>ÂàõÂª∫Á¥¢Âºï</span></a></h4><p>Á¥¢ÂºïÊòØÊï∞ÊçÆÂ∫ì‰ºòÂåñÊúÄÈáçË¶ÅÁöÑÊâãÊÆµ‰πã‰∏ÄÔºåÈÄöËøáÁ¥¢ÂºïÈÄöÂ∏∏ÂèØ‰ª•Â∏ÆÂä©Áî®Êà∑Ëß£ÂÜ≥Â§ßÂ§öÊï∞ÁöÑ MySQL ÁöÑÊÄßËÉΩ‰ºòÂåñÈóÆÈ¢ò</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `tb_seller` (</span></span>
<span class="line"><span>	`sellerid` varchar (100),</span></span>
<span class="line"><span>	`name` varchar (100),</span></span>
<span class="line"><span>	`nickname` varchar (50),</span></span>
<span class="line"><span>	`password` varchar (60),</span></span>
<span class="line"><span>	`status` varchar (1),</span></span>
<span class="line"><span>	`address` varchar (100),</span></span>
<span class="line"><span>	`createtime` datetime,</span></span>
<span class="line"><span>    PRIMARY KEY(`sellerid`)</span></span>
<span class="line"><span>)ENGINE=INNODB DEFAULT CHARSET=utf8mb4;</span></span>
<span class="line"><span>INSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) values(&#39;xiaomi&#39;,&#39;Â∞èÁ±≥ÁßëÊäÄ&#39;,&#39;Â∞èÁ±≥ÂÆòÊñπÊóóËà∞Â∫ó&#39;,&#39;e10adc3949ba59abbe56e057f20f883e&#39;,&#39;1&#39;,&#39;Ë•øÂÆâÂ∏Ç&#39;,&#39;2088-01-01 12:00:00&#39;);</span></span>
<span class="line"><span>CREATE INDEX idx_seller_name_sta_addr ON tb_seller(name, status, address); # ËÅîÂêàÁ¥¢Âºï</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢ÂºïÁéØÂ¢ÉÂáÜÂ§á.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h4 id="ÈÅøÂÖçÂ§±Êïà" tabindex="-1"><a class="header-anchor" href="#ÈÅøÂÖçÂ§±Êïà"><span>ÈÅøÂÖçÂ§±Êïà</span></a></h4><h5 id="ËØ≠Âè•ÈîôËØØ" tabindex="-1"><a class="header-anchor" href="#ËØ≠Âè•ÈîôËØØ"><span>ËØ≠Âè•ÈîôËØØ</span></a></h5><ul><li><p>ÂÖ®ÂÄºÂåπÈÖçÔºöÂØπÁ¥¢Âºï‰∏≠ÊâÄÊúâÂàóÈÉΩÊåáÂÆöÂÖ∑‰ΩìÂÄºÔºåËøôÁßçÊÉÖÂÜµÁ¥¢ÂºïÁîüÊïàÔºåÊâßË°åÊïàÁéáÈ´ò</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39; AND status=&#39;1&#39; AND address=&#39;Ë•øÂÆâÂ∏Ç&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p><strong>ÊúÄÂ∑¶ÂâçÁºÄÊ≥ïÂàô</strong>ÔºöËÅîÂêàÁ¥¢ÂºïÈÅµÂÆàÊúÄÂ∑¶ÂâçÁºÄÊ≥ïÂàô</p><p>ÂåπÈÖçÊúÄÂ∑¶ÂâçÁºÄÊ≥ïÂàôÔºåËµ∞Á¥¢ÂºïÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39;;</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39; AND status=&#39;1&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ËøùÊ≥ïÊúÄÂ∑¶ÂâçÁºÄÊ≥ïÂàô Ôºå Á¥¢ÂºïÂ§±ÊïàÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE status=&#39;1&#39;;</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE status=&#39;1&#39; AND address=&#39;Ë•øÂÆâÂ∏Ç&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Â¶ÇÊûúÁ¨¶ÂêàÊúÄÂ∑¶Ê≥ïÂàôÔºå‰ΩÜÊòØÂá∫Áé∞Ë∑≥Ë∑ÉÊüê‰∏ÄÂàóÔºåÂè™ÊúâÊúÄÂ∑¶ÂàóÁ¥¢ÂºïÁîüÊïàÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39; AND address=&#39;Ë•øÂÆâÂ∏Ç&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ËôΩÁÑ∂Á¥¢ÂºïÂàóÂ§±ÊïàÔºå‰ΩÜÊòØÁ≥ªÁªü‰ºö<strong>‰ΩøÁî®‰∫ÜÁ¥¢Âºï‰∏ãÊé®ËøõË°å‰∫Ü‰ºòÂåñ</strong></p></li><li><p><strong>ËåÉÂõ¥Êü•ËØ¢</strong>Âè≥ËæπÁöÑÂàóÔºå‰∏çËÉΩ‰ΩøÁî®Á¥¢ÂºïÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39; AND status&gt;&#39;1&#39; AND address=&#39;Ë•øÂÆâÂ∏Ç&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Ê†πÊçÆÂâçÈù¢ÁöÑ‰∏§‰∏™Â≠óÊÆµ name Ôºå status Êü•ËØ¢ÊòØËµ∞Á¥¢ÂºïÁöÑÔºå ‰ΩÜÊòØÊúÄÂêé‰∏Ä‰∏™Êù°‰ª∂ address Ê≤°ÊúâÁî®Âà∞Á¥¢ÂºïÔºå‰ΩøÁî®‰∫ÜÁ¥¢Âºï‰∏ãÊé®</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Âú®Á¥¢ÂºïÂàó‰∏ä<strong>ÂáΩÊï∞ÊàñËÄÖËøêÁÆóÔºà+ - Êï∞ÂÄºÔºâÊìç‰Ωú</strong>Ôºå Á¥¢ÂºïÂ∞ÜÂ§±ÊïàÔºö‰ºöÁ†¥ÂùèÁ¥¢ÂºïÂÄºÁöÑÊúâÂ∫èÊÄß</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE SUBSTRING(name,3,2) = &#39;ÁßëÊäÄ&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï6.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p><strong>Â≠óÁ¨¶‰∏≤‰∏çÂä†ÂçïÂºïÂè∑</strong>ÔºåÈÄ†ÊàêÁ¥¢ÂºïÂ§±ÊïàÔºöÈöêÂºèÁ±ªÂûãËΩ¨Êç¢ÔºåÂΩìÂ≠óÁ¨¶‰∏≤ÂíåÊï∞Â≠óÊØîËæÉÊó∂‰ºö<strong>ÊääÂ≠óÁ¨¶‰∏≤ËΩ¨Âåñ‰∏∫Êï∞Â≠ó</strong></p><p>Ê≤°ÊúâÂØπÂ≠óÁ¨¶‰∏≤Âä†ÂçïÂºïÂè∑ÔºåÊü•ËØ¢‰ºòÂåñÂô®‰ºöË∞ÉÁî® CAST ÂáΩÊï∞Â∞Ü status ËΩ¨Êç¢‰∏∫ int ËøõË°åÊØîËæÉÔºåÈÄ†ÊàêÁ¥¢ÂºïÂ§±Êïà</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39; AND status = 1;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï7.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Â¶ÇÊûú status ÊòØ int Á±ªÂûãÔºåSQL ‰∏∫ <code>SELECT * FROM tb_seller WHERE status = &#39;1&#39; </code> Âπ∂‰∏ç‰ºöÈÄ†ÊàêÁ¥¢ÂºïÂ§±ÊïàÔºåÂõ†‰∏∫‰ºöÂ∞Ü <code>&#39;1&#39;</code> ËΩ¨Êç¢‰∏∫ <code>1</code>ÔºåÂπ∂<strong>‰∏ç‰ºöÂØπÁ¥¢ÂºïÂàó‰∫ßÁîüÊìç‰Ωú</strong></p></li><li><p>Â§öË°®ËøûÊé•Êü•ËØ¢Êó∂ÔºåÂ¶ÇÊûú‰∏§Âº†Ë°®ÁöÑ<strong>Â≠óÁ¨¶ÈõÜ‰∏çÂêå</strong>Ôºå‰ºöÈÄ†ÊàêÁ¥¢ÂºïÂ§±ÊïàÔºåÂõ†‰∏∫‰ºöËøõË°åÁ±ªÂûãËΩ¨Êç¢</p><p>Ëß£ÂÜ≥ÊñπÊ≥ïÔºöCONVERT ÂáΩÊï∞ÊòØÂä†Âú®ËæìÂÖ•ÂèÇÊï∞‰∏ä„ÄÅ‰øÆÊîπË°®ÁöÑÂ≠óÁ¨¶ÈõÜ</p></li><li><p><strong>Áî® OR ÂàÜÂâ≤Êù°‰ª∂ÔºåÁ¥¢ÂºïÂ§±Êïà</strong>ÔºåÂØºËá¥ÂÖ®Ë°®Êü•ËØ¢Ôºö</p><p>OR ÂâçÁöÑÊù°‰ª∂‰∏≠ÁöÑÂàóÊúâÁ¥¢ÂºïËÄåÂêéÈù¢ÁöÑÂàó‰∏≠Ê≤°ÊúâÁ¥¢ÂºïÊàñ OR ÂâçÂêé‰∏§‰∏™ÂàóÊòØÂêå‰∏Ä‰∏™Â§çÂêàÁ¥¢ÂºïÔºåÈÉΩÈÄ†ÊàêÁ¥¢ÂºïÂ§±Êïà</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name=&#39;ÈòøÈáåÂ∑¥Â∑¥&#39; OR createtime = &#39;2088-01-01 12:00:00&#39;;</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39; OR status=&#39;1&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï10.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>AND ÂàÜÂâ≤ÁöÑÊù°‰ª∂‰∏çÂΩ±Âìç</strong>Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name=&#39;ÈòøÈáåÂ∑¥Â∑¥&#39; AND createtime = &#39;2088-01-01 12:00:00&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï11.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p><strong>‰ª• % ÂºÄÂ§¥ÁöÑ LIKE Ê®°Á≥äÊü•ËØ¢</strong>ÔºåÁ¥¢ÂºïÂ§±ÊïàÔºö</p><p>Â¶ÇÊûúÊòØÂ∞æÈÉ®Ê®°Á≥äÂåπÈÖçÔºåÁ¥¢Âºï‰∏ç‰ºöÂ§±ÊïàÔºõÂ¶ÇÊûúÊòØÂ§¥ÈÉ®Ê®°Á≥äÂåπÈÖçÔºåÁ¥¢ÂºïÂ§±Êïà</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name like &#39;%ÁßëÊäÄ%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï12.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Ëß£ÂÜ≥ÊñπÊ°àÔºöÈÄöËøáË¶ÜÁõñÁ¥¢ÂºïÊù•Ëß£ÂÜ≥</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT sellerid,name,status FROM tb_seller WHERE name like &#39;%ÁßëÊäÄ%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï13.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ÂéüÂõ†ÔºöÂú®Ë¶ÜÁõñÁ¥¢ÂºïÁöÑËøôÊ£µ B+ Êï∞‰∏äÂè™ÈúÄË¶ÅËøõË°å like ÁöÑÂåπÈÖçÔºåÊàñËÄÖÊòØÂü∫‰∫éË¶ÜÁõñÁ¥¢ÂºïÊü•ËØ¢ÂÜçËøõË°å WHERE ÁöÑÂà§Êñ≠Â∞±ÂèØ‰ª•Ëé∑ÂæóÁªìÊûú</p></li></ul><hr><h5 id="Á≥ªÁªü‰ºòÂåñ-1" tabindex="-1"><a class="header-anchor" href="#Á≥ªÁªü‰ºòÂåñ-1"><span>Á≥ªÁªü‰ºòÂåñ</span></a></h5><p>Á≥ªÁªü‰ºòÂåñ‰∏∫ÂÖ®Ë°®Êâ´ÊèèÔºö</p><ul><li><p>Â¶ÇÊûú MySQL ËØÑ‰º∞‰ΩøÁî®Á¥¢ÂºïÊØîÂÖ®Ë°®Êõ¥ÊÖ¢ÔºåÂàô‰∏ç‰ΩøÁî®Á¥¢ÂºïÔºåÁ¥¢ÂºïÂ§±ÊïàÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE INDEX idx_address ON tb_seller(address);</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE address=&#39;Ë•øÂÆâÂ∏Ç&#39;;</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE address=&#39;Âåó‰∫¨Â∏Ç&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Âåó‰∫¨Â∏ÇÁöÑÈîÆÂÄºÂç† 9/10ÔºàÂå∫ÂàÜÂ∫¶‰ΩéÔºâÔºåÊâÄ‰ª•‰ºòÂåñ‰∏∫ÂÖ®Ë°®Êâ´ÊèèÔºåtype = ALL</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï14.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>IS NULL„ÄÅIS NOT NULL <strong>ÊúâÊó∂</strong>Á¥¢ÂºïÂ§±ÊïàÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name IS NULL;</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE name IS NOT NULL;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>NOT NULL Â§±ÊïàÁöÑÂéüÂõ†ÊòØ name ÂàóÂÖ®ÈÉ®‰∏çÊòØ nullÔºå‰ºòÂåñ‰∏∫ÂÖ®Ë°®Êâ´ÊèèÔºåÂΩì NULL ËøáÂ§öÊó∂ÔºåIS NULL Â§±Êïà</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï15.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>IN ËÇØÂÆö‰ºöËµ∞Á¥¢ÂºïÔºå‰ΩÜÊòØÂΩì IN ÁöÑÂèñÂÄºËåÉÂõ¥ËæÉÂ§ßÊó∂‰ºöÂØºËá¥Á¥¢ÂºïÂ§±ÊïàÔºåËµ∞ÂÖ®Ë°®Êâ´ÊèèÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE sellerId IN (&#39;alibaba&#39;,&#39;huawei&#39;);-- ÈÉΩËµ∞Á¥¢Âºï</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM tb_seller WHERE sellerId NOT IN (&#39;alibaba&#39;,&#39;huawei&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><a href="https://time.geekbang.org/column/article/74687" target="_blank" rel="noopener noreferrer">MySQL ÂÆûÊàò 45 ËÆ≤</a>ËØ•Á´†ËäÇÊúÄÂêéÊèêÂá∫‰∫Ü‰∏ÄÁßçÊÖ¢Êü•ËØ¢Âú∫ÊôØÔºåËé∑ÂèñÂà∞Êï∞ÊçÆ‰ª•Âêé Server Â±ÇËøò‰ºöÂÅöÂà§Êñ≠</p></li></ul><hr><h4 id="Â∫ïÂ±ÇÂéüÁêÜ" tabindex="-1"><a class="header-anchor" href="#Â∫ïÂ±ÇÂéüÁêÜ"><span>Â∫ïÂ±ÇÂéüÁêÜ</span></a></h4><p>Á¥¢ÂºïÂ§±Êïà‰∏ÄËà¨ÊòØÈíàÂØπËÅîÂêàÁ¥¢ÂºïÔºåËÅîÂêàÁ¥¢Âºï‰∏ÄËà¨Áî±Âá†‰∏™Â≠óÊÆµÁªÑÊàêÔºåÊéíÂ∫èÊñπÂºèÊòØÂÖàÊåâÁÖßÁ¨¨‰∏Ä‰∏™Â≠óÊÆµËøõË°åÊéíÂ∫èÔºåÁÑ∂ÂêéÊéíÂ∫èÁ¨¨‰∫å‰∏™Ôºå‰æùÊ≠§Á±ªÊé®ÔºåÂõæÁ§∫Ôºàa, bÔºâÁ¥¢ÂºïÔºå<strong>a Áõ∏Á≠âÁöÑÊÉÖÂÜµ‰∏ã b ÊòØÊúâÂ∫èÁöÑ</strong></p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Á¥¢ÂºïÂ§±ÊïàÂ∫ïÂ±ÇÂéüÁêÜ1.png" style="zoom:67%;"><ul><li><p>ÊúÄÂ∑¶ÂâçÁºÄÊ≥ïÂàôÔºöÂΩì‰∏çÂåπÈÖçÂâçÈù¢ÁöÑÂ≠óÊÆµÁöÑÊó∂ÂÄôÔºåÂêéÈù¢ÁöÑÂ≠óÊÆµÈÉΩÊòØÊó†Â∫èÁöÑ„ÄÇËøôÁßçÊó†Â∫è‰∏ç‰ªÖ‰ΩìÁé∞Âú®Âè∂Â≠êËäÇÁÇπÔºå‰πü‰ºö<strong>ÂØºËá¥Êü•ËØ¢Êó∂Êâ´ÊèèÁöÑÈùûÂè∂Â≠êËäÇÁÇπ‰πüÊòØÊó†Â∫èÁöÑ</strong>ÔºåÂõ†‰∏∫Á¥¢ÂºïÊ†ëÁõ∏ÂΩì‰∫éÂøΩÁï•ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÊÆµÔºåÂ∞±Êó†Ê≥ï‰ΩøÁî®‰∫åÂàÜÊü•Êâæ</p></li><li><p>ËåÉÂõ¥Êü•ËØ¢Âè≥ËæπÁöÑÂàóÔºå‰∏çËÉΩ‰ΩøÁî®Á¥¢ÂºïÔºåÊØîÂ¶ÇËØ≠Âè•Ôºö <code>WHERE a &gt; 1 AND b = 1 </code>ÔºåÂú® a Â§ß‰∫é 1 ÁöÑÊó∂ÂÄôÔºåb ÊòØÊó†Â∫èÁöÑÔºåa &gt; 1 ÊòØÊâ´ÊèèÊó∂ÊúâÂ∫èÁöÑÔºå‰ΩÜÊòØÊâæÂà∞‰ª•ÂêéËøõË°åÂØªÊâæ b Êó∂ÔºåÁ¥¢ÂºïÊ†ëÂ∞±‰∏çÊòØÊúâÂ∫èÁöÑ‰∫Ü</p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Á¥¢ÂºïÂ§±ÊïàÂ∫ïÂ±ÇÂéüÁêÜ2.png" style="zoom:67%;"></li><li><p>‰ª• % ÂºÄÂ§¥ÁöÑ LIKE Ê®°Á≥äÊü•ËØ¢ÔºåÁ¥¢ÂºïÂ§±ÊïàÔºåÊØîÂ¶ÇËØ≠Âè•Ôºö<code>WHERE a LIKE &#39;%d&#39;</code>ÔºåÂâçÈù¢ÁöÑ‰∏çÁ°ÆÂÆöÔºåÂØºËá¥‰∏çÁ¨¶ÂêàÊúÄÂ∑¶ÂåπÈÖçÔºåÁõ¥Êé•ÂéªÁ¥¢Âºï‰∏≠ÊêúÁ¥¢‰ª• d ÁªìÂ∞æÁöÑËäÇÁÇπÔºåÊâÄ‰ª•Ê≤°ÊúâÈ°∫Â∫è <img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Á¥¢ÂºïÂ§±ÊïàÂ∫ïÂ±ÇÂéüÁêÜ3.png" alt="" loading="lazy"></p></li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://mp.weixin.qq.com/s/B_M09dzLe9w7cT46rdGIeQ</p><hr><h4 id="Êü•ÁúãÁ¥¢Âºï" tabindex="-1"><a class="header-anchor" href="#Êü•ÁúãÁ¥¢Âºï"><span>Êü•ÁúãÁ¥¢Âºï</span></a></h4><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW STATUS LIKE &#39;Handler_read%&#39;;	</span></span>
<span class="line"><span>SHOW GLOBAL STATUS LIKE &#39;Handler_read%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÊü•ÁúãÁ¥¢Âºï‰ΩøÁî®ÊÉÖÂÜµ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>Handler_read_firstÔºöÁ¥¢Âºï‰∏≠Á¨¨‰∏ÄÊù°Ë¢´ËØªÁöÑÊ¨°Êï∞ÔºåÂ¶ÇÊûúËæÉÈ´òÔºåË°®Á§∫ÊúçÂä°Âô®Ê≠£ÊâßË°åÂ§ßÈáèÂÖ®Á¥¢ÂºïÊâ´ÊèèÔºàËøô‰∏™ÂÄºË∂ä‰ΩéË∂äÂ•ΩÔºâ</li><li>Handler_read_keyÔºöÂ¶ÇÊûúÁ¥¢ÂºïÊ≠£Âú®Â∑•‰ΩúÔºåËøô‰∏™ÂÄº‰ª£Ë°®‰∏Ä‰∏™Ë°åË¢´Á¥¢ÂºïÂÄºËØªÁöÑÊ¨°Êï∞ÔºåÂÄºË∂ä‰ΩéË°®Á§∫Á¥¢Âºï‰∏çÁªèÂ∏∏‰ΩøÁî®ÔºàËøô‰∏™ÂÄºË∂äÈ´òË∂äÂ•ΩÔºâ</li><li>Handler_read_nextÔºöÊåâÁÖßÈîÆÈ°∫Â∫èËØª‰∏ã‰∏ÄË°åÁöÑËØ∑Ê±ÇÊï∞ÔºåÂ¶ÇÊûúËåÉÂõ¥Á∫¶ÊùüÊàñÊâßË°åÁ¥¢ÂºïÊâ´ÊèèÊù•Êü•ËØ¢Á¥¢ÂºïÂàóÔºåÂÄºÂ¢ûÂä†</li><li>Handler_read_prevÔºöÊåâÁÖßÈîÆÈ°∫Â∫èËØªÂâç‰∏ÄË°åÁöÑËØ∑Ê±ÇÊï∞ÔºåËØ•ËØªÊñπÊ≥ï‰∏ªË¶ÅÁî®‰∫é‰ºòÂåñ ORDER BY ... DESC</li><li>Handler_read_rndÔºöÊ†πÊçÆÂõ∫ÂÆö‰ΩçÁΩÆËØª‰∏ÄË°åÁöÑËØ∑Ê±ÇÊï∞ÔºåÂ¶ÇÊûúÊâßË°åÂ§ßÈáèÊü•ËØ¢Âπ∂ÂØπÁªìÊûúËøõË°åÊéíÂ∫èÂàôËØ•ÂÄºËæÉÈ´òÔºåÂèØËÉΩÊòØ‰ΩøÁî®‰∫ÜÂ§ßÈáèÈúÄË¶Å MySQL Êâ´ÊèèÊï¥‰∏™Ë°®ÁöÑÊü•ËØ¢ÊàñËøûÊé•ÔºåËøô‰∏™ÂÄºËæÉÈ´òÊÑèÂë≥ÁùÄËøêË°åÊïàÁéá‰ΩéÔºåÂ∫îËØ•Âª∫Á´ãÁ¥¢ÂºïÊù•Ëß£ÂÜ≥</li><li>Handler_read_rnd_nextÔºöÂú®Êï∞ÊçÆÊñá‰ª∂‰∏≠ËØª‰∏ã‰∏ÄË°åÁöÑËØ∑Ê±ÇÊï∞ÔºåÂ¶ÇÊûúÊ≠£ËøõË°åÂ§ßÈáèÁöÑË°®Êâ´ÊèèÔºåËØ•ÂÄºËæÉÈ´òÔºåËØ¥ÊòéË°®Á¥¢Âºï‰∏çÊ≠£Á°ÆÊàñÂÜôÂÖ•ÁöÑÊü•ËØ¢Ê≤°ÊúâÂà©Áî®Á¥¢Âºï</li></ul><hr><h3 id="sql-‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#sql-‰ºòÂåñ"><span>SQL ‰ºòÂåñ</span></a></h3><h4 id="Ëá™Â¢û‰∏ªÈîÆ" tabindex="-1"><a class="header-anchor" href="#Ëá™Â¢û‰∏ªÈîÆ"><span>Ëá™Â¢û‰∏ªÈîÆ</span></a></h4><h5 id="Ëá™Â¢ûÊú∫Âà∂" tabindex="-1"><a class="header-anchor" href="#Ëá™Â¢ûÊú∫Âà∂"><span>Ëá™Â¢ûÊú∫Âà∂</span></a></h5><p>Ëá™Â¢û‰∏ªÈîÆÂèØ‰ª•ËÆ©‰∏ªÈîÆÁ¥¢ÂºïÂ∞ΩÈáèÂú∞‰øùÊåÅÂú®Êï∞ÊçÆÈ°µ‰∏≠ÈÄíÂ¢ûÈ°∫Â∫èÊèíÂÖ•Ôºå‰∏çËá™Â¢ûÈúÄË¶ÅÂØªÊâæÂÖ∂‰ªñÈ°µÊèíÂÖ•ÔºåÂØºËá¥ÈöèÊú∫ IO ÂíåÈ°µÂàÜË£ÇÁöÑÊÉÖÂÜµ</p><p>Ë°®ÁöÑÁªìÊûÑÂÆö‰πâÂ≠òÊîæÂú®ÂêéÁºÄÂêç‰∏∫.frm ÁöÑÊñá‰ª∂‰∏≠Ôºå‰ΩÜÊòØÂπ∂‰∏ç‰ºö‰øùÂ≠òËá™Â¢ûÂÄºÔºå‰∏çÂêåÁöÑÂºïÊìéÂØπ‰∫éËá™Â¢ûÂÄºÁöÑ‰øùÂ≠òÁ≠ñÁï•‰∏çÂêåÔºö</p><ul><li>MyISAM ÂºïÊìéÁöÑËá™Â¢ûÂÄº‰øùÂ≠òÂú®Êï∞ÊçÆÊñá‰ª∂‰∏≠</li><li>InnoDB ÂºïÊìéÁöÑËá™Â¢ûÂÄº‰øùÂ≠òÂú®‰∫ÜÂÜÖÂ≠òÈáåÔºåÊØèÊ¨°ÊâìÂºÄË°®ÈÉΩ‰ºöÂéªÊâæËá™Â¢ûÂÄºÁöÑÊúÄÂ§ßÂÄº max(id)ÔºåÁÑ∂ÂêéÂ∞Ü max(id)+1 ‰Ωú‰∏∫ÂΩìÂâçÁöÑËá™Â¢ûÂÄºÔºõ8.0 ÁâàÊú¨ÂêéÔºåÊâçÊúâ‰∫ÜËá™Â¢ûÂÄºÊåÅ‰πÖÂåñÁöÑËÉΩÂäõÔºåÂ∞ÜËá™Â¢ûÂÄºÁöÑÂèòÊõ¥ËÆ∞ÂΩïÂú®‰∫Ü redo log ‰∏≠ÔºåÈáçÂêØÁöÑÊó∂ÂÄô‰æùÈù† redo log ÊÅ¢Â§çÈáçÂêØ‰πãÂâçÁöÑÂÄº</li></ul><p>Âú®ÊèíÂÖ•‰∏ÄË°åÊï∞ÊçÆÁöÑÊó∂ÂÄôÔºåËá™Â¢ûÂÄºÁöÑË°å‰∏∫Â¶Ç‰∏ãÔºö</p><ul><li>Â¶ÇÊûúÊèíÂÖ•Êï∞ÊçÆÊó∂ id Â≠óÊÆµÊåáÂÆö‰∏∫ 0„ÄÅnull ÊàñÊú™ÊåáÂÆöÂÄºÔºåÈÇ£‰πàÂ∞±ÊääËøô‰∏™Ë°®ÂΩìÂâçÁöÑ AUTO_INCREMENT ÂÄºÂ°´Âà∞Ëá™Â¢ûÂ≠óÊÆµ</li><li>Â¶ÇÊûúÊèíÂÖ•Êï∞ÊçÆÊó∂ id Â≠óÊÆµÊåáÂÆö‰∫ÜÂÖ∑‰ΩìÁöÑÂÄºÔºåÊØîÂ¶ÇÊüêÊ¨°Ë¶ÅÊèíÂÖ•ÁöÑÂÄºÊòØ XÔºåÂΩìÂâçÁöÑËá™Â¢ûÂÄºÊòØ Y <ul><li>Â¶ÇÊûú X&lt;YÔºåÈÇ£‰πàËøô‰∏™Ë°®ÁöÑËá™Â¢ûÂÄº‰∏çÂèò</li><li>Â¶ÇÊûú X‚â•YÔºåÂ∞±ÈúÄË¶ÅÊääÂΩìÂâçËá™Â¢ûÂÄº‰øÆÊîπ‰∏∫Êñ∞ÁöÑËá™Â¢ûÂÄº</li></ul></li></ul><p>ÂèÇÊï∞ËØ¥ÊòéÔºöauto_increment_offset Âíå auto_increment_increment ÂàÜÂà´Ë°®Á§∫Ëá™Â¢ûÁöÑÂàùÂßãÂÄºÂíåÊ≠•ÈïøÔºåÈªòËÆ§ÂÄºÈÉΩÊòØ 1</p><p>ËØ≠Âè•ÊâßË°åÂ§±Ë¥•‰πü‰∏çÂõûÈÄÄËá™Â¢û idÔºåÊâÄ‰ª•‰øùËØÅ‰∫ÜËá™Â¢û id ÊòØÈÄíÂ¢ûÁöÑÔºå‰ΩÜ‰∏ç‰øùËØÅÊòØËøûÁª≠ÁöÑÔºà‰∏çËÉΩÂõûÈÄÄÔºåÊâÄ‰ª•Êúâ‰∫õÂõûÊªö‰∫ãÂä°ÁöÑËá™Â¢û id Â∞±‰∏ç‰ºöÈáçÊñ∞‰ΩøÁî®ÔºåÂØºËá¥Âá∫Áé∞‰∏çËøûÁª≠Ôºâ</p><h6 id="È°µÂàÜË£Ç" tabindex="-1"><a class="header-anchor" href="#È°µÂàÜË£Ç"><span><strong>È°µÂàÜË£Ç</strong></span></a></h6><p>È°µÂèØ‰ª•‰∏∫Á©∫Ôºå‰πüÂèØ‰ª•Â°´ÂÖÖ‰∏ÄÂçäÔºå‰πüÂèØ‰ª•Â°´ÂÖÖ100%„ÄÇÊØè‰∏™È°µÂåÖÂê´‰∫Ü2-NË°åÊï∞ÊçÆ(Â¶ÇÊûú‰∏ÄË°åÊï∞ÊçÆËøáÂ§ßÔºå‰ºöË°å Ê∫¢Âá∫)ÔºåÊ†πÊçÆ‰∏ªÈîÆÊéíÂàó„ÄÇ</p><p>‰∏ªÈîÆÈ°∫Â∫èÊèíÂÖ•ÊïàÊûú ‚ë†. ‰ªéÁ£ÅÁõò‰∏≠Áî≥ËØ∑È°µÔºå ‰∏ªÈîÆÈ°∫Â∫èÊèíÂÖ•</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053539419.png" alt="1687053539419" tabindex="0" loading="lazy"><figcaption>1687053539419</figcaption></figure><p>‚ë°. Á¨¨‰∏Ä‰∏™È°µÊ≤°ÊúâÊª°ÔºåÁªßÁª≠ÂæÄÁ¨¨‰∏ÄÈ°µÊèíÂÖ•</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053603265.png" alt="1687053603265" tabindex="0" loading="lazy"><figcaption>1687053603265</figcaption></figure><p>‚ë¢. ÂΩìÁ¨¨‰∏Ä‰∏™‰πüÂÜôÊª°‰πãÂêéÔºåÂÜçÂÜôÂÖ•Á¨¨‰∫å‰∏™È°µÔºåÈ°µ‰∏éÈ°µ‰πãÈó¥‰ºöÈÄöËøáÊåáÈíàËøûÊé•</p><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053617687.png" alt="1687053617687" loading="lazy">‚ë£. ÂΩìÁ¨¨‰∫åÈ°µÂÜôÊª°‰∫ÜÔºåÂÜçÂæÄÁ¨¨‰∏âÈ°µÂÜôÂÖ•</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053680135.png" alt="1687053680135" tabindex="0" loading="lazy"><figcaption>1687053680135</figcaption></figure><p>‰∏ªÈîÆ‰π±Â∫èÊèíÂÖ•ÊïàÊûú ‚ë†. Âä†ÂÖ•1#,2#È°µÈÉΩÂ∑≤ÁªèÂÜôÊª°‰∫ÜÔºåÂ≠òÊîæ‰∫ÜÂ¶ÇÂõæÊâÄÁ§∫ÁöÑÊï∞ÊçÆ</p><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053697186.png" alt="1687053697186" loading="lazy">‚ë°. Ê≠§Êó∂ÂÜçÊèíÂÖ•id‰∏∫50ÁöÑËÆ∞ÂΩïÔºåÊàë‰ª¨Êù•ÁúãÁúã‰ºöÂèëÁîü‰ªÄ‰πàÁé∞Ë±° ‰ºöÂÜçÊ¨°ÂºÄÂêØ‰∏Ä‰∏™È°µÔºåÂÜôÂÖ•Êñ∞ÁöÑÈ°µ‰∏≠ÂêóÔºü</p><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053720439.png" alt="1687053720439" loading="lazy">‰∏ç‰ºö„ÄÇÂõ†‰∏∫ÔºåÁ¥¢ÂºïÁªìÊûÑÁöÑÂè∂Â≠êËäÇÁÇπÊòØÊúâÈ°∫Â∫èÁöÑ„ÄÇÊåâÁÖßÈ°∫Â∫èÔºåÂ∫îËØ•Â≠òÂÇ®Âú®47‰πãÂêé„ÄÇ</p><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053735874.png" alt="1687053735874" loading="lazy">‰ΩÜÊòØ47ÊâÄÂú®ÁöÑ1#È°µÔºåÂ∑≤ÁªèÂÜôÊª°‰∫ÜÔºåÂ≠òÂÇ®‰∏ç‰∫Ü50ÂØπÂ∫îÁöÑÊï∞ÊçÆ‰∫Ü„ÄÇ ÈÇ£‰πàÊ≠§Êó∂‰ºöÂºÄËæü‰∏Ä‰∏™Êñ∞ÁöÑÈ°µ 3#„ÄÇ</p><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053753314.png" alt="1687053753314" loading="lazy">‰ΩÜÊòØÂπ∂‰∏ç‰ºöÁõ¥Êé•Â∞Ü50Â≠òÂÖ•3#È°µÔºåËÄåÊòØ‰ºöÂ∞Ü1#È°µÂêé‰∏ÄÂçäÁöÑÊï∞ÊçÆÔºåÁßªÂä®Âà∞3#È°µÔºåÁÑ∂ÂêéÂú®3#È°µÔºåÊèíÂÖ•50„ÄÇ</p><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053766267.png" alt="1687053766267" loading="lazy">ÁßªÂä®Êï∞ÊçÆÔºåÂπ∂ÊèíÂÖ•id‰∏∫50ÁöÑÊï∞ÊçÆ‰πãÂêéÔºåÈÇ£‰πàÊ≠§Êó∂ÔºåËøô‰∏â‰∏™È°µ‰πãÈó¥ÁöÑÊï∞ÊçÆÈ°∫Â∫èÊòØÊúâÈóÆÈ¢òÁöÑ„ÄÇ 1#ÁöÑ‰∏ã‰∏Ä‰∏™ È°µÔºåÂ∫îËØ•ÊòØ3#Ôºå 3#ÁöÑ‰∏ã‰∏Ä‰∏™È°µÊòØ2#„ÄÇ ÊâÄ‰ª•ÔºåÊ≠§Êó∂ÔºåÈúÄË¶ÅÈáçÊñ∞ËÆæÁΩÆÈìæË°®ÊåáÈíà„ÄÇ</p><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053801878.png" alt="1687053801878" loading="lazy">‰∏äËø∞ÁöÑËøôÁßçÁé∞Ë±°ÔºåÁß∞‰πã‰∏∫ &quot;È°µÂàÜË£Ç&quot;ÔºåÊòØÊØîËæÉËÄóË¥πÊÄßËÉΩÁöÑÊìç‰Ωú„ÄÇ</p><h6 id="È°µÂêàÂπ∂" tabindex="-1"><a class="header-anchor" href="#È°µÂêàÂπ∂"><span>È°µÂêàÂπ∂</span></a></h6><p>È°µÂêàÂπ∂ ÁõÆÂâçË°®‰∏≠Â∑≤ÊúâÊï∞ÊçÆÁöÑÁ¥¢ÂºïÁªìÊûÑ(Âè∂Â≠êËäÇÁÇπ)Â¶Ç‰∏ãÔºö</p><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053884009.png" alt="1687053884009" loading="lazy">ÂΩìÊàë‰ª¨ÂØπÂ∑≤ÊúâÊï∞ÊçÆËøõË°åÂà†Èô§Êó∂ÔºåÂÖ∑‰ΩìÁöÑÊïàÊûúÂ¶Ç‰∏ã: ÂΩìÂà†Èô§‰∏ÄË°åËÆ∞ÂΩïÊó∂ÔºåÂÆûÈôÖ‰∏äËÆ∞ÂΩïÂπ∂Ê≤°ÊúâË¢´Áâ©ÁêÜÂà†Èô§ÔºåÂè™ÊòØËÆ∞ÂΩïË¢´Ê†áËÆ∞ÔºàflagedÔºâ‰∏∫Âà†Èô§Âπ∂‰∏îÂÆÉÁöÑÁ©∫Èó¥ ÂèòÂæóÂÖÅËÆ∏Ë¢´ÂÖ∂‰ªñËÆ∞ÂΩïÂ£∞Êòé‰ΩøÁî®„ÄÇ</p><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053897233.png" alt="1687053897233" loading="lazy">ÂΩìÊàë‰ª¨ÁªßÁª≠Âà†Èô§2#ÁöÑÊï∞ÊçÆËÆ∞ÂΩï<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053911184.png" alt="1687053911184" loading="lazy"> ÂΩìÈ°µ‰∏≠Âà†Èô§ÁöÑËÆ∞ÂΩïËææÂà∞ MERGE_THRESHOLDÔºàÈªòËÆ§‰∏∫È°µÁöÑ50%ÔºâÔºåInnoDB‰ºöÂºÄÂßãÂØªÊâæÊúÄÈù†ËøëÁöÑÈ°µÔºàÂâç ÊàñÂêéÔºâÁúãÁúãÊòØÂê¶ÂèØ‰ª•Â∞Ü‰∏§‰∏™È°µÂêàÂπ∂‰ª•‰ºòÂåñÁ©∫Èó¥‰ΩøÁî®„ÄÇ<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053921836.png" alt="1687053921836" loading="lazy"> Âà†Èô§Êï∞ÊçÆÔºåÂπ∂Â∞ÜÈ°µÂêàÂπ∂‰πãÂêéÔºåÂÜçÊ¨°ÊèíÂÖ•Êñ∞ÁöÑÊï∞ÊçÆ21ÔºåÂàôÁõ¥Êé•ÊèíÂÖ•3#È°µ<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687053930426.png" alt="1687053930426" loading="lazy"> Ëøô‰∏™ÈáåÈù¢ÊâÄÂèëÁîüÁöÑÂêàÂπ∂È°µÁöÑËøô‰∏™Áé∞Ë±°ÔºåÂ∞±Áß∞‰πã‰∏∫ &quot;È°µÂêàÂπ∂&quot;„ÄÇ</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Áü•ËØÜÂ∞èË¥¥Â£´Ôºö</span></span>
<span class="line"><span>MERGE_THRESHOLDÔºöÂêàÂπ∂È°µÁöÑÈòàÂÄºÔºåÂèØ‰ª•Ëá™Â∑±ËÆæÁΩÆÔºåÂú®ÂàõÂª∫Ë°®ÊàñËÄÖÂàõÂª∫Á¥¢ÂºïÊó∂ÊåáÂÆö„ÄÇ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h5 id="Ëá™Â¢û-id" tabindex="-1"><a class="header-anchor" href="#Ëá™Â¢û-id"><span>Ëá™Â¢û ID</span></a></h5><p>MySQL ‰∏çÂêåÁöÑËá™Â¢û id Âú®ËææÂà∞‰∏äÈôêÂêéÁöÑË°®Áé∞‰∏çÂêåÔºö</p><ul><li><p>Ë°®ÁöÑËá™Â¢û id Â¶ÇÊûúÊòØ int Á±ªÂûãÔºåËææÂà∞‰∏äÈôê 2^32-1 ÂêéÔºåÂÜçÁî≥ËØ∑Êó∂ÂÄºÂ∞±‰∏ç‰ºöÊîπÂèòÔºåËøõËÄåÂØºËá¥ÁªßÁª≠ÊèíÂÖ•Êï∞ÊçÆÊó∂Êä•‰∏ªÈîÆÂÜ≤Á™ÅÁöÑÈîôËØØ</p></li><li><p>row_id ÈïøÂ∫¶‰∏∫ 6 ‰∏™Â≠óËäÇÔºåËææÂà∞‰∏äÈôêÂêéÂàô‰ºöÂΩí 0 ÂÜçÈáçÊñ∞ÈÄíÂ¢ûÔºåÂ¶ÇÊûúÂá∫Áé∞Áõ∏ÂêåÁöÑ row_idÔºåÂêéÂÜôÁöÑÊï∞ÊçÆ‰ºöË¶ÜÁõñ‰πãÂâçÁöÑÊï∞ÊçÆÔºåÈÄ†ÊàêÊóßÊï∞ÊçÆ‰∏¢Â§±ÔºåÂΩ±ÂìçÁöÑÊòØÊï∞ÊçÆÂèØÈù†ÊÄßÔºåÊâÄ‰ª•Â∫îËØ•Âú® InnoDB Ë°®‰∏≠‰∏ªÂä®ÂàõÂª∫Ëá™Â¢û‰∏ªÈîÆÊä•‰∏ªÈîÆÂÜ≤Á™ÅÔºåÊèíÂÖ•Â§±Ë¥•ÂΩ±ÂìçÁöÑÊòØÂèØÁî®ÊÄßÔºåËÄå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºå<strong>ÂèØÈù†ÊÄß‰ºòÂÖà‰∫éÂèØÁî®ÊÄß</strong></p></li><li><p>Xid ÈïøÂ∫¶ 8 Â≠óËäÇÔºåÁî± Server Â±ÇÁª¥Êä§ÔºåÂè™ÈúÄË¶Å‰∏çÂú®Âêå‰∏Ä‰∏™ binlog Êñá‰ª∂‰∏≠Âá∫Áé∞ÈáçÂ§çÂÄºÂç≥ÂèØÔºåËôΩÁÑ∂ÁêÜËÆ∫‰∏ä‰ºöÂá∫Áé∞ÈáçÂ§çÂÄºÔºå‰ΩÜÊòØÊ¶ÇÁéáÊûÅÂ∞è</p></li><li><p>InnoDB ÁöÑ max_trx_id ÈÄíÂ¢ûÂÄºÊØèÊ¨° MySQL ÈáçÂêØÈÉΩ‰ºöË¢´‰øùÂ≠òËµ∑Êù•ÔºåÈáçÂêØ‰πü‰∏ç‰ºöÈáçÁΩÆ‰∏∫ 0ÔºåÊâÄ‰ª•‰ºöÂØºËá¥‰∏ÄÁõ¥Â¢ûÂä†Âà∞Ëææ‰∏äÈôêÔºåÁÑ∂Âêé‰ªé 0 ÂºÄÂßãÔºåËøôÊó∂Âéü‰∫ãÂä° 0 ‰øÆÊîπÁöÑÊï∞ÊçÆÂØπÂΩìÂâç‰∫ãÂä°Â∞±ÊòØÂèØËßÅÁöÑÔºå‰∫ßÁîüËÑèËØªÁöÑÁé∞Ë±°</p><p>Âè™ËØª‰∫ãÂä°‰∏çÂàÜÈÖç trx_idÔºåÊâÄ‰ª• trx_id ÁöÑÂ¢ûÂä†ÈÄüÂ∫¶ÂèòÊÖ¢‰∫Ü</p></li><li><p>thread_id ÈïøÂ∫¶ 4 ‰∏™Â≠óËäÇÔºåÂà∞Ëææ‰∏äÈôêÂêéÂ∞±‰ºöÈáçÁΩÆ‰∏∫ 0ÔºåMySQL ËÆæËÆ°‰∫Ü‰∏Ä‰∏™ÂîØ‰∏ÄÊï∞ÁªÑÁöÑÈÄªËæëÔºåÁªôÊñ∞Á∫øÁ®ãÂàÜÈÖç thread_id Êó∂ÂÅöÂà§Êñ≠Ôºå‰øùËØÅ‰∏ç‰ºöÂá∫Áé∞‰∏§‰∏™Áõ∏ÂêåÁöÑ thread_idÔºö</p><div class="language-c++ line-numbers-mode" data-highlighter="shiki" data-ext="c++" data-title="c++" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">	new_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> thread_id_counter</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">thread_ids</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">insert_unique</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(new_id).</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">second</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://time.geekbang.org/column/article/83183</p><hr><h4 id="Ë¶ÜÁõñÁ¥¢Âºï-1" tabindex="-1"><a class="header-anchor" href="#Ë¶ÜÁõñÁ¥¢Âºï-1"><span>Ë¶ÜÁõñÁ¥¢Âºï</span></a></h4><p>Â§çÂêàÁ¥¢ÂºïÂè∂Â≠êËäÇÁÇπ‰∏ç‰ªÖ‰øùÂ≠ò‰∫ÜÂ§çÂêàÁ¥¢ÂºïÁöÑÂÄºÔºåËøòÊúâ‰∏ªÈîÆÁ¥¢ÂºïÔºåÊâÄ‰ª•‰ΩøÁî®Ë¶ÜÁõñÁ¥¢ÂºïÁöÑÊó∂ÂÄôÔºåÂä†‰∏ä‰∏ªÈîÆ‰πü‰ºöÁî®Âà∞Á¥¢Âºï</p><p>Â∞ΩÈáè‰ΩøÁî®Ë¶ÜÁõñÁ¥¢ÂºïÔºåÈÅøÂÖç SELECT *Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT name,status,address FROM tb_seller WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39; AND status=&#39;1&#39; AND address=&#39;Ë•øÂÆâÂ∏Ç&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï8.png" alt="" loading="lazy">Â¶ÇÊûúÊü•ËØ¢ÂàóÔºåË∂ÖÂá∫Á¥¢ÂºïÂàóÔºå‰πü‰ºöÈôç‰ΩéÊÄßËÉΩÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT name,status,address,password FROM tb_seller WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39; AND status=&#39;1&#39; AND address=&#39;Ë•øÂÆâÂ∏Ç&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®Á¥¢Âºï9.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h4 id="ÂáèÂ∞ëËÆøÈóÆ" tabindex="-1"><a class="header-anchor" href="#ÂáèÂ∞ëËÆøÈóÆ"><span>ÂáèÂ∞ëËÆøÈóÆ</span></a></h4><p>ÈÅøÂÖçÂØπÊï∞ÊçÆËøõË°åÈáçÂ§çÊ£ÄÁ¥¢ÔºöËÉΩÂ§ü‰∏ÄÊ¨°ËøûÊé•Â∞±Ëé∑ÂèñÂà∞ÁªìÊûúÁöÑÔºåÂ∞±‰∏çÁî®‰∏§Ê¨°ËøûÊé•ÔºåËøôÊ†∑ÂèØ‰ª•Â§ßÂ§ßÂáèÂ∞ëÂØπÊï∞ÊçÆÂ∫ìÊó†Áî®ÁöÑÈáçÂ§çËØ∑Ê±Ç</p><ul><li><p>Êü•ËØ¢Êï∞ÊçÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT id,name FROM tb_book;</span></span>
<span class="line"><span>SELECT id,status FROM tb_book; -- ÂêëÊï∞ÊçÆÂ∫ìÊèê‰∫§‰∏§Ê¨°ËØ∑Ê±ÇÔºåÊï∞ÊçÆÂ∫ìÂ∞±Ë¶ÅÂÅö‰∏§Ê¨°Êü•ËØ¢Êìç‰Ωú</span></span>
<span class="line"><span>-- &gt; ‰ºòÂåñ‰∏∫:</span></span>
<span class="line"><span>SELECT id,name,statu FROM tb_book;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÊèíÂÖ•Êï∞ÊçÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>INSERT INTO tb_test VALUES(1,&#39;Tom&#39;);</span></span>
<span class="line"><span>INSERT INTO tb_test VALUES(2,&#39;Cat&#39;);</span></span>
<span class="line"><span>INSERT INTO tb_test VALUES(3,&#39;Jerry&#39;);	-- ËøûÊé•‰∏âÊ¨°Êï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span>-- &gt;‰ºòÂåñ‰∏∫</span></span>
<span class="line"><span>INSERT INTO tb_test VALUES(1,&#39;Tom&#39;),(2,&#39;Cat&#39;)Ôºå(3,&#39;Jerry&#39;);	-- ËøûÊé•‰∏ÄÊ¨°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Âú®‰∫ãÂä°‰∏≠ËøõË°åÊï∞ÊçÆÊèíÂÖ•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>start transaction;</span></span>
<span class="line"><span>INSERT INTO tb_test VALUES(1,&#39;Tom&#39;);</span></span>
<span class="line"><span>INSERT INTO tb_test VALUES(2,&#39;Cat&#39;);</span></span>
<span class="line"><span>INSERT INTO tb_test VALUES(3,&#39;Jerry&#39;);</span></span>
<span class="line"><span>commit;	-- ÊâãÂä®Êèê‰∫§ÔºåÂàÜÊÆµÊèê‰∫§</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êï∞ÊçÆÊúâÂ∫èÊèíÂÖ•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>INSERT INTO tb_test VALUES(1,&#39;Tom&#39;);</span></span>
<span class="line"><span>INSERT INTO tb_test VALUES(2,&#39;Cat&#39;);</span></span>
<span class="line"><span>INSERT INTO tb_test VALUES(3,&#39;Jerry&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>Â¢ûÂä† cache Â±ÇÔºöÂú®Â∫îÁî®‰∏≠Â¢ûÂä†ÁºìÂ≠òÂ±ÇÊù•ËææÂà∞ÂáèËΩªÊï∞ÊçÆÂ∫ìË¥üÊãÖÁöÑÁõÆÁöÑ„ÄÇÂèØ‰ª•ÈÉ®ÂàÜÊï∞ÊçÆ‰ªéÊï∞ÊçÆÂ∫ì‰∏≠ÊäΩÂèñÂá∫Êù•ÊîæÂà∞Â∫îÁî®Á´Ø‰ª•ÊñáÊú¨ÊñπÂºèÂ≠òÂÇ®ÔºåÊàñËÄÖ‰ΩøÁî®Ê°ÜÊû∂ÔºàMybatisÔºâÊèê‰æõÁöÑ‰∏ÄÁ∫ßÁºìÂ≠ò / ‰∫åÁ∫ßÁºìÂ≠òÔºåÊàñËÄÖ‰ΩøÁî® Redis Êï∞ÊçÆÂ∫ìÊù•ÁºìÂ≠òÊï∞ÊçÆ</p><hr><h4 id="Êï∞ÊçÆÊèíÂÖ•" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÊèíÂÖ•"><span>Êï∞ÊçÆÊèíÂÖ•</span></a></h4><p>ÂΩì‰ΩøÁî® load ÂëΩ‰ª§ÂØºÂÖ•Êï∞ÊçÆÁöÑÊó∂ÂÄôÔºåÈÄÇÂΩìÁöÑËÆæÁΩÆÂèØ‰ª•ÊèêÈ´òÂØºÂÖ•ÁöÑÊïàÁéáÔºö<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL load data.png" alt="" loading="lazy"></p><p>ÂèØ‰ª•ÊâßË°åÂ¶Ç‰∏ãÊåá‰ª§ÔºåÂ∞ÜÊï∞ÊçÆËÑöÊú¨Êñá‰ª∂‰∏≠ÁöÑÊï∞ÊçÆÂä†ËΩΩÂà∞Ë°®ÁªìÊûÑ‰∏≠Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂÆ¢Êà∑Á´ØËøûÊé•ÊúçÂä°Á´ØÊó∂ÔºåÂä†‰∏äÂèÇÊï∞  -‚Äìlocal-infile</span></span>
<span class="line"><span> mysql ‚Äì-local-infile  -u  root  -p</span></span>
<span class="line"><span> </span></span>
<span class="line"><span> -- ËÆæÁΩÆÂÖ®Â±ÄÂèÇÊï∞local_infile‰∏∫1ÔºåÂºÄÂêØ‰ªéÊú¨Âú∞Âä†ËΩΩÊñá‰ª∂ÂØºÂÖ•Êï∞ÊçÆÁöÑÂºÄÂÖ≥</span></span>
<span class="line"><span>set  global  local_infile = 1;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÊâßË°åloadÊåá‰ª§Â∞ÜÂáÜÂ§áÂ•ΩÁöÑÊï∞ÊçÆÔºåÂä†ËΩΩÂà∞Ë°®ÁªìÊûÑ‰∏≠</span></span>
<span class="line"><span>load  data  local  infile  &#39;/root/sql1.log&#39;  into  table  tb_user  fields  </span></span>
<span class="line"><span>terminated  by  &#39;,&#39;  lines  terminated  by  &#39;\n&#39; ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ÂØπ‰∫é InnoDB Á±ªÂûãÁöÑË°®ÔºåÊúâ‰ª•‰∏ãÂá†ÁßçÊñπÂºèÂèØ‰ª•ÊèêÈ´òÂØºÂÖ•ÁöÑÊïàÁéáÔºö</p><ol><li><p><strong>‰∏ªÈîÆÈ°∫Â∫èÊèíÂÖ•</strong>ÔºöÂõ†‰∏∫ InnoDB Á±ªÂûãÁöÑË°®ÊòØÊåâÁÖß‰∏ªÈîÆÁöÑÈ°∫Â∫è‰øùÂ≠òÁöÑÔºåÊâÄ‰ª•Â∞ÜÂØºÂÖ•ÁöÑÊï∞ÊçÆÊåâÁÖß‰∏ªÈîÆÁöÑÈ°∫Â∫èÊéíÂàóÔºåÂèØ‰ª•ÊúâÊïàÁöÑÊèêÈ´òÂØºÂÖ•Êï∞ÊçÆÁöÑÊïàÁéáÔºåÂ¶ÇÊûú InnoDB Ë°®Ê≤°Êúâ‰∏ªÈîÆÔºåÈÇ£‰πàÁ≥ªÁªü‰ºöËá™Âä®ÈªòËÆ§ÂàõÂª∫‰∏Ä‰∏™ÂÜÖÈÉ®Âàó‰Ωú‰∏∫‰∏ªÈîÆ</p><p>‰∏ªÈîÆÊòØÂê¶ËøûÁª≠ÂØπÊÄßËÉΩÂΩ±Âìç‰∏çÂ§ßÔºåÂè™Ë¶ÅÊòØÈÄíÂ¢ûÁöÑÂ∞±ÂèØ‰ª•ÔºåÊØîÂ¶ÇÈõ™Ëä±ÁÆóÊ≥ï‰∫ßÁîüÁöÑ ID ‰∏çÊòØËøûÁª≠ÁöÑÔºå‰ΩÜÊòØÊòØÈÄíÂ¢ûÁöÑÔºåÂõ†‰∏∫ÈÄíÂ¢ûÂèØ‰ª•ËÆ©‰∏ªÈîÆÁ¥¢ÂºïÂ∞ΩÈáèÂú∞‰øùÊåÅÈ°∫Â∫èÊèíÂÖ•Ôºå<strong>ÈÅøÂÖç‰∫ÜÈ°µÂàÜË£Ç</strong>ÔºåÂõ†Ê≠§Á¥¢ÂºïÊõ¥Á¥ßÂáë</p><ol><li><ul><li>ÊèíÂÖ• ID È°∫Â∫èÊéíÂàóÊï∞ÊçÆÔºö</li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÊèíÂÖ•IDÈ°∫Â∫èÊéíÂàóÊï∞ÊçÆ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>ÊèíÂÖ• ID Êó†Â∫èÊéíÂàóÊï∞ÊçÆÔºö</li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÊèíÂÖ•IDÊó†Â∫èÊéíÂàóÊï∞ÊçÆ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ol></li><li><p><strong>ÂÖ≥Èó≠ÂîØ‰∏ÄÊÄßÊ†°È™å</strong>ÔºöÂú®ÂØºÂÖ•Êï∞ÊçÆÂâçÊâßË°å <code>SET UNIQUE_CHECKS=0</code>ÔºåÂÖ≥Èó≠ÂîØ‰∏ÄÊÄßÊ†°È™åÔºõÂØºÂÖ•ÁªìÊùüÂêéÊâßË°å <code>SET UNIQUE_ S=1</code>ÔºåÊÅ¢Â§çÂîØ‰∏ÄÊÄßÊ†°È™åÔºåÂèØ‰ª•ÊèêÈ´òÂØºÂÖ•ÁöÑÊïàÁéá„ÄÇ<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÊèíÂÖ•Êï∞ÊçÆÂÖ≥Èó≠ÂîØ‰∏ÄÊÄßÊ†°È™å.png" alt="" loading="lazy"></p></li><li><p><strong>ÊâãÂä®Êèê‰∫§‰∫ãÂä°</strong>ÔºöÂ¶ÇÊûúÂ∫îÁî®‰ΩøÁî®Ëá™Âä®Êèê‰∫§ÁöÑÊñπÂºèÔºåÂª∫ËÆÆÂú®ÂØºÂÖ•ÂâçÊâßË°å<code>SET AUTOCOMMIT=0</code>ÔºåÂÖ≥Èó≠Ëá™Âä®Êèê‰∫§ÔºõÂØºÂÖ•ÁªìÊùüÂêéÂÜçÊâìÂºÄËá™Âä®Êèê‰∫§ÔºåÂèØ‰ª•ÊèêÈ´òÂØºÂÖ•ÁöÑÊïàÁéá„ÄÇ</p><p>‰∫ãÂä°ÈúÄË¶ÅÊéßÂà∂Â§ßÂ∞èÔºå‰∫ãÂä°Â§™Â§ßÂèØËÉΩ‰ºöÂΩ±ÂìçÊâßË°åÁöÑÊïàÁéá„ÄÇMySQL Êúâ innodb_log_buffer_size ÈÖçÁΩÆÈ°πÔºåË∂ÖËøáËøô‰∏™ÂÄºÁöÑÊó•Âøó‰ºöÂÜôÂÖ•Á£ÅÁõòÊï∞ÊçÆÔºåÊïàÁéá‰ºö‰∏ãÈôçÔºåÊâÄ‰ª•Âú®‰∫ãÂä°Â§ßÂ∞èËææÂà∞ÈÖçÁΩÆÈ°πÊï∞ÊçÆÁ∫ßÂâçËøõË°å‰∫ãÂä°Êèê‰∫§ÂèØ‰ª•ÊèêÈ´òÊïàÁéá</p></li></ol><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÊèíÂÖ•Êï∞ÊçÆÊâãÂä®Êèê‰∫§‰∫ãÂä°.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h4 id="ÂàÜÁªÑÊéíÂ∫è" tabindex="-1"><a class="header-anchor" href="#ÂàÜÁªÑÊéíÂ∫è"><span>ÂàÜÁªÑÊéíÂ∫è</span></a></h4><h5 id="order-by" tabindex="-1"><a class="header-anchor" href="#order-by"><span>ORDER BY</span></a></h5><p>Êï∞ÊçÆÂáÜÂ§áÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `emp` (</span></span>
<span class="line"><span>  `id` INT(11) NOT NULL AUTO_INCREMENT,</span></span>
<span class="line"><span>  `name` VARCHAR(100) NOT NULL,</span></span>
<span class="line"><span>  `age` INT(3) NOT NULL,</span></span>
<span class="line"><span>  `salary` INT(11) DEFAULT NULL,</span></span>
<span class="line"><span>  PRIMARY KEY (`id`)</span></span>
<span class="line"><span>) ENGINE=INNODB DEFAULT CHARSET=utf8mb4;</span></span>
<span class="line"><span>INSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES(&#39;1&#39;,&#39;Tom&#39;,&#39;25&#39;,&#39;2300&#39;);-- ...</span></span>
<span class="line"><span>CREATE INDEX idx_emp_age_salary ON emp(age, salary);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>Á¨¨‰∏ÄÁßçÊòØÈÄöËøáÂØπËøîÂõûÊï∞ÊçÆËøõË°åÊéíÂ∫èÔºåÊâÄÊúâ‰∏çÈÄöËøáÁ¥¢ÂºïÁõ¥Êé•ËøîÂõûÁªìÊûúÁöÑÊéíÂ∫èÈÉΩÂè´ FileSort ÊéíÂ∫èÔºå‰ºöÂú®ÂÜÖÂ≠ò‰∏≠ÈáçÊñ∞ÊéíÂ∫è</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM emp ORDER BY age DESC;	-- Âπ¥ÈæÑÈôçÂ∫è</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL ORDER BYÊéíÂ∫è1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Á¨¨‰∫åÁßçÈÄöËøáÊúâÂ∫èÁ¥¢ÂºïÈ°∫Â∫èÊâ´ÊèèÁõ¥Êé•ËøîÂõû<strong>ÊúâÂ∫èÊï∞ÊçÆ</strong>ÔºåËøôÁßçÊÉÖÂÜµ‰∏∫ Using indexÔºå‰∏çÈúÄË¶ÅÈ¢ùÂ§ñÊéíÂ∫èÔºåÊìç‰ΩúÊïàÁéáÈ´ò</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT id, age, salary FROM emp ORDER BY age DESC;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL ORDER BYÊéíÂ∫è2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Â§öÂ≠óÊÆµÊéíÂ∫èÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT id,age,salary FROM emp ORDER BY age DESC, salary DESC;</span></span>
<span class="line"><span>EXPLAIN SELECT id,age,salary FROM emp ORDER BY salary DESC, age DESC;</span></span>
<span class="line"><span>EXPLAIN SELECT id,age,salary FROM emp ORDER BY age DESC, salary ASC;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL ORDER BYÊéíÂ∫è3.png" alt="" loading="lazy">Â∞ΩÈáèÂáèÂ∞ëÈ¢ùÂ§ñÁöÑÊéíÂ∫èÔºåÈÄöËøáÁ¥¢ÂºïÁõ¥Êé•ËøîÂõûÊúâÂ∫èÊï∞ÊçÆ„ÄÇ<strong>ÈúÄË¶ÅÊª°Ë∂≥ Order by ‰ΩøÁî®Áõ∏ÂêåÁöÑÁ¥¢Âºï„ÄÅOrder By ÁöÑÈ°∫Â∫èÂíåÁ¥¢ÂºïÈ°∫Â∫èÁõ∏Âêå„ÄÅOrder by ÁöÑÂ≠óÊÆµÈÉΩÊòØÂçáÂ∫èÊàñÈÉΩÊòØÈôçÂ∫è</strong>ÔºåÂê¶ÂàôÈúÄË¶ÅÈ¢ùÂ§ñÁöÑÊìç‰ΩúÔºåÂ∞±‰ºöÂá∫Áé∞ FileSort</p><p>Ëß£ÂÜ≥ÂäûÊ≥ïÔºöÂàõÂª∫ËÅîÂêàÁ¥¢ÂºïÂπ∂ÊåáÂÆöÊéíÂ∫èÊñπÂºè</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>create index idx_user_age_phone_ad on tb_user(age asc ,phone desc);</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>- ORDER BY RAND() ÂëΩ‰ª§Áî®Êù•ËøõË°åÈöèÊú∫ÊéíÂ∫èÔºå‰ºö‰ΩøÁî®‰∫Ü‰∏¥Êó∂ÂÜÖÂ≠òË°®Ôºå‰∏¥Êó∂ÂÜÖÂ≠òË°®ÊéíÂ∫èÁöÑÊó∂‰ΩøÁî® rowid ÊéíÂ∫èÊñπÊ≥ï</span></span>
<span class="line"><span></span></span>
<span class="line"><span>‰ºòÂåñÊñπÂºèÔºöÂàõÂª∫ÂêàÈÄÇÁöÑÁ¥¢ÂºïËÉΩÂ§üÂáèÂ∞ë Filesort ÁöÑÂá∫Áé∞Ôºå‰ΩÜÊòØÊüê‰∫õÊÉÖÂÜµ‰∏ãÊù°‰ª∂ÈôêÂà∂‰∏çËÉΩËÆ© Filesort Ê∂àÂ§±ÔºåÂ∞±Ë¶ÅÂä†Âø´ Filesort ÁöÑÊéíÂ∫èÊìç‰Ωú</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ÂÜÖÂ≠ò‰∏¥Êó∂Ë°®ÔºåMySQL Êúâ‰∏§Áßç Filesort ÊéíÂ∫èÁÆóÊ≥ïÔºö</span></span>
<span class="line"><span></span></span>
<span class="line"><span>- rowid ÊéíÂ∫èÔºöÈ¶ñÂÖàÊ†πÊçÆÊù°‰ª∂ÂèñÂá∫ÊéíÂ∫èÂ≠óÊÆµÂíå‰ø°ÊÅØÔºåÁÑ∂ÂêéÂú®**ÊéíÂ∫èÂå∫ sort bufferÔºàServer Â±ÇÔºâ**‰∏≠ÊéíÂ∫èÔºåÂ¶ÇÊûú sort buffer ‰∏çÂ§üÔºåÂàôÂú®‰∏¥Êó∂Ë°® temporary table ‰∏≠Â≠òÂÇ®ÊéíÂ∫èÁªìÊûú„ÄÇÂÆåÊàêÊéíÂ∫èÂêéÂÜçÊ†πÊçÆË°åÊåáÈíà**ÂõûË°®ËØªÂèñËÆ∞ÂΩï**ÔºåËØ•Êìç‰ΩúÂèØËÉΩ‰ºöÂØºËá¥Â§ßÈáèÈöèÊú∫ I/O Êìç‰Ωú</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ËØ¥ÊòéÔºöÂØπ‰∫é‰∏¥Êó∂ÂÜÖÂ≠òË°®ÔºåÂõûË°®ËøáÁ®ãÂè™ÊòØÁÆÄÂçïÂú∞Ê†πÊçÆÊï∞ÊçÆË°åÁöÑ‰ΩçÁΩÆÔºåÁõ¥Êé•ËÆøÈóÆÂÜÖÂ≠òÂæóÂà∞Êï∞ÊçÆÔºå‰∏ç‰ºöÂØºËá¥Â§öËÆøÈóÆÁ£ÅÁõòÔºå‰ºòÂÖàÈÄâÊã©ËØ•ÊñπÂºè</span></span>
<span class="line"><span></span></span>
<span class="line"><span>- ÂÖ®Â≠óÊÆµÊéíÂ∫èÔºö‰∏ÄÊ¨°ÊÄßÂèñÂá∫Êª°Ë∂≥Êù°‰ª∂ÁöÑÊâÄÊúâÊï∞ÊçÆÔºåÈúÄË¶ÅÂõûË°®ÔºåÁÑ∂ÂêéÂú®ÊéíÂ∫èÂå∫ sort  buffer ‰∏≠ÊéíÂ∫èÂêéÁõ¥Êé•ËæìÂá∫ÁªìÊûúÈõÜ„ÄÇÊéíÂ∫èÊó∂ÂÜÖÂ≠òÂºÄÈîÄËæÉÂ§ßÔºå‰ΩÜÊòØÊéíÂ∫èÊïàÁéáÊØî‰∏§Ê¨°Êâ´ÊèèÁÆóÊ≥ïÈ´ò</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ÂÖ∑‰ΩìÁöÑÈÄâÊã©ÊñπÂºèÔºö</span></span>
<span class="line"><span></span></span>
<span class="line"><span>- MySQL ÈÄöËøáÊØîËæÉÁ≥ªÁªüÂèòÈáè max_length_for_sort_data ÁöÑÂ§ßÂ∞èÂíå Query ËØ≠Âè•ÂèñÂá∫ÁöÑÂ≠óÊÆµÁöÑÂ§ßÂ∞èÔºåÊù•Âà§ÂÆö‰ΩøÁî®Âì™ÁßçÊéíÂ∫èÁÆóÊ≥ï„ÄÇÂ¶ÇÊûúÂâçËÄÖÂ§ßÔºåÂàôËØ¥Êòé sort  buffer Á©∫Èó¥Ë∂≥Â§üÔºå‰ΩøÁî®Á¨¨‰∫åÁßç‰ºòÂåñ‰πãÂêéÁöÑÁÆóÊ≥ïÔºåÂê¶Âàô‰ΩøÁî®Á¨¨‰∏ÄÁßç„ÄÇ</span></span>
<span class="line"><span></span></span>
<span class="line"><span>- ÂèØ‰ª•ÈÄÇÂΩìÊèêÈ´ò sort_buffer_size  Âíå max_length_for_sort_data Á≥ªÁªüÂèòÈáèÔºåÊù•Â¢ûÂ§ßÊéíÂ∫èÂå∫ÁöÑÂ§ßÂ∞èÔºåÊèêÈ´òÊéíÂ∫èÁöÑÊïàÁéá</span></span>
<span class="line"><span></span></span>
<span class="line"><span>```mysql</span></span>
<span class="line"><span>SET @@max_length_for_sort_data = 10000; 		-- ËÆæÁΩÆÂÖ®Â±ÄÂèòÈáè</span></span>
<span class="line"><span>SET max_length_for_sort_data = 10240; 			-- ËÆæÁΩÆ‰ºöËØùÂèòÈáè</span></span>
<span class="line"><span>SHOW VARIABLES LIKE &#39;max_length_for_sort_data&#39;;	-- ÈªòËÆ§1024</span></span>
<span class="line"><span>SHOW VARIABLES LIKE &#39;sort_buffer_size&#39;;			-- ÈªòËÆ§262114Âç≥256k</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Á£ÅÁõò‰∏¥Êó∂Ë°®ÔºöÊéíÂ∫è‰ΩøÁî®‰ºòÂÖàÈòüÂàóÔºàÂ†ÜÔºâÁöÑÊñπÂºè</p><hr><h5 id="group-by" tabindex="-1"><a class="header-anchor" href="#group-by"><span>GROUP BY</span></a></h5><p>GROUP BY ‰πü‰ºöËøõË°åÊéíÂ∫èÊìç‰ΩúÔºå‰∏é ORDER BY Áõ∏ÊØîÔºåGROUP BY ‰∏ªË¶ÅÂè™ÊòØÂ§ö‰∫ÜÊéíÂ∫è‰πãÂêéÁöÑÂàÜÁªÑÊìç‰ΩúÔºåÊâÄ‰ª•Âú® GROUP BY ÁöÑÂÆûÁé∞ËøáÁ®ã‰∏≠Ôºå‰∏é ORDER BY ‰∏ÄÊ†∑‰πüÂèØ‰ª•Âà©Áî®Âà∞Á¥¢Âºï</p><ul><li><p>ÂàÜÁªÑÊü•ËØ¢Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>DROP INDEX idx_emp_age_salary ON emp;</span></span>
<span class="line"><span>EXPLAIN SELECT age,COUNT(*) FROM emp GROUP BY age;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL GROUP BYÊéíÂ∫è1.png" alt="" loading="lazy">Using temporaryÔºöË°®Á§∫ MySQL ÈúÄË¶Å‰ΩøÁî®‰∏¥Êó∂Ë°®Ôºà‰∏çÊòØ sort bufferÔºâÊù•Â≠òÂÇ®ÁªìÊûúÈõÜÔºåÂ∏∏ËßÅ‰∫éÊéíÂ∫èÂíåÂàÜÁªÑÊü•ËØ¢</p></li><li><p>Êü•ËØ¢ÂåÖÂê´ GROUP BY ‰ΩÜÊòØÁî®Êà∑ÊÉ≥Ë¶ÅÈÅøÂÖçÊéíÂ∫èÁªìÊûúÁöÑÊ∂àËÄóÔºå ÂàôÂèØ‰ª•ÊâßË°å ORDER BY NULL Á¶ÅÊ≠¢ÊéíÂ∫èÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT age,COUNT(*) FROM emp GROUP BY age ORDER BY NULL;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL GROUP BYÊéíÂ∫è2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>ÂàõÂª∫Á¥¢ÂºïÔºöÁ¥¢ÂºïÊú¨Ë∫´ÊúâÂ∫èÔºå‰∏çÈúÄË¶Å‰∏¥Êó∂Ë°®Ôºå‰πü‰∏çÈúÄË¶ÅÂÜçÈ¢ùÂ§ñÊéíÂ∫è</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE INDEX idx_emp_age_salary ON emp(age, salary);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL GROUP BYÊéíÂ∫è3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Êï∞ÊçÆÈáèÂæàÂ§ßÊó∂Ôºå‰ΩøÁî® SQL_BIG_RESULT ÊèêÁ§∫‰ºòÂåñÂô®Áõ¥Êé•‰ΩøÁî®Áõ¥Êé•Áî®Á£ÅÁõò‰∏¥Êó∂Ë°®</p></li></ul><hr><h4 id="ËÅîÂêàÊü•ËØ¢-1" tabindex="-1"><a class="header-anchor" href="#ËÅîÂêàÊü•ËØ¢-1"><span>ËÅîÂêàÊü•ËØ¢</span></a></h4><p>ÂØπ‰∫éÂåÖÂê´ OR ÁöÑÊü•ËØ¢Â≠êÂè•ÔºåÂ¶ÇÊûúË¶ÅÂà©Áî®Á¥¢ÂºïÔºåÂàô OR ‰πãÈó¥ÁöÑ<strong>ÊØè‰∏™Êù°‰ª∂ÂàóÈÉΩÂøÖÈ°ªÁî®Âà∞Á¥¢ÂºïÔºåËÄå‰∏î‰∏çËÉΩ‰ΩøÁî®Âà∞Êù°‰ª∂‰πãÈó¥ÁöÑÂ§çÂêàÁ¥¢Âºï</strong>ÔºåÂ¶ÇÊûúÊ≤°ÊúâÁ¥¢ÂºïÔºåÂàôÂ∫îËØ•ËÄÉËôëÂ¢ûÂä†Á¥¢Âºï</p><ul><li><p>ÊâßË°åÊü•ËØ¢ËØ≠Âè•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM emp WHERE id = 1 OR age = 30;	-- ‰∏§‰∏™Á¥¢ÂºïÔºåÂπ∂‰∏î‰∏çÊòØÂ§çÂêàÁ¥¢Âºï</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Extra:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sort_union</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">idx_emp_age_salary,PRIMARY</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Using</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> where</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL ORÊù°‰ª∂Êü•ËØ¢1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>‰ΩøÁî® UNION ÊõøÊç¢ ORÔºåÊ±ÇÂπ∂ÈõÜÔºö</p><p>Ê≥®ÊÑèÔºöËØ•‰ºòÂåñÂè™ÈíàÂØπÂ§ö‰∏™Á¥¢ÂºïÂàóÊúâÊïàÔºåÂ¶ÇÊûúÊúâÂàóÊ≤°ÊúâË¢´Á¥¢ÂºïÔºåÊü•ËØ¢ÊïàÁéáÂèØËÉΩ‰ºöÂõ†‰∏∫Ê≤°ÊúâÈÄâÊã© OR ËÄåÈôç‰Ωé</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM emp WHERE id = 1 UNION SELECT * FROM emp WHERE age = 30;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL ORÊù°‰ª∂Êü•ËØ¢2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>UNION Ë¶Å‰ºò‰∫é OR ÁöÑÂéüÂõ†Ôºö</p><ul><li>UNION ËØ≠Âè•ÁöÑ type ÂÄº‰∏∫ refÔºåOR ËØ≠Âè•ÁöÑ type ÂÄº‰∏∫ range</li><li>UNION ËØ≠Âè•ÁöÑ ref ÂÄº‰∏∫ constÔºåOR ËØ≠Âè•ÁöÑ ref ÂÄº‰∏∫ nullÔºåconst Ë°®Á§∫ÊòØÂ∏∏ÈáèÂÄºÂºïÁî®ÔºåÈùûÂ∏∏Âø´</li></ul></li></ul><hr><h4 id="ÂµåÂ•óÊü•ËØ¢-1" tabindex="-1"><a class="header-anchor" href="#ÂµåÂ•óÊü•ËØ¢-1"><span>ÂµåÂ•óÊü•ËØ¢</span></a></h4><p>MySQL 4.1 ÁâàÊú¨‰πãÂêéÔºåÂºÄÂßãÊîØÊåÅ SQL ÁöÑÂ≠êÊü•ËØ¢</p><ul><li>ÂèØ‰ª•‰ΩøÁî® SELECT ËØ≠Âè•Êù•ÂàõÂª∫‰∏Ä‰∏™ÂçïÂàóÁöÑÊü•ËØ¢ÁªìÊûúÔºåÁÑ∂ÂêéÊääÁªìÊûú‰Ωú‰∏∫ËøáÊª§Êù°‰ª∂Áî®Âú®Âè¶‰∏Ä‰∏™Êü•ËØ¢‰∏≠</li><li>‰ΩøÁî®Â≠êÊü•ËØ¢ÂèØ‰ª•‰∏ÄÊ¨°ÊÄßÁöÑÂÆåÊàêÈÄªËæë‰∏äÈúÄË¶ÅÂ§ö‰∏™Ê≠•È™§ÊâçËÉΩÂÆåÊàêÁöÑ SQL Êìç‰ΩúÔºåÂêåÊó∂‰πüÂèØ‰ª•ÈÅøÂÖç‰∫ãÂä°ÊàñËÄÖË°®ÈîÅÊ≠ª</li><li>Âú®Êúâ‰∫õÊÉÖÂÜµ‰∏ãÔºå<strong>Â≠êÊü•ËØ¢ÊòØÂèØ‰ª•Ë¢´Êõ¥È´òÊïàÁöÑËøûÊé•ÔºàJOINÔºâÊõø‰ª£</strong></li></ul><p>‰æãÂ¶ÇÊü•ÊâæÊúâËßíËâ≤ÁöÑÊâÄÊúâÁöÑÁî®Êà∑‰ø°ÊÅØÔºö</p><ul><li><p>ÊâßË°åËÆ°ÂàíÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM t_user WHERE id IN (SELECT user_id FROM user_role);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÂµåÂ•óÊü•ËØ¢1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>‰ºòÂåñÂêéÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM t_user u , user_role ur WHERE u.id = ur.user_id;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÂµåÂ•óÊü•ËØ¢2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ËøûÊé•Êü•ËØ¢‰πãÊâÄ‰ª•ÊïàÁéáÊõ¥È´ò ÔºåÊòØÂõ†‰∏∫<strong>‰∏çÈúÄË¶ÅÂú®ÂÜÖÂ≠ò‰∏≠ÂàõÂª∫‰∏¥Êó∂Ë°®</strong>Êù•ÂÆåÊàêÈÄªËæë‰∏äÈúÄË¶Å‰∏§‰∏™Ê≠•È™§ÁöÑÊü•ËØ¢Â∑•‰Ωú</p></li></ul><hr><h4 id="ÂàÜÈ°µÊü•ËØ¢-1" tabindex="-1"><a class="header-anchor" href="#ÂàÜÈ°µÊü•ËØ¢-1"><span>ÂàÜÈ°µÊü•ËØ¢</span></a></h4><p>‰∏ÄËà¨ÂàÜÈ°µÊü•ËØ¢Êó∂ÔºåÈÄöËøáÂàõÂª∫Ë¶ÜÁõñÁ¥¢ÂºïËÉΩÂ§üÊØîËæÉÂ•ΩÂú∞ÊèêÈ´òÊÄßËÉΩ</p><p>‰∏Ä‰∏™Â∏∏ËßÅÁöÑÈóÆÈ¢òÊòØ <code>LIMIT 200000,10</code>ÔºåÊ≠§Êó∂ÈúÄË¶Å MySQL Êâ´ÊèèÂâç 200010 ËÆ∞ÂΩïÔºå‰ªÖ‰ªÖËøîÂõû 200000 - 200010 ‰πãÈó¥ÁöÑËÆ∞ÂΩïÔºåÂÖ∂‰ªñËÆ∞ÂΩï‰∏¢ÂºÉÔºåÊü•ËØ¢ÊéíÂ∫èÁöÑ‰ª£‰ª∑ÈùûÂ∏∏Â§ß</p><ul><li><p>ÂàÜÈ°µÊü•ËØ¢Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_user_1 LIMIT 200000,10;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÂàÜÈ°µÊü•ËØ¢1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>‰ºòÂåñÊñπÂºè‰∏ÄÔºöÂÜÖËøûÊé•Êü•ËØ¢ÔºåÂú®Á¥¢ÂºïÂàó id ‰∏äÂÆåÊàêÊéíÂ∫èÂàÜÈ°µÊìç‰ΩúÔºåÊúÄÂêéÊ†πÊçÆ‰∏ªÈîÆÂÖ≥ËÅîÂõûÂéüË°®Êü•ËØ¢ÊâÄÈúÄË¶ÅÁöÑÂÖ∂‰ªñÂàóÂÜÖÂÆπ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_user_1 t,(SELECT id FROM tb_user_1 ORDER BY id LIMIT 200000,10) a WHERE t.id = a.id;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÂàÜÈ°µÊü•ËØ¢2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>‰ºòÂåñÊñπÂºè‰∫åÔºöÊñπÊ°àÈÄÇÁî®‰∫é‰∏ªÈîÆËá™Â¢ûÁöÑË°®ÔºåÂèØ‰ª•Êää LIMIT Êü•ËØ¢ËΩ¨Êç¢ÊàêÊüê‰∏™‰ΩçÁΩÆÁöÑÊü•ËØ¢</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_user_1 WHERE id &gt; 200000 LIMIT 10;			-- ÂÜôÊ≥ï 1</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM tb_user_1 WHERE id BETWEEN 200000 and 200010;	-- ÂÜôÊ≥ï 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQLÂàÜÈ°µÊü•ËØ¢3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><hr><h4 id="‰ΩøÁî®ÊèêÁ§∫" tabindex="-1"><a class="header-anchor" href="#‰ΩøÁî®ÊèêÁ§∫"><span>‰ΩøÁî®ÊèêÁ§∫</span></a></h4><p>SQL ÊèêÁ§∫ÔºåÊòØ‰ºòÂåñÊï∞ÊçÆÂ∫ìÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÊâãÊÆµÔºåÂ∞±ÊòØÂú® SQL ËØ≠Âè•‰∏≠Âä†ÂÖ•‰∏Ä‰∫õÊèêÁ§∫Êù•ËææÂà∞‰ºòÂåñÊìç‰ΩúÁöÑÁõÆÁöÑ</p><ul><li><p>USE INDEXÔºöÂú®Êü•ËØ¢ËØ≠Âè•‰∏≠Ë°®ÂêçÁöÑÂêéÈù¢Ê∑ªÂä† USE INDEX Êù•Êèê‰æõ MySQL ÂéªÂèÇËÄÉÁöÑÁ¥¢ÂºïÂàóË°®ÔºåÂèØ‰ª•ËÆ© MySQL ‰∏çÂÜçËÄÉËôëÂÖ∂‰ªñÂèØÁî®ÁöÑÁ¥¢Âºï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE INDEX idx_seller_name ON tb_seller(name);</span></span>
<span class="line"><span>EXPLAIN SELECT * FROM tb_seller USE INDEX(idx_seller_name) WHERE name=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®ÊèêÁ§∫1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>IGNORE INDEXÔºöËÆ© MySQL ÂøΩÁï•‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™Á¥¢ÂºïÔºåÂàôÂèØ‰ª•‰ΩøÁî® IGNORE INDEX ‰Ωú‰∏∫ÊèêÁ§∫</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller IGNORE INDEX(idx_seller_name) WHERE name = &#39;Â∞èÁ±≥ÁßëÊäÄ&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®ÊèêÁ§∫2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>FORCE INDEXÔºöÂº∫Âà∂ MySQL ‰ΩøÁî®‰∏Ä‰∏™ÁâπÂÆöÁöÑÁ¥¢Âºï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>EXPLAIN SELECT * FROM tb_seller FORCE INDEX(idx_seller_name_sta_addr) WHERE NAME=&#39;Â∞èÁ±≥ÁßëÊäÄ&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰ºòÂåñSQL‰ΩøÁî®ÊèêÁ§∫3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><hr><h4 id="ÁªüËÆ°ËÆ°Êï∞" tabindex="-1"><a class="header-anchor" href="#ÁªüËÆ°ËÆ°Êï∞"><span>ÁªüËÆ°ËÆ°Êï∞</span></a></h4><p>Âú®‰∏çÂêåÁöÑ MySQL ÂºïÊìé‰∏≠Ôºåcount(*) Êúâ‰∏çÂêåÁöÑÂÆûÁé∞ÊñπÂºèÔºö</p><ul><li>MyISAM ÂºïÊìéÊää‰∏Ä‰∏™Ë°®ÁöÑÊÄªË°åÊï∞Â≠òÂú®‰∫ÜÁ£ÅÁõò‰∏äÔºåÂõ†Ê≠§ÊâßË°å count(*) ÁöÑÊó∂ÂÄô‰ºöÁõ¥Êé•ËøîÂõûËøô‰∏™Êï∞ÔºåÊïàÁéáÂæàÈ´òÔºå‰ΩÜ‰∏çÊîØÊåÅ‰∫ãÂä°</li><li>show table status ÂëΩ‰ª§ÈÄöËøáÈááÊ†∑‰º∞ÁÆóÂèØ‰ª•Âø´ÈÄüËé∑ÂèñÔºå‰ΩÜÊòØ‰∏çÂáÜÁ°Æ</li><li>InnoDB Ë°®ÊâßË°å count(*) ‰ºöÈÅçÂéÜÂÖ®Ë°®ÔºåËôΩÁÑ∂ÁªìÊûúÂáÜÁ°ÆÔºå‰ΩÜ‰ºöÂØºËá¥ÊÄßËÉΩÈóÆÈ¢ò</li></ul><p>Ëß£ÂÜ≥ÊñπÊ°àÔºö</p><ul><li><p>ËÆ°Êï∞‰øùÂ≠òÂú® Redis ‰∏≠Ôºå‰ΩÜÊòØÊõ¥Êñ∞ MySQL Âíå Redis ÁöÑÊìç‰Ωú‰∏çÊòØÂéüÂ≠êÁöÑÔºå‰ºöÂ≠òÂú®Êï∞ÊçÆ‰∏ÄËá¥ÊÄßÁöÑÈóÆÈ¢ò</p></li><li><p>ËÆ°Êï∞Áõ¥Êé•ÊîæÂà∞Êï∞ÊçÆÂ∫ìÈáåÂçïÁã¨ÁöÑ‰∏ÄÂº†ËÆ°Êï∞Ë°®‰∏≠ÔºåÂà©Áî®‰∫ãÂä°Ëß£ÂÜ≥ËÆ°Êï∞Á≤æÁ°ÆÈóÆÈ¢òÔºö</p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ËÆ°Êï∞count‰ºòÂåñ.png" style="zoom:50%;"><p>‰ºöËØù B ÁöÑËØªÊìç‰ΩúÂú® T3 ÊâßË°åÁöÑÔºåËøôÊó∂Êõ¥Êñ∞‰∫ãÂä°ËøòÊ≤°ÊúâÊèê‰∫§ÔºåÊâÄ‰ª•ËÆ°Êï∞ÂÄºÂä† 1 Ëøô‰∏™Êìç‰ΩúÂØπ‰ºöËØù B Ëøò‰∏çÂèØËßÅÔºåÂõ†Ê≠§‰ºöËØù B Êü•ËØ¢ÁöÑËÆ°Êï∞ÂÄºÂíåÊúÄËøë 100 Êù°ËÆ∞ÂΩïÔºåËøîÂõûÁöÑÁªìÊûúÈÄªËæë‰∏äÂ∞±ÊòØ‰∏ÄËá¥ÁöÑ</p><p>Âπ∂ÂèëÁ≥ªÁªüÊÄßËÉΩÁöÑËßíÂ∫¶ËÄÉËôëÔºåÂ∫îËØ•ÂÖàÊèíÂÖ•Êìç‰ΩúËÆ∞ÂΩïÂÜçÊõ¥Êñ∞ËÆ°Êï∞Ë°®ÔºåÂõ†‰∏∫Êõ¥Êñ∞ËÆ°Êï∞Ë°®Ê∂âÂèäÂà∞Ë°åÈîÅÁöÑÁ´û‰∫âÔºå<strong>ÂÖàÊèíÂÖ•ÂÜçÊõ¥Êñ∞ËÉΩÊúÄÂ§ßÁ®ãÂ∫¶Âú∞ÂáèÂ∞ë‰∫ãÂä°‰πãÈó¥ÁöÑÈîÅÁ≠âÂæÖÔºåÊèêÂçáÂπ∂ÂèëÂ∫¶</strong></p></li></ul><p>count ÂáΩÊï∞ÁöÑÊåâÁÖßÊïàÁéáÊéíÂ∫èÔºö<code>count(Â≠óÊÆµ) &lt; count(‰∏ªÈîÆid) &lt; count(1) ‚âà count(*)</code>ÔºåÊâÄ‰ª•Âª∫ËÆÆÂ∞ΩÈáè‰ΩøÁî® count(*)</p><ul><li>count(‰∏ªÈîÆ id)ÔºöInnoDB ÂºïÊìé‰ºöÈÅçÂéÜÊï¥Âº†Ë°®ÔºåÊääÊØè‰∏ÄË°åÁöÑ id ÂÄºÈÉΩÂèñÂá∫Êù•ËøîÂõûÁªô Server Â±ÇÔºåServer Âà§Êñ≠ id ‰∏ç‰∏∫Á©∫Â∞±ÊåâË°åÁ¥ØÂä†</li><li>count(1)ÔºöInnoDB ÂºïÊìéÈÅçÂéÜÊï¥Âº†Ë°®‰ΩÜ‰∏çÂèñÂÄºÔºåServer Â±ÇÂØπ‰∫éËøîÂõûÁöÑÊØè‰∏ÄË°åÔºåÊîæ‰∏Ä‰∏™Êï∞Â≠ó 1 ËøõÂéªÔºåÂà§Êñ≠‰∏ç‰∏∫Á©∫Â∞±ÊåâË°åÁ¥ØÂä†</li><li>count(Â≠óÊÆµ)ÔºöÂ¶ÇÊûúËøô‰∏™Â≠óÊÆµÊòØÂÆö‰πâ‰∏∫ not null ÁöÑËØùÔºå‰∏ÄË°åË°åÂú∞‰ªéËÆ∞ÂΩïÈáåÈù¢ËØªÂá∫Ëøô‰∏™Â≠óÊÆµÔºåÂà§Êñ≠‰∏çËÉΩ‰∏∫ nullÔºåÊåâË°åÁ¥ØÂä†ÔºõÂ¶ÇÊûúËøô‰∏™Â≠óÊÆµÂÆö‰πâÂÖÅËÆ∏‰∏∫ nullÔºåÈÇ£‰πàÊâßË°åÁöÑÊó∂ÂÄôÔºåÂà§Êñ≠Âà∞ÊúâÂèØËÉΩÊòØ nullÔºåËøòË¶ÅÊääÂÄºÂèñÂá∫Êù•ÂÜçÂà§Êñ≠‰∏Ä‰∏ãÔºå‰∏çÊòØ null ÊâçÁ¥ØÂä†</li><li>count(*)Ôºö‰∏çÂèñÂÄºÔºåÊåâË°åÁ¥ØÂä†</li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://time.geekbang.org/column/article/72775</p><h4 id="update-1" tabindex="-1"><a class="header-anchor" href="#update-1"><span>update</span></a></h4><p>Êàë‰ª¨‰∏ªË¶ÅÈúÄË¶ÅÊ≥®ÊÑè‰∏Ä‰∏ãupdateËØ≠Âè•ÊâßË°åÊó∂ÁöÑÊ≥®ÊÑè‰∫ãÈ°π„ÄÇ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>update  course  set  name = &#39;javaEE&#39;  where  id  =  1 ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ÂΩìÊàë‰ª¨Âú®ÊâßË°åÂà†Èô§ÁöÑSQLËØ≠Âè•Êó∂Ôºå‰ºöÈîÅÂÆöid‰∏∫1Ëøô‰∏ÄË°åÁöÑÊï∞ÊçÆÔºåÁÑ∂Âêé‰∫ãÂä°Êèê‰∫§‰πãÂêéÔºåË°åÈîÅÈáäÊîæ„ÄÇ ‰ΩÜÊòØÂΩìÊàë‰ª¨Âú®ÊâßË°åÂ¶Ç‰∏ãSQLÊó∂„ÄÇ ÂΩìÊàë‰ª¨ÂºÄÂêØÂ§ö‰∏™‰∫ãÂä°ÔºåÂú®ÊâßË°å‰∏äËø∞ÁöÑSQLÊó∂ÔºåÊàë‰ª¨ÂèëÁé∞Ë°åÈîÅÂçáÁ∫ß‰∏∫‰∫ÜË°®ÈîÅ„ÄÇ ÂØºËá¥ËØ•updateËØ≠Âè•ÁöÑÊÄßËÉΩ Â§ßÂ§ßÈôç‰Ωé„ÄÇ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>update course set name = &#39;SpringBoot&#39; where name = &#39;PHP&#39; ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>InnoDBÁöÑË°åÈîÅÊòØÈíàÂØπÁ¥¢ÂºïÂä†ÁöÑÈîÅÔºå‰∏çÊòØÈíàÂØπËÆ∞ÂΩïÂä†ÁöÑÈîÅ ,Âπ∂‰∏îËØ•Á¥¢Âºï‰∏çËÉΩÂ§±ÊïàÔºåÂê¶Âàô‰ºö‰ªéË°åÈîÅ ÂçáÁ∫ß‰∏∫Ë°®ÈîÅ „ÄÇ</p><p><strong>InnoDBÁöÑË°åÈîÅÊòØÈíàÂØπÁ¥¢ÂºïÂä†ÁöÑÈîÅÔºå‰∏çÊòØÈíàÂØπËÆ∞ÂΩïÂä†ÁöÑÈîÅ ,Âπ∂‰∏îËØ•Á¥¢Âºï‰∏çËÉΩÂ§±ÊïàÔºåÂê¶Âàô‰ºö‰ªéË°åÈîÅ</strong><strong>ÂçáÁ∫ß‰∏∫Ë°®ÈîÅ „ÄÇ</strong></p><hr><h3 id="ÁºìÂÜ≤‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#ÁºìÂÜ≤‰ºòÂåñ"><span>ÁºìÂÜ≤‰ºòÂåñ</span></a></h3><h4 id="‰ºòÂåñÂéüÂàô" tabindex="-1"><a class="header-anchor" href="#‰ºòÂåñÂéüÂàô"><span>‰ºòÂåñÂéüÂàô</span></a></h4><p>‰∏â‰∏™ÂéüÂàôÔºö</p><ul><li>Â∞ÜÂ∞ΩÈáèÂ§öÁöÑÂÜÖÂ≠òÂàÜÈÖçÁªô MySQL ÂÅöÁºìÂ≠òÔºå‰ΩÜ‰πüË¶ÅÁªôÊìç‰ΩúÁ≥ªÁªüÂíåÂÖ∂‰ªñÁ®ãÂ∫èÈ¢ÑÁïôË∂≥Â§üÂÜÖÂ≠ò</li><li>MyISAM Â≠òÂÇ®ÂºïÊìéÁöÑÊï∞ÊçÆÊñá‰ª∂ËØªÂèñ‰æùËµñ‰∫éÊìç‰ΩúÁ≥ªÁªüËá™Ë∫´ÁöÑ IO ÁºìÂ≠òÔºåÂ¶ÇÊûúÊúâ MyISAM Ë°®ÔºåÂ∞±Ë¶ÅÈ¢ÑÁïôÊõ¥Â§öÁöÑÂÜÖÂ≠òÁªôÊìç‰ΩúÁ≥ªÁªüÂÅö IO ÁºìÂ≠ò</li><li>ÊéíÂ∫èÂå∫„ÄÅËøûÊé•Âå∫Á≠âÁºìÂ≠òÊòØÂàÜÈÖçÁªôÊØè‰∏™Êï∞ÊçÆÂ∫ì‰ºöËØùÔºàSessionÔºâ‰∏ìÁî®ÁöÑÔºåÂÄºÁöÑËÆæÁΩÆË¶ÅÊ†πÊçÆÊúÄÂ§ßËøûÊé•Êï∞ÂêàÁêÜÂàÜÈÖçÔºåÂ¶ÇÊûúËÆæÁΩÆÂ§™Â§ßÔºå‰∏ç‰ΩÜÊµ™Ë¥πËµÑÊ∫êÔºåËÄå‰∏îÂú®Âπ∂ÂèëÊï∞ËæÉÈ´òÊó∂‰ºöÂØºËá¥Áâ©ÁêÜÂÜÖÂ≠òËÄóÂ∞Ω</li></ul><hr><h4 id="ÁºìÂÜ≤ÂÜÖÂ≠ò" tabindex="-1"><a class="header-anchor" href="#ÁºìÂÜ≤ÂÜÖÂ≠ò"><span>ÁºìÂÜ≤ÂÜÖÂ≠ò</span></a></h4><p>Buffer Pool Êú¨Ë¥®‰∏äÊòØ InnoDB ÂêëÊìç‰ΩúÁ≥ªÁªüÁî≥ËØ∑ÁöÑ‰∏ÄÊÆµËøûÁª≠ÁöÑÂÜÖÂ≠òÁ©∫Èó¥„ÄÇInnoDB ÁöÑÊï∞ÊçÆÊòØÊåâÊï∞ÊçÆÈ°µ‰∏∫Âçï‰ΩçÊù•ËØªÂÜôÔºåÊØè‰∏™Êï∞ÊçÆÈ°µÁöÑÂ§ßÂ∞èÈªòËÆ§ÊòØ 16KB„ÄÇÊï∞ÊçÆÊòØÂ≠òÊîæÂú®Á£ÅÁõò‰∏≠ÔºåÊØèÊ¨°ËØªÂÜôÊï∞ÊçÆÈÉΩÈúÄË¶ÅËøõË°åÁ£ÅÁõò IO Â∞ÜÊï∞ÊçÆËØªÂÖ•ÂÜÖÂ≠òËøõË°åÊìç‰ΩúÔºåÊïàÁéá‰ºöÂæà‰ΩéÔºåÊâÄ‰ª•Êèê‰æõ‰∫Ü Buffer Pool Êù•ÊöÇÂ≠òËøô‰∫õÊï∞ÊçÆÈ°µÔºåÁºìÂ≠ò‰∏≠ÁöÑËøô‰∫õÈ°µÂèàÂè´ÁºìÂÜ≤È°µ</p><p>Â∑•‰ΩúÂéüÁêÜÔºö</p><ul><li>‰ªéÊï∞ÊçÆÂ∫ìËØªÂèñÊï∞ÊçÆÊó∂Ôºå‰ºöÈ¶ñÂÖà‰ªéÁºìÂ≠ò‰∏≠ËØªÂèñÔºåÂ¶ÇÊûúÁºìÂ≠ò‰∏≠Ê≤°ÊúâÔºåÂàô‰ªéÁ£ÅÁõòËØªÂèñÂêéÊîæÂÖ• Buffer Pool</li><li>ÂêëÊï∞ÊçÆÂ∫ìÂÜôÂÖ•Êï∞ÊçÆÊó∂Ôºå‰ºöÂÜôÂÖ•ÁºìÂ≠òÔºåÁºìÂ≠ò‰∏≠‰øÆÊîπÁöÑÊï∞ÊçÆ‰ºö<strong>ÂÆöÊúüÂà∑Êñ∞</strong>Âà∞Á£ÅÁõòÔºåËøô‰∏ÄËøáÁ®ãÁß∞‰∏∫Âà∑ËÑè</li></ul><p>Buffer Pool ‰∏≠ÊØè‰∏™ÁºìÂÜ≤È°µÈÉΩÊúâÂØπÂ∫îÁöÑÊéßÂà∂‰ø°ÊÅØÔºåÂåÖÊã¨Ë°®Á©∫Èó¥ÁºñÂè∑„ÄÅÈ°µÂè∑„ÄÅÂÅèÁßªÈáè„ÄÅÈìæË°®‰ø°ÊÅØÁ≠âÔºåÊéßÂà∂‰ø°ÊÅØÂ≠òÊîæÂú®Âç†Áî®ÁöÑÂÜÖÂ≠òÁß∞‰∏∫ÊéßÂà∂ÂùóÔºåÊéßÂà∂Âùó‰∏éÁºìÂÜ≤È°µÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑÔºå‰ΩÜÂπ∂‰∏çÊòØÁâ©ÁêÜ‰∏äÁõ∏ËøûÁöÑÔºåÈÉΩÂú®ÁºìÂÜ≤Ê±†‰∏≠</p><p>MySQL Êèê‰æõ‰∫ÜÁºìÂÜ≤È°µÁöÑÂø´ÈÄüÊü•ÊâæÊñπÂºèÔºö<strong>ÂìàÂ∏åË°®</strong>Ôºå‰ΩøÁî®Ë°®Á©∫Èó¥Âè∑ÂíåÈ°µÂè∑‰Ωú‰∏∫ KeyÔºåÁºìÂÜ≤È°µÊéßÂà∂ÂùóÁöÑÂú∞ÂùÄ‰Ωú‰∏∫ Value ÂàõÂª∫‰∏Ä‰∏™ÂìàÂ∏åË°®ÔºåËé∑ÂèñÊï∞ÊçÆÈ°µÊó∂Ê†πÊçÆ Key ËøõË°åÂìàÂ∏åÂØªÂùÄÔºö</p><ul><li>Â¶ÇÊûú‰∏çÂ≠òÂú®ÂØπÂ∫îÁöÑÁºìÂ≠òÈ°µÔºåÂ∞±‰ªé free ÈìæË°®‰∏≠ÈÄâ‰∏Ä‰∏™Á©∫Èó≤ÁºìÂÜ≤È°µÔºåÊääÁ£ÅÁõò‰∏≠ÁöÑÂØπÂ∫îÈ°µÂä†ËΩΩÂà∞ËØ•‰ΩçÁΩÆ</li><li>Â¶ÇÊûúÂ≠òÂú®ÂØπÂ∫îÁöÑÁºìÂ≠òÈ°µÔºåÁõ¥Êé•Ëé∑Âèñ‰ΩøÁî®ÔºåÊèêÈ´òÊü•ËØ¢Êï∞ÊçÆÁöÑÊïàÁéá</li></ul><p>ÂΩìÂÜÖÂ≠òÊï∞ÊçÆÈ°µË∑üÁ£ÅÁõòÊï∞ÊçÆÈ°µÂÜÖÂÆπ‰∏ç‰∏ÄËá¥Êó∂ÔºåÁß∞Ëøô‰∏™ÂÜÖÂ≠òÈ°µ‰∏∫ËÑèÈ°µÔºõÂÜÖÂ≠òÊï∞ÊçÆÂÜôÂÖ•Á£ÅÁõòÂêéÔºåÂÜÖÂ≠òÂíåÁ£ÅÁõò‰∏äÁöÑÊï∞ÊçÆÈ°µ‰∏ÄËá¥ÔºåÁß∞‰∏∫Âπ≤ÂáÄÈ°µ</p><hr><h4 id="ÂÜÖÂ≠òÁÆ°ÁêÜ" tabindex="-1"><a class="header-anchor" href="#ÂÜÖÂ≠òÁÆ°ÁêÜ"><span>ÂÜÖÂ≠òÁÆ°ÁêÜ</span></a></h4><h5 id="free-ÈìæË°®" tabindex="-1"><a class="header-anchor" href="#free-ÈìæË°®"><span>Free ÈìæË°®</span></a></h5><p>MySQL ÂêØÂä®Êó∂ÂÆåÊàêÂØπ Buffer Pool ÁöÑÂàùÂßãÂåñÔºåÂÖàÂêëÊìç‰ΩúÁ≥ªÁªüÁî≥ËØ∑ËøûÁª≠ÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÔºåÁÑ∂ÂêéÂ∞ÜÂÜÖÂ≠òÂàíÂàÜ‰∏∫Ëã•Âπ≤ÂØπÊéßÂà∂ÂùóÂíåÁºìÂÜ≤È°µ„ÄÇ‰∏∫‰∫ÜÂå∫ÂàÜÁ©∫Èó≤ÂíåÂ∑≤Âç†Áî®ÁöÑÊï∞ÊçÆÈ°µÔºåÂ∞ÜÊâÄÊúâÁ©∫Èó≤ÁºìÂÜ≤È°µÂØπÂ∫îÁöÑ<strong>ÊéßÂà∂Âùó‰Ωú‰∏∫‰∏Ä‰∏™ËäÇÁÇπ</strong>ÊîæÂÖ•‰∏Ä‰∏™ÈìæË°®‰∏≠ÔºåÂ∞±ÊòØ Free ÈìæË°®Ôºà<strong>Á©∫Èó≤ÈìæË°®</strong>Ôºâ</p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Á©∫Èó≤ÈìæË°®.png" style="zoom:50%;"><p>Âü∫ËäÇÁÇπÔºöÊòØ‰∏ÄÂùóÂçïÁã¨Áî≥ËØ∑ÁöÑÂÜÖÂ≠òÁ©∫Èó¥ÔºàÂç† 40 Â≠óËäÇÔºâÔºåÂπ∂‰∏çÂú® Buffer Pool ÁöÑÈÇ£‰∏ÄÂ§ßÁâáËøûÁª≠ÂÜÖÂ≠òÁ©∫Èó¥Èáå</p><p>Á£ÅÁõòÂä†ËΩΩÈ°µÁöÑÊµÅÁ®ãÔºö</p><ul><li>‰ªé Free ÈìæË°®‰∏≠ÂèñÂá∫‰∏Ä‰∏™Á©∫Èó≤ÁöÑÁºìÂÜ≤È°µ</li><li>ÊääÁºìÂÜ≤È°µÂØπÂ∫îÁöÑÊéßÂà∂ÂùóÁöÑ‰ø°ÊÅØÂ°´‰∏äÔºàÈ°µÊâÄÂú®ÁöÑË°®Á©∫Èó¥„ÄÅÈ°µÂè∑‰πãÁ±ªÁöÑ‰ø°ÊÅØÔºâ</li><li>ÊääÁºìÂÜ≤È°µÂØπÂ∫îÁöÑ Free ÈìæË°®ËäÇÁÇπÔºàÊéßÂà∂ÂùóÔºâ‰ªéÈìæË°®‰∏≠ÁßªÈô§ÔºåË°®Á§∫ËØ•ÁºìÂÜ≤È°µÂ∑≤ÁªèË¢´‰ΩøÁî®</li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://blog.csdn.net/li1325169021/article/details/121124440</p><hr><h5 id="flush-ÈìæË°®" tabindex="-1"><a class="header-anchor" href="#flush-ÈìæË°®"><span>Flush ÈìæË°®</span></a></h5><p>Flush ÈìæË°®ÊòØ‰∏Ä‰∏™Áî®Êù•<strong>Â≠òÂÇ®ËÑèÈ°µ</strong>ÁöÑÈìæË°®ÔºåÂØπ‰∫éÂ∑≤Áªè‰øÆÊîπËøáÁöÑÁºìÂÜ≤ËÑèÈ°µÔºåÁ¨¨‰∏ÄÊ¨°‰øÆÊîπÂêéÂä†ÂÖ•Âà∞<strong>ÈìæË°®Â§¥ÈÉ®</strong>Ôºå‰ª•ÂêéÊØèÊ¨°‰øÆÊîπÈÉΩ‰∏ç‰ºöÈáçÊñ∞Âä†ÂÖ•ÔºåÂè™‰øÆÊîπÈÉ®ÂàÜÊéßÂà∂‰ø°ÊÅØÔºåÂá∫‰∫éÊÄßËÉΩËÄÉËôëÂπ∂‰∏çÊòØÁõ¥Êé•Êõ¥Êñ∞Âà∞Á£ÅÁõòÔºåËÄåÊòØÂú®Êú™Êù•ÁöÑÊüê‰∏™Êó∂Èó¥ËøõË°åÂà∑ËÑè</p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ËÑèÈ°µÈìæË°®.png" style="zoom:50%;"><p><strong>ÂêéÂè∞Êúâ‰∏ìÈó®ÁöÑÁ∫øÁ®ãÊØèÈöî‰∏ÄÊÆµÊó∂Èó¥ÊääËÑèÈ°µÂà∑Êñ∞Âà∞Á£ÅÁõò</strong>Ôºö</p><ul><li>‰ªé Flush ÈìæË°®‰∏≠Âà∑Êñ∞‰∏ÄÈÉ®ÂàÜÈ°µÈù¢Âà∞Á£ÅÁõòÔºö <ul><li><strong>ÂêéÂè∞Á∫øÁ®ãÂÆöÊó∂</strong>‰ªé Flush ÈìæË°®Âà∑ËÑèÔºåÊ†πÊçÆÁ≥ªÁªüÁöÑÁπÅÂøôÁ®ãÂ∫¶Êù•ÂÜ≥ÂÆöÂà∑Êñ∞ÈÄüÁéáÔºåËøôÁßçÊñπÂºèÁß∞‰∏∫ BUF_FLUSH_LIST</li><li>Á∫øÁ®ãÂà∑ËÑèÁöÑÊØîËæÉÊÖ¢ÔºåÂØºËá¥Áî®Êà∑Á∫øÁ®ãÂä†ËΩΩ‰∏Ä‰∏™Êñ∞ÁöÑÊï∞ÊçÆÈ°µÊó∂ÂèëÁé∞Ê≤°ÊúâÁ©∫Èó≤ÁºìÂÜ≤È°µÔºåÊ≠§Êó∂‰ºöÂ∞ùËØï‰ªé LRU ÈìæË°®Â∞æÈÉ®ÂØªÊâæÁºìÂÜ≤È°µÁõ¥Êé•ÈáäÊîæÔºåÂ¶ÇÊûúËØ•È°µÈù¢ÊòØÂ∑≤Áªè‰øÆÊîπËøáÁöÑËÑèÈ°µÂ∞±<strong>ÂêåÊ≠•Âà∑Êñ∞</strong>Âà∞Á£ÅÁõòÔºåÈÄüÂ∫¶ËæÉÊÖ¢ÔºåËøôÁßçÊñπÂºèÁß∞‰∏∫ BUF_FLUSH_SINGLE_PAGE</li></ul></li><li>‰ªé LRU ÈìæË°®ÁöÑÂÜ∑Êï∞ÊçÆ‰∏≠Âà∑Êñ∞‰∏ÄÈÉ®ÂàÜÈ°µÈù¢Âà∞Á£ÅÁõòÔºåÂç≥ÔºöBUF_FLUSH_LRU <ul><li>ÂêéÂè∞Á∫øÁ®ã‰ºöÂÆöÊó∂‰ªé LRU ÈìæË°®ÁöÑÂ∞æÈÉ®ÂºÄÂßãÊâ´Êèè‰∏Ä‰∫õÈ°µÈù¢ÔºåÊâ´ÊèèÁöÑÈ°µÈù¢Êï∞ÈáèÂèØ‰ª•ÈÄöËøáÁ≥ªÁªüÂèòÈáè <code>innodb_lru_scan_depth</code> ÊåáÂÆöÔºåÂ¶ÇÊûúÂú® LRU ÈìæË°®‰∏≠ÂèëÁé∞ËÑèÈ°µÔºåÂàôÊääÂÆÉ‰ª¨Âà∑Êñ∞Âà∞Á£ÅÁõòÔºåËøôÁßçÊñπÂºèÁß∞‰∏∫ BUF_FLUSH_LRU</li><li>ÊéßÂà∂ÂùóÈáå‰ºöÂ≠òÂÇ®ËØ•ÁºìÂÜ≤È°µÊòØÂê¶Ë¢´‰øÆÊîπÁöÑ‰ø°ÊÅØÔºåÊâÄ‰ª•ÂèØ‰ª•ÂæàÂÆπÊòìÁöÑËé∑ÂèñÂà∞Êüê‰∏™ÁºìÂÜ≤È°µÊòØÂê¶ÊòØËÑèÈ°µ</li></ul></li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://blog.csdn.net/li1325169021/article/details/121125765</p><hr><h5 id="lru-ÈìæË°®" tabindex="-1"><a class="header-anchor" href="#lru-ÈìæË°®"><span>LRU ÈìæË°®</span></a></h5><p>Buffer Pool ÈúÄË¶Å‰øùËØÅÁºìÂ≠òÁöÑÂëΩ‰∏≠ÁéáÔºåÊâÄ‰ª• MySQL ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ LRU ÈìæË°®ÔºåÂΩìËÆøÈóÆÊüê‰∏™È°µÊó∂Ôºö</p><ul><li>Â¶ÇÊûúËØ•È°µ‰∏çÂú® Buffer Pool ‰∏≠ÔºåÊääËØ•È°µ‰ªéÁ£ÅÁõòÂä†ËΩΩËøõÊù•Âêé‰ºöÂ∞ÜËØ•ÁºìÂÜ≤È°µÂØπÂ∫îÁöÑÊéßÂà∂Âùó‰Ωú‰∏∫ËäÇÁÇπÊîæÂÖ• <strong>LRU ÈìæË°®ÁöÑÂ§¥ÈÉ®</strong>Ôºå‰øùËØÅÁÉ≠ÁÇπÊï∞ÊçÆÂú®ÈìæË°®Â§¥</li><li>Â¶ÇÊûúËØ•È°µÂú® Buffer Pool ‰∏≠ÔºåÂàôÁõ¥Êé•ÊääËØ•È°µÂØπÂ∫îÁöÑÊéßÂà∂ÂùóÁßªÂä®Âà∞ LRU ÈìæË°®ÁöÑÂ§¥ÈÉ®ÔºåÊâÄ‰ª• LRU ÈìæË°®Â∞æÈÉ®Â∞±ÊòØÊúÄËøëÊúÄÂ∞ë‰ΩøÁî®ÁöÑÁºìÂÜ≤È°µ</li></ul><p>MySQL Âü∫‰∫éÂ±ÄÈÉ®ÊÄßÂéüÁêÜÊèê‰æõ‰∫ÜÈ¢ÑËØªÂäüËÉΩÔºö</p><ul><li>Á∫øÊÄßÈ¢ÑËØªÔºöÁ≥ªÁªüÂèòÈáè <code>innodb_read_ahead_threshold</code>ÔºåÂ¶ÇÊûúÈ°∫Â∫èËÆøÈóÆÊüê‰∏™Âå∫ÔºàextentÔºö16 KB ÁöÑÈ°µÔºåËøûÁª≠ 64 ‰∏™ÂΩ¢Êàê‰∏Ä‰∏™Âå∫Ôºå‰∏Ä‰∏™Âå∫ÈªòËÆ§ 1MB Â§ßÂ∞èÔºâÁöÑÈ°µÈù¢Êï∞Ë∂ÖËøá‰∫ÜËØ•Á≥ªÁªüÂèòÈáèÂÄºÔºåÂ∞±‰ºöËß¶Âèë‰∏ÄÊ¨°<strong>ÂºÇÊ≠•ËØªÂèñ</strong>‰∏ã‰∏Ä‰∏™Âå∫‰∏≠ÂÖ®ÈÉ®ÁöÑÈ°µÈù¢Âà∞ Buffer Pool ‰∏≠</li><li>ÈöèÊú∫È¢ÑËØªÔºöÂ¶ÇÊûúÊüê‰∏™Âå∫ 13 ‰∏™ËøûÁª≠ÁöÑÈ°µÈù¢ÈÉΩË¢´Âä†ËΩΩÂà∞ Buffer PoolÔºåÊó†ËÆ∫Ëøô‰∫õÈ°µÈù¢ÊòØÂê¶ÊòØÈ°∫Â∫èËØªÂèñÔºåÈÉΩ‰ºöËß¶Âèë‰∏ÄÊ¨°<strong>ÂºÇÊ≠•ËØªÂèñ</strong>Êú¨Âå∫ÊâÄÊúâÁöÑÂÖ∂‰ªñÈ°µÈù¢Âà∞ Buffer Pool ‰∏≠</li></ul><p>È¢ÑËØª‰ºöÈÄ†ÊàêÂä†ËΩΩÂ§™Â§öÁî®‰∏çÂà∞ÁöÑÊï∞ÊçÆÈ°µÔºåÈÄ†ÊàêÈÇ£‰∫õ‰ΩøÁî®È¢ëÁéáÂæàÈ´òÁöÑÊï∞ÊçÆÈ°µË¢´Êå§Âà∞ LRU ÈìæË°®Â∞æÈÉ®ÔºåÊâÄ‰ª• InnoDB Â∞Ü LRU ÈìæË°®ÂàÜÊàê‰∏§ÊÆµÔºå<strong>ÂÜ∑ÁÉ≠Êï∞ÊçÆÈöîÁ¶ª</strong>Ôºö</p><ul><li>‰∏ÄÈÉ®ÂàÜÂ≠òÂÇ®‰ΩøÁî®È¢ëÁéáÂæàÈ´òÁöÑÊï∞ÊçÆÈ°µÔºåËøôÈÉ®ÂàÜÈìæË°®‰πüÂè´ÁÉ≠Êï∞ÊçÆÔºåyoung Âå∫ÔºåÈù†ËøëÈìæË°®Â§¥ÈÉ®ÁöÑÂå∫Âüü</li><li>‰∏ÄÈÉ®ÂàÜÂ≠òÂÇ®‰ΩøÁî®È¢ëÁéá‰∏çÈ´òÁöÑÂÜ∑Êï∞ÊçÆÔºåold Âå∫ÔºåÈù†ËøëÈìæË°®Â∞æÈÉ®ÔºåÈªòËÆ§Âç† 37%ÔºåÂèØ‰ª•ÈÄöËøáÁ≥ªÁªüÂèòÈáè <code>innodb_old_blocks_pct</code> ÊåáÂÆö</li></ul><p>ÂΩìÁ£ÅÁõò‰∏äÁöÑÊüêÊï∞ÊçÆÈ°µË¢´ÂàùÊ¨°Âä†ËΩΩÂà∞ Buffer Pool ‰∏≠‰ºöË¢´ÊîæÂÖ• old Âå∫ÔºåÊ∑òÊ±∞Êó∂‰ºòÂÖàÊ∑òÊ±∞ old Âå∫</p><ul><li>ÂΩìÂØπ old Âå∫ÁöÑÊï∞ÊçÆËøõË°åËÆøÈóÆÊó∂Ôºå‰ºöÂú®ÊéßÂà∂ÂùóËÆ∞ÂΩï‰∏ãËÆøÈóÆÊó∂Èó¥ÔºåÁ≠âÂæÖÂêéÁª≠ÁöÑËÆøÈóÆÊó∂Èó¥‰∏éÁ¨¨‰∏ÄÊ¨°ËÆøÈóÆÁöÑÊó∂Èó¥ÊòØÂê¶Âú®Êüê‰∏™Êó∂Èó¥Èó¥ÈöîÂÜÖÔºåÈÄöËøáÁ≥ªÁªüÂèòÈáè <code>innodb_old_blocks_time</code> ÊåáÂÆöÊó∂Èó¥Èó¥ÈöîÔºåÈªòËÆ§ 1000msÔºåÊàêÁ´ãÂ∞±<strong>ÁßªÂä®Âà∞ young Âå∫ÁöÑÈìæË°®Â§¥ÈÉ®</strong></li><li><code>innodb_old_blocks_time</code> ‰∏∫ 0 Êó∂ÔºåÊØèÊ¨°ËÆøÈóÆ‰∏Ä‰∏™È°µÈù¢ÈÉΩ‰ºöÊîæÂÖ• young Âå∫ÁöÑÂ§¥ÈÉ®</li></ul><hr><h4 id="ÂèÇÊï∞‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#ÂèÇÊï∞‰ºòÂåñ"><span>ÂèÇÊï∞‰ºòÂåñ</span></a></h4><p>InnoDB Áî®‰∏ÄÂùóÂÜÖÂ≠òÂå∫ÂÅö IO ÁºìÂ≠òÊ±†ÔºåËØ•ÁºìÂ≠òÊ±†‰∏ç‰ªÖÁî®Êù•ÁºìÂ≠ò InnoDB ÁöÑÁ¥¢ÂºïÂùóÔºå‰πüÁî®Êù•ÁºìÂ≠ò InnoDB ÁöÑÊï∞ÊçÆÂùóÔºåÂèØ‰ª•ÈÄöËøá‰∏ãÈù¢ÁöÑÊåá‰ª§Êü•Áúã Buffer Pool ÁöÑÁä∂ÊÄÅ‰ø°ÊÅØÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW ENGINE INNODB STATUS\G</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>Buffer pool hit rate</code> Â≠óÊÆµ‰ª£Ë°®<strong>ÂÜÖÂ≠òÂëΩ‰∏≠Áéá</strong>ÔºåË°®Á§∫ Buffer Pool ÂØπÊü•ËØ¢ÁöÑÂä†ÈÄüÊïàÊûú</p><p>Ê†∏ÂøÉÂèÇÊï∞Ôºö</p><ul><li><p><code>innodb_buffer_pool_size</code>ÔºöËØ•ÂèòÈáèÂÜ≥ÂÆö‰∫Ü Innodb Â≠òÂÇ®ÂºïÊìéË°®Êï∞ÊçÆÂíåÁ¥¢ÂºïÊï∞ÊçÆÁöÑÊúÄÂ§ßÁºìÂ≠òÂå∫Â§ßÂ∞èÔºåÈªòËÆ§ 128M</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW VARIABLES LIKE &#39;innodb_buffer_pool_size&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Âú®‰øùËØÅÊìç‰ΩúÁ≥ªÁªüÂèäÂÖ∂‰ªñÁ®ãÂ∫èÊúâË∂≥Â§üÂÜÖÂ≠òÂèØÁî®ÁöÑÊÉÖÂÜµ‰∏ãÔºå<code>innodb_buffer_pool_size</code> ÁöÑÂÄºË∂äÂ§ßÔºåÁºìÂ≠òÂëΩ‰∏≠ÁéáË∂äÈ´òÔºåÂª∫ËÆÆËÆæÁΩÆÊàêÂèØÁî®Áâ©ÁêÜÂÜÖÂ≠òÁöÑ 60%~80%</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">innodb_buffer_pool_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">512M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><code>innodb_log_buffer_size</code>ÔºöËØ•ÂÄºÂÜ≥ÂÆö‰∫Ü Innodb Êó•ÂøóÁºìÂÜ≤Âå∫ÁöÑÂ§ßÂ∞èÔºå‰øùÂ≠òË¶ÅÂÜôÂÖ•Á£ÅÁõò‰∏äÁöÑÊó•ÂøóÊñá‰ª∂Êï∞ÊçÆ</p><p>ÂØπ‰∫éÂèØËÉΩ‰∫ßÁîüÂ§ßÈáèÊõ¥Êñ∞ËÆ∞ÂΩïÁöÑÂ§ß‰∫ãÂä°ÔºåÂ¢ûÂä†ËØ•ÂÄºÁöÑÂ§ßÂ∞èÔºåÂèØ‰ª•ÈÅøÂÖç Innodb Âú®‰∫ãÂä°Êèê‰∫§ÂâçÂ∞±ÊâßË°å‰∏çÂøÖË¶ÅÁöÑÊó•ÂøóÂÜôÂÖ•Á£ÅÁõòÊìç‰ΩúÔºåÂΩ±ÂìçÊâßË°åÊïàÁéáÔºåÈÄöËøáÈÖçÁΩÆÊñá‰ª∂‰øÆÊîπÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">innodb_log_buffer_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">10M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>Âú®Â§öÁ∫øÁ®ã‰∏ãÔºåËÆøÈóÆ Buffer Pool ‰∏≠ÁöÑÂêÑÁßçÈìæË°®ÈÉΩÈúÄË¶ÅÂä†ÈîÅÔºåÊâÄ‰ª•Â∞Ü Buffer Pool ÊãÜÊàêËã•Âπ≤‰∏™Â∞èÂÆû‰æãÔºå<strong>ÊØè‰∏™Á∫øÁ®ãÂØπÂ∫î‰∏Ä‰∏™ÂÆû‰æã</strong>ÔºåÁã¨Á´ãÁÆ°ÁêÜÂÜÖÂ≠òÁ©∫Èó¥ÂíåÂêÑÁßçÈìæË°®ÔºàÁ±ª‰ºº ThreadLocalÔºâÔºåÂ§öÁ∫øÁ®ãËÆøÈóÆÂêÑËá™ÂÆû‰æã‰∫í‰∏çÂΩ±ÂìçÔºåÊèêÈ´ò‰∫ÜÂπ∂ÂèëËÉΩÂäõ</p><p>MySQL 5.7.5 ‰πãÂâç <code>innodb_buffer_pool_size</code> Âè™ÊîØÊåÅÂú®Á≥ªÁªüÂêØÂä®Êó∂‰øÆÊîπÔºåÁé∞Âú®Â∑≤ÁªèÊîØÊåÅËøêË°åÊó∂‰øÆÊîπ Buffer Pool ÁöÑÂ§ßÂ∞èÔºå‰ΩÜÊòØÊØèÊ¨°Ë∞ÉÊï¥ÂèÇÊï∞ÈÉΩ‰ºöÈáçÊñ∞ÂêëÊìç‰ΩúÁ≥ªÁªüÁî≥ËØ∑‰∏ÄÂùóËøûÁª≠ÁöÑÂÜÖÂ≠òÁ©∫Èó¥Ôºå<strong>Â∞ÜÊóßÁöÑÁºìÂÜ≤Ê±†ÁöÑÂÜÖÂÆπÊã∑Ë¥ùÂà∞Êñ∞Á©∫Èó¥</strong>ÈùûÂ∏∏ËÄóÊó∂ÔºåÊâÄ‰ª• MySQL ÂºÄÂßã‰ª•‰∏Ä‰∏™ chunk ‰∏∫Âçï‰ΩçÂêëÊìç‰ΩúÁ≥ªÁªüÁî≥ËØ∑ÂÜÖÂ≠òÔºåÊâÄ‰ª•‰∏Ä‰∏™ Buffer Pool ÂÆû‰æãÂèØ‰ª•Áî±Â§ö‰∏™ chunk ÁªÑÊàê</p><ul><li>Âú®Á≥ªÁªüÂêØÂä®Êó∂ËÆæÁΩÆÁ≥ªÁªüÂèòÈáè <code>innodb_buffer_pool_instance</code> ÂèØ‰ª•ÊåáÂÆö Buffer Pool ÂÆû‰æãÁöÑ‰∏™Êï∞Ôºå‰ΩÜÊòØÂΩì Buffer Pool Â∞è‰∫é 1GB Êó∂ÔºåËÆæÁΩÆÂ§ö‰∏™ÂÆû‰æãÊó∂Êó†ÊïàÁöÑ</li><li>ÊåáÂÆöÁ≥ªÁªüÂèòÈáè <code>innodb_buffer_pool_chunk_size</code> Êù•ÊîπÂèò chunk ÁöÑÂ§ßÂ∞èÔºåÂè™ËÉΩÂú®ÂêØÂä®Êó∂‰øÆÊîπÔºåËøêË°å‰∏≠‰∏çËÉΩ‰øÆÊîπÔºåËÄå‰∏îËØ•ÂèòÈáèÂπ∂‰∏çÂåÖÂê´ÁºìÂÜ≤È°µÁöÑÊéßÂà∂ÂùóÁöÑÂÜÖÂ≠òÂ§ßÂ∞è</li><li><code>innodb_buffer_pool_size</code> ÂøÖÈ°ªÊòØ <code>innodb_buffer_pool_chunk_size √ó innodb_buffer_pool_instance</code> ÁöÑÂÄçÊï∞ÔºåÈªòËÆ§ÂÄºÊòØ <code>128M √ó 16 = 2G</code>ÔºåBuffer Pool ÂøÖÈ°ªÊòØ 2G ÁöÑÊï¥Êï∞ÂÄçÔºåÂ¶ÇÊûúÊåáÂÆö 5GÔºå‰ºöËá™Âä®Ë∞ÉÊï¥Êàê 6G</li><li>Â¶ÇÊûúÂêØÂä®Êó∂ <code>chunk √ó instances</code> &gt; <code>pool_size</code>ÔºåÈÇ£‰πà chunk ÁöÑÂÄº‰ºöËá™Âä®ËÆæÁΩÆ‰∏∫ <code>pool_size √∑ instances</code></li></ul><hr><h3 id="ÂÜÖÂ≠ò‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#ÂÜÖÂ≠ò‰ºòÂåñ"><span>ÂÜÖÂ≠ò‰ºòÂåñ</span></a></h3><h4 id="change" tabindex="-1"><a class="header-anchor" href="#change"><span>Change</span></a></h4><p>InnoDB ÁÆ°ÁêÜÁöÑ Buffer Pool ‰∏≠Êúâ‰∏ÄÂùóÂÜÖÂ≠òÂè´ Change Buffer Áî®Êù•ÂØπ<strong>Â¢ûÂà†ÊîπÊìç‰Ωú</strong>Êèê‰æõÁºìÂ≠òÔºåÂèØ‰ª•ÈÄöËøáÂèÇÊï∞Êù•Âä®ÊÄÅËÆæÁΩÆÔºåËÆæÁΩÆ‰∏∫ 50 Êó∂Ë°®Á§∫ Change Buffer ÁöÑÂ§ßÂ∞èÊúÄÂ§öÂç†Áî® Buffer Pool ÁöÑ 50%</p><ul><li>ÂîØ‰∏ÄÁ¥¢ÂºïÁöÑÊõ¥Êñ∞‰∏çËÉΩ‰ΩøÁî® Change BufferÔºåÈúÄË¶ÅÂ∞ÜÊï∞ÊçÆÈ°µËØªÂÖ•ÂÜÖÂ≠òÔºåÂà§Êñ≠Ê≤°ÊúâÂÜ≤Á™ÅÂú®ÂÜôÂÖ•</li><li>ÊôÆÈÄöÁ¥¢ÂºïÂèØ‰ª•‰ΩøÁî® Change BufferÔºå<strong>Áõ¥Êé•ÂÜôÂÖ• Buffer Â∞±ÁªìÊùü</strong>Ôºå‰∏çÁî®Ê†°È™åÂîØ‰∏ÄÊÄß</li></ul><p>Change Buffer Âπ∂‰∏çÊòØÊï∞ÊçÆÈ°µÔºåÂè™ÊòØÂØπÊìç‰ΩúÁöÑÁºìÂ≠òÔºåÊâÄ‰ª•ÈúÄË¶ÅÂ∞Ü Change Buffer ‰∏≠ÁöÑÊìç‰ΩúÂ∫îÁî®Âà∞ÊóßÊï∞ÊçÆÈ°µÔºåÂæóÂà∞Êñ∞ÁöÑÊï∞ÊçÆÈ°µÔºàËÑèÈ°µÔºâÁöÑËøáÁ®ãÁß∞‰∏∫ Merge</p><ul><li>Ëß¶ÂèëÊó∂Êú∫ÔºöËÆøÈóÆÊï∞ÊçÆÈ°µÊó∂‰ºöËß¶Âèë Merge„ÄÅÂêéÂè∞ÊúâÂÆöÊó∂Á∫øÁ®ãËøõË°å Merge„ÄÅÂú®Êï∞ÊçÆÂ∫ìÊ≠£Â∏∏ÂÖ≥Èó≠ÔºàshutdownÔºâÁöÑËøáÁ®ã‰∏≠‰πü‰ºöËß¶Âèë</li><li>Â∑•‰ΩúÊµÅÁ®ãÔºöÈ¶ñÂÖà‰ªéÁ£ÅÁõòËØªÂÖ•Êï∞ÊçÆÈ°µÂà∞ÂÜÖÂ≠òÔºàÂõ†‰∏∫ Buffer Pool ‰∏≠‰∏ç‰∏ÄÂÆöÂ≠òÂú®ÂØπÂ∫îÁöÑÊï∞ÊçÆÈ°µÔºâÔºå‰ªé Change Buffer ‰∏≠ÊâæÂà∞ÂØπÂ∫îÁöÑÊìç‰ΩúÂ∫îÁî®Âà∞Êï∞ÊçÆÈ°µÔºåÂæóÂà∞Êñ∞ÁöÑÊï∞ÊçÆÈ°µÂç≥‰∏∫ËÑèÈ°µÔºåÁÑ∂ÂêéÂÜôÂÖ• redo logÔºåÁ≠âÂæÖÂà∑ËÑèÂç≥ÂèØ</li></ul><p>ËØ¥ÊòéÔºöChange Buffer ‰∏≠ÁöÑËÆ∞ÂΩïÔºåÂú®‰∫ãÂä°Êèê‰∫§Êó∂‰πü‰ºöÂÜôÂÖ• redo logÔºåÊâÄ‰ª•ÊòØÂèØ‰ª•‰øùËØÅ‰∏ç‰∏¢Â§±ÁöÑ</p><p>‰∏öÂä°Âú∫ÊôØÔºö</p><ul><li>ÂØπ‰∫é<strong>ÂÜôÂ§öËØªÂ∞ë</strong>ÁöÑ‰∏öÂä°Êù•ËØ¥ÔºåÈ°µÈù¢Âú®ÂÜôÂÆå‰ª•ÂêéÈ©¨‰∏äË¢´ËÆøÈóÆÂà∞ÁöÑÊ¶ÇÁéáÊØîËæÉÂ∞èÔºåÊ≠§Êó∂ Change Buffer ÁöÑ‰ΩøÁî®ÊïàÊûúÊúÄÂ•ΩÔºåÂ∏∏ËßÅÁöÑÂ∞±ÊòØË¥¶ÂçïÁ±ª„ÄÅÊó•ÂøóÁ±ªÁöÑÁ≥ªÁªü</li><li>‰∏Ä‰∏™‰∏öÂä°ÁöÑÊõ¥Êñ∞Ê®°ÂºèÊòØÂÜôÂÖ•ÂêéÈ©¨‰∏äÂÅöÊü•ËØ¢ÔºåÈÇ£‰πàÂç≥‰ΩøÊª°Ë∂≥‰∫ÜÊù°‰ª∂ÔºåÂ∞ÜÊõ¥Êñ∞ÂÖàËÆ∞ÂΩïÂú® Change BufferÔºå‰ΩÜ‰πãÂêéÁî±‰∫éÈ©¨‰∏äË¶ÅËÆøÈóÆËøô‰∏™Êï∞ÊçÆÈ°µÔºå‰ºöÁ´ãÂç≥Ëß¶Âèë Merge ËøáÁ®ãÔºåËøôÊ†∑ÈöèÊú∫ËÆøÈóÆ IO ÁöÑÊ¨°Êï∞‰∏ç‰ºöÂáèÂ∞ëÔºåÂπ∂‰∏îÂ¢ûÂä†‰∫Ü Change Buffer ÁöÑÁª¥Êä§‰ª£‰ª∑</li></ul><p>Ë°•ÂÖÖÔºöChange Buffer ÁöÑÂâçË∫´ÊòØ Insert BufferÔºåÂè™ËÉΩÂØπ Insert Êìç‰Ωú‰ºòÂåñÔºåÂêéÊù•Â¢ûÂä†‰∫Ü Update/Delete ÁöÑÊîØÊåÅÔºåÊîπ‰∏∫ Change Buffer</p><hr><h4 id="net" tabindex="-1"><a class="header-anchor" href="#net"><span>Net</span></a></h4><p>Server Â±ÇÈíàÂØπ‰ºòÂåñ<strong>Êü•ËØ¢</strong>ÁöÑÂÜÖÂ≠ò‰∏∫ Net BufferÔºåÂÜÖÂ≠òÁöÑÂ§ßÂ∞èÊòØÁî±ÂèÇÊï∞ <code>net_buffer_length</code>ÂÆö‰πâÔºåÈªòËÆ§ 16kÔºåÂÆûÁé∞ÊµÅÁ®ãÔºö</p><ul><li>Ëé∑Âèñ‰∏ÄË°åÊï∞ÊçÆÂÜôÂÖ• Net BufferÔºåÈáçÂ§çËé∑ÂèñÁõ¥Âà∞ Net Buffer ÂÜôÊª°ÔºåË∞ÉÁî®ÁΩëÁªúÊé•Âè£ÂèëÂá∫Âéª</li><li>Ëã•ÂèëÈÄÅÊàêÂäüÂ∞±Ê∏ÖÁ©∫ Net BufferÔºåÁÑ∂ÂêéÁªßÁª≠Âèñ‰∏ã‰∏ÄË°åÔºõËã•ÂèëÈÄÅÂáΩÊï∞ËøîÂõû EAGAIN Êàñ WSAEWOULDBLOCKÔºåË°®Á§∫Êú¨Âú∞ÁΩëÁªúÊ†à <code>socket send buffer</code> ÂÜôÊª°‰∫ÜÔºå<strong>ËøõÂÖ•Á≠âÂæÖ</strong>ÔºåÁõ¥Âà∞ÁΩëÁªúÊ†àÈáçÊñ∞ÂèØÂÜôÂÜçÁªßÁª≠ÂèëÈÄÅ</li></ul><p>MySQL ÈááÁî®ÁöÑÊòØËæπËØªËæπÂèëÁöÑÈÄªËæëÔºåÂõ†Ê≠§ÂØπ‰∫éÊï∞ÊçÆÈáèÂæàÂ§ßÁöÑÊü•ËØ¢Êù•ËØ¥Ôºå‰∏ç‰ºöÂú® Server Á´Ø‰øùÂ≠òÂÆåÊï¥ÁöÑÁªìÊûúÈõÜÔºåÂ¶ÇÊûúÂÆ¢Êà∑Á´ØËØªÁªìÊûú‰∏çÂèäÊó∂Ôºå‰ºöÂ†µ‰Ωè MySQL ÁöÑÊü•ËØ¢ËøáÁ®ãÔºå‰ΩÜÊòØ<strong>‰∏ç‰ºöÊääÂÜÖÂ≠òÊâìÁàÜÂØºËá¥ OOM</strong></p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Êü•ËØ¢ÂÜÖÂ≠ò‰ºòÂåñ.png" style="zoom:50%;"><p>SHOW PROCESSLIST Ëé∑ÂèñÁ∫øÁ®ã‰ø°ÊÅØÂêéÔºåÂ§Ñ‰∫é Sending to client Áä∂ÊÄÅ‰ª£Ë°®ÊúçÂä°Âô®Á´ØÁöÑÁΩëÁªúÊ†àÂÜôÊª°ÔºåÁ≠âÂæÖÂÆ¢Êà∑Á´ØÊé•Êî∂Êï∞ÊçÆ</p><p>ÂÅáËÆæÊúâ‰∏Ä‰∏™‰∏öÂä°ÁöÑÈÄªËæëÊØîËæÉÂ§çÊùÇÔºåÊØèËØª‰∏ÄË°åÊï∞ÊçÆ‰ª•ÂêéË¶ÅÂ§ÑÁêÜÂæà‰πÖÁöÑÈÄªËæëÔºåÂ∞±‰ºöÂØºËá¥ÂÆ¢Êà∑Á´ØË¶ÅËøáÂæà‰πÖÊâç‰ºöÂéªÂèñ‰∏ã‰∏ÄË°åÊï∞ÊçÆÔºåÂØºËá¥ MySQL ÁöÑÈòªÂ°ûÔºå‰∏ÄÁõ¥Â§Ñ‰∫é Sending to client ÁöÑÁä∂ÊÄÅ</p><p>Ëß£ÂÜ≥ÊñπÊ≥ïÔºöÂ¶ÇÊûú‰∏Ä‰∏™Êü•ËØ¢ÁöÑËøîÂõûÁªìÊûúÂæàÊòØÂæàÂ§öÔºåÂª∫ËÆÆ‰ΩøÁî® mysql_store_result Ëøô‰∏™Êé•Âè£ÔºåÁõ¥Êé•ÊääÊü•ËØ¢ÁªìÊûú‰øùÂ≠òÂà∞Êú¨Âú∞ÂÜÖÂ≠ò</p><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://blog.csdn.net/qq_33589510/article/details/117673449</p><hr><h4 id="read" tabindex="-1"><a class="header-anchor" href="#read"><span>Read</span></a></h4><p>read_rnd_buffer ÊòØ MySQL ÁöÑÈöèÊú∫ËØªÁºìÂÜ≤Âå∫ÔºåÂΩìÊåâ‰ªªÊÑèÈ°∫Â∫èËØªÂèñËÆ∞ÂΩïË°åÊó∂Â∞ÜÂàÜÈÖç‰∏Ä‰∏™ÈöèÊú∫ËØªÂèñÁºìÂÜ≤Âå∫ÔºåËøõË°åÊéíÂ∫èÊü•ËØ¢Êó∂ÔºåMySQL ‰ºöÈ¶ñÂÖàÊâ´Êèè‰∏ÄÈÅçËØ•ÁºìÂÜ≤Ôºå‰ª•ÈÅøÂÖçÁ£ÅÁõòÊêúÁ¥¢ÔºåÊèêÈ´òÊü•ËØ¢ÈÄüÂ∫¶ÔºåÂ§ßÂ∞èÊòØÁî± read_rnd_buffer_size ÂèÇÊï∞ÊéßÂà∂ÁöÑ</p><p>Multi-Range Read ‰ºòÂåñÔºå<strong>Â∞ÜÈöèÊú∫ IO ËΩ¨Âåñ‰∏∫È°∫Â∫è IO</strong> ‰ª•Èôç‰ΩéÊü•ËØ¢ËøáÁ®ã‰∏≠ IO ÂºÄÈîÄÔºåÂõ†‰∏∫Â§ßÂ§öÊï∞ÁöÑÊï∞ÊçÆÈÉΩÊòØÊåâÁÖß‰∏ªÈîÆÈÄíÂ¢ûÈ°∫Â∫èÊèíÂÖ•ÂæóÂà∞ÔºåÊâÄ‰ª•ÊåâÁÖß‰∏ªÈîÆÁöÑÈÄíÂ¢ûÈ°∫Â∫èÊü•ËØ¢ÁöÑËØùÔºåÂØπÁ£ÅÁõòÁöÑËØªÊØîËæÉÊé•ËøëÈ°∫Â∫èËØªÔºåËÉΩÂ§üÊèêÂçáËØªÊÄßËÉΩ</p><p>‰∫åÁ∫ßÁ¥¢Âºï‰∏∫ aÔºåËÅöÁ∞áÁ¥¢Âºï‰∏∫ idÔºå‰ºòÂåñÂõûË°®ÊµÅÁ®ãÔºö</p><ul><li>Ê†πÊçÆÁ¥¢Âºï aÔºåÂÆö‰ΩçÂà∞Êª°Ë∂≥Êù°‰ª∂ÁöÑËÆ∞ÂΩïÔºåÂ∞Ü id ÂÄºÊîæÂÖ• read_rnd_buffer ‰∏≠</li><li>Â∞Ü read_rnd_buffer ‰∏≠ÁöÑ id ËøõË°å<strong>ÈÄíÂ¢ûÊéíÂ∫è</strong></li><li>ÊéíÂ∫èÂêéÁöÑ id Êï∞ÁªÑÔºå‰æùÊ¨°ÂõûË°®Âà∞‰∏ªÈîÆ id Á¥¢Âºï‰∏≠Êü•ËÆ∞ÂΩïÔºåÂπ∂‰Ωú‰∏∫ÁªìÊûúËøîÂõû</li></ul><p>ËØ¥ÊòéÔºöÂ¶ÇÊûúÊ≠•È™§ 1 ‰∏≠ read_rnd_buffer ÊîæÊª°‰∫ÜÔºåÂ∞±‰ºöÂÖàÊâßË°åÊ≠•È™§ 2 Âíå 3ÔºåÁÑ∂ÂêéÊ∏ÖÁ©∫ read_rnd_bufferÔºå‰πãÂêéÁªßÁª≠ÊâæÁ¥¢Âºï a ÁöÑ‰∏ã‰∏™ËÆ∞ÂΩï</p><p>‰ΩøÁî® MRR ‰ºòÂåñÈúÄË¶ÅËÆæËøõË°åËÆæÁΩÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET optimizer_switch=&#39;mrr_cost_based=off&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h4 id="key-1" tabindex="-1"><a class="header-anchor" href="#key-1"><span>Key</span></a></h4><p>MyISAM Â≠òÂÇ®ÂºïÊìé‰ΩøÁî® key_buffer ÁºìÂ≠òÁ¥¢ÂºïÂùóÔºåÂä†ÈÄü MyISAM Á¥¢ÂºïÁöÑËØªÂÜôÈÄüÂ∫¶„ÄÇÂØπ‰∫é MyISAM Ë°®ÁöÑÊï∞ÊçÆÂùóÊ≤°ÊúâÁâπÂà´ÁöÑÁºìÂ≠òÊú∫Âà∂ÔºåÂÆåÂÖ®‰æùËµñ‰∫éÊìç‰ΩúÁ≥ªÁªüÁöÑ IO ÁºìÂ≠ò</p><ul><li><p>key_buffer_sizeÔºöËØ•ÂèòÈáèÂÜ≥ÂÆö MyISAM Á¥¢ÂºïÂùóÁºìÂ≠òÂå∫ÁöÑÂ§ßÂ∞èÔºåÁõ¥Êé•ÂΩ±ÂìçÂà∞ MyISAM Ë°®ÁöÑÂ≠òÂèñÊïàÁéá</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW VARIABLES LIKE &#39;key_buffer_size&#39;;	-- Âçï‰ΩçÊòØÂ≠óËäÇ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Âú® MySQL ÈÖçÁΩÆÊñá‰ª∂‰∏≠ËÆæÁΩÆËØ•ÂÄºÔºåÂª∫ËÆÆËá≥Â∞ëÂ∞Ü1/4ÂèØÁî®ÂÜÖÂ≠òÂàÜÈÖçÁªô key_buffer_sizeÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/mysql/my.cnf</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">key_buffer_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1024M</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>read_buffer_sizeÔºöÂ¶ÇÊûúÈúÄË¶ÅÁªèÂ∏∏È°∫Â∫èÊâ´Êèè MyISAM Ë°®ÔºåÂèØ‰ª•ÈÄöËøáÂ¢ûÂ§ß read_buffer_size ÁöÑÂÄºÊù•ÊîπÂñÑÊÄßËÉΩ„ÄÇ‰ΩÜ read_buffer_size ÊòØÊØè‰∏™ Session Áã¨Âç†ÁöÑÔºåÂ¶ÇÊûúÈªòËÆ§ÂÄºËÆæÁΩÆÂ§™Â§ßÔºåÂπ∂ÂèëÁéØÂ¢ÉÂ∞±‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊµ™Ë¥π</p></li><li><p>read_rnd_buffer_sizeÔºöÂØπ‰∫éÈúÄË¶ÅÂÅöÊéíÂ∫èÁöÑ MyISAM Ë°®ÁöÑÊü•ËØ¢ÔºåÂ¶ÇÂ∏¶Êúâ ORDER BY Â≠êÂè•ÁöÑËØ≠Âè•ÔºåÈÄÇÂΩìÂ¢ûÂä†ËØ•ÁöÑÂÄºÔºåÂèØ‰ª•ÊîπÂñÑÊ≠§Á±ªÁöÑ SQL ÁöÑÊÄßËÉΩÔºå‰ΩÜÊòØ read_rnd_buffer_size ÊòØÊØè‰∏™ Session Áã¨Âç†ÁöÑÔºåÂ¶ÇÊûúÈªòËÆ§ÂÄºËÆæÁΩÆÂ§™Â§ßÔºåÂ∞±‰ºöÈÄ†ÊàêÂÜÖÂ≠òÊµ™Ë¥π</p></li></ul><hr><h3 id="Â≠òÂÇ®‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#Â≠òÂÇ®‰ºòÂåñ"><span>Â≠òÂÇ®‰ºòÂåñ</span></a></h3><h4 id="Êï∞ÊçÆÂ≠òÂÇ®" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÂ≠òÂÇ®"><span>Êï∞ÊçÆÂ≠òÂÇ®</span></a></h4><p>Á≥ªÁªüË°®Á©∫Èó¥ÊòØÁî®Êù•ÊîæÁ≥ªÁªü‰ø°ÊÅØÁöÑÔºåÊØîÂ¶ÇÊï∞ÊçÆÂ≠óÂÖ∏‰ªÄ‰πàÁöÑÔºåÂØπÂ∫îÁöÑÁ£ÅÁõòÊñá‰ª∂ÊòØ ibdataÔºåÊï∞ÊçÆË°®Á©∫Èó¥ÊòØ‰∏Ä‰∏™‰∏™ÁöÑË°®Êï∞ÊçÆÊñá‰ª∂ÔºåÂØπÂ∫îÁöÑÁ£ÅÁõòÊñá‰ª∂Â∞±ÊòØË°®Âêç.ibd</p><p>Ë°®Êï∞ÊçÆÊó¢ÂèØ‰ª•Â≠òÂú®ÂÖ±‰∫´Ë°®Á©∫Èó¥ÈáåÔºå‰πüÂèØ‰ª•ÊòØÂçïÁã¨ÁöÑÊñá‰ª∂ÔºåËøô‰∏™Ë°å‰∏∫ÊòØÁî±ÂèÇÊï∞ innodb_file_per_table ÊéßÂà∂ÁöÑÔºö</p><ul><li>OFFÔºöË°®Á§∫Ë°®ÁöÑÊï∞ÊçÆÊîæÂú®Á≥ªÁªüÂÖ±‰∫´Ë°®Á©∫Èó¥Ôºå‰πüÂ∞±ÊòØË∑üÊï∞ÊçÆÂ≠óÂÖ∏ÊîæÂú®‰∏ÄËµ∑</li><li>ON ÔºöË°®Á§∫ÊØè‰∏™ InnoDB Ë°®Êï∞ÊçÆÂ≠òÂÇ®Âú®‰∏Ä‰∏™‰ª• .ibd ‰∏∫ÂêéÁºÄÁöÑÊñá‰ª∂‰∏≠ÔºàÈªòËÆ§Ôºâ</li></ul><p>‰∏Ä‰∏™Ë°®ÂçïÁã¨Â≠òÂÇ®‰∏∫‰∏Ä‰∏™Êñá‰ª∂Êõ¥ÂÆπÊòìÁÆ°ÁêÜÔºåÂú®‰∏çÈúÄË¶ÅËøô‰∏™Ë°®Êó∂ÈÄöËøá drop table ÂëΩ‰ª§ÔºåÁ≥ªÁªüÂ∞±‰ºöÁõ¥Êé•Âà†Èô§Ëøô‰∏™Êñá‰ª∂ÔºõÂ¶ÇÊûúÊòØÊîæÂú®ÂÖ±‰∫´Ë°®Á©∫Èó¥‰∏≠ÔºåÂç≥‰ΩøË°®Âà†Êéâ‰∫ÜÔºåÁ©∫Èó¥‰πüÊòØ‰∏ç‰ºöÂõûÊî∂ÁöÑ</p><hr><h4 id="Êï∞ÊçÆÂà†Èô§" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÂà†Èô§"><span>Êï∞ÊçÆÂà†Èô§</span></a></h4><p>MySQL ÁöÑÊï∞ÊçÆÂà†Èô§Â∞±ÊòØÁßªÈô§ÊéâÊüê‰∏™ËÆ∞ÂΩïÂêéÔºåËØ•‰ΩçÁΩÆÂ∞±Ë¢´Ê†áËÆ∞‰∏∫<strong>ÂèØÂ§çÁî®</strong>ÔºåÂ¶ÇÊûúÊúâÁ¨¶ÂêàËåÉÂõ¥Êù°‰ª∂ÁöÑÊï∞ÊçÆÂèØ‰ª•ÊèíÂÖ•Âà∞ËøôÈáå„ÄÇÁ¨¶ÂêàËåÉÂõ¥Êù°‰ª∂ÁöÑÊÑèÊÄùÊòØÂÅáËÆæÂà†Èô§ËÆ∞ÂΩï R4Ôºå‰πãÂêéË¶ÅÂÜçÊèíÂÖ•‰∏Ä‰∏™ ID Âú® 300 Âíå 600 ‰πãÈó¥ÁöÑËÆ∞ÂΩïÊó∂ÔºåÂ∞±‰ºöÂ§çÁî®Ëøô‰∏™‰ΩçÁΩÆ</p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Âà†Èô§Êï∞ÊçÆ.png" style="zoom:50%;"><p>InnoDB ÁöÑÊï∞ÊçÆÊòØÊåâÈ°µÂ≠òÂÇ®ÁöÑÂ¶ÇÊûúÂà†Êéâ‰∫Ü‰∏Ä‰∏™Êï∞ÊçÆÈ°µ‰∏äÁöÑÊâÄÊúâËÆ∞ÂΩïÔºåÊï¥‰∏™Êï∞ÊçÆÈ°µÂ∞±ÂèØ‰ª•Ë¢´Â§çÁî®‰∫ÜÔºåÂ¶ÇÊûúÁõ∏ÈÇªÁöÑ‰∏§‰∏™Êï∞ÊçÆÈ°µÂà©Áî®ÁéáÈÉΩÂæàÂ∞èÔºåÁ≥ªÁªüÂ∞±‰ºöÊääËøô‰∏§‰∏™È°µ‰∏äÁöÑÊï∞ÊçÆÂêàÂà∞ÂÖ∂‰∏≠‰∏Ä‰∏™È°µ‰∏äÔºåÂè¶Â§ñ‰∏Ä‰∏™Êï∞ÊçÆÈ°µÂ∞±Ë¢´Ê†áËÆ∞‰∏∫ÂèØÂ§çÁî®</p><p>Âà†Èô§ÂëΩ‰ª§ÂÖ∂ÂÆûÂè™ÊòØÊääËÆ∞ÂΩïÁöÑ‰ΩçÁΩÆÔºåÊàñËÄÖ<strong>Êï∞ÊçÆÈ°µÊ†áËÆ∞‰∏∫‰∫ÜÂèØÂ§çÁî®Ôºå‰ΩÜÁ£ÅÁõòÊñá‰ª∂ÁöÑÂ§ßÂ∞èÊòØ‰∏ç‰ºöÂèòÁöÑ</strong>ÔºåËøô‰∫õÂèØ‰ª•Â§çÁî®ËøòÊ≤°ÊúâË¢´‰ΩøÁî®ÁöÑÁ©∫Èó¥ÔºåÁúãËµ∑Êù•Â∞±ÂÉèÊòØÁ©∫Ê¥ûÔºåÈÄ†ÊàêÊï∞ÊçÆÂ∫ìÁöÑÁ®ÄÁñèÔºåÂõ†Ê≠§ÈúÄË¶ÅËøõË°åÁ¥ßÂáëÂ§ÑÁêÜ</p><hr><h4 id="ÈáçÂª∫Êï∞ÊçÆ" tabindex="-1"><a class="header-anchor" href="#ÈáçÂª∫Êï∞ÊçÆ"><span>ÈáçÂª∫Êï∞ÊçÆ</span></a></h4><p>ÈáçÂª∫Ë°®Â∞±ÊòØÊåâÁÖß‰∏ªÈîÆ ID ÈÄíÂ¢ûÁöÑÈ°∫Â∫èÔºåÊääÊï∞ÊçÆ‰∏ÄË°å‰∏ÄË°åÂú∞‰ªéÊóßË°®‰∏≠ËØªÂá∫Êù•ÂÜçÊèíÂÖ•Âà∞Êñ∞Ë°®‰∏≠ÔºåËÆ©Êï∞ÊçÆÊõ¥Âä†Á¥ßÂáë„ÄÇÈáçÂª∫Ë°®Êó∂ MySQL ‰ºöËá™Âä®ÂÆåÊàêËΩ¨Â≠òÊï∞ÊçÆ„ÄÅ‰∫§Êç¢Ë°®Âêç„ÄÅÂà†Èô§ÊóßË°®ÁöÑÊìç‰ΩúÔºåÁ∫ø‰∏äÊìç‰Ωú‰ºöÈòªÂ°ûÂ§ßÈáèÁöÑÁ∫øÁ®ãÂ¢ûÂà†ÊîπÊü•ÁöÑÊìç‰Ωú</p><p>ÈáçÂª∫ÂëΩ‰ª§Ôºö</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> A ENGINE</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">InnoDB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Â∑•‰ΩúÊµÅÁ®ãÔºöÊñ∞Âª∫‰∏¥Êó∂Ë°® tmp_table BÔºàÂú® Server Â±ÇÂàõÂª∫ÁöÑÔºâÔºåÊääË°® A ‰∏≠ÁöÑÊï∞ÊçÆÂØºÂÖ•Âà∞Ë°® B ‰∏≠ÔºåÊìç‰ΩúÂÆåÊàêÂêéÁî®Ë°® B ÊõøÊç¢Ë°® AÔºåÂÆåÊàêÈáçÂª∫</p><p>ÈáçÂª∫Ë°®ÁöÑÊ≠•È™§ÈúÄË¶Å DDL ‰∏çÊòØ Online ÁöÑÔºåÂõ†‰∏∫Âú®ÂØºÂÖ•Êï∞ÊçÆÁöÑËøáÁ®ãÊúâÊñ∞ÁöÑÊï∞ÊçÆË¶ÅÂÜôÂÖ•Âà∞Ë°® A ÁöÑËØùÔºåÂ∞±‰ºöÈÄ†ÊàêÊï∞ÊçÆ‰∏¢Â§±</p><p>MySQL 5.6 ÁâàÊú¨ÂºÄÂßãÂºïÂÖ•ÁöÑ <strong>Online DDL</strong>ÔºåÈáçÂª∫Ë°®ÁöÑÂëΩ‰ª§ÈªòËÆ§ÊâßË°åÊ≠§Ê≠•È™§Ôºö</p><ul><li>Âª∫Á´ã‰∏Ä‰∏™‰∏¥Êó∂Êñá‰ª∂ tmp_fileÔºàInnoDB ÂàõÂª∫ÔºâÔºåÊâ´ÊèèË°® A ‰∏ªÈîÆÁöÑÊâÄÊúâÊï∞ÊçÆÈ°µ</li><li>Áî®Êï∞ÊçÆÈ°µ‰∏≠Ë°® A ÁöÑËÆ∞ÂΩïÁîüÊàê B+ Ê†ëÔºåÂ≠òÂÇ®Âà∞‰∏¥Êó∂Êñá‰ª∂‰∏≠</li><li>ÁîüÊàê‰∏¥Êó∂Êñá‰ª∂ÁöÑËøáÁ®ã‰∏≠ÔºåÂ∞ÜÊâÄÊúâÂØπ A ÁöÑÊìç‰ΩúËÆ∞ÂΩïÂú®‰∏Ä‰∏™Êó•ÂøóÊñá‰ª∂Ôºàrow logÔºâ‰∏≠ÔºåÂØπÂ∫îÁöÑÊòØÂõæ‰∏≠ state2 ÁöÑÁä∂ÊÄÅ</li><li>‰∏¥Êó∂Êñá‰ª∂ÁîüÊàêÂêéÔºåÂ∞ÜÊó•ÂøóÊñá‰ª∂‰∏≠ÁöÑÊìç‰ΩúÂ∫îÁî®Âà∞‰∏¥Êó∂Êñá‰ª∂ÔºåÂæóÂà∞‰∏Ä‰∏™ÈÄªËæëÊï∞ÊçÆ‰∏ä‰∏éË°® A Áõ∏ÂêåÁöÑÊï∞ÊçÆÊñá‰ª∂ÔºåÂØπÂ∫îÁöÑÂ∞±ÊòØÂõæ‰∏≠ state3</li><li>Áî®‰∏¥Êó∂Êñá‰ª∂ÊõøÊç¢Ë°® A ÁöÑÊï∞ÊçÆÊñá‰ª∂</li></ul><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ÈáçÂª∫Ë°®.png" style="zoom:67%;"><p>Online DDL Êìç‰Ωú‰ºöÂÖàËé∑Âèñ MDL ÂÜôÈîÅÔºåÂÜçÈÄÄÂåñÊàê MDL ËØªÈîÅ„ÄÇ‰ΩÜ MDL ÂÜôÈîÅÊåÅÊúâÊó∂Èó¥ÊØîËæÉÁü≠ÔºåÊâÄ‰ª•ÂèØ‰ª•Áß∞‰∏∫ OnlineÔºõ ËÄå MDL ËØªÈîÅÔºå‰∏çÈòªÊ≠¢Êï∞ÊçÆÂ¢ûÂà†Êü•ÊîπÔºå‰ΩÜ‰ºöÈòªÊ≠¢ÂÖ∂ÂÆÉÁ∫øÁ®ã‰øÆÊîπË°®ÁªìÊûÑÔºàÂèØ‰ª•ÂØπÊØî <code>ANALYZE TABLE t</code> ÂëΩ‰ª§Ôºâ</p><p>ÈóÆÈ¢òÔºöÈáçÂª∫Ë°®ÂèØ‰ª•Êî∂Áº©Ë°®Á©∫Èó¥Ôºå‰ΩÜÊòØÊâßË°åÊåá‰ª§ÂêéÊï¥‰ΩìÂç†Áî®Á©∫Èó¥Â¢ûÂ§ß</p><p>ÂéüÂõ†ÔºöÂú®ÈáçÂª∫Ë°®Âêé InnoDB ‰∏ç‰ºöÊääÊï¥Âº†Ë°®Âç†Êª°ÔºåÊØè‰∏™È°µÁïô‰∫Ü 1/16 ÁªôÂêéÁª≠ÁöÑÊõ¥Êñ∞‰ΩøÁî®„ÄÇË°®Âú®Êú™Êï¥ÁêÜ‰πãÂâçÈ°µÂ∑≤ÁªèÂç†Áî® 15/16 ‰ª•‰∏äÔºåÊî∂Áº©‰πãÂêéÈúÄË¶Å‰øùÊåÅÊï∞ÊçÆÂç†Áî®Á©∫Èó¥Âú® 15/16ÔºåÊâÄ‰ª•Êñá‰ª∂Âç†Áî®Á©∫Èó¥Êõ¥Â§ßÊâçËÉΩ‰øùÊåÅ</p><p>Ê≥®ÊÑèÔºö‰∏¥Êó∂Êñá‰ª∂‰πüË¶ÅÂç†Áî®Á©∫Èó¥ÔºåÂ¶ÇÊûúÁ©∫Èó¥‰∏çË∂≥‰ºöÈáçÂª∫Â§±Ë¥•</p><hr><h4 id="ÂéüÂú∞ÁΩÆÊç¢" tabindex="-1"><a class="header-anchor" href="#ÂéüÂú∞ÁΩÆÊç¢"><span>ÂéüÂú∞ÁΩÆÊç¢</span></a></h4><p>DDL ‰∏≠ÁöÑ‰∏¥Êó∂Ë°® tmp_table ÊòØÂú® Server Â±ÇÂàõÂª∫ÁöÑÔºåOnline DDL ‰∏≠ÁöÑ‰∏¥Êó∂Êñá‰ª∂ tmp_file ÊòØ InnoDB Âú®ÂÜÖÈÉ®ÂàõÂª∫Âá∫Êù•ÁöÑÔºåÊï¥‰∏™ DDL ËøáÁ®ãÈÉΩÂú® InnoDB ÂÜÖÈÉ®ÂÆåÊàêÔºåÂØπ‰∫é Server Â±ÇÊù•ËØ¥ÔºåÊ≤°ÊúâÊääÊï∞ÊçÆÊå™Âä®Âà∞‰∏¥Êó∂Ë°®ÔºåÊòØ‰∏Ä‰∏™ÂéüÂú∞Êìç‰ΩúÔºåËøôÂ∞±ÊòØ inplace</p><p>‰∏§ËÄÖÁöÑÂÖ≥Á≥ªÔºö</p><ul><li>DDL ËøáÁ®ãÂ¶ÇÊûúÊòØ Online ÁöÑÔºåÂ∞±‰∏ÄÂÆöÊòØ inplace ÁöÑ</li><li>inplace ÁöÑ DDLÔºåÊúâÂèØËÉΩ‰∏çÊòØ Online ÁöÑÔºåÊà™Ê≠¢Âà∞ MySQL 8.0ÔºåÂÖ®ÊñáÁ¥¢ÂºïÔºàFULLTEXTÔºâÂíåÁ©∫Èó¥Á¥¢ÂºïÔºàSPATIALÔºâÂ±û‰∫éËøôÁßçÊÉÖÂÜµ</li></ul><hr><h3 id="Âπ∂Âèë‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#Âπ∂Âèë‰ºòÂåñ"><span>Âπ∂Âèë‰ºòÂåñ</span></a></h3><p>MySQL Server ÊòØÂ§öÁ∫øÁ®ãÁªìÊûÑÔºåÂåÖÊã¨ÂêéÂè∞Á∫øÁ®ãÂíåÂÆ¢Êà∑ÊúçÂä°Á∫øÁ®ã„ÄÇÂ§öÁ∫øÁ®ãÂèØ‰ª•ÊúâÊïàÂà©Áî®ÊúçÂä°Âô®ËµÑÊ∫êÔºåÊèêÈ´òÊï∞ÊçÆÂ∫ìÁöÑÂπ∂ÂèëÊÄßËÉΩ„ÄÇÂú® MySQL ‰∏≠ÔºåÊéßÂà∂Âπ∂ÂèëËøûÊé•ÂíåÁ∫øÁ®ãÁöÑ‰∏ªË¶ÅÂèÇÊï∞Ôºö</p><ul><li><p>max_connectionsÔºöÊéßÂà∂ÂÖÅËÆ∏ËøûÊé•Âà∞ MySQL Êï∞ÊçÆÂ∫ìÁöÑÊúÄÂ§ßËøûÊé•Êï∞ÔºåÈªòËÆ§ÂÄºÊòØ 151</p><p>Â¶ÇÊûúÁä∂ÊÄÅÂèòÈáè connection_errors_max_connections ‰∏ç‰∏∫Èõ∂ÔºåÂπ∂‰∏î‰∏ÄÁõ¥Â¢ûÈïøÔºåÂàôËØ¥Êòé‰∏çÊñ≠ÊúâËøûÊé•ËØ∑Ê±ÇÂõ†Êï∞ÊçÆÂ∫ìËøûÊé•Êï∞Â∑≤ËææÂà∞ÂÖÅËÆ∏ÊúÄÂ§ßÂÄºËÄåÂ§±Ë¥•ÔºåËøôÊó∂ÂèØ‰ª•ËÄÉËôëÂ¢ûÂ§ß max_connections ÁöÑÂÄº</p><p>MySQL ÊúÄÂ§ßÂèØÊîØÊåÅÁöÑËøûÊé•Êï∞ÂèñÂÜ≥‰∫éÂæàÂ§öÂõ†Á¥†ÔºåÂåÖÊã¨Êìç‰ΩúÁ≥ªÁªüÂπ≥Âè∞ÁöÑÁ∫øÁ®ãÂ∫ìÁöÑË¥®Èáè„ÄÅÂÜÖÂ≠òÂ§ßÂ∞è„ÄÅÊØè‰∏™ËøûÊé•ÁöÑË¥üËç∑„ÄÅCPUÁöÑÂ§ÑÁêÜÈÄüÂ∫¶„ÄÅÊúüÊúõÁöÑÂìçÂ∫îÊó∂Èó¥Á≠â„ÄÇÂú® Linux Âπ≥Âè∞‰∏ãÔºåÊÄßËÉΩÂ•ΩÁöÑÊúçÂä°Âô®ÔºåÂèØ‰ª•ÊîØÊåÅ 500-1000 ‰∏™ËøûÊé•ÔºåÈúÄË¶ÅÊ†πÊçÆÊúçÂä°Âô®ÊÄßËÉΩËøõË°åËØÑ‰º∞ËÆæÂÆö</p></li><li><p>innodb_thread_concurrencyÔºöÂπ∂ÂèëÁ∫øÁ®ãÊï∞Ôºå‰ª£Ë°®Á≥ªÁªüÂÜÖÂêåÊó∂ËøêË°åÁöÑÁ∫øÁ®ãÊï∞ÈáèÔºàÂ∑≤ÁªèË¢´ÁßªÈô§Ôºâ</p></li><li><p>back_logÔºöÊéßÂà∂ MySQL ÁõëÂê¨ TCP Á´ØÂè£Êó∂ÁöÑÁßØÂéãËØ∑Ê±ÇÊ†àÁöÑÂ§ßÂ∞è</p><p>Â¶ÇÊûú Mysql ÁöÑËøûÊé•Êï∞ËææÂà∞ max_connections Êó∂ÔºåÊñ∞Êù•ÁöÑËØ∑Ê±ÇÂ∞Ü‰ºöË¢´Â≠òÂú®Â†ÜÊ†à‰∏≠Ôºå‰ª•Á≠âÂæÖÊüê‰∏ÄËøûÊé•ÈáäÊîæËµÑÊ∫êÔºåËØ•Â†ÜÊ†àÁöÑÊï∞ÈáèÂç≥ back_log„ÄÇÂ¶ÇÊûúÁ≠âÂæÖËøûÊé•ÁöÑÊï∞ÈáèË∂ÖËøá back_logÔºåÂ∞Ü‰∏çË¢´Êéà‰∫àËøûÊé•ËµÑÊ∫êÁõ¥Êé•Êä•Èîô</p><p>5.6.6 ÁâàÊú¨‰πãÂâçÈªòËÆ§ÂÄº‰∏∫ 50Ôºå‰πãÂêéÁöÑÁâàÊú¨ÈªòËÆ§‰∏∫ <code>50 + (max_connections/5)</code>Ôºå‰ΩÜÊúÄÂ§ß‰∏çË∂ÖËøá900ÔºåÂ¶ÇÊûúÈúÄË¶ÅÊï∞ÊçÆÂ∫ìÂú®ËæÉÁü≠ÁöÑÊó∂Èó¥ÂÜÖÂ§ÑÁêÜÂ§ßÈáèËøûÊé•ËØ∑Ê±ÇÔºå ÂèØ‰ª•ËÄÉËôëÈÄÇÂΩìÂ¢ûÂ§ß back_log ÁöÑÂÄº</p></li><li><p>table_open_cacheÔºöÊéßÂà∂ÊâÄÊúâ SQL ËØ≠Âè•ÊâßË°åÁ∫øÁ®ãÂèØÊâìÂºÄË°®ÁºìÂ≠òÁöÑÊï∞Èáè</p><p>Âú®ÊâßË°å SQL ËØ≠Âè•Êó∂ÔºåÊØè‰∏™ÊâßË°åÁ∫øÁ®ãËá≥Â∞ëË¶ÅÊâìÂºÄ1‰∏™Ë°®ÁºìÂ≠òÔºåËØ•ÂèÇÊï∞ÁöÑÂÄºÂ∫îËØ•Ê†πÊçÆËÆæÁΩÆÁöÑÊúÄÂ§ßËøûÊé•Êï∞‰ª•ÂèäÊØè‰∏™ËøûÊé•ÊâßË°åÂÖ≥ËÅîÊü•ËØ¢‰∏≠Ê∂âÂèäÁöÑË°®ÁöÑÊúÄÂ§ßÊï∞ÈáèÊù•ËÆæÂÆöÔºö<code>max_connections * N</code></p></li><li><p>thread_cache_sizeÔºöÂèØÊéßÂà∂ MySQL ÁºìÂ≠òÂÆ¢Êà∑ÊúçÂä°Á∫øÁ®ãÁöÑÊï∞Èáè</p><p>‰∏∫‰∫ÜÂä†Âø´ËøûÊé•Êï∞ÊçÆÂ∫ìÁöÑÈÄüÂ∫¶ÔºåMySQL ‰ºöÁºìÂ≠ò‰∏ÄÂÆöÊï∞ÈáèÁöÑÂÆ¢Êà∑ÊúçÂä°Á∫øÁ®ã‰ª•Â§áÈáçÁî®ÔºåÊ±†ÂåñÊÄùÊÉ≥</p></li><li><p>innodb_lock_wait_timeoutÔºöËÆæÁΩÆ InnoDB ‰∫ãÂä°Á≠âÂæÖË°åÈîÅÁöÑÊó∂Èó¥ÔºåÈªòËÆ§ÂÄºÊòØ 50ms</p><p>ÂØπ‰∫éÈúÄË¶ÅÂø´ÈÄüÂèçÈ¶àÁöÑ‰∏öÂä°Á≥ªÁªüÔºåÂèØ‰ª•Â∞ÜË°åÈîÅÁöÑÁ≠âÂæÖÊó∂Èó¥Ë∞ÉÂ∞èÔºå‰ª•ÈÅøÂÖç‰∫ãÂä°Ë¢´ÈïøÊó∂Èó¥ÊåÇËµ∑Ôºõ ÂØπ‰∫éÂêéÂè∞ËøêË°åÁöÑÊâπÈáèÂ§ÑÁêÜÁ®ãÂ∫èÊù•ËØ¥ÔºåÂèØ‰ª•Â∞ÜË°åÈîÅÁöÑÁ≠âÂæÖÊó∂Èó¥Ë∞ÉÂ§ßÔºå‰ª•ÈÅøÂÖçÂèëÁîüÂ§ßÁöÑÂõûÊªöÊìç‰Ωú</p></li></ul><hr><h2 id="‰∫ãÂä°Êú∫Âà∂" tabindex="-1"><a class="header-anchor" href="#‰∫ãÂä°Êú∫Âà∂"><span>‰∫ãÂä°Êú∫Âà∂</span></a></h2><h3 id="Âü∫Êú¨‰ªãÁªç-7" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-7"><span>Âü∫Êú¨‰ªãÁªç</span></a></h3><p>‰∫ãÂä°ÔºàTransactionÔºâÊòØËÆøÈóÆÂíåÊõ¥Êñ∞Êï∞ÊçÆÂ∫ìÁöÑÁ®ãÂ∫èÊâßË°åÂçïÂÖÉÔºõ‰∫ãÂä°‰∏≠ÂèØËÉΩÂåÖÂê´‰∏Ä‰∏™ÊàñÂ§ö‰∏™ SQL ËØ≠Âè•ÔºåËøô‰∫õËØ≠Âè•Ë¶Å‰πàÈÉΩÊâßË°åÔºåË¶Å‰πàÈÉΩ‰∏çÊâßË°åÔºå‰Ωú‰∏∫‰∏Ä‰∏™ÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÔºåMySQL ÊîØÊåÅ‰∫ãÂä°„ÄÇ</p><p>ÂçïÂÖÉ‰∏≠ÁöÑÊØèÊù° SQL ËØ≠Âè•ÈÉΩÁõ∏‰∫í‰æùËµñÔºåÂΩ¢Êàê‰∏Ä‰∏™Êï¥‰Ωì</p><ul><li>Â¶ÇÊûúÊüêÊù° SQL ËØ≠Âè•ÊâßË°åÂ§±Ë¥•ÊàñËÄÖÂá∫Áé∞ÈîôËØØÔºåÈÇ£‰πàÊï¥‰∏™ÂçïÂÖÉÂ∞±‰ºöÂõûÊªöÔºåÊí§ÂõûÂà∞‰∫ãÂä°ÊúÄÂàùÁöÑÁä∂ÊÄÅ</li><li>Â¶ÇÊûúÂçïÂÖÉ‰∏≠ÊâÄÊúâÁöÑ SQL ËØ≠Âè•ÈÉΩÊâßË°åÊàêÂäüÔºåÂàô‰∫ãÂä°Â∞±È°∫Âà©ÊâßË°å</li></ul><p>‰∫ãÂä°ÁöÑÂõõÂ§ßÁâπÂæÅÔºöACID</p><ul><li>ÂéüÂ≠êÊÄß (atomicity)</li><li>‰∏ÄËá¥ÊÄß (consistency)</li><li>ÈöîÁ¶ªÊÄß (isolaction)</li><li>ÊåÅ‰πÖÊÄß (durability)</li></ul><p>ËÄåÂØπ‰∫éËøôÂõõÂ§ßÁâπÊÄßÔºåÂÆûÈôÖ‰∏äÂàÜ‰∏∫‰∏§‰∏™ÈÉ®ÂàÜ„ÄÇ ÂÖ∂‰∏≠ÁöÑÂéüÂ≠êÊÄß„ÄÅ‰∏ÄËá¥ÊÄß„ÄÅÊåÅ‰πÖÂåñÔºåÂÆûÈôÖ‰∏äÊòØÁî±InnoDB‰∏≠ÁöÑ‰∏§‰ªΩÊó•ÂøóÊù•‰øùËØÅÁöÑÔºå‰∏Ä‰ªΩÊòØredo logÊó•ÂøóÔºå‰∏Ä‰ªΩÊòØundo logÊó•Âøó„ÄÇ ËÄåÊåÅ‰πÖÊÄßÊòØÈÄöËøáÊï∞ÊçÆÂ∫ìÁöÑÈîÅÔºåÂä†‰∏äMVCCÊù•‰øùËØÅÁöÑ„ÄÇ<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687226636543.png" alt="1687226636543" loading="lazy"></p><p>‰∫ãÂä°ÁöÑÂá†ÁßçÁä∂ÊÄÅÔºö</p><ul><li>Ê¥ªÂä®ÁöÑÔºàactiveÔºâÔºö‰∫ãÂä°ÂØπÂ∫îÁöÑÊï∞ÊçÆÂ∫ìÊìç‰ΩúÊ≠£Âú®ÊâßË°å‰∏≠</li><li>ÈÉ®ÂàÜÊèê‰∫§ÁöÑÔºàpartially committedÔºâÔºö‰∫ãÂä°ÁöÑÊúÄÂêé‰∏Ä‰∏™Êìç‰ΩúÊâßË°åÂÆåÔºå‰ΩÜÊòØÂÜÖÂ≠òËøòÊ≤°Âà∑Êñ∞Ëá≥Á£ÅÁõò</li><li>Â§±Ë¥•ÁöÑÔºàfailedÔºâÔºöÂΩì‰∫ãÂä°Â§Ñ‰∫éÊ¥ªÂä®Áä∂ÊÄÅÊàñÈÉ®ÂàÜÊèê‰∫§Áä∂ÊÄÅÊó∂ÔºåÂ¶ÇÊûúÊï∞ÊçÆÂ∫ìÈÅáÂà∞‰∫ÜÈîôËØØÊàñÂà∑ËÑèÂ§±Ë¥•ÔºåÊàñËÄÖÁî®Êà∑‰∏ªÂä®ÂÅúÊ≠¢ÂΩìÂâçÁöÑ‰∫ãÂä°</li><li>‰∏≠Ê≠¢ÁöÑÔºàabortedÔºâÔºöÂ§±Ë¥•Áä∂ÊÄÅÁöÑ‰∫ãÂä°ÂõûÊªöÂÆåÊàêÂêéÁöÑÁä∂ÊÄÅ</li><li>Êèê‰∫§ÁöÑÔºàcommittedÔºâÔºöÂΩìÂ§Ñ‰∫éÈÉ®ÂàÜÊèê‰∫§Áä∂ÊÄÅÁöÑ‰∫ãÂä°Âà∑ËÑèÊàêÂäüÔºåÂ∞±Â§Ñ‰∫éÊèê‰∫§Áä∂ÊÄÅ</li></ul><hr><h3 id="‰∫ãÂä°ÁÆ°ÁêÜ" tabindex="-1"><a class="header-anchor" href="#‰∫ãÂä°ÁÆ°ÁêÜ"><span>‰∫ãÂä°ÁÆ°ÁêÜ</span></a></h3><h4 id="Âü∫Êú¨Êìç‰Ωú-2" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨Êìç‰Ωú-2"><span>Âü∫Êú¨Êìç‰Ωú</span></a></h4><p>‰∫ãÂä°ÁÆ°ÁêÜÁöÑ‰∏â‰∏™Ê≠•È™§</p><ol><li>ÂºÄÂêØ‰∫ãÂä°ÔºöËÆ∞ÂΩïÂõûÊªöÁÇπÔºåÂπ∂ÈÄöÁü•ÊúçÂä°Âô®ÔºåÂ∞ÜË¶ÅÊâßË°å‰∏ÄÁªÑÊìç‰ΩúÔºåË¶Å‰πàÂêåÊó∂ÊàêÂäü„ÄÅË¶Å‰πàÂêåÊó∂Â§±Ë¥•</li><li>ÊâßË°å SQL ËØ≠Âè•ÔºöÊâßË°åÂÖ∑‰ΩìÁöÑ‰∏ÄÊù°ÊàñÂ§öÊù° SQL ËØ≠Âè•</li><li>ÁªìÊùü‰∫ãÂä°ÔºàÊèê‰∫§|ÂõûÊªöÔºâ <ul><li>Êèê‰∫§ÔºöÊ≤°Âá∫Áé∞ÈóÆÈ¢òÔºåÊï∞ÊçÆËøõË°åÊõ¥Êñ∞</li><li>ÂõûÊªöÔºöÂá∫Áé∞ÈóÆÈ¢òÔºåÊï∞ÊçÆÊÅ¢Â§çÂà∞ÂºÄÂêØ‰∫ãÂä°Êó∂ÁöÑÁä∂ÊÄÅ</li></ul></li></ol><p>‰∫ãÂä°Êìç‰ΩúÔºö</p><ul><li><p>ÊòæÂºèÂºÄÂêØ‰∫ãÂä°</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>START TRANSACTION [READ ONLY|READ WRITE|WITH CONSISTENT SNAPSHOT]; #ÂèØ‰ª•Ë∑ü‰∏Ä‰∏™ÊàñÂ§ö‰∏™Áä∂ÊÄÅÔºåÊúÄÂêéÁöÑÊòØ‰∏ÄËá¥ÊÄßËØª</span></span>
<span class="line"><span>BEGIN [WORK];</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>ËØ¥ÊòéÔºö‰∏çÂ°´Áä∂ÊÄÅÈªòËÆ§ÊòØËØªÂÜô‰∫ãÂä°</p><ul><li><p>ÂõûÊªö‰∫ãÂä°ÔºåÁî®Êù•ÊâãÂä®‰∏≠Ê≠¢‰∫ãÂä°</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ROLLBACK;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êèê‰∫§‰∫ãÂä°ÔºåÊòæÁ§∫ÊâßË°åÊòØÊâãÂä®Êèê‰∫§ÔºåMySQL ÈªòËÆ§‰∏∫Ëá™Âä®Êèê‰∫§</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>COMMIT;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>‰øùÂ≠òÁÇπÔºöÂú®‰∫ãÂä°ÁöÑÊâßË°åËøáÁ®ã‰∏≠ËÆæÁΩÆÁöÑËøòÂéüÁÇπÔºåË∞ÉÁî® ROLLBACK Êó∂ÂèØ‰ª•ÊåáÂÆöÂõûÊªöÂà∞Âì™‰∏™ÁÇπ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SAVEPOINT point_name;						#ËÆæÁΩÆ‰øùÂ≠òÁÇπ</span></span>
<span class="line"><span>RELEASE point_name							#Âà†Èô§‰øùÂ≠òÁÇπ</span></span>
<span class="line"><span>ROLLBACK [WORK] TO [SAVEPOINT] point_name	#ÂõûÊªöËá≥Êüê‰∏™‰øùÂ≠òÁÇπÔºå‰∏çÂ°´ÈªòËÆ§ÂõûÊªöÂà∞‰∫ãÂä°ÊâßË°å‰πãÂâçÁöÑÁä∂ÊÄÅ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êìç‰ΩúÊºîÁ§∫</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂºÄÂêØ‰∫ãÂä°</span></span>
<span class="line"><span>START TRANSACTION;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Âº†‰∏âÁªôÊùéÂõõËΩ¨Ë¥¶500ÂÖÉ</span></span>
<span class="line"><span>-- 1.Âº†‰∏âË¥¶Êà∑-500</span></span>
<span class="line"><span>UPDATE account SET money=money-500 WHERE NAME=&#39;Âº†‰∏â&#39;;</span></span>
<span class="line"><span>-- 2.ÊùéÂõõË¥¶Êà∑+500</span></span>
<span class="line"><span>UPDATE account SET money=money+500 WHERE NAME=&#39;ÊùéÂõõ&#39;;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂõûÊªö‰∫ãÂä°(Âá∫Áé∞ÈóÆÈ¢ò)</span></span>
<span class="line"><span>ROLLBACK;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Êèê‰∫§‰∫ãÂä°(Ê≤°Âá∫Áé∞ÈóÆÈ¢ò)</span></span>
<span class="line"><span>COMMIT;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="Êèê‰∫§ÊñπÂºè" tabindex="-1"><a class="header-anchor" href="#Êèê‰∫§ÊñπÂºè"><span>Êèê‰∫§ÊñπÂºè</span></a></h4><p>Êèê‰∫§ÊñπÂºèÁöÑÁõ∏ÂÖ≥ËØ≠Ê≥ïÔºö</p><ul><li><p>Êü•Áúã‰∫ãÂä°Êèê‰∫§ÊñπÂºè</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT @@AUTOCOMMIT;  		-- ‰ºöËØùÔºå1 ‰ª£Ë°®Ëá™Âä®Êèê‰∫§    0 ‰ª£Ë°®ÊâãÂä®Êèê‰∫§</span></span>
<span class="line"><span>SELECT @@GLOBAL.AUTOCOMMIT;	-- Á≥ªÁªü</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>‰øÆÊîπ‰∫ãÂä°Êèê‰∫§ÊñπÂºè</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET @@AUTOCOMMIT=Êï∞Â≠ó;	-- Á≥ªÁªü</span></span>
<span class="line"><span>SET AUTOCOMMIT=Êï∞Â≠ó;		-- ‰ºöËØù</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Â∑•‰ΩúÂéüÁêÜÔºö</p></li><li><p>Ëá™Âä®Êèê‰∫§ÔºöÂ¶ÇÊûúÊ≤°Êúâ START TRANSACTION ÊòæÂºèÂú∞ÂºÄÂßã‰∏Ä‰∏™‰∫ãÂä°ÔºåÈÇ£‰πà<strong>ÊØèÊù° SQL ËØ≠Âè•ÈÉΩ‰ºöË¢´ÂΩìÂÅö‰∏Ä‰∏™‰∫ãÂä°ÊâßË°åÊèê‰∫§Êìç‰Ωú</strong>ÔºõÊòæÂºèÂºÄÂêØ‰∫ãÂä°ÂêéÔºå‰ºöÂú®Êú¨Ê¨°‰∫ãÂä°ÁªìÊùüÔºàÊèê‰∫§ÊàñÂõûÊªöÔºâÂâçÊöÇÊó∂ÂÖ≥Èó≠Ëá™Âä®Êèê‰∫§</p></li><li><p>ÊâãÂä®Êèê‰∫§Ôºö‰∏çÈúÄË¶ÅÊòæÂºèÁöÑÂºÄÂêØ‰∫ãÂä°ÔºåÊâÄÊúâÁöÑ SQL ËØ≠Âè•ÈÉΩÂú®‰∏Ä‰∏™‰∫ãÂä°‰∏≠ÔºåÁõ¥Âà∞ÊâßË°å‰∫ÜÊèê‰∫§ÊàñÂõûÊªöÔºåÁÑ∂ÂêéËøõÂÖ•‰∏ã‰∏Ä‰∏™‰∫ãÂä°</p></li><li><p>ÈöêÂºèÊèê‰∫§ÔºöÂ≠òÂú®‰∏Ä‰∫õÁâπÊÆäÁöÑÂëΩ‰ª§ÔºåÂú®‰∫ãÂä°‰∏≠ÊâßË°å‰∫ÜËøô‰∫õÂëΩ‰ª§‰ºöÈ©¨‰∏ä<strong>Âº∫Âà∂ÊâßË°å COMMIT Êèê‰∫§‰∫ãÂä°</strong></p><ul><li><strong>DDL ËØ≠Âè•</strong> (CREATE/DROP/ALTER)„ÄÅLOCK TABLES ËØ≠Âè•„ÄÅLOAD DATA ÂØºÂÖ•Êï∞ÊçÆËØ≠Âè•„ÄÅ‰∏ª‰ªéÂ§çÂà∂ËØ≠Âè•Á≠â</li><li>ÂΩì‰∏Ä‰∏™‰∫ãÂä°ËøòÊ≤°Êèê‰∫§ÊàñÂõûÊªöÔºåÊòæÂºèÁöÑÂºÄÂêØ‰∏Ä‰∏™‰∫ãÂä°‰ºöÈöêÂºèÁöÑÊèê‰∫§‰∏ä‰∏Ä‰∏™‰∫ãÂä°</li></ul></li></ul><hr><h4 id="‰∫ãÂä°-id" tabindex="-1"><a class="header-anchor" href="#‰∫ãÂä°-id"><span>‰∫ãÂä° ID</span></a></h4><p>‰∫ãÂä°Âú®ÊâßË°åËøáÁ®ã‰∏≠ÂØπÊüê‰∏™Ë°®ÊâßË°å‰∫Ü<strong>Â¢ûÂà†ÊîπÊìç‰ΩúÊàñËÄÖÂàõÂª∫Ë°®</strong>ÔºåÂ∞±‰ºö‰∏∫ÂΩìÂâç‰∫ãÂä°ÂàÜÈÖç‰∏Ä‰∏™Áã¨‰∏ÄÊó†‰∫åÁöÑ‰∫ãÂä° IDÔºàÂØπ‰∏¥Êó∂Ë°®Âπ∂‰∏ç‰ºöÂàÜÈÖç IDÔºâÔºåÂ¶ÇÊûúÂΩìÂâç‰∫ãÂä°Ê≤°ÊúâË¢´ÂàÜÈÖç IDÔºåÈªòËÆ§ÊòØ 0</p><p>ËØ¥ÊòéÔºöÂè™ËØª‰∫ãÂä°‰∏çËÉΩÂØπÊôÆÈÄöÁöÑË°®ËøõË°åÂ¢ûÂà†ÊîπÊìç‰ΩúÔºå‰ΩÜÊòØÂèØ‰ª•ÂØπ‰∏¥Êó∂Ë°®Â¢ûÂà†ÊîπÔºåËØªÂÜô‰∫ãÂä°ÂèØ‰ª•ÂØπÊï∞ÊçÆË°®ÊâßË°åÂ¢ûÂà†ÊîπÊü•Êìç‰Ωú</p><p>‰∫ãÂä° ID Êú¨Ë¥®‰∏äÂ∞±ÊòØ‰∏Ä‰∏™Êï∞Â≠óÔºåÊúçÂä°Âô®Âú®ÂÜÖÂ≠ò‰∏≠Áª¥Êä§‰∏Ä‰∏™ÂÖ®Â±ÄÂèòÈáèÔºö</p><ul><li>ÊØèÂΩìÈúÄË¶Å‰∏∫Êüê‰∏™‰∫ãÂä°ÂàÜÈÖç IDÔºåÂ∞±‰ºöÊääÂÖ®Â±ÄÂèòÈáèÁöÑÂÄºËµãÂÄºÁªô‰∫ãÂä° IDÔºåÁÑ∂ÂêéÂèòÈáèËá™Â¢û 1</li><li>ÊØèÂΩìÂèòÈáèÂÄº‰∏∫ 256 ÁöÑÂÄçÊï∞Êó∂ÔºåÂ∞±Â∞ÜËØ•ÂèòÈáèÁöÑÂÄºÂà∑Êñ∞Âà∞Á≥ªÁªüË°®Á©∫Èó¥ÁöÑ Max Trx ID Â±ûÊÄß‰∏≠ÔºåËØ•Â±ûÊÄßÂç† 8 Â≠óËäÇ</li><li>Á≥ªÁªüÂÜçÊ¨°ÂêØÂä®ÂêéÔºå‰ºöËØªÂèñË°®Á©∫Èó¥ÁöÑ Max Trx ID Â±ûÊÄßÂà∞ÂÜÖÂ≠òÔºåÂä†‰∏ä 256 ÂêéËµãÂÄºÁªôÂÖ®Â±ÄÂèòÈáèÔºåÂõ†‰∏∫ÂÖ≥Êú∫Êó∂ÁöÑ‰∫ãÂä° ID ÂèØËÉΩÂπ∂‰∏çÊòØ 256 ÁöÑÂÄçÊï∞Ôºå‰ºöÊØî Max Trx ID Â§ßÔºåÊâÄ‰ª•ÈúÄË¶ÅÂä†‰∏ä 256 ‰øùÊåÅ‰∫ãÂä° ID ÊòØ‰∏Ä‰∏™<strong>ÈÄíÂ¢ûÁöÑÊï∞Â≠ó</strong></li></ul><p><strong>ËÅöÁ∞áÁ¥¢Âºï</strong>ÁöÑË°åËÆ∞ÂΩïÈô§‰∫ÜÂÆåÊï¥ÁöÑÊï∞ÊçÆÔºåËøò‰ºöËá™Âä®Ê∑ªÂä† trx_id„ÄÅroll_pointer ÈöêËóèÂàóÔºåÂ¶ÇÊûúË°®‰∏≠Ê≤°Êúâ‰∏ªÈîÆÂπ∂‰∏îÊ≤°ÊúâÈùûÁ©∫ÂîØ‰∏ÄÁ¥¢ÂºïÔºå‰πü‰ºöÊ∑ªÂä†‰∏Ä‰∏™ row_id ÁöÑÈöêËóèÂàó‰Ωú‰∏∫ËÅöÁ∞áÁ¥¢Âºï</p><hr><h3 id="ÈöîÁ¶ªÁ∫ßÂà´" tabindex="-1"><a class="header-anchor" href="#ÈöîÁ¶ªÁ∫ßÂà´"><span>ÈöîÁ¶ªÁ∫ßÂà´</span></a></h3><h4 id="ÂõõÁßçÁ∫ßÂà´" tabindex="-1"><a class="header-anchor" href="#ÂõõÁßçÁ∫ßÂà´"><span>ÂõõÁßçÁ∫ßÂà´</span></a></h4><p>‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´ÔºöÂ§ö‰∏™ÂÆ¢Êà∑Á´ØÊìç‰ΩúÊó∂ÔºåÂêÑ‰∏™ÂÆ¢Êà∑Á´ØÁöÑ‰∫ãÂä°‰πãÈó¥Â∫îËØ•ÊòØÈöîÁ¶ªÁöÑÔºå<strong>‰∏çÂêåÁöÑ‰∫ãÂä°‰πãÈó¥‰∏çËØ•‰∫íÁõ∏ÂΩ±Âìç</strong>ÔºåËÄåÂ¶ÇÊûúÂ§ö‰∏™‰∫ãÂä°Êìç‰ΩúÂêå‰∏ÄÊâπÊï∞ÊçÆÊó∂ÔºåÂàôÈúÄË¶ÅËÆæÁΩÆ‰∏çÂêåÁöÑÈöîÁ¶ªÁ∫ßÂà´ÔºåÂê¶ÂàôÂ∞±‰ºö‰∫ßÁîüÈóÆÈ¢ò„ÄÇ</p><p>ÈöîÁ¶ªÁ∫ßÂà´ÂàÜÁ±ªÔºö</p><table><thead><tr><th>ÈöîÁ¶ªÁ∫ßÂà´</th><th>ÂêçÁß∞</th><th>‰ºöÂºïÂèëÁöÑÈóÆÈ¢ò</th><th>Êï∞ÊçÆÂ∫ìÈªòËÆ§ÈöîÁ¶ªÁ∫ßÂà´</th></tr></thead><tbody><tr><td>Read Uncommitted</td><td>ËØªÊú™Êèê‰∫§</td><td>ËÑèËØª„ÄÅ‰∏çÂèØÈáçÂ§çËØª„ÄÅÂπªËØª</td><td></td></tr><tr><td>Read Committed</td><td>ËØªÂ∑≤Êèê‰∫§</td><td>‰∏çÂèØÈáçÂ§çËØª„ÄÅÂπªËØª</td><td>Oracle / SQL Server</td></tr><tr><td>Repeatable Read</td><td>ÂèØÈáçÂ§çËØª</td><td>ÂπªËØª</td><td>MySQL</td></tr><tr><td>Serializable</td><td>ÂèØ‰∏≤Ë°åÂåñ</td><td>Êó†</td><td></td></tr></tbody></table><p>‰∏ÄËà¨Êù•ËØ¥ÔºåÈöîÁ¶ªÁ∫ßÂà´Ë∂ä‰ΩéÔºåÁ≥ªÁªüÂºÄÈîÄË∂ä‰ΩéÔºåÂèØÊîØÊåÅÁöÑÂπ∂ÂèëË∂äÈ´òÔºå‰ΩÜÈöîÁ¶ªÊÄß‰πüË∂äÂ∑Æ</p><ul><li><p>ËÑèÂÜô (Dirty Write)ÔºöÂΩì‰∏§‰∏™ÊàñÂ§ö‰∏™‰∫ãÂä°ÈÄâÊã©Âêå‰∏ÄË°åÔºåÊúÄÂàùÁöÑ‰∫ãÂä°‰øÆÊîπÁöÑÂÄºË¢´ÂêéÈù¢‰∫ãÂä°‰øÆÊîπÁöÑÂÄºË¶ÜÁõñÔºåÊâÄÊúâÁöÑÈöîÁ¶ªÁ∫ßÂà´ÈÉΩÂèØ‰ª•ÈÅøÂÖçËÑèÂÜôÔºàÂèàÂè´‰∏¢Â§±Êõ¥Êñ∞ÔºâÔºåÂõ†‰∏∫ÊúâË°åÈîÅ</p></li><li><p>ËÑèËØª (Dirty Reads)ÔºöÂú®‰∏Ä‰∏™‰∫ãÂä°Â§ÑÁêÜËøáÁ®ã‰∏≠ËØªÂèñ‰∫ÜÂè¶‰∏Ä‰∏™<strong>Êú™Êèê‰∫§</strong>ÁöÑ‰∫ãÂä°‰∏≠‰øÆÊîπËøáÁöÑÊï∞ÊçÆ</p></li><li><p>‰∏çÂèØÈáçÂ§çËØª (Non-Repeatable Reads)ÔºöÂú®‰∏Ä‰∏™‰∫ãÂä°Â§ÑÁêÜËøáÁ®ã‰∏≠ËØªÂèñ‰∫ÜÂè¶‰∏Ä‰∏™‰∫ãÂä°‰∏≠‰øÆÊîπÂπ∂<strong>Â∑≤Êèê‰∫§</strong>ÁöÑÊï∞ÊçÆ</p><blockquote><p>ÂèØÈáçÂ§çËØªÁöÑÊÑèÊÄùÊòØ‰∏çÁÆ°ËØªÂá†Ê¨°ÔºåÁªìÊûúÈÉΩ‰∏ÄÊ†∑ÔºåÂèØ‰ª•ÈáçÂ§çÁöÑËØªÔºåÂèØ‰ª•ÁêÜËß£‰∏∫Âø´ÁÖßËØªÔºåË¶ÅËØªÁöÑÊï∞ÊçÆÈõÜ‰∏ç‰ºöÂèëÁîüÂèòÂåñ</p></blockquote></li><li><p>ÂπªËØª (Phantom Reads)ÔºöÂú®‰∫ãÂä°‰∏≠ÊåâÊüê‰∏™Êù°‰ª∂ÂÖàÂêé‰∏§Ê¨°Êü•ËØ¢Êï∞ÊçÆÂ∫ìÔºåÂêé‰∏ÄÊ¨°Êü•ËØ¢Êü•Âà∞‰∫ÜÂâç‰∏ÄÊ¨°Êü•ËØ¢Ê≤°ÊúâÊü•Âà∞ÁöÑË°åÔºå<strong>Êï∞ÊçÆÊù°ÁõÆ</strong>ÂèëÁîü‰∫ÜÂèòÂåñ„ÄÇÊØîÂ¶ÇÊü•ËØ¢ÊüêÊï∞ÊçÆ‰∏çÂ≠òÂú®ÔºåÂáÜÂ§áÊèíÂÖ•Ê≠§ËÆ∞ÂΩïÔºå‰ΩÜÊâßË°åÊèíÂÖ•Êó∂ÂèëÁé∞Ê≠§ËÆ∞ÂΩïÂ∑≤Â≠òÂú®ÔºåÊó†Ê≥ïÊèíÂÖ•</p></li></ul><p>ÈöîÁ¶ªÁ∫ßÂà´Êìç‰ΩúËØ≠Ê≥ïÔºö</p><ul><li><p>Êü•Áúã‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT @@TRANSACTION_ISOLATION;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ËÆæÁΩÆ‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET  [ SESSION | GLOBAL ]  TRANSACTION  ISOLATION  LEVEL  { READ UNCOMMITTED | </span></span>
<span class="line"><span>READ COMMITTED | REPEATABLE READ | SERIALIZABLE }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Êï∞ÊçÆÂ∫ìÈöîÁ¶ªÁ∫ßÂà´</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT @@TX_ISOLATION;			-- ‰ºöËØù</span></span>
<span class="line"><span>SELECT @@GLOBAL.TX_ISOLATION;	-- Á≥ªÁªü</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>‰øÆÊîπÊï∞ÊçÆÂ∫ìÈöîÁ¶ªÁ∫ßÂà´</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET GLOBAL TRANSACTION ISOLATION LEVEL Á∫ßÂà´Â≠óÁ¨¶‰∏≤;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><hr><h4 id="Âä†ÈîÅÂàÜÊûê" tabindex="-1"><a class="header-anchor" href="#Âä†ÈîÅÂàÜÊûê"><span>Âä†ÈîÅÂàÜÊûê</span></a></h4><p>InnoDB Â≠òÂÇ®ÂºïÊìéÊîØÊåÅ‰∫ãÂä°ÔºåÊâÄ‰ª•Âä†ÈîÅÂàÜÊûêÊòØÂü∫‰∫éËØ•Â≠òÂÇ®ÂºïÊìé</p><ul><li><p>Read Uncommitted Á∫ßÂà´Ôºå‰ªª‰ΩïÊìç‰ΩúÈÉΩ‰∏ç‰ºöÂä†ÈîÅ</p></li><li><p>Read Committed Á∫ßÂà´ÔºåÂ¢ûÂà†ÊîπÊìç‰Ωú‰ºöÂä†ÂÜôÈîÅÔºàË°åÈîÅÔºâÔºåËØªÊìç‰Ωú‰∏çÂä†ÈîÅ</p><p>Âú® Server Â±ÇËøáÊª§Êù°‰ª∂Êó∂ÂèëÁé∞‰∏çÊª°Ë∂≥ÁöÑËÆ∞ÂΩï‰ºöË∞ÉÁî® unlock_row ÊñπÊ≥ïÈáäÊîæËØ•ËÆ∞ÂΩïÁöÑË°åÈîÅÔºå‰øùËØÅÊúÄÂêéÂè™ÊúâÊª°Ë∂≥Êù°‰ª∂ÁöÑËÆ∞ÂΩïÂä†ÈîÅÔºå‰ΩÜÊòØÊâ´Ë°®ËøáÁ®ã‰∏≠ÊØèÊù°ËÆ∞ÂΩïÁöÑ<strong>Âä†ÈîÅÊìç‰Ωú‰∏çËÉΩÁúÅÁï•</strong>„ÄÇÊâÄ‰ª•ÂØπÊï∞ÊçÆÈáèÂæàÂ§ßÁöÑË°®ÂÅöÊâπÈáè‰øÆÊîπÊó∂ÔºåÂ¶ÇÊûúÊó†Ê≥ï‰ΩøÁî®Áõ∏Â∫îÁöÑÁ¥¢ÂºïÔºàÂÖ®Ë°®Êâ´ÊèèÔºâÔºåÂú® Server ËøáÊª§Êï∞ÊçÆÊó∂Â∞±‰ºöÁâπÂà´ÊÖ¢ÔºåÂá∫Áé∞ËôΩÁÑ∂Ê≤°Êúâ‰øÆÊîπÊüê‰∫õË°åÁöÑÊï∞ÊçÆÔºå‰ΩÜÊòØËøòÊòØË¢´ÈîÅ‰Ωè‰∫ÜÁöÑÁé∞Ë±°ÔºàÈîÅË°®ÔºâÔºåËøôÁßçÊÉÖÂÜµÂêåÊ†∑ÈÄÇÁî®‰∫é RR</p></li><li><p>Repeatable Read Á∫ßÂà´ÔºåÂ¢ûÂà†ÊîπÊìç‰Ωú‰ºöÂä†ÂÜôÈîÅÔºåËØªÊìç‰Ωú‰∏çÂä†ÈîÅ„ÄÇÂõ†‰∏∫ËØªÂÜôÈîÅ‰∏çÂÖºÂÆπÔºå<strong>Âä†‰∫ÜËØªÈîÅÂêéÂÖ∂‰ªñ‰∫ãÂä°Â∞±Êó†Ê≥ï‰øÆÊîπÊï∞ÊçÆ</strong>ÔºåÂΩ±Âìç‰∫ÜÂπ∂ÂèëÊÄßËÉΩÔºå‰∏∫‰∫Ü‰øùËØÅÈöîÁ¶ªÊÄßÂíåÂπ∂ÂèëÊÄßÔºåMySQL ÈÄöËøá MVCC Ëß£ÂÜ≥‰∫ÜËØªÂÜôÂÜ≤Á™Å„ÄÇRR Á∫ßÂà´‰∏ãÁöÑÈîÅÊúâÂæàÂ§öÁßçÔºåÈîÅÊú∫Âà∂Á´†ËäÇËØ¶Ëß£</p></li><li><p>Serializable Á∫ßÂà´ÔºåËØªÂä†ÂÖ±‰∫´ÈîÅÔºåÂÜôÂä†Êéí‰ªñÈîÅÔºåËØªÂÜô‰∫íÊñ•Ôºå‰ΩøÁî®ÁöÑÊÇ≤ËßÇÈîÅÁöÑÁêÜËÆ∫ÔºåÂÆûÁé∞ÁÆÄÂçïÔºåÊï∞ÊçÆÊõ¥Âä†ÂÆâÂÖ®Ôºå‰ΩÜÊòØÂπ∂ÂèëËÉΩÂäõÈùûÂ∏∏Â∑Æ</p><ul><li>‰∏≤Ë°åÂåñÔºöËÆ©ÊâÄÊúâ‰∫ãÂä°ÊåâÈ°∫Â∫èÂçïÁã¨ÊâßË°åÔºåÂÜôÊìç‰Ωú‰ºöÂä†ÂÜôÈîÅÔºåËØªÊìç‰Ωú‰ºöÂä†ËØªÈîÅ</li><li>ÂèØ‰∏≤Ë°åÂåñÔºöËÆ©ÊâÄÊúâÊìç‰ΩúÁõ∏ÂêåÊï∞ÊçÆÁöÑ‰∫ãÂä°È°∫Â∫èÊâßË°åÔºåÈÄöËøáÂä†ÈîÅÂÆûÁé∞</li></ul></li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://tech.meituan.com/2014/08/20/innodb-lock.html</p><hr><h3 id="ÂéüÂ≠êÁâπÊÄß" tabindex="-1"><a class="header-anchor" href="#ÂéüÂ≠êÁâπÊÄß"><span>ÂéüÂ≠êÁâπÊÄß</span></a></h3><h4 id="ÂÆûÁé∞ÊñπÂºè" tabindex="-1"><a class="header-anchor" href="#ÂÆûÁé∞ÊñπÂºè"><span>ÂÆûÁé∞ÊñπÂºè</span></a></h4><p>ÂéüÂ≠êÊÄßÊòØÊåá‰∫ãÂä°ÊòØ‰∏Ä‰∏™‰∏çÂèØÂàÜÂâ≤ÁöÑÂ∑•‰ΩúÂçï‰ΩçÔºå‰∫ãÂä°ÁöÑÊìç‰ΩúÂ¶ÇÊûúÊàêÂäüÂ∞±ÂøÖÈ°ªË¶ÅÂÆåÂÖ®Â∫îÁî®Âà∞Êï∞ÊçÆÂ∫ìÔºåÂ§±Ë¥•Âàô‰∏çËÉΩÂØπÊï∞ÊçÆÂ∫ìÊúâ‰ªª‰ΩïÂΩ±Âìç„ÄÇÊØîÂ¶Ç‰∫ãÂä°‰∏≠‰∏Ä‰∏™ SQL ËØ≠Âè•ÊâßË°åÂ§±Ë¥•ÔºåÂàôÂ∑≤ÊâßË°åÁöÑËØ≠Âè•‰πüÂøÖÈ°ªÂõûÊªöÔºåÊï∞ÊçÆÂ∫ìÈÄÄÂõûÂà∞‰∫ãÂä°ÂâçÁöÑÁä∂ÊÄÅ</p><p>InnoDB Â≠òÂÇ®ÂºïÊìéÊèê‰æõ‰∫Ü‰∏§Áßç‰∫ãÂä°Êó•ÂøóÔºöredo logÔºàÈáçÂÅöÊó•ÂøóÔºâÂíå undo logÔºàÂõûÊªöÊó•ÂøóÔºâ</p><ul><li>redo log Áî®‰∫é‰øùËØÅ‰∫ãÂä°ÊåÅ‰πÖÊÄß</li><li>undo log Áî®‰∫é‰øùËØÅ‰∫ãÂä°ÂéüÂ≠êÊÄßÂíåÈöîÁ¶ªÊÄß</li></ul><p>undo log Â±û‰∫é<strong>ÈÄªËæëÊó•Âøó</strong>ÔºåÊ†πÊçÆÊØèË°åÊìç‰ΩúËøõË°åËÆ∞ÂΩïÔºåËÆ∞ÂΩï‰∫Ü SQL ÊâßË°åÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØÔºåÁî®Êù•ÂõûÊªöË°åËÆ∞ÂΩïÂà∞Êüê‰∏™ÁâàÊú¨</p><p>ÂΩì‰∫ãÂä°ÂØπÊï∞ÊçÆÂ∫ìËøõË°å‰øÆÊîπÊó∂ÔºåInnoDB ‰ºöÂÖàËÆ∞ÂΩïÂØπÂ∫îÁöÑ undo logÔºåÂ¶ÇÊûú‰∫ãÂä°ÊâßË°åÂ§±Ë¥•ÊàñË∞ÉÁî®‰∫Ü rollback ÂØºËá¥‰∫ãÂä°ÂõûÊªöÔºåInnoDB ‰ºöÊ†πÊçÆ undo log ÁöÑÂÜÖÂÆπ<strong>ÂÅö‰∏é‰πãÂâçÁõ∏ÂèçÁöÑÊìç‰Ωú</strong>Ôºö</p><ul><li>ÂØπ‰∫éÊØè‰∏™ insertÔºåÂõûÊªöÊó∂‰ºöÊâßË°å delete</li><li>ÂØπ‰∫éÊØè‰∏™ deleteÔºåÂõûÊªöÊó∂‰ºöÊâßË°å insert</li><li>ÂØπ‰∫éÊØè‰∏™ updateÔºåÂõûÊªöÊó∂‰ºöÊâßË°å‰∏Ä‰∏™Áõ∏ÂèçÁöÑ updateÔºåÊääÊï∞ÊçÆ‰øÆÊîπÂõûÂéª</li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://www.cnblogs.com/kismetv/p/10331633.html</p><hr><h4 id="dml-Ëß£Êûê" tabindex="-1"><a class="header-anchor" href="#dml-Ëß£Êûê"><span>DML Ëß£Êûê</span></a></h4><h5 id="insert-1" tabindex="-1"><a class="header-anchor" href="#insert-1"><span>INSERT</span></a></h5><p>‰πêËßÇÊèíÂÖ•ÔºöÂΩìÂâçÊï∞ÊçÆÈ°µÁöÑÂâ©‰ΩôÁ©∫Èó¥ÂÖÖË∂≥ÔºåÁõ¥Êé•Â∞ÜÊï∞ÊçÆËøõË°åÊèíÂÖ•</p><p>ÊÇ≤ËßÇÊèíÂÖ•ÔºöÂΩìÂâçÊï∞ÊçÆÈ°µÁöÑÂâ©‰ΩôÁ©∫Èó¥‰∏çË∂≥ÔºåÈúÄË¶ÅËøõË°åÈ°µÂàÜË£ÇÔºåÁî≥ËØ∑‰∏Ä‰∏™Êñ∞ÁöÑÈ°µÈù¢Êù•ÊèíÂÖ•Êï∞ÊçÆÔºå‰ºöÈÄ†ÊàêÊõ¥Â§öÁöÑ redo logÔºåundo log ÂΩ±Âìç‰∏çÂ§ß</p><p>ÂΩìÂêëÊüê‰∏™Ë°®ÊèíÂÖ•‰∏ÄÊù°ËÆ∞ÂΩïÔºåÂÆûÈôÖ‰∏äÈúÄË¶ÅÂêëËÅöÁ∞áÁ¥¢ÂºïÂíåÊâÄÊúâ‰∫åÁ∫ßÁ¥¢ÂºïÈÉΩÊèíÂÖ•‰∏ÄÊù°ËÆ∞ÂΩïÔºå‰ΩÜÊòØ undo log <strong>Âè™ÈíàÂØπËÅöÁ∞áÁ¥¢ÂºïËÆ∞ÂΩï</strong>ÔºåÂú®ÂõûÊªöÊó∂‰ºöÊ†πÊçÆËÅöÁ∞áÁ¥¢ÂºïÂéªÊâÄÊúâÁöÑ‰∫åÁ∫ßÁ¥¢ÂºïËøõË°åÂõûÊªöÊìç‰Ωú</p><p>roll_pointer ÊòØ‰∏Ä‰∏™ÊåáÈíàÔºå<strong>ÊåáÂêëËÆ∞ÂΩïÂØπÂ∫îÁöÑ undo log Êó•Âøó</strong>Ôºå‰∏ÄÊù°ËÆ∞ÂΩïÂ∞±ÊòØ‰∏Ä‰∏™Êï∞ÊçÆË°åÔºåË°åÊ†ºÂºè‰∏≠ÁöÑ roll_pointer Â∞±ÊåáÂêë undo log</p><hr><h5 id="delete-1" tabindex="-1"><a class="header-anchor" href="#delete-1"><span>DELETE</span></a></h5><p>ÊèíÂÖ•Âà∞È°µÈù¢‰∏≠ÁöÑËÆ∞ÂΩï‰ºöÊ†πÊçÆ next_record Â±ûÊÄßÁªÑÊàê‰∏Ä‰∏™ÂçïÂêëÈìæË°®ÔºåËøô‰∏™ÈìæË°®Áß∞‰∏∫Ê≠£Â∏∏ÈìæË°®ÔºåË¢´Âà†Èô§ÁöÑËÆ∞ÂΩï‰πü‰ºöÈÄöËøá next_record ÁªÑÊàê‰∏Ä‰∏™ÂûÉÂúæÈìæË°®ÔºåËØ•ÈìæË°®‰∏≠ÊâÄÂç†Áî®ÁöÑÂ≠òÂÇ®Á©∫Èó¥ÂèØ‰ª•Ë¢´ÈáçÊñ∞Âà©Áî®ÔºåÂπ∂‰∏ç‰ºöÁõ¥Êé•Ê∏ÖÈô§Êï∞ÊçÆ</p><p>Âú®È°µÈù¢ Page Header ‰∏≠ÔºåPAGE_FREE Â±ûÊÄßÊåáÂêëÂûÉÂúæÈìæË°®ÁöÑÂ§¥ËäÇÁÇπÔºåÂà†Èô§ÁöÑÂ∑•‰ΩúËøáÁ®ãÔºö</p><ul><li><p>Â∞ÜË¶ÅÂà†Èô§ÁöÑËÆ∞ÂΩïÁöÑ delete_flag ‰ΩçÁΩÆ‰∏∫ 1ÔºåÂÖ∂‰ªñ‰∏çÂÅö‰øÆÊîπÔºåËøô‰∏™ËøáÁ®ãÂè´ <strong>delete mark</strong></p></li><li><p>Âú®‰∫ãÂä°Êèê‰∫§ÂâçÔºådelete_flag = 1 ÁöÑËÆ∞ÂΩï‰∏ÄÁõ¥ÈÉΩ‰ºöÂ§Ñ‰∫é‰∏≠Èó¥Áä∂ÊÄÅ</p></li><li><p>‰∫ãÂä°Êèê‰∫§ÂêéÔºåÊúâ‰∏ìÈó®ÁöÑÁ∫øÁ®ãÂ∞Ü delete_flag = 1 ÁöÑËÆ∞ÂΩï‰ªéÊ≠£Â∏∏ÈìæË°®ÁßªÈô§Âπ∂Âä†ÂÖ•ÂûÉÂúæÈìæË°®ÔºåËøô‰∏™ËøáÁ®ãÂè´ <strong>purge</strong></p><p>purge Á∫øÁ®ãÂú®ÊâßË°åÂà†Èô§Êìç‰ΩúÊó∂‰ºöÂàõÂª∫‰∏Ä‰∏™ ReadViewÔºåÊ†πÊçÆ‰∫ãÂä°ÁöÑÂèØËßÅÊÄßÁßªÈô§Êï∞ÊçÆÔºàÈöîÁ¶ªÁâπÊÄßÈÉ®ÂàÜËØ¶Ëß£Ôºâ</p></li></ul><p>ÂΩìÊúâÊñ∞ÊèíÂÖ•ÁöÑËÆ∞ÂΩïÊó∂ÔºåÈ¶ñÂÖàÂà§Êñ≠ PAGE_FREE ÊåáÂêëÁöÑÂ§¥ËäÇÁÇπÊòØÂê¶Ë∂≥Â§üÂÆπÁ∫≥Êñ∞Á∫™ÂΩïÔºö</p><ul><li>Â¶ÇÊûúÂèØ‰ª•ÂÆπÁ∫≥Êñ∞Á∫™ÂΩïÔºåÂ∞±‰ºöÁõ¥Êé•ÈáçÁî®Â∑≤Âà†Èô§ÁöÑËÆ∞ÂΩïÁöÑÂ≠òÂÇ®Á©∫Èó¥ÔºåÁÑ∂ÂêéËÆ© PAGE_FREE ÊåáÂêëÂûÉÂúæÈìæË°®ÁöÑ‰∏ã‰∏Ä‰∏™ËäÇÁÇπ</li><li>Â¶ÇÊûú‰∏çËÉΩÂÆπÁ∫≥Êñ∞Á∫™ÂΩïÔºåÂ∞±Áõ¥Êé•ÂêëÈ°µÈù¢Áî≥ËØ∑Êñ∞ÁöÑÁ©∫Èó¥Â≠òÂÇ®ÔºåÂπ∂‰∏ç‰ºöÈÅçÂéÜÂûÉÂúæÈìæË°®</li></ul><p>ÈáçÁî®Â∑≤Âà†Èô§ÁöÑËÆ∞ÂΩïÁ©∫Èó¥ÔºåÂèØËÉΩ‰ºöÈÄ†ÊàêÁ©∫Èó¥Á¢éÁâáÔºåÂΩìÊï∞ÊçÆÈ°µÂÆπÁ∫≥‰∏ç‰∫Ü‰∏ÄÊù°ËÆ∞ÂΩïÊó∂Ôºå‰ºöÂà§Êñ≠Â∞ÜÁ¢éÁâáÁ©∫Èó¥Âä†Ëµ∑Êù•ÊòØÂê¶ÂèØ‰ª•ÂÆπÁ∫≥ÔºåÂà§Êñ≠‰∏∫ÁúüÂ∞±‰ºöÈáçÊñ∞ÁªÑÁªáÈ°µÂÜÖÁöÑËÆ∞ÂΩïÔºö</p><ul><li>ÂºÄËæü‰∏Ä‰∏™‰∏¥Êó∂È°µÈù¢ÔºåÂ∞ÜÈ°µÂÜÖËÆ∞ÂΩï‰∏ÄÊ¨°ÊèíÂÖ•Âà∞‰∏¥Êó∂È°µÈù¢ÔºåÊ≠§Êó∂‰∏¥Êó∂È°µÈù¢Êó∂Ê≤°ÊúâÁ¢éÁâáÁöÑ</li><li>Êää‰∏¥Êó∂È°µÈù¢ÁöÑÂÜÖÂÆπÂ§çÂà∂Âà∞Êú¨È°µÔºåËøôÊ†∑Â∞±Ëß£ÊîæÂá∫‰∫ÜÂÜÖÂ≠òÁ¢éÁâáÔºå‰ΩÜÊòØ‰ºöËÄóË¥πÂæàÂ§ßÁöÑÊÄßËÉΩËµÑÊ∫ê</li></ul><hr><h5 id="update-2" tabindex="-1"><a class="header-anchor" href="#update-2"><span>UPDATE</span></a></h5><p>ÊâßË°å UPDATE ËØ≠Âè•ÔºåÂØπ‰∫éÊõ¥Êñ∞‰∏ªÈîÆÂíå‰∏çÊõ¥Êñ∞‰∏ªÈîÆÊúâ‰∏§Áßç‰∏çÂêåÁöÑÂ§ÑÁêÜÊñπÂºè</p><p>‰∏çÊõ¥Êñ∞‰∏ªÈîÆÁöÑÊÉÖÂÜµÔºö</p><ul><li>Â∞±Âú∞Êõ¥Êñ∞Ôºàin-place updateÔºâÔºåÂ¶ÇÊûúÊõ¥Êñ∞ÂêéÁöÑÂàóÂíåÊõ¥Êñ∞ÂâçÁöÑÂàóÂç†Áî®ÁöÑÂ≠òÂÇ®Á©∫Èó¥‰∏ÄÊ†∑Â§ßÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•Âú®ÂéüËÆ∞ÂΩï‰∏ä‰øÆÊîπ</li><li>ÂÖàÂà†Èô§ÊóßÁ∫™ÂΩïÔºåÂÜçÊèíÂÖ•Êñ∞Á∫™ÂΩïÔºåËøôÈáåÁöÑÂà†Èô§‰∏çÊòØ delete markÔºåËÄåÊòØÁõ¥Êé•Â∞ÜËÆ∞ÂΩïÂä†ÂÖ•ÂûÉÂúæÈìæË°®ÔºåÂπ∂‰∏î‰øÆÊîπÈ°µÈù¢ÁöÑÁõ∏Â∫îÁöÑÊéßÂà∂‰ø°ÊÅØÔºåÊâßË°åÂà†Èô§ÁöÑÁ∫øÁ®ã‰∏çÊòØ purgeÔºåÊòØÊâßË°åÊõ¥Êñ∞ÁöÑÁî®Êà∑Á∫øÁ®ãÔºåÊèíÂÖ•Êñ∞ËÆ∞ÂΩïÊó∂ÂèØËÉΩÈÄ†ÊàêÈ°µÁ©∫Èó¥‰∏çË∂≥Ôºå‰ªéËÄåÂØºËá¥È°µÂàÜË£Ç</li></ul><p>Êõ¥Êñ∞‰∏ªÈîÆÁöÑÊÉÖÂÜµÔºö</p><ul><li>Â∞ÜÊóßÁ∫™ÂΩïËøõË°å delete markÔºåÂú®Êõ¥Êñ∞ËØ≠Âè•Êèê‰∫§ÂêéÁî± purge Á∫øÁ®ãÁßªÂÖ•ÂûÉÂúæÈìæË°®</li><li>Ê†πÊçÆÊõ¥Êñ∞ÁöÑÂêÑÂàóÁöÑÂÄºÂàõÂª∫‰∏ÄÊù°Êñ∞Á∫™ÂΩïÔºåÊèíÂÖ•Âà∞ËÅöÁ∞áÁ¥¢Âºï‰∏≠</li></ul><p>Âú®ÂØπ‰∏ÄÊù°ËÆ∞ÂΩï‰øÆÊîπÂâç‰ºö<strong>Â∞ÜËÆ∞ÂΩïÁöÑÈöêËóèÂàó trx_id Âíå roll_pointer ÁöÑÊóßÂÄºËÆ∞ÂΩïÂà∞ÂΩìÂâç undo log ÂØπÂ∫îÁöÑÂ±ûÊÄß‰∏≠</strong>ÔºåËøôÊ†∑ÂΩìÂâçËÆ∞ÂΩïÁöÑ roll_pointer ÊåáÂêëÂΩìÂâç undo log ËÆ∞ÂΩïÔºåÂΩìÂâç undo log ËÆ∞ÂΩïÁöÑ roll_pointer ÊåáÂêëÊóßÁöÑ undo log ËÆ∞ÂΩïÔºå<strong>ÂΩ¢Êàê‰∏Ä‰∏™ÁâàÊú¨Èìæ</strong></p><p>UPDATE„ÄÅDELETE Êìç‰Ωú‰∫ßÁîüÁöÑ undo Êó•Âøó‰ºöÁî®‰∫éÂÖ∂‰ªñ‰∫ãÂä°ÁöÑ MVCC Êìç‰ΩúÔºåÊâÄ‰ª•‰∏çËÉΩÁ´ãÂç≥Âà†Èô§ÔºåINSERT ÂèØ‰ª•Âà†Èô§ÁöÑÂéüÂõ†ÊòØ MVCC ÊòØÂØπÁé∞ÊúâÊï∞ÊçÆÁöÑÂø´ÁÖß</p><hr><h4 id="ÂõûÊªöÊó•Âøó" tabindex="-1"><a class="header-anchor" href="#ÂõûÊªöÊó•Âøó"><span>ÂõûÊªöÊó•Âøó</span></a></h4><p>undo log ÊòØÈááÁî®ÊÆµÁöÑÊñπÂºèÊù•ËÆ∞ÂΩïÔºåÂ≠òÊîæÂú®Rollback Segement ÔºàÂõûÊªöÊÆµÔºâÈáåÔºåÊú¨Ë¥®‰∏äÂ∞±ÊòØ‰∏Ä‰∏™Á±ªÂûãÊòØ Rollback Segement Header ÁöÑÈ°µÈù¢</p><p>ÊØè‰∏™ÂõûÊªöÊÆµ‰∏≠Êúâ 1024 ‰∏™ undo slotÔºåÊØè‰∏™ slot Â≠òÊîæ undo ÈìæË°®È°µÈù¢ÁöÑÂ§¥ËäÇÁÇπÈ°µÂè∑ÔºåÊØè‰∏™ÈìæË°®ÂØπÂ∫î‰∏Ä‰∏™Âè´ undo log segment ÁöÑÊÆµ</p><ul><li>Âú®‰ª•ÂâçËÄÅÁâàÊú¨ÔºåÂè™ÊîØÊåÅ 1 ‰∏™ Rollback SegementÔºåÂè™ËÉΩËÆ∞ÂΩï 1024 ‰∏™ undo log segment</li><li>MySQL5.5 ÂºÄÂßãÊîØÊåÅ 128 ‰∏™ Rollback SegementÔºåÊîØÊåÅ 128*1024 ‰∏™ undo Êìç‰Ωú</li><li>undo logÂú®‰∫ãÂä°ÊâßË°åÊó∂‰∫ßÁîüÔºå‰∫ãÂä°Êèê‰∫§Êó∂ÔºåÂπ∂‰∏ç‰ºöÁ´ãÂç≥Âà†Èô§undo logÔºåÂõ†‰∏∫Ëøô‰∫õÊó•ÂøóÂèØËÉΩËøòÁî®‰∫éMVCC„ÄÇ</li></ul><p>Â∑•‰ΩúÊµÅÁ®ãÔºö</p><ul><li><p>‰∫ãÂä°ÊâßË°åÂâçÈúÄË¶ÅÂà∞Á≥ªÁªüË°®Á©∫Èó¥Á¨¨ 5 Âè∑È°µÈù¢‰∏≠ÂàÜÈÖç‰∏Ä‰∏™ÂõûÊªöÊÆµÔºàÈ°µÔºâÔºåËé∑Âèñ‰∏Ä‰∏™ Rollback Segement Header È°µÈù¢ÁöÑÂú∞ÂùÄ</p></li><li><p>ÂõûÊªöÊÆµÈ°µÈù¢Êúâ 1024 ‰∏™ undo slotÔºåÈ¶ñÂÖàÂéªÂõûÊªöÊÆµÁöÑ‰∏§‰∏™ cached ÈìæË°®Ëé∑ÂèñÁºìÂ≠òÁöÑ slotÔºåÁºìÂ≠ò‰∏≠Ê≤°ÊúâÂ∞±Âú®ÂõûÊªöÊÆµÈ°µÈù¢‰∏≠Êâæ‰∏Ä‰∏™ÂèØÁî®ÁöÑ undo slot ÂàÜÈÖçÁªôÂΩìÂâç‰∫ãÂä°</p></li><li><p>Â¶ÇÊûúÊòØÁºìÂ≠ò‰∏≠Ëé∑ÂèñÁöÑ slotÔºåÂàôËØ• slot ÂØπÂ∫îÁöÑ undo log segment Â∑≤ÁªèÂàÜÈÖç‰∫ÜÔºåÈúÄË¶ÅÈáçÊñ∞ÂàÜÈÖçÔºåÁÑ∂Âêé‰ªé undo log segment ‰∏≠Áî≥ËØ∑‰∏Ä‰∏™È°µÈù¢‰Ωú‰∏∫Êó•ÂøóÈìæË°®ÁöÑÂ§¥ËäÇÁÇπÔºåÂπ∂Â°´ÂÖ•ÂØπÂ∫îÁöÑ slot ‰∏≠</p></li><li><p>ÊØè‰∏™‰∫ãÂä° undo Êó•ÂøóÂú®ËÆ∞ÂΩïÁöÑÊó∂ÂÄô<strong>Âç†Áî®‰∏§‰∏™ undo È°µÈù¢ÁöÑÁªÑÊàêÈìæË°®</strong>ÔºåÂàÜÂà´‰∏∫ insert undo ÈìæË°®Âíå update undo ÈìæË°®ÔºåÈìæË°®ÁöÑÂ§¥ËäÇÁÇπÈ°µÈù¢‰∏∫ first undo page ‰ºöÂåÖÂê´‰∏Ä‰∫õÁÆ°ÁêÜ‰ø°ÊÅØÔºåÂÖ∂‰ªñÈ°µÈù¢‰∏∫ normal undo page</p><p>ËØ¥ÊòéÔºö‰∫ãÂä°ÊâßË°åËøáÁ®ãÁöÑ‰∏¥Êó∂Ë°®‰πüÈúÄË¶Å‰∏§‰∏™ undo ÈìæË°®Ôºå‰∏çÂíåÊôÆÈÄöË°®ÂÖ±Áî®ÔºåËøô‰∫õÈìæË°®Âπ∂‰∏çÊòØ‰∫ãÂä°ÂºÄÂßãÂ∞±ÂàÜÈÖçÔºåËÄåÊòØÊåâÈúÄÂàÜÈÖç</p></li></ul><hr><h3 id="ÈöîÁ¶ªÁâπÊÄß" tabindex="-1"><a class="header-anchor" href="#ÈöîÁ¶ªÁâπÊÄß"><span>ÈöîÁ¶ªÁâπÊÄß</span></a></h3><h4 id="ÂÆûÁé∞ÊñπÂºè-1" tabindex="-1"><a class="header-anchor" href="#ÂÆûÁé∞ÊñπÂºè-1"><span>ÂÆûÁé∞ÊñπÂºè</span></a></h4><p>ÈöîÁ¶ªÊÄßÊòØÊåáÔºå‰∫ãÂä°ÂÜÖÈÉ®ÁöÑÊìç‰Ωú‰∏éÂÖ∂‰ªñ‰∫ãÂä°ÊòØÈöîÁ¶ªÁöÑÔºåÂ§ö‰∏™Âπ∂Âèë‰∫ãÂä°‰πãÈó¥Ë¶ÅÁõ∏‰∫íÈöîÁ¶ªÔºå‰∏çËÉΩ‰∫íÁõ∏Âπ≤Êâ∞</p><ul><li>‰∏•Ê†ºÁöÑÈöîÁ¶ªÊÄßÔºåÂØπÂ∫î‰∫Ü‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´‰∏≠ÁöÑ serializableÔºåÂÆûÈôÖÂ∫îÁî®‰∏≠ÂØπÊÄßËÉΩËÄÉËôëÂæàÂ∞ë‰ΩøÁî®ÂèØ‰∏≤Ë°åÂåñ</li><li>‰∏éÂéüÂ≠êÊÄß„ÄÅÊåÅ‰πÖÊÄß‰æßÈáç‰∫éÁ†îÁ©∂‰∫ãÂä°Êú¨Ë∫´‰∏çÂêåÔºåÈöîÁ¶ªÊÄßÁ†îÁ©∂ÁöÑÊòØ<strong>‰∏çÂêå‰∫ãÂä°</strong>‰πãÈó¥ÁöÑÁõ∏‰∫íÂΩ±Âìç</li></ul><p>ÈöîÁ¶ªÊÄßËÆ©Âπ∂ÂèëÊÉÖÂΩ¢‰∏ãÁöÑ‰∫ãÂä°‰πãÈó¥‰∫í‰∏çÂπ≤Êâ∞Ôºö</p><ul><li>‰∏Ä‰∏™‰∫ãÂä°ÁöÑÂÜôÊìç‰ΩúÂØπÂè¶‰∏Ä‰∏™‰∫ãÂä°ÁöÑÂÜôÊìç‰ΩúÔºàÂÜôÂÜôÔºâÔºöÈîÅÊú∫Âà∂‰øùËØÅÈöîÁ¶ªÊÄß</li><li>‰∏Ä‰∏™‰∫ãÂä°ÁöÑÂÜôÊìç‰ΩúÂØπÂè¶‰∏Ä‰∏™‰∫ãÂä°ÁöÑËØªÊìç‰ΩúÔºàËØªÂÜôÔºâÔºöMVCC ‰øùËØÅÈöîÁ¶ªÊÄß</li></ul><p>ÈîÅÊú∫Âà∂Ôºö‰∫ãÂä°Âú®‰øÆÊîπÊï∞ÊçÆ‰πãÂâçÔºåÈúÄË¶ÅÂÖàËé∑ÂæóÁõ∏Â∫îÁöÑÈîÅÔºåËé∑ÂæóÈîÅ‰πãÂêéÔºå‰∫ãÂä°‰æøÂèØ‰ª•‰øÆÊîπÊï∞ÊçÆÔºõËØ•‰∫ãÂä°Êìç‰ΩúÊúüÈó¥ÔºåËøôÈÉ®ÂàÜÊï∞ÊçÆÊòØÈîÅÂÆöÁöÑÔºåÂÖ∂‰ªñ‰∫ãÂä°Â¶ÇÊûúÈúÄË¶Å‰øÆÊîπÊï∞ÊçÆÔºåÈúÄË¶ÅÁ≠âÂæÖÂΩìÂâç‰∫ãÂä°Êèê‰∫§ÊàñÂõûÊªöÂêéÈáäÊîæÈîÅÔºàËØ¶Ëß£ËßÅÈîÅÊú∫Âà∂Ôºâ</p><hr><h4 id="mvccÂπ∂ÂèëÊéßÂà∂" tabindex="-1"><a class="header-anchor" href="#mvccÂπ∂ÂèëÊéßÂà∂"><span>MVCCÂπ∂ÂèëÊéßÂà∂</span></a></h4><p>MVCC ÂÖ®Áß∞ Multi-Version Concurrency ControlÔºåÂç≥Â§öÁâàÊú¨Âπ∂ÂèëÊéßÂà∂ÔºåÁî®Êù•<strong>Ëß£ÂÜ≥ËØªÂÜôÂÜ≤Á™ÅÁöÑÊó†ÈîÅÂπ∂ÂèëÊéßÂà∂</strong>ÔºåÂèØ‰ª•Âú®ÂèëÁîüËØªÂÜôËØ∑Ê±ÇÂÜ≤Á™ÅÊó∂‰∏çÁî®Âä†ÈîÅËß£ÂÜ≥ÔºåËøô‰∏™ËØªÊòØÊåáÁöÑÂø´ÁÖßËØªÔºà‰πüÂè´‰∏ÄËá¥ÊÄßËØªÊàñ‰∏ÄËá¥ÊÄßÊó†ÈîÅËØªÔºâÔºåËÄå‰∏çÊòØÂΩìÂâçËØª„ÄÇMVCCÁöÑÂÖ∑‰ΩìÂÆûÁé∞ÔºåËøòÈúÄË¶Å‰æùËµñ‰∫éÊï∞ÊçÆÂ∫ìËÆ∞ÂΩï‰∏≠ÁöÑ‰∏â‰∏™ÈöêÂºèÂ≠óÊÆµ„ÄÅundo logÊó•Âøó„ÄÅreadView„ÄÇ</p><ul><li>Âø´ÁÖßËØªÔºöÂÆûÁé∞Âü∫‰∫é MVCCÔºåÂõ†‰∏∫ÊòØÂ§öÁâàÊú¨Âπ∂ÂèëÔºåÊâÄ‰ª•Âø´ÁÖßËØªËØªÂà∞ÁöÑÊï∞ÊçÆ‰∏ç‰∏ÄÂÆöÊòØÂΩìÂâçÊúÄÊñ∞ÁöÑÊï∞ÊçÆÔºåÊúâÂèØËÉΩÊòØÂéÜÂè≤ÁâàÊú¨ÁöÑÊï∞ÊçÆÔºåÁÆÄÂçïÁöÑselectÔºà‰∏çÂä†ÈîÅÔºâÂ∞±ÊòØÂø´ÁÖßËØªÔºåËØªÂèñÁöÑÊòØËÆ∞ÂΩïÊï∞ÊçÆÁöÑÂèØËßÅÁâàÊú¨ÔºåÊúâÂèØËÉΩÊòØÂéÜÂè≤Êï∞ÊçÆÔºå‰∏çÂä†ÈîÅÔºåÊòØÈùûÈòªÂ°ûËØª„ÄÇ ‚Ä¢ Read CommittedÔºöÊØèÊ¨°selectÔºåÈÉΩÁîüÊàê‰∏Ä‰∏™Âø´ÁÖßËØª„ÄÇ ‚Ä¢ Repeatable ReadÔºöÂºÄÂêØ‰∫ãÂä°ÂêéÁ¨¨‰∏Ä‰∏™selectËØ≠Âè•ÊâçÊòØÂø´ÁÖßËØªÁöÑÂú∞Êñπ„ÄÇ ‚Ä¢ SerializableÔºöÂø´ÁÖßËØª‰ºöÈÄÄÂåñ‰∏∫ÂΩìÂâçËØª„ÄÇ</li><li>ÂΩìÂâçËØªÔºöÂèàÂè´Âä†ÈîÅËØªÔºåËØªÂèñÊï∞ÊçÆÂ∫ìËÆ∞ÂΩïÊòØÂΩìÂâç<strong>ÊúÄÊñ∞ÁöÑÁâàÊú¨</strong>Ôºà‰∫ßÁîüÂπªËØª„ÄÅ‰∏çÂèØÈáçÂ§çËØªÔºâÔºåÂèØ‰ª•ÂØπËØªÂèñÁöÑÊï∞ÊçÆËøõË°åÂä†ÈîÅÔºåÈò≤Ê≠¢ÂÖ∂‰ªñ‰∫ãÂä°‰øÆÊîπÊï∞ÊçÆÔºåÊòØÊÇ≤ËßÇÈîÅÁöÑ‰∏ÄÁßçÊìç‰ΩúÔºåËØªÂÜôÊìç‰ΩúÂä†ÂÖ±‰∫´ÈîÅÊàñËÄÖÊéí‰ªñÈîÅÂíå‰∏≤Ë°åÂåñ‰∫ãÂä°ÁöÑÈöîÁ¶ªÁ∫ßÂà´ÈÉΩÊòØÂΩìÂâçËØª„ÄÇ</li></ul><p>Êï∞ÊçÆÂ∫ìÂπ∂ÂèëÂú∫ÊôØÔºö</p><ul><li>ËØª-ËØªÔºö‰∏çÂ≠òÂú®‰ªª‰ΩïÈóÆÈ¢òÔºå‰πü‰∏çÈúÄË¶ÅÂπ∂ÂèëÊéßÂà∂</li><li>ËØª-ÂÜôÔºöÊúâÁ∫øÁ®ãÂÆâÂÖ®ÈóÆÈ¢òÔºåÂèØËÉΩ‰ºöÈÄ†Êàê‰∫ãÂä°ÈöîÁ¶ªÊÄßÈóÆÈ¢òÔºåÂèØËÉΩÈÅáÂà∞ËÑèËØªÔºåÂπªËØªÔºå‰∏çÂèØÈáçÂ§çËØª</li><li>ÂÜô-ÂÜôÔºöÊúâÁ∫øÁ®ãÂÆâÂÖ®ÈóÆÈ¢òÔºåÂèØËÉΩ‰ºöÂ≠òÂú®ËÑèÂÜôÔºà‰∏¢Â§±Êõ¥Êñ∞ÔºâÈóÆÈ¢ò</li></ul><p>MVCC ÁöÑ‰ºòÁÇπÔºö</p><ul><li>Âú®Âπ∂ÂèëËØªÂÜôÊï∞ÊçÆÂ∫ìÊó∂ÔºåÂÅöÂà∞Âú®ËØªÊìç‰ΩúÊó∂‰∏çÁî®ÈòªÂ°ûÂÜôÊìç‰ΩúÔºåÂÜôÊìç‰Ωú‰πü‰∏çÁî®ÈòªÂ°ûËØªÊìç‰ΩúÔºåÊèêÈ´ò‰∫ÜÂπ∂ÂèëËØªÂÜôÁöÑÊÄßËÉΩ</li><li>ÂèØ‰ª•Ëß£ÂÜ≥ËÑèËØªÔºå‰∏çÂèØÈáçÂ§çËØªÁ≠â‰∫ãÂä°ÈöîÁ¶ªÈóÆÈ¢òÔºàÂä†ÈîÅ‰πüËÉΩËß£ÂÜ≥ÔºâÔºå‰ΩÜ‰∏çËÉΩËß£ÂÜ≥Êõ¥Êñ∞‰∏¢Â§±ÈóÆÈ¢òÔºàÂÜôÈîÅ‰ºöËß£ÂÜ≥Ôºâ</li></ul><p>ÊèêÈ´òËØªÂÜôÂíåÂÜôÂÜôÁöÑÂπ∂ÂèëÊÄßËÉΩÔºö</p><ul><li>MVCC + ÊÇ≤ËßÇÈîÅÔºöMVCC Ëß£ÂÜ≥ËØªÂÜôÂÜ≤Á™ÅÔºåÊÇ≤ËßÇÈîÅËß£ÂÜ≥ÂÜôÂÜôÂÜ≤Á™Å</li><li>MVCC + ‰πêËßÇÈîÅÔºöMVCC Ëß£ÂÜ≥ËØªÂÜôÂÜ≤Á™ÅÔºå‰πêËßÇÈîÅËß£ÂÜ≥ÂÜôÂÜôÂÜ≤Á™Å</li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://www.jianshu.com/p/8845ddca3b23</p><hr><h4 id="ÂÆûÁé∞ÂéüÁêÜ" tabindex="-1"><a class="header-anchor" href="#ÂÆûÁé∞ÂéüÁêÜ"><span>ÂÆûÁé∞ÂéüÁêÜ</span></a></h4><h5 id="ÈöêËóèÂ≠óÊÆµ" tabindex="-1"><a class="header-anchor" href="#ÈöêËóèÂ≠óÊÆµ"><span>ÈöêËóèÂ≠óÊÆµ</span></a></h5><p>ÂÆûÁé∞ÂéüÁêÜ‰∏ªË¶ÅÊòØÈöêËóèÂ≠óÊÆµÔºåundoÊó•ÂøóÔºåRead View Êù•ÂÆûÁé∞ÁöÑ</p><p>InnoDB Â≠òÂÇ®ÂºïÊìéÔºåÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑ<strong>ËÅöÁ∞áÁ¥¢Âºï</strong>ÊØèË°åÊï∞ÊçÆÔºåÈô§‰∫ÜËá™ÂÆö‰πâÁöÑÂ≠óÊÆµÔºåËøòÊúâÊï∞ÊçÆÂ∫ìÈöêÂºèÂÆö‰πâÁöÑÂ≠óÊÆµÔºö</p><ul><li>DB_TRX_IDÔºöÊúÄËøë‰øÆÊîπ‰∫ãÂä° IDÔºåËÆ∞ÂΩïÂàõÂª∫ËØ•Êï∞ÊçÆÊàñÊúÄÂêé‰∏ÄÊ¨°‰øÆÊîπËØ•Êï∞ÊçÆÁöÑ‰∫ãÂä° ID</li><li>DB_ROLL_PTRÔºöÂõûÊªöÊåáÈíàÔºå<strong>ÊåáÂêëËÆ∞ÂΩïÂØπÂ∫îÁöÑ undo log Êó•Âøó</strong>Ôºåundo log ‰∏≠ÂèàÊåáÂêë‰∏ä‰∏Ä‰∏™ÊóßÁâàÊú¨ÁöÑ undo log</li><li>DB_ROW_IDÔºöÈöêÂê´ÁöÑËá™Â¢û IDÔºà<strong>ÈöêËóè‰∏ªÈîÆ</strong>ÔºâÔºåÂ¶ÇÊûúÊï∞ÊçÆË°®Ê≤°Êúâ‰∏ªÈîÆÔºåInnoDB ‰ºöËá™Âä®‰ª• DB_ROW_ID ‰Ωú‰∏∫ËÅöÁ∞áÁ¥¢Âºï</li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MVCCÁâàÊú¨ÈìæÈöêËóèÂ≠óÊÆµ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ÊµãËØï</p><p>1). Êü•ÁúãÊúâ‰∏ªÈîÆÁöÑË°® stu ËøõÂÖ•ÊúçÂä°Âô®‰∏≠ÁöÑ /var/lib/mysql/itcast/ , Êü•ÁúãstuÁöÑË°®ÁªìÊûÑ‰ø°ÊÅØ, ÈÄöËøáÂ¶Ç‰∏ãÊåá‰ª§:</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>ibd2sdi stu.ibd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Êü•ÁúãÂà∞ÁöÑË°®ÁªìÊûÑ‰ø°ÊÅØ‰∏≠ÔºåÊúâ‰∏ÄÊ†è columnsÔºåÂú®ÂÖ∂‰∏≠Êàë‰ª¨‰ºöÁúãÂà∞Â§ÑÁêÜÊàë‰ª¨Âª∫Ë°®Êó∂ÊåáÂÆöÁöÑÂ≠óÊÆµ‰ª•Â§ñÔºåËøòÊúâÈ¢ùÂ§ñÁöÑ‰∏§‰∏™Â≠óÊÆµ ÂàÜÂà´ÊòØÔºöDB_TRX_ID „ÄÅ DB_ROLL_PTR ÔºåÂõ†‰∏∫ËØ•Ë°®Êúâ‰∏ªÈîÆÔºåÊâÄ‰ª•Ê≤°ÊúâDB_ROW_IDÈöêËóèÂ≠óÊÆµ„ÄÇ</p><hr><h5 id="ÁâàÊú¨Èìæ" tabindex="-1"><a class="header-anchor" href="#ÁâàÊú¨Èìæ"><span>ÁâàÊú¨Èìæ</span></a></h5><p>undo log ÊòØÈÄªËæëÊó•ÂøóÔºåËÆ∞ÂΩïÁöÑÊòØÊØè‰∏™‰∫ãÂä°ÂØπÊï∞ÊçÆÊâßË°åÁöÑÊìç‰ΩúÔºåËÄå‰∏çÊòØËÆ∞ÂΩïÁöÑÂÖ®ÈÉ®Êï∞ÊçÆÔºåË¶Å<strong>Ê†πÊçÆ undo log ÈÄÜÊé®Âá∫‰ª•ÂæÄ‰∫ãÂä°ÁöÑÊï∞ÊçÆ</strong></p><p>undo log ÁöÑ‰ΩúÁî®Ôºö</p><ul><li>‰øùËØÅ‰∫ãÂä°ËøõË°å rollback Êó∂ÁöÑÂéüÂ≠êÊÄßÂíå‰∏ÄËá¥ÊÄßÔºåÂΩì‰∫ãÂä°ËøõË°åÂõûÊªöÁöÑÊó∂ÂÄôÂèØ‰ª•Áî® undo log ÁöÑÊï∞ÊçÆËøõË°åÊÅ¢Â§ç</li><li>Áî®‰∫é MVCC Âø´ÁÖßËØªÔºåÈÄöËøáËØªÂèñ undo log ÁöÑÂéÜÂè≤ÁâàÊú¨Êï∞ÊçÆÂèØ‰ª•ÂÆûÁé∞‰∏çÂêå‰∫ãÂä°ÁâàÊú¨Âè∑ÈÉΩÊã•ÊúâËá™Â∑±Áã¨Á´ãÁöÑÂø´ÁÖßÊï∞ÊçÆ</li></ul><p>undo log ‰∏ªË¶ÅÂàÜ‰∏∫‰∏§ÁßçÔºö</p><ul><li>insert undo logÔºö‰∫ãÂä°Âú® insert Êñ∞ËÆ∞ÂΩïÊó∂‰∫ßÁîüÁöÑ undo logÔºåÂè™Âú®‰∫ãÂä°ÂõûÊªöÊó∂ÈúÄË¶ÅÔºåÂπ∂‰∏îÂú®‰∫ãÂä°Êèê‰∫§ÂêéÂèØ‰ª•Ë¢´Á´ãÂç≥‰∏¢ÂºÉ</li><li>update undo logÔºö‰∫ãÂä°Âú®ËøõË°å update Êàñ delete Êó∂‰∫ßÁîüÁöÑ undo logÔºåÂú®‰∫ãÂä°ÂõûÊªöÊó∂ÈúÄË¶ÅÔºåÂú®Âø´ÁÖßËØªÊó∂‰πüÈúÄË¶Å„ÄÇ‰∏çËÉΩÈöèÊÑèÂà†Èô§ÔºåÂè™ÊúâÂú®ÂΩìÂâçËØªÊàñ‰∫ãÂä°ÂõûÊªö‰∏çÊ∂âÂèäËØ•Êó•ÂøóÊó∂ÔºåÂØπÂ∫îÁöÑÊó•ÂøóÊâç‰ºöË¢´ purge Á∫øÁ®ãÁªü‰∏ÄÊ∏ÖÈô§</li></ul><p>ÊØèÊ¨°ÂØπÊï∞ÊçÆÂ∫ìËÆ∞ÂΩïËøõË°åÊîπÂä®ÔºåÈÉΩ‰ºö‰∫ßÁîüÁöÑÊñ∞ÁâàÊú¨ÁöÑ undo logÔºåÈöèÁùÄÊõ¥Êñ∞Ê¨°Êï∞ÁöÑÂ¢ûÂ§öÔºåÊâÄÊúâÁöÑÁâàÊú¨ÈÉΩ‰ºöË¢´ roll_pointer Â±ûÊÄßËøûÊé•Êàê‰∏Ä‰∏™ÈìæË°®ÔºåÊääËøô‰∏™ÈìæË°®Áß∞‰πã‰∏∫<strong>ÁâàÊú¨Èìæ</strong>ÔºåÁâàÊú¨ÈìæÁöÑÂ§¥ËäÇÁÇπÂ∞±ÊòØÂΩìÂâçÁöÑÊúÄÊñ∞ÁöÑ undo logÔºåÈìæÂ∞æÂ∞±ÊòØÊúÄÊó©ÁöÑÊóß undo log</p><p>ËØ¥ÊòéÔºöÂõ†‰∏∫ DELETE Âà†Èô§ËÆ∞ÂΩïÔºåÈÉΩÊòØÁßªÂä®Âà∞ÂûÉÂúæÈìæË°®‰∏≠Ôºå‰∏çÊòØÁúüÊ≠£ÁöÑÂà†Èô§ÔºåÊâÄ‰ª•ÊâçÂèØ‰ª•ÈÄöËøáÁâàÊú¨ÈìæËÆøÈóÆÂéüÂßãÊï∞ÊçÆ</p><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MVCCÁâàÊú¨Èìæ.png" style="zoom:80%;"><p>Ê≥®ÊÑèÔºöundo ÊòØÈÄªËæëÊó•ÂøóÔºåËøôÈáåÂè™ÊòØÁõ¥ËßÇÁöÑÂ±ïÁ§∫Âá∫Êù•</p><p>Â∑•‰ΩúÊµÅÁ®ãÔºö</p><ul><li>Êúâ‰∏™‰∫ãÂä°ÊèíÂÖ• persion Ë°®‰∏ÄÊù°Êñ∞ËÆ∞ÂΩïÔºåname ‰∏∫ JerryÔºåage ‰∏∫ 24</li><li>‰∫ãÂä° 1 ‰øÆÊîπËØ•Ë°åÊï∞ÊçÆÊó∂ÔºåÊï∞ÊçÆÂ∫ì‰ºöÂÖàÂØπËØ•Ë°åÂä†Êéí‰ªñÈîÅÔºåÁÑ∂ÂêéÂÖàËÆ∞ÂΩï undo logÔºåÁÑ∂Âêé‰øÆÊîπËØ•Ë°å name ‰∏∫ TomÔºåÂπ∂‰∏î‰øÆÊîπÈöêËóèÂ≠óÊÆµÁöÑ‰∫ãÂä° ID ‰∏∫ÂΩìÂâç‰∫ãÂä° 1 ÁöÑ IDÔºàÈªòËÆ§‰∏∫ 1 ‰πãÂêéÈÄíÂ¢ûÔºâÔºåÂõûÊªöÊåáÈíàÊåáÂêëÊã∑Ë¥ùÂà∞ undo log ÁöÑÂâØÊú¨ËÆ∞ÂΩïÔºå‰∫ãÂä°Êèê‰∫§ÂêéÔºåÈáäÊîæÈîÅ</li><li>‰ª•Ê≠§Á±ªÊé®</li></ul><hr><h5 id="ËØªËßÜÂõæ" tabindex="-1"><a class="header-anchor" href="#ËØªËßÜÂõæ"><span>ËØªËßÜÂõæ</span></a></h5><p>Read View ÊòØ‰∫ãÂä°ËøõË°åËØªÊï∞ÊçÆÊìç‰ΩúÊó∂‰∫ßÁîüÁöÑËØªËßÜÂõæÔºåËØ•‰∫ãÂä°ÊâßË°åÂø´ÁÖßËØªÁöÑÈÇ£‰∏ÄÂàª‰ºöÁîüÊàêÊï∞ÊçÆÂ∫ìÁ≥ªÁªüÂΩìÂâçÁöÑ‰∏Ä‰∏™Âø´ÁÖßÔºåËÆ∞ÂΩïÂπ∂Áª¥Êä§Á≥ªÁªüÂΩìÂâçÊ¥ªË∑É‰∫ãÂä°ÁöÑ IDÔºåÁî®Êù•ÂÅöÂèØËßÅÊÄßÂà§Êñ≠ÔºåÊ†πÊçÆËßÜÂõæÂà§Êñ≠ÂΩìÂâç‰∫ãÂä°ËÉΩÂ§üÁúãÂà∞Âì™‰∏™ÁâàÊú¨ÁöÑÊï∞ÊçÆ</p><p>Ê≥®ÊÑèÔºöËøôÈáåÁöÑÂø´ÁÖßÂπ∂‰∏çÊòØÊääÊâÄÊúâÁöÑÊï∞ÊçÆÊã∑Ë¥ù‰∏Ä‰ªΩÂâØÊú¨ÔºåËÄåÊòØÁî± undo log ËÆ∞ÂΩïÁöÑÈÄªËæëÊó•ÂøóÔºåÊ†πÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆËøõË°åËÆ°ÁÆóÂá∫ÂéÜÂè≤Êï∞ÊçÆ</p><p>Â∑•‰ΩúÊµÅÁ®ãÔºöÂ∞ÜÁâàÊú¨ÈìæÁöÑÂ§¥ËäÇÁÇπÁöÑ‰∫ãÂä° IDÔºàÊúÄÊñ∞Êï∞ÊçÆ‰∫ãÂä° IDÔºåÂ§ßÊ¶ÇÁéá‰∏çÊòØÂΩìÂâçÁ∫øÁ®ãÔºâDB_TRX_ID ÂèñÂá∫Êù•Ôºå‰∏éÁ≥ªÁªüÂΩìÂâçÊ¥ªË∑É‰∫ãÂä°ÁöÑ ID ÂØπÊØîËøõË°åÂèØËßÅÊÄßÂàÜÊûêÔºå‰∏çÂèØËßÅÂ∞±ÈÄöËøá DB_ROLL_PTR ÂõûÊªöÊåáÈíàÂéªÂèñÂá∫ undo log ‰∏≠ÁöÑ‰∏ã‰∏Ä‰∏™ DB_TRX_ID ÊØîËæÉÔºåÁõ¥Âà∞ÊâæÂà∞ÊúÄËøëÁöÑÊª°Ë∂≥ÂèØËßÅÊÄßÁöÑ DB_TRX_IDÔºåËØ•‰∫ãÂä° ID ÊâÄÂú®ÁöÑÊóßËÆ∞ÂΩïÂ∞±ÊòØÂΩìÂâç‰∫ãÂä°ËÉΩÁúãËßÅÁöÑÊúÄÊñ∞ÁöÑËÆ∞ÂΩï</p><p>Read View Âá†‰∏™Â±ûÊÄßÔºö</p><ul><li>m_idsÔºöÁîüÊàê Read View Êó∂ÂΩìÂâçÁ≥ªÁªü‰∏≠Ê¥ªË∑ÉÁöÑ‰∫ãÂä° id ÂàóË°®ÔºàÊú™Êèê‰∫§ÁöÑ‰∫ãÂä°ÈõÜÂêàÔºåÂΩìÂâç‰∫ãÂä°‰πüÂú®ÂÖ∂‰∏≠Ôºâ</li><li>min_trx_idÔºöÁîüÊàê Read View Êó∂ÂΩìÂâçÁ≥ªÁªü‰∏≠Ê¥ªË∑ÉÁöÑÊúÄÂ∞èÁöÑ‰∫ãÂä° idÔºå‰πüÂ∞±ÊòØ m_ids ‰∏≠ÁöÑÊúÄÂ∞èÂÄºÔºàÂ∑≤Êèê‰∫§ÁöÑ‰∫ãÂä°ÈõÜÂêàÔºâ</li><li>max_trx_idÔºöÁîüÊàê Read View Êó∂ÂΩìÂâçÁ≥ªÁªüÂ∫îËØ•ÂàÜÈÖçÁªô‰∏ã‰∏Ä‰∏™‰∫ãÂä°ÁöÑ id ÂÄºÔºåm_ids ‰∏≠ÁöÑÊúÄÂ§ßÂÄºÂä† 1ÔºàÊú™ÂºÄÂßã‰∫ãÂä°Ôºâ</li><li>creator_trx_idÔºöÁîüÊàêËØ• Read View ÁöÑ‰∫ãÂä°ÁöÑ‰∫ãÂä° idÔºåÂ∞±ÊòØÂà§Êñ≠ËØ• id ÁöÑ‰∫ãÂä°ËÉΩËØªÂà∞‰ªÄ‰πàÊï∞ÊçÆ</li></ul><p>creator ÂàõÂª∫‰∏Ä‰∏™ Read ViewÔºåËøõË°åÂèØËßÅÊÄßÁÆóÊ≥ïÂàÜÊûêÔºöÔºàËß£ÂÜ≥‰∫ÜËØªÊú™Êèê‰∫§Ôºâ</p><ul><li>db_trx_id == creator_trx_idÔºöË°®Á§∫Ëøô‰∏™Êï∞ÊçÆÂ∞±ÊòØÂΩìÂâç‰∫ãÂä°Ëá™Â∑±ÁîüÊàêÁöÑÔºåËá™Â∑±ÁîüÊàêÁöÑÊï∞ÊçÆËá™Â∑±ËÇØÂÆöËÉΩÁúãËßÅÔºåÊâÄ‰ª•Ê≠§Êï∞ÊçÆÂØπ creator ÊòØÂèØËßÅÁöÑ</li><li>db_trx_id &lt; min_trx_idÔºöËØ•ÁâàÊú¨ÂØπÂ∫îÁöÑ‰∫ãÂä° ID Â∞è‰∫é Read view ‰∏≠ÁöÑÊúÄÂ∞èÊ¥ªË∑É‰∫ãÂä° IDÔºåÂàôËøô‰∏™‰∫ãÂä°Âú®ÂΩìÂâç‰∫ãÂä°‰πãÂâçÂ∞±Â∑≤ÁªèË¢´Êèê‰∫§‰∫ÜÔºåÂØπ creator ÂèØËßÅÔºàÂõ†‰∏∫ÊØîÂ∑≤Êèê‰∫§ÁöÑÊúÄÂ§ß‰∫ãÂä° ID Â∞èÁöÑÂπ∂‰∏ç‰∏ÄÂÆöÂ∑≤ÁªèÊèê‰∫§ÔºåÊâÄ‰ª•Â∫îËØ•Âà§Êñ≠ÊòØÂê¶Âú®Ê¥ªË∑É‰∫ãÂä°ÂàóË°®Ôºâ</li><li>db_trx_id &gt;= max_trx_idÔºöËØ•ÁâàÊú¨ÂØπÂ∫îÁöÑ‰∫ãÂä° ID Â§ß‰∫é Read view ‰∏≠ÂΩìÂâçÁ≥ªÁªüÁöÑÊúÄÂ§ß‰∫ãÂä° IDÔºåÂàôËØ¥ÊòéËØ•Êï∞ÊçÆÊòØÂú®ÂΩìÂâç Read view ÂàõÂª∫‰πãÂêéÊâç‰∫ßÁîüÁöÑÔºåÂØπ creator ‰∏çÂèØËßÅ</li><li>min_trx_id&lt;= db_trx_id &lt; max_trx_idÔºöÂà§Êñ≠ db_trx_id ÊòØÂê¶Âú®Ê¥ªË∑É‰∫ãÂä°ÂàóË°® m_ids ‰∏≠ <ul><li>Âú®ÂàóË°®‰∏≠ÔºåËØ¥ÊòéËØ•ÁâàÊú¨ÂØπÂ∫îÁöÑ‰∫ãÂä°Ê≠£Âú®ËøêË°åÔºåÊï∞ÊçÆ‰∏çËÉΩÊòæÁ§∫Ôºà<strong>‰∏çËÉΩËØªÂà∞Êú™Êèê‰∫§ÁöÑÊï∞ÊçÆ</strong>Ôºâ</li><li>‰∏çÂú®ÂàóË°®‰∏≠ÔºåËØ¥ÊòéËØ•ÁâàÊú¨ÂØπÂ∫îÁöÑ‰∫ãÂä°Â∑≤ÁªèË¢´Êèê‰∫§ÔºåÊï∞ÊçÆÂèØ‰ª•ÊòæÁ§∫Ôºà<strong>ÂèØ‰ª•ËØªÂà∞Â∑≤ÁªèÊèê‰∫§ÁöÑÊï∞ÊçÆ</strong>Ôºâ</li></ul></li></ul><hr><h5 id="Â∑•‰ΩúÊµÅÁ®ã-1" tabindex="-1"><a class="header-anchor" href="#Â∑•‰ΩúÊµÅÁ®ã-1"><span>Â∑•‰ΩúÊµÅÁ®ã</span></a></h5><p>Ë°® user Êï∞ÊçÆ</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">id</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">		name</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">		age</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">		Âº†‰∏â</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">		   18</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Transaction 20Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>START TRANSACTION;	-- ÂºÄÂêØ‰∫ãÂä°</span></span>
<span class="line"><span>UPDATE user SET name = &#39;ÊùéÂõõ&#39; WHERE id = 1;</span></span>
<span class="line"><span>UPDATE user SET name = &#39;Áéã‰∫î&#39; WHERE id = 1;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Transaction 60Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>START TRANSACTION;	-- ÂºÄÂêØ‰∫ãÂä°</span></span>
<span class="line"><span>-- Êìç‰ΩúË°®ÁöÑÂÖ∂‰ªñÊï∞ÊçÆ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MVCCÂ∑•‰ΩúÊµÅÁ®ã1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ID ‰∏∫ 0 ÁöÑ‰∫ãÂä°ÂàõÂª∫ Read ViewÔºö</p><ul><li>m_idsÔºö20„ÄÅ60</li><li>min_trx_idÔºö20</li><li>max_trx_idÔºö61</li><li>creator_trx_idÔºö0</li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MVCCÂ∑•‰ΩúÊµÅÁ®ã2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Âè™ÊúâÁ∫¢Ê°ÜÈÉ®ÂàÜÊâçÂ§çÂêàÊù°‰ª∂ÔºåÊâÄ‰ª•Âè™ÊúâÂº†‰∏âÂØπÂ∫îÁöÑÁâàÊú¨ÁöÑÊï∞ÊçÆÂèØ‰ª•Ë¢´ÁúãÂà∞</p><p>ÂèÇËÄÉËßÜÈ¢ëÔºöhttps://www.bilibili.com/video/BV1t5411u7Fg</p><hr><h5 id="‰∫åÁ∫ßÁ¥¢Âºï" tabindex="-1"><a class="header-anchor" href="#‰∫åÁ∫ßÁ¥¢Âºï"><span>‰∫åÁ∫ßÁ¥¢Âºï</span></a></h5><p>Âè™ÊúâÂú®ËÅöÁ∞áÁ¥¢Âºï‰∏≠ÊâçÊúâ trx_id Âíå roll_pointer ÁöÑÈöêËóèÂàóÔºåÂØπ‰∫é‰∫åÁ∫ßÁ¥¢ÂºïÂà§Êñ≠ÂèØËßÅÊÄßÁöÑÊñπÂºèÔºö</p><ul><li>‰∫åÁ∫ßÁ¥¢ÂºïÈ°µÈù¢ÁöÑ Page Header ‰∏≠Êúâ‰∏Ä‰∏™ PAGE_MAX_TRX_ID Â±ûÊÄßÔºå‰ª£Ë°®‰øÆÊîπÂΩìÂâçÈ°µÈù¢ÁöÑÊúÄÂ§ßÁöÑ‰∫ãÂä° IDÔºåSELECT ËØ≠Âè•ËÆøÈóÆÊüê‰∏™‰∫åÁ∫ßÁ¥¢ÂºïÊó∂‰ºöÂà§Êñ≠ ReadView ÁöÑ min_trx_id ÊòØÂê¶Â§ß‰∫éËØ•Â±ûÊÄßÔºåÂ§ß‰∫éËØ¥ÊòéËØ•È°µÈù¢ÁöÑÊâÄÊúâÂ±ûÊÄßÂØπ ReadView ÂèØËßÅ</li><li>Â¶ÇÊûúÂ±ûÊÄßÂà§Êñ≠‰∏çÂèØËßÅÔºåÂ∞±ÈúÄË¶ÅÂà©Áî®‰∫åÁ∫ßÁ¥¢ÂºïËé∑Âèñ‰∏ªÈîÆÂÄºËøõË°å<strong>ÂõûË°®Êìç‰Ωú</strong>ÔºåÂæóÂà∞ËÅöÁ∞áÁ¥¢ÂºïÂêéÊåâÁÖßËÅöÁ∞áÁ¥¢ÂºïÁöÑÂèØËßÅÊÄßÂà§Êñ≠ÁöÑÊñπÊ≥ïÊìç‰Ωú</li></ul><hr><h4 id="rc-rr" tabindex="-1"><a class="header-anchor" href="#rc-rr"><span>RC RR</span></a></h4><p>Read View Áî®‰∫éÊîØÊåÅ RCÔºàRead CommittedÔºåËØªÂ∑≤Êèê‰∫§ÔºâÂíå RRÔºàRepeatable ReadÔºåÂèØÈáçÂ§çËØªÔºâÈöîÁ¶ªÁ∫ßÂà´ÁöÑÂÆûÁé∞ÔºåÊâÄ‰ª• <strong>SELECT Âú® RC Âíå RR ÈöîÁ¶ªÁ∫ßÂà´‰ΩøÁî® MVCC ËØªÂèñËÆ∞ÂΩï</strong></p><p>RR„ÄÅRC ÁîüÊàêÊó∂Êú∫Ôºö</p><ul><li>RC ÈöîÁ¶ªÁ∫ßÂà´‰∏ãÔºåÊØèÊ¨°ËØªÂèñÊï∞ÊçÆÂâçÈÉΩ‰ºöÁîüÊàêÊúÄÊñ∞ÁöÑ Read ViewÔºàÂΩìÂâçËØªÔºâ</li><li>RR ÈöîÁ¶ªÁ∫ßÂà´‰∏ãÔºåÂú®Á¨¨‰∏ÄÊ¨°Êï∞ÊçÆËØªÂèñÊó∂Êâç‰ºöÂàõÂª∫ Read ViewÔºàÂø´ÁÖßËØªÔºâ</li></ul><p>RC„ÄÅRR Á∫ßÂà´‰∏ãÁöÑ InnoDB Âø´ÁÖßËØªÂå∫Âà´</p><ul><li><p>RC Á∫ßÂà´‰∏ãÔºå‰∫ãÂä°‰∏≠ÊØèÊ¨°Âø´ÁÖßËØªÈÉΩ‰ºöÊñ∞ÁîüÊàê‰∏Ä‰∏™ Read ViewÔºåËøôÂ∞±ÊòØÂú® RC Á∫ßÂà´‰∏ãÁöÑ‰∫ãÂä°‰∏≠ÂèØ‰ª•ÁúãÂà∞Âà´ÁöÑ‰∫ãÂä°Êèê‰∫§ÁöÑÊõ¥Êñ∞ÁöÑÂéüÂõ†</p></li><li><p>RR Á∫ßÂà´‰∏ãÔºåÊüê‰∏™‰∫ãÂä°ÁöÑÂØπÊüêÊù°ËÆ∞ÂΩïÁöÑ<strong>Á¨¨‰∏ÄÊ¨°Âø´ÁÖßËØª</strong>‰ºöÂàõÂª∫‰∏Ä‰∏™ Read ViewÔºå Â∞ÜÂΩìÂâçÁ≥ªÁªüÊ¥ªË∑ÉÁöÑÂÖ∂‰ªñ‰∫ãÂä°ËÆ∞ÂΩïËµ∑Êù•ÔºåÊ≠§ÂêéÂú®Ë∞ÉÁî®Âø´ÁÖßËØªÁöÑÊó∂ÂÄôÔºå‰ΩøÁî®ÁöÑÊòØÂêå‰∏Ä‰∏™ Read ViewÔºåÊâÄ‰ª•‰∏Ä‰∏™‰∫ãÂä°ÁöÑÊü•ËØ¢ÁªìÊûúÊØèÊ¨°ÈÉΩÊòØÁõ∏ÂêåÁöÑ</p><p>RR Á∫ßÂà´‰∏ãÔºåÈÄöËøá <code>START TRANSACTION WITH CONSISTENT SNAPSHOT</code> ÂºÄÂêØ‰∫ãÂä°Ôºå‰ºöÂú®ÊâßË°åËØ•ËØ≠Âè•ÂêéÁ´ãÂàªÁîüÊàê‰∏Ä‰∏™ Read ViewÔºå‰∏çÊòØÂú®ÊâßË°åÁ¨¨‰∏ÄÊù° SELECT ËØ≠Âè•Êó∂ÁîüÊàêÔºàÊâÄ‰ª•ËØ¥ <code>START TRANSACTION</code> Âπ∂‰∏çÊòØ‰∫ãÂä°ÁöÑËµ∑ÁÇπÔºåÊâßË°åÁ¨¨‰∏ÄÊù°ËØ≠Âè•ÊâçÁÆóËµ∑ÁÇπÔºâ</p></li></ul><p>Ëß£ÂÜ≥ÂπªËØªÈóÆÈ¢òÔºö</p><ul><li><p>Âø´ÁÖßËØªÔºöÈÄöËøá MVCC Êù•ËøõË°åÊéßÂà∂ÁöÑÔºåÂú®ÂèØÈáçÂ§çËØªÈöîÁ¶ªÁ∫ßÂà´‰∏ãÔºåÊôÆÈÄöÊü•ËØ¢ÊòØÂø´ÁÖßËØªÔºåÊòØ‰∏ç‰ºöÁúãÂà∞Âà´ÁöÑ‰∫ãÂä°ÊèíÂÖ•ÁöÑÊï∞ÊçÆÁöÑÔºå‰ΩÜÊòØ<strong>Âπ∂‰∏çËÉΩÂÆåÂÖ®ÈÅøÂÖçÂπªËØª</strong></p><p>Âú∫ÊôØÔºöRR Á∫ßÂà´ÔºåT1 ‰∫ãÂä°ÂºÄÂêØÔºåÂàõÂª∫ Read ViewÔºåÊ≠§Êó∂ T2 Âéª INSERT Êñ∞ÁöÑ‰∏ÄË°åÁÑ∂ÂêéÊèê‰∫§ÔºåÁÑ∂Âêé T1 Âéª UPDATE ËØ•Ë°å‰ºöÂèëÁé∞Êõ¥Êñ∞ÊàêÂäüÔºåÂπ∂‰∏îÊääËøôÊù°Êñ∞ËÆ∞ÂΩïÁöÑ trx_id Âèò‰∏∫ÂΩìÂâçÁöÑ‰∫ãÂä° idÔºåÊâÄ‰ª•ÂØπÂΩìÂâç‰∫ãÂä°Â∞±ÊòØÂèØËßÅÁöÑ„ÄÇÂõ†‰∏∫ <strong>Read View Âπ∂‰∏çËÉΩÈòªÊ≠¢‰∫ãÂä°ÂéªÊõ¥Êñ∞Êï∞ÊçÆÔºåÊõ¥Êñ∞Êï∞ÊçÆÈÉΩÊòØÂÖàËØªÂêéÂÜôÂπ∂‰∏îÊòØÂΩìÂâçËØª</strong>ÔºåËØªÂèñÂà∞ÁöÑÊòØÊúÄÊñ∞ÁâàÊú¨ÁöÑÊï∞ÊçÆ</p></li><li><p>ÂΩìÂâçËØªÔºöÈÄöËøá next-key ÈîÅÔºàË°åÈîÅ + Èó¥ÈöôÈîÅÔºâÊù•Ëß£ÂÜ≥ÈóÆÈ¢ò</p></li></ul><hr><h3 id="ÊåÅ‰πÖÁâπÊÄß" tabindex="-1"><a class="header-anchor" href="#ÊåÅ‰πÖÁâπÊÄß"><span>ÊåÅ‰πÖÁâπÊÄß</span></a></h3><h4 id="ÂÆûÁé∞ÊñπÂºè-2" tabindex="-1"><a class="header-anchor" href="#ÂÆûÁé∞ÊñπÂºè-2"><span>ÂÆûÁé∞ÊñπÂºè</span></a></h4><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687227607521.png" alt="1687227607521" tabindex="0" loading="lazy"><figcaption>1687227607521</figcaption></figure><p>ÊåÅ‰πÖÊÄßÊòØÊåá‰∏Ä‰∏™‰∫ãÂä°‰∏ÄÊó¶Ë¢´Êèê‰∫§‰∫ÜÔºåÈÇ£‰πàÂØπÊï∞ÊçÆÂ∫ì‰∏≠Êï∞ÊçÆÁöÑÊîπÂèòÂ∞±ÊòØÊ∞∏‰πÖÊÄßÁöÑÔºåÊé•‰∏ãÊù•ÁöÑÂÖ∂‰ªñÊìç‰ΩúÊàñÊïÖÈöú‰∏çÂ∫îËØ•ÂØπÂÖ∂Êúâ‰ªª‰ΩïÂΩ±Âìç„ÄÇBuffer Pool ÁöÑ‰ΩøÁî®ÊèêÈ´ò‰∫ÜËØªÂÜôÊï∞ÊçÆÁöÑÊïàÁéáÔºå‰ΩÜÊòØÂ¶ÇÊûú MySQL ÂÆïÊú∫ÔºåÊ≠§Êó∂ Buffer Pool ‰∏≠‰øÆÊîπÁöÑÊï∞ÊçÆËøòÊ≤°ÊúâÂà∑Êñ∞Âà∞Á£ÅÁõòÔºåÂ∞±‰ºöÂØºËá¥Êï∞ÊçÆÁöÑ‰∏¢Â§±Ôºå‰∫ãÂä°ÁöÑÊåÅ‰πÖÊÄßÊó†Ê≥ï‰øùËØÅÔºåÊâÄ‰ª•ÂºïÂÖ•‰∫Ü redo log ÔºàÈáçÂÅöÊó•ÂøóÔºâÔºåËØ•Êó•ÂøóÊñá‰ª∂Áî±‰∏§ÈÉ®ÂàÜÁªÑÊàêÔºöÈáçÂÅöÊó•ÂøóÁºìÂÜ≤Ôºàredo log bufferÔºâ‰ª•ÂèäÈáçÂÅöÊó•ÂøóÊñá‰ª∂Ôºàredo log fileÔºâ,ÂâçËÄÖÊòØÂú®ÂÜÖÂ≠ò‰∏≠ÔºåÂêéËÄÖÂú®Á£ÅÁõò‰∏≠„ÄÇÂΩì‰∫ãÂä°Êèê‰∫§‰πãÂêé‰ºöÊääÊâÄÊúâ‰øÆÊîπ‰ø°ÊÅØÈÉΩÂ≠òÂà∞ËØ•Êó•ÂøóÊñá‰ª∂‰∏≠, Áî®‰∫éÂú®Âà∑Êñ∞ËÑèÈ°µÂà∞Á£ÅÁõò,ÂèëÁîüÈîôËØØÊó∂, ËøõË°åÊï∞ÊçÆÊÅ¢Â§ç‰ΩøÁî®„ÄÇ</p><ul><li>redo log <strong>ËÆ∞ÂΩïÊï∞ÊçÆÈ°µÁöÑÁâ©ÁêÜ‰øÆÊîπ</strong>ÔºåËÄå‰∏çÊòØÊüê‰∏ÄË°åÊàñÊüêÂá†Ë°åÁöÑ‰øÆÊîπÔºåÁî®Êù•ÊÅ¢Â§çÊèê‰∫§ÂêéÁöÑÊï∞ÊçÆÈ°µÔºåÂè™ËÉΩ<strong>ÊÅ¢Â§çÂà∞ÊúÄÂêé‰∏ÄÊ¨°Êèê‰∫§</strong>ÁöÑ‰ΩçÁΩÆ</li><li>redo log ÈááÁî®ÁöÑÊòØ WALÔºàWrite-ahead loggingÔºå<strong>È¢ÑÂÜôÂºèÊó•Âøó</strong>ÔºâÔºåÊâÄÊúâ‰øÆÊîπË¶ÅÂÖàÂÜôÂÖ•Êó•ÂøóÔºåÂÜçÊõ¥Êñ∞Âà∞Á£ÅÁõòÔºå‰øùËØÅ‰∫ÜÊï∞ÊçÆ‰∏ç‰ºöÂõ† MySQL ÂÆïÊú∫ËÄå‰∏¢Â§±Ôºå‰ªéËÄåÊª°Ë∂≥‰∫ÜÊåÅ‰πÖÊÄßË¶ÅÊ±Ç</li><li>ÁÆÄÂçïÁöÑ redo log ÊòØÁ∫ØÁ≤πÁöÑÁâ©ÁêÜÊó•ÂøóÔºåÂ§çÊùÇÁöÑ redo log ‰ºöÂ≠òÂú®Áâ©ÁêÜÊó•ÂøóÂíåÈÄªËæëÊó•Âøó</li></ul><p>Â∑•‰ΩúËøáÁ®ãÔºöMySQL ÂèëÁîü‰∫ÜÂÆïÊú∫ÔºåInnoDB ‰ºöÂà§Êñ≠‰∏Ä‰∏™Êï∞ÊçÆÈ°µÂú®Â¥©Ê∫ÉÊÅ¢Â§çÊó∂‰∏¢Â§±‰∫ÜÊõ¥Êñ∞ÔºåÂ∞±‰ºöÂ∞ÜÂÆÉËØªÂà∞ÂÜÖÂ≠òÔºåÁÑ∂ÂêéÊ†πÊçÆ redo log ÂÜÖÂÆπÊõ¥Êñ∞ÂÜÖÂ≠òÔºåÊõ¥Êñ∞ÂÆåÊàêÂêéÔºåÂÜÖÂ≠òÈ°µÂèòÊàêËÑèÈ°µÔºåÁÑ∂ÂêéËøõË°åÂà∑ËÑè</p><p>ÁºìÂÜ≤Ê±†ÁöÑ<strong>Âà∑ËÑèÁ≠ñÁï•</strong>Ôºö</p><ul><li>redo log Êñá‰ª∂ÊòØÂõ∫ÂÆöÂ§ßÂ∞èÁöÑÔºåÂ¶ÇÊûúÂÜôÊª°‰∫ÜÂ∞±Ë¶ÅÊì¶Èô§‰ª•ÂâçÁöÑËÆ∞ÂΩïÔºåÂú®Êì¶Èô§‰πãÂâçÈúÄË¶ÅÊääÂØπÂ∫îÁöÑÊõ¥Êñ∞ÊåÅ‰πÖÂåñÂà∞Á£ÅÁõò‰∏≠</li><li>Buffer Pool ÂÜÖÂ≠ò‰∏çË∂≥ÔºåÈúÄË¶ÅÊ∑òÊ±∞ÈÉ®ÂàÜÊï∞ÊçÆÈ°µÔºàLRU ÈìæË°®Â∞æÈÉ®ÔºâÔºåÂ¶ÇÊûúÊ∑òÊ±∞ÁöÑÊòØËÑèÈ°µÔºåÂ∞±Ë¶ÅÂÖàÂ∞ÜËÑèÈ°µÂÜôÂà∞Á£ÅÁõòÔºàË¶ÅÈÅøÂÖçÂ§ß‰∫ãÂä°Ôºâ</li><li>Á≥ªÁªüÁ©∫Èó≤Êó∂ÔºåÂêéÂè∞Á∫øÁ®ã‰ºöËá™Âä®ËøõË°åÂà∑ËÑèÔºàFlush ÈìæË°®ÈÉ®ÂàÜÂ∑≤ÁªèËØ¶Ëß£Ôºâ</li><li>MySQL Ê≠£Â∏∏ÂÖ≥Èó≠Êó∂Ôºå‰ºöÊääÂÜÖÂ≠òÁöÑËÑèÈ°µÈÉΩÂà∑Êñ∞Âà∞Á£ÅÁõò‰∏ä</li></ul><hr><h4 id="ÈáçÂÅöÊó•Âøó" tabindex="-1"><a class="header-anchor" href="#ÈáçÂÅöÊó•Âøó"><span>ÈáçÂÅöÊó•Âøó</span></a></h4><h5 id="Êó•ÂøóÁºìÂÜ≤" tabindex="-1"><a class="header-anchor" href="#Êó•ÂøóÁºìÂÜ≤"><span>Êó•ÂøóÁºìÂÜ≤</span></a></h5><p>ÊúçÂä°Âô®ÂêØÂä®Êó∂‰ºöÂêëÊìç‰ΩúÁ≥ªÁªüÁî≥ËØ∑‰∏ÄÁâáËøûÁª≠ÂÜÖÂ≠òÁ©∫Èó¥‰Ωú‰∏∫ redo log bufferÔºàÈáçÂÅöÊó•ÂøóÁºìÂÜ≤Âå∫ÔºâÔºåÂèØ‰ª•ÈÄöËøá <code>innodb_log_buffer_size</code> Á≥ªÁªüÂèòÈáèÊåáÂÆö redo log buffer ÁöÑÂ§ßÂ∞èÔºåÈªòËÆ§ÊòØ 16MB</p><p>log buffer Ë¢´ÂàíÂàÜ‰∏∫Ëã•Âπ≤ redo log blockÔºàÂùóÔºåÁ±ª‰ººÊï∞ÊçÆÈ°µÁöÑÊ¶ÇÂøµÔºâÔºåÊØè‰∏™ÈªòËÆ§Â§ßÂ∞è 512 Â≠óËäÇÔºåÊØè‰∏™ block Áî± 12 Â≠óËäÇÁöÑ log block head„ÄÅ496 Â≠óËäÇÁöÑ log block body„ÄÅ4 Â≠óËäÇÁöÑ log block trailer ÁªÑÊàê</p><ul><li>ÂΩìÊï∞ÊçÆ‰øÆÊîπÊó∂ÔºåÂÖà‰øÆÊîπ Change Buffer ‰∏≠ÁöÑÊï∞ÊçÆÔºåÁÑ∂ÂêéÂú® redo log buffer ËÆ∞ÂΩïËøôÊ¨°Êìç‰ΩúÔºåÂÜôÂÖ• log buffer ÁöÑËøáÁ®ãÊòØ<strong>È°∫Â∫èÂÜôÂÖ•</strong>ÁöÑÔºàÂÖàÂÜôÂÖ•ÂâçÈù¢ÁöÑ blockÔºåÂÜôÊª°ÂêéÁªßÁª≠ÂÜô‰∏ã‰∏Ä‰∏™Ôºâ</li><li>log buffer ‰∏≠Êúâ‰∏Ä‰∏™ÊåáÈíà buf_freeÔºåÊù•Ê†áËØÜËØ•‰ΩçÁΩÆ‰πãÂâçÈÉΩÊòØÂ°´Êª°ÁöÑ blockÔºåËØ•‰ΩçÁΩÆ‰πãÂêéÈÉΩÊòØÁ©∫Èó≤Âå∫Âüü</li></ul><p>MySQL ËßÑÂÆöÂØπÂ∫ïÂ±ÇÈ°µÈù¢ÁöÑ‰∏ÄÊ¨°ÂéüÂ≠êËÆøÈóÆÁß∞‰∏∫‰∏Ä‰∏™ Mini-TransactionÔºàMTRÔºâÔºåÊØîÂ¶ÇÂú® B+ Ê†ë‰∏äÊèíÂÖ•‰∏ÄÊù°Êï∞ÊçÆÂ∞±ÁÆó‰∏Ä‰∏™ MTR</p><ul><li>‰∏Ä‰∏™‰∫ãÂä°ÂåÖÂê´Ëã•Âπ≤‰∏™ MTRÔºå‰∏Ä‰∏™ MTR ÂØπÂ∫î‰∏ÄÁªÑËã•Âπ≤Êù° redo logÔºå‰∏ÄÁªÑ redo log ÊòØ‰∏çÂèØÂàÜÂâ≤ÁöÑÔºåÂú®ËøõË°åÊï∞ÊçÆÊÅ¢Â§çÊó∂‰πüÊää‰∏ÄÁªÑ redo log ÂΩì‰Ωú‰∏Ä‰∏™‰∏çÂèØÂàÜÂâ≤ÁöÑÊï¥‰ΩìÂ§ÑÁêÜ</li><li>‰∏çÊòØÊØèÁîüÊàê‰∏ÄÊù° redo Êó•ÂøóÂ∞±Â∞ÜÂÖ∂ÊèíÂÖ•Âà∞ log buffer ‰∏≠ÔºåËÄåÊòØ‰∏Ä‰∏™ MTR ÁªìÊùüÂêé<strong>Â∞Ü‰∏ÄÁªÑ redo Êó•ÂøóÂÜôÂÖ•</strong></li></ul><p>InnoDB ÁöÑ redo log ÊòØ<strong>Âõ∫ÂÆöÂ§ßÂ∞è</strong>ÁöÑÔºåredo Êó•ÂøóÂú®Á£ÅÁõò‰∏≠‰ª•Êñá‰ª∂ÁªÑÁöÑÂΩ¢ÂºèÂ≠òÂÇ®ÔºåÂêå‰∏ÄÁªÑ‰∏≠ÁöÑÊØè‰∏™Êñá‰ª∂Â§ßÂ∞è‰∏ÄÊ†∑Ê†ºÂºè‰∏ÄÊ†∑</p><ul><li><code>innodb_log_group_home_dir</code> ‰ª£Ë°®Á£ÅÁõòÂ≠òÂÇ® redo log ÁöÑÊñá‰ª∂ÁõÆÂΩïÔºåÈªòËÆ§ÊòØÂΩìÂâçÊï∞ÊçÆÁõÆÂΩï</li><li><code>innodb_log_file_size</code> ‰ª£Ë°®Êñá‰ª∂Â§ßÂ∞èÔºåÈªòËÆ§ 48MÔºå<code>innodb_log_files_in_group</code> ‰ª£Ë°®Êñá‰ª∂‰∏™Êï∞ÔºåÈªòËÆ§ 2 ÊúÄÂ§ß 100ÔºåÊâÄ‰ª•Êó•ÂøóÁöÑÊñá‰ª∂Â§ßÂ∞è‰∏∫ <code>innodb_log_file_size * innodb_log_files_in_group</code></li></ul><p>redo Êó•ÂøóÊñá‰ª∂‰πüÊòØÁî±Ëã•Âπ≤‰∏™ 512 Â≠óËäÇÁöÑ block ÁªÑÊàêÔºåÊó•ÂøóÊñá‰ª∂ÁöÑÂâç 2048 ‰∏™Â≠óËäÇÔºàÂâç 4 ‰∏™ blockÔºâÁî®Êù•Â≠òÂÇ®‰∏Ä‰∫õÁÆ°ÁêÜ‰ø°ÊÅØÔºå‰ª•ÂêéÁöÑÁî®Êù•Â≠òÂÇ® log buffer ‰∏≠ÁöÑ block ÈïúÂÉè</p><p>Ê≥®ÊÑèÔºöblock Âπ∂‰∏ç‰ª£Ë°®‰∏ÄÁªÑ redo logÔºå‰∏ÄÁªÑÊó•ÂøóÂèØËÉΩÂç†Áî®‰∏çÂà∞‰∏Ä‰∏™ block ÊàñËÄÖÂá†‰∏™ blockÔºå‰æùËµñ‰∫é MTR ÁöÑÂ§ßÂ∞è</p><hr><h5 id="Êó•ÂøóÂà∑Áõò" tabindex="-1"><a class="header-anchor" href="#Êó•ÂøóÂà∑Áõò"><span>Êó•ÂøóÂà∑Áõò</span></a></h5><p>redo log ÈúÄË¶ÅÂú®‰∫ãÂä°Êèê‰∫§Êó∂Â∞ÜÊó•ÂøóÂÜôÂÖ•Á£ÅÁõòÔºå‰ΩÜÊòØÊØî Buffer Pool ‰øÆÊîπÁöÑÊï∞ÊçÆÂÜôÂÖ•Á£ÅÁõòÁöÑÈÄüÂ∫¶Âø´ÔºåÂéüÂõ†Ôºö</p><ul><li>Âà∑ËÑèÊòØÈöèÊú∫ IOÔºåÂõ†‰∏∫ÊØèÊ¨°‰øÆÊîπÁöÑÊï∞ÊçÆ‰ΩçÁΩÆÈöèÊú∫Ôºõredo log Âíå binlog ÈÉΩÊòØ<strong>È°∫Â∫èÂÜô</strong>ÔºåÁ£ÅÁõòÁöÑÈ°∫Â∫è IO ÊØîÈöèÊú∫ IO ÈÄüÂ∫¶Ë¶ÅÂø´</li><li>Âà∑ËÑèÊòØ‰ª•Êï∞ÊçÆÈ°µÔºàPageÔºâ‰∏∫Âçï‰ΩçÁöÑÔºå‰∏Ä‰∏™È°µ‰∏äÁöÑ‰∏Ä‰∏™Â∞è‰øÆÊîπÈÉΩË¶ÅÊï¥È°µÂÜôÂÖ•Ôºõredo log ‰∏≠Âè™ÂåÖÂê´ÁúüÊ≠£ÈúÄË¶ÅÂÜôÂÖ•ÁöÑÈÉ®ÂàÜÔºåÂ•ΩÂá†È°µÁöÑÊï∞ÊçÆ‰øÆÊîπÂèØËÉΩÂè™ËÆ∞ÂΩïÂú®‰∏Ä‰∏™ redo log È°µ‰∏≠ÔºåÂáèÂ∞ëÊó†Êïà IO</li><li><strong>ÁªÑÊèê‰∫§Êú∫Âà∂</strong>ÔºåÂèØ‰ª•Â§ßÂπÖÂ∫¶Èôç‰ΩéÁ£ÅÁõòÁöÑ IO Ê∂àËÄó</li></ul><p>InnoDB ÂºïÊìé‰ºöÂú®ÈÄÇÂΩìÁöÑÊó∂ÂÄôÔºåÊääÂÜÖÂ≠ò‰∏≠ redo log buffer ÊåÅ‰πÖÂåñÔºàfsyncÔºâÂà∞Á£ÅÁõòÔºåÂÖ∑‰ΩìÁöÑ<strong>Âà∑ÁõòÁ≠ñÁï•</strong>Ôºö</p><ul><li>Âú®‰∫ãÂä°Êèê‰∫§Êó∂ÈúÄË¶ÅËøõË°åÂà∑ÁõòÔºåÈÄöËøá‰øÆÊîπÂèÇÊï∞ <code>innodb_flush_log_at_trx_commit</code> ËÆæÁΩÆÔºö <ul><li>0ÔºöË°®Á§∫ÂΩìÊèê‰∫§‰∫ãÂä°Êó∂ÔºåÂπ∂‰∏çÂ∞ÜÁºìÂÜ≤Âå∫ÁöÑ redo Êó•ÂøóÂÜôÂÖ•Á£ÅÁõòÔºåËÄåÊòØÁ≠âÂæÖ<strong>ÂêéÂè∞Á∫øÁ®ãÊØèÁßíÂà∑Êñ∞‰∏ÄÊ¨°</strong></li><li>1ÔºöÂú®‰∫ãÂä°Êèê‰∫§Êó∂Â∞ÜÁºìÂÜ≤Âå∫ÁöÑ redo Êó•Âøó<strong>ÂêåÊ≠•ÂÜôÂÖ•</strong>Âà∞Á£ÅÁõòÔºå‰øùËØÅ‰∏ÄÂÆö‰ºöÂÜôÂÖ•ÊàêÂäüÔºàÈªòËÆ§ÂÄºÔºâ</li><li>2ÔºöÂú®‰∫ãÂä°Êèê‰∫§Êó∂Â∞ÜÁºìÂÜ≤Âå∫ÁöÑ redo Êó•ÂøóÂºÇÊ≠•ÂÜôÂÖ•Âà∞Á£ÅÁõòÔºå‰∏çËÉΩ‰øùËØÅÊèê‰∫§Êó∂ËÇØÂÆö‰ºöÂÜôÂÖ•ÔºåÂè™ÊòØÊúâËøô‰∏™Âä®‰Ωú„ÄÇÊó•ÂøóÂ∑≤ÁªèÂú®Êìç‰ΩúÁ≥ªÁªüÁöÑÁºìÂ≠òÔºåÂ¶ÇÊûúÊìç‰ΩúÁ≥ªÁªüÊ≤°ÊúâÂÆïÊú∫ËÄå MySQL ÂÆïÊú∫Ôºå‰πüÊòØÂèØ‰ª•ÊÅ¢Â§çÊï∞ÊçÆÁöÑ</li></ul></li><li>ÂÜôÂÖ• redo log buffer ÁöÑÊó•ÂøóË∂ÖËøá‰∫ÜÊÄªÂÆπÈáèÁöÑ‰∏ÄÂçäÔºåÂ∞±‰ºöÂ∞ÜÊó•ÂøóÂà∑ÂÖ•Âà∞Á£ÅÁõòÊñá‰ª∂ÔºåËøô‰ºöÂΩ±ÂìçÊâßË°åÊïàÁéáÔºåÊâÄ‰ª•ÂºÄÂèë‰∏≠Â∫î<strong>ÈÅøÂÖçÂ§ß‰∫ãÂä°</strong></li><li>ÊúçÂä°Âô®ÂÖ≥Èó≠Êó∂</li><li>Âπ∂Ë°åÁöÑ‰∫ãÂä°Êèê‰∫§ÔºàÁªÑÊèê‰∫§ÔºâÊó∂Ôºå‰ºöÂ∞ÜÂ∞ÜÂÖ∂‰ªñ‰∫ãÂä°ÁöÑ redo log ÊåÅ‰πÖÂåñÂà∞Á£ÅÁõò„ÄÇÂÅáËÆæ‰∫ãÂä° A Â∑≤ÁªèÂÜôÂÖ• redo log buffer ‰∏≠ÔºåËøôÊó∂Âè¶Â§ñ‰∏Ä‰∏™Á∫øÁ®ãÁöÑ‰∫ãÂä° B Êèê‰∫§ÔºåÂ¶ÇÊûú innodb_flush_log_at_trx_commit ËÆæÁΩÆÁöÑÊòØ 1ÔºåÈÇ£‰πà‰∫ãÂä° B Ë¶ÅÊää redo log buffer ÈáåÁöÑÊó•ÂøóÂÖ®ÈÉ®ÊåÅ‰πÖÂåñÂà∞Á£ÅÁõòÔºå<strong>Âõ†‰∏∫Â§ö‰∏™‰∫ãÂä°ÂÖ±Áî®‰∏Ä‰∏™ redo log buffer</strong>ÔºåÊâÄ‰ª•‰∏ÄÊ¨° fsync ÂèØ‰ª•Âà∑ÁõòÂ§ö‰∏™‰∫ãÂä°ÁöÑ redo logÔºåÊèêÂçá‰∫ÜÂπ∂ÂèëÈáè</li></ul><p>ÊúçÂä°Âô®ÂêØÂä®Âêé redo Á£ÅÁõòÁ©∫Èó¥‰∏çÂèòÔºåÊâÄ‰ª• redo Á£ÅÁõò‰∏≠ÁöÑÊó•ÂøóÊñá‰ª∂ÊòØË¢´<strong>Âæ™ÁéØ‰ΩøÁî®</strong>ÁöÑÔºåÈááÁî®Âæ™ÁéØÂÜôÊï∞ÊçÆÁöÑÊñπÂºèÔºåÂÜôÂÆåÂ∞æÈÉ®ÈáçÊñ∞ÂÜôÂ§¥ÈÉ®ÔºåÊâÄ‰ª•Ë¶ÅÁ°Æ‰øùÂ§¥ÈÉ® log ÂØπÂ∫îÁöÑ‰øÆÊîπÂ∑≤ÁªèÊåÅ‰πÖÂåñÂà∞Á£ÅÁõò</p><hr><h5 id="Êó•ÂøóÂ∫èÂè∑" tabindex="-1"><a class="header-anchor" href="#Êó•ÂøóÂ∫èÂè∑"><span>Êó•ÂøóÂ∫èÂè∑</span></a></h5><p>lsn (log sequence number) ‰ª£Ë°®Â∑≤ÁªèÂÜôÂÖ•ÁöÑ redo Êó•ÂøóÈáè„ÄÅflushed_to_disk_lsn ÊåáÂà∑Êñ∞Âà∞Á£ÅÁõò‰∏≠ÁöÑ redo Êó•ÂøóÈáèÔºå‰∏§ËÄÖÈÉΩÊòØ<strong>ÂÖ®Â±ÄÂèòÈáè</strong>ÔºåÂ¶ÇÊûú‰∏§ËÄÖÁöÑÂÄºÁõ∏ÂêåÔºåËØ¥Êòé log buffer ‰∏≠ÊâÄÊúâÁöÑ redo Êó•ÂøóÈÉΩÂ∑≤ÁªèÊåÅ‰πÖÂåñÂà∞Á£ÅÁõò</p><p>Â∑•‰ΩúËøáÁ®ãÔºöÂÜôÂÖ• log buffer Êï∞ÊçÆÊó∂Ôºåbuf_free ‰ºöËøõË°åÂÅèÁßªÔºåÂÅèÁßªÈáèÂ∞±‰ºöÂä†Âà∞ lsn ‰∏ä</p><p>MTR ÁöÑÊâßË°åËøáÁ®ã‰∏≠‰øÆÊîπËøáÁöÑÈ°µÂØπÂ∫îÁöÑÊéßÂà∂Âùó‰ºöÂä†Âà∞ Buffer Pool ÁöÑ flush ÈìæË°®‰∏≠ÔºåÈìæË°®‰∏≠ËÑèÈ°µÊòØÊåâÁÖßÁ¨¨‰∏ÄÊ¨°‰øÆÊîπÁöÑÊó∂Èó¥ËøõË°åÊéíÂ∫èÁöÑÔºàÂ§¥ÊèíÔºâÔºåÊéßÂà∂Âùó‰∏≠Êúâ‰∏§‰∏™ÊåáÈíàÁî®Êù•ËÆ∞ÂΩïËÑèÈ°µË¢´‰øÆÊîπÁöÑÊó∂Èó¥Ôºö</p><ul><li>oldest_modificationÔºöÁ¨¨‰∏ÄÊ¨°‰øÆÊîπ Buffer Pool ‰∏≠Êüê‰∏™ÁºìÂÜ≤È°µÊó∂ÔºåÂ∞Ü‰øÆÊîπËØ•È°µÁöÑ MTR <strong>ÂºÄÂßãÊó∂</strong>ÂØπÂ∫îÁöÑ lsn ÂÄºÂÜôÂÖ•Ëøô‰∏™Â±ûÊÄß</li><li>newest_modificationÔºöÊØèÊ¨°‰øÆÊîπÈ°µÈù¢ÔºåÈÉΩÂ∞Ü MTR ÁªìÊùüÊó∂ÂÖ®Â±ÄÁöÑ lsn ÂÄºÂÜôÂÖ•Ëøô‰∏™Â±ûÊÄßÔºåÊâÄ‰ª•ËØ•ÂÄºÊòØËØ•È°µÈù¢ÊúÄÂêé‰∏ÄÊ¨°‰øÆÊîπÂêéÁöÑ lsn ÂÄº</li></ul><p>ÂÖ®Â±ÄÂèòÈáè checkpoint_lsn Ë°®Á§∫<strong>ÂΩìÂâçÁ≥ªÁªüÂèØ‰ª•Ë¢´Ë¶ÜÁõñÁöÑ redo Êó•ÂøóÊÄªÈáè</strong>ÔºåÂΩì redo Êó•ÂøóÂØπÂ∫îÁöÑËÑèÈ°µÂ∑≤ÁªèË¢´Âà∑Êñ∞Âà∞Á£ÅÁõòÂêéÔºåËØ•Êñá‰ª∂Á©∫Èó¥Â∞±ÂèØ‰ª•Ë¢´Ë¶ÜÁõñÈáçÁî®ÔºåÊ≠§Êó∂ÊâßË°å‰∏ÄÊ¨° checkpoint Êù•Êõ¥Êñ∞ checkpoint_lsn ÁöÑÂÄºÂ≠òÂÖ•ÁÆ°ÁêÜ‰ø°ÊÅØÔºàÂà∑ËÑèÂíåÊâßË°å‰∏ÄÊ¨° checkpoint Âπ∂‰∏çÊòØÂêå‰∏Ä‰∏™Á∫øÁ®ãÔºâÔºåËØ•ÂÄºÁöÑÂ¢ûÈáèÂ∞±‰ª£Ë°®Á£ÅÁõòÊñá‰ª∂‰∏≠ÂΩìÂâç‰ΩçÁΩÆÂêëÂêéÂèØ‰ª•Ë¢´Ë¶ÜÁõñÁöÑÊñá‰ª∂ÁöÑÈáèÔºåÊâÄ‰ª•ËØ•ÂÄºÊòØ‰∏ÄÁõ¥Â¢ûÂ§ßÁöÑ</p><p><strong>checkpoint</strong>Ôºö‰ªé flush ÈìæË°®Â∞æÈÉ®‰∏≠ÊâæÂá∫ËøòÊú™Âà∑ËÑèÁöÑÈ°µÈù¢ÔºåËØ•È°µÈù¢ÊòØÂΩìÂâçÁ≥ªÁªü‰∏≠ÊúÄÊó©Ë¢´‰øÆÊîπÁöÑËÑèÈ°µÔºåËØ•È°µÈù¢‰πãÂâç‰∫ßÁîüÁöÑËÑèÈ°µÈÉΩÂ∑≤ÁªèÂà∑ËÑèÔºåÁÑ∂ÂêéÂ∞ÜËØ•È°µ oldest_modification ÂÄºËµãÂÄºÁªô checkpoint_lsnÔºåÂõ†‰∏∫ lsn Â∞è‰∫éËØ•ÂÄºÊó∂‰∫ßÁîüÁöÑ redo Êó•ÂøóÈÉΩÂèØ‰ª•Ë¢´Ë¶ÜÁõñ‰∫Ü</p><p>‰ΩÜÊòØÂú®Á≥ªÁªüÂøôÁ¢åÊó∂ÔºåÂêéÂè∞Á∫øÁ®ãÁöÑÂà∑ËÑèÊìç‰Ωú‰∏çËÉΩÂ∞ÜËÑèÈ°µÂø´ÈÄüÂà∑Âá∫ÔºåÂØºËá¥Á≥ªÁªüÊó†Ê≥ïÂèäÊó∂ÊâßË°å checkpoint ÔºåËøôÊó∂ÈúÄË¶ÅÁî®Êà∑Á∫øÁ®ã‰ªé flush ÈìæË°®‰∏≠ÊääÊúÄÊó©‰øÆÊîπÁöÑËÑèÈ°µÂà∑Êñ∞Âà∞Á£ÅÁõò‰∏≠ÔºåÁÑ∂ÂêéÊâßË°å checkpoint</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">write pos </span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">------</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> checkpoint_lsn </span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">// ‰∏§ÂÄº‰πãÈó¥ÁöÑÈÉ®ÂàÜË°®Á§∫ÂèØ‰ª•ÂÜôÂÖ•ÁöÑÊó•ÂøóÈáèÔºåÂΩì pos ËøΩËµ∂‰∏ä lsn Êó∂ÂøÖÈ°ªÊâßË°å checkpoint</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>‰ΩøÁî®ÂëΩ‰ª§ÂèØ‰ª•Êü•ÁúãÂΩìÂâç InnoDB Â≠òÂÇ®ÂºïÊìéÂêÑÁßç lsn ÁöÑÂÄºÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW ENGINE INNODB STATUS\G</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h5 id="Â¥©Ê∫ÉÊÅ¢Â§ç" tabindex="-1"><a class="header-anchor" href="#Â¥©Ê∫ÉÊÅ¢Â§ç"><span>Â¥©Ê∫ÉÊÅ¢Â§ç</span></a></h5><p>ÊÅ¢Â§çÁöÑËµ∑ÁÇπÔºöÂú®‰ªé redo Êó•ÂøóÊñá‰ª∂ÁªÑÁöÑÁÆ°ÁêÜ‰ø°ÊÅØ‰∏≠Ëé∑ÂèñÊúÄËøëÂèëÁîü checkpoint ÁöÑ‰ø°ÊÅØÔºå<strong>‰ªé checkpoint_lsn ÂØπÂ∫îÁöÑÊó•ÂøóÊñá‰ª∂ÂºÄÂßãÊÅ¢Â§ç</strong></p><p>ÊÅ¢Â§çÁöÑÁªàÁÇπÔºöÊâ´ÊèèÊó•ÂøóÊñá‰ª∂ÁöÑ blockÔºåblock ÁöÑÂ§¥ÈÉ®ËÆ∞ÂΩïÁùÄÂΩìÂâç block ‰ΩøÁî®‰∫ÜÂ§öÂ∞ëÂ≠óËäÇÔºåÂ°´Êª°ÁöÑ block ÊÄªÊòØ 512 Â≠óËäÇÔºå Â¶ÇÊûúÊüê‰∏™ block ‰∏çÊòØ 512 Â≠óËäÇÔºåËØ¥ÊòéËØ• block Â∞±ÊòØÈúÄË¶ÅÊÅ¢Â§çÁöÑÊúÄÂêé‰∏Ä‰∏™ block</p><p>ÊÅ¢Â§çÁöÑËøáÁ®ãÔºöÊåâÁÖß redo log ‰æùÊ¨°ÊâßË°åÊÅ¢Â§çÊï∞ÊçÆÔºå‰ºòÂåñÊñπÂºè</p><ul><li>‰ΩøÁî®ÂìàÂ∏åË°®ÔºöÊ†πÊçÆ redo log ÁöÑ space id Âíå page number Â±ûÊÄßËÆ°ÁÆóÂá∫ÂìàÂ∏åÂÄºÔºåÂ∞ÜÂØπÂêå‰∏ÄÈ°µÈù¢ÁöÑ‰øÆÊîπÊîæÂÖ•Âêå‰∏Ä‰∏™ÊßΩÈáåÔºåÂèØ‰ª•‰∏ÄÊ¨°ÊÄßÂÆåÊàêÂØπÊüêÈ°µÁöÑÊÅ¢Â§çÔºå<strong>ÈÅøÂÖç‰∫ÜÈöèÊú∫ IO</strong></li><li>Ë∑≥ËøáÂ∑≤ÁªèÂà∑Êñ∞Âà∞Á£ÅÁõò‰∏≠ÁöÑÈ°µÈù¢ÔºöÊï∞ÊçÆÈ°µÁöÑ File Header ‰∏≠ÁöÑ FILE_PAGE_LSN Â±ûÊÄßÔºàÁ±ª‰ºº newest_modificationÔºâË°®Á§∫ÊúÄËøë‰∏ÄÊ¨°‰øÆÊîπÈ°µÈù¢Êó∂ÁöÑ lsn ÂÄºÔºåÊï∞ÊçÆÈ°µË¢´Âà∑Êñ∞Âà∞Á£ÅÁõò‰∏≠ÔºåÈÇ£‰πàËØ•È°µ lsn Â±ûÊÄßËÇØÂÆöÂ§ß‰∫é checkpoint_lsn</li></ul><p>ÂèÇËÄÉ‰π¶Á±çÔºöhttps://book.douban.com/subject/35231266/</p><hr><h4 id="Â∑•‰ΩúÊµÅÁ®ã-2" tabindex="-1"><a class="header-anchor" href="#Â∑•‰ΩúÊµÅÁ®ã-2"><span>Â∑•‰ΩúÊµÅÁ®ã</span></a></h4><h5 id="Êó•ÂøóÂØπÊØî" tabindex="-1"><a class="header-anchor" href="#Êó•ÂøóÂØπÊØî"><span>Êó•ÂøóÂØπÊØî</span></a></h5><p>MySQL ‰∏≠ËøòÂ≠òÂú® binlogÔºà‰∫åËøõÂà∂Êó•ÂøóÔºâ‰πüÂèØ‰ª•ËÆ∞ÂΩïÂÜôÊìç‰ΩúÂπ∂Áî®‰∫éÊï∞ÊçÆÁöÑÊÅ¢Â§çÔºå<strong>‰øùËØÅÊï∞ÊçÆ‰∏ç‰∏¢Â§±</strong>Ôºå‰∫åËÄÖÁöÑÂå∫Âà´ÊòØÔºö</p><ul><li>‰ΩúÁî®‰∏çÂêåÔºöredo log ÊòØÁî®‰∫é crash recovery ÔºàÊïÖÈöúÊÅ¢Â§çÔºâÔºå‰øùËØÅ MySQL ÂÆïÊú∫‰πü‰∏ç‰ºöÂΩ±ÂìçÊåÅ‰πÖÊÄßÔºõbinlog ÊòØÁî®‰∫é point-in-time recovery ÁöÑÔºå‰øùËØÅÊúçÂä°Âô®ÂèØ‰ª•Âü∫‰∫éÊó∂Èó¥ÁÇπÊÅ¢Â§çÊï∞ÊçÆÔºåÊ≠§Â§ñ binlog ËøòÁî®‰∫é‰∏ª‰ªéÂ§çÂà∂</li><li>Â±ÇÊ¨°‰∏çÂêåÔºöredo log ÊòØ InnoDB Â≠òÂÇ®ÂºïÊìéÂÆûÁé∞ÁöÑÔºåËÄå binlog ÊòØMySQLÁöÑ Server Â±ÇÂÆûÁé∞ÁöÑÔºåÂêåÊó∂ÊîØÊåÅ InnoDB ÂíåÂÖ∂‰ªñÂ≠òÂÇ®ÂºïÊìé</li><li>ÂÜÖÂÆπ‰∏çÂêåÔºöredo log ÊòØÁâ©ÁêÜÊó•ÂøóÔºåÂÜÖÂÆπÂü∫‰∫éÁ£ÅÁõòÁöÑ PageÔºõbinlog ÁöÑÂÜÖÂÆπÊòØ‰∫åËøõÂà∂ÁöÑÔºåÊ†πÊçÆ binlog_format ÂèÇÊï∞ÁöÑ‰∏çÂêåÔºåÂèØËÉΩÂü∫‰∫éSQL ËØ≠Âè•„ÄÅÂü∫‰∫éÊï∞ÊçÆÊú¨Ë∫´ÊàñËÄÖ‰∫åËÄÖÁöÑÊ∑∑ÂêàÔºàÊó•ÂøóÈÉ®ÂàÜËØ¶Ëß£Ôºâ</li><li>ÂÜôÂÖ•Êó∂Êú∫‰∏çÂêåÔºöbinlog Âú®‰∫ãÂä°Êèê‰∫§Êó∂‰∏ÄÊ¨°ÂÜôÂÖ•Ôºõredo log ÁöÑÂÜôÂÖ•Êó∂Êú∫Áõ∏ÂØπÂ§öÂÖÉ</li></ul><p>binlog ‰∏∫‰ªÄ‰πà‰∏çÊîØÊåÅÂ¥©Ê∫ÉÊÅ¢Â§çÔºü</p><ul><li>binlog ËÆ∞ÂΩïÁöÑÊòØËØ≠Âè•ÔºåÂπ∂‰∏çËÆ∞ÂΩïÊï∞ÊçÆÈ°µÁ∫ßÁöÑÊï∞ÊçÆÔºàÂì™‰∏™È°µÊîπ‰∫ÜÂì™‰∫õÂú∞ÊñπÔºâÔºåÊâÄ‰ª•Ê≤°ÊúâËÉΩÂäõÊÅ¢Â§çÊï∞ÊçÆÈ°µ</li><li>binlog ÊòØËøΩÂä†ÂÜôÔºå‰øùÂ≠òÂÖ®ÈáèÁöÑÊó•ÂøóÔºåÊ≤°ÊúâÊ†áÂøóÁ°ÆÂÆö‰ªéÂì™‰∏™ÁÇπÂºÄÂßãÁöÑÊï∞ÊçÆÊòØÂ∑≤ÁªèÂà∑Áõò‰∫ÜÔºåËÄå redo log Âè™Ë¶ÅÂú® checkpoint_lsn ÂêéÈù¢ÁöÑÂ∞±ÊòØÊ≤°ÊúâÂà∑ÁõòÁöÑ</li></ul><hr><h5 id="Êõ¥Êñ∞ËÆ∞ÂΩï" tabindex="-1"><a class="header-anchor" href="#Êõ¥Êñ∞ËÆ∞ÂΩï"><span>Êõ¥Êñ∞ËÆ∞ÂΩï</span></a></h5><p>Êõ¥Êñ∞‰∏ÄÊù°ËÆ∞ÂΩïÁöÑËøáÁ®ãÔºöÂÜô‰πãÂâç‰∏ÄÂÆöÂÖàËØª</p><ul><li><p>Âú® B+ Ê†ë‰∏≠ÂÆö‰ΩçÂà∞ËØ•ËÆ∞ÂΩïÔºåÂ¶ÇÊûúËØ•ËÆ∞ÂΩïÊâÄÂú®ÁöÑÈ°µÈù¢‰∏çÂú® Buffer Pool ÈáåÔºåÂÖàÂ∞ÜÂÖ∂Âä†ËΩΩËøõÂÜÖÂ≠ò</p></li><li><p>È¶ñÂÖàÊõ¥Êñ∞ËØ•ËÆ∞ÂΩïÂØπÂ∫îÁöÑËÅöÁ∞áÁ¥¢ÂºïÔºåÊõ¥Êñ∞ËÅöÁ∞áÁ¥¢ÂºïËÆ∞ÂΩïÊó∂Ôºö</p><ul><li><p>Êõ¥Êñ∞ËÆ∞ÂΩïÂâçÂêë undo È°µÈù¢ÂÜô undo Êó•ÂøóÔºåÁî±‰∫éËøôÊòØÊõ¥ÊîπÈ°µÈù¢ÔºåÊâÄ‰ª•ÈúÄË¶ÅËÆ∞ÂΩï‰∏Ä‰∏ãÁõ∏Â∫îÁöÑ redo Êó•Âøó</p><p>Ê≥®ÊÑèÔºö‰øÆÊîπ undo È°µÈù¢‰πüÊòØÂú®<strong>‰øÆÊîπÈ°µÈù¢</strong>Ôºå‰∫ãÂä°Âè™Ë¶Å‰øÆÊîπÈ°µÈù¢Â∞±ÈúÄË¶ÅÂÖàËÆ∞ÂΩïÁõ∏Â∫îÁöÑ redo Êó•Âøó</p></li><li><p>ÁÑ∂Âêé<strong>ËÆ∞ÂΩïÂØπÂ∫îÁöÑ redo Êó•Âøó</strong>ÔºàÁ≠âÂæÖ MTR Êèê‰∫§ÂêéÂÜôÂÖ• redo log bufferÔºâÔºå<strong>ÊúÄÂêéËøõË°åÁúüÊ≠£ÁöÑÊõ¥Êñ∞ËÆ∞ÂΩï</strong></p></li></ul></li><li><p>Êõ¥Êñ∞ÂÖ∂‰ªñÁöÑ‰∫åÁ∫ßÁ¥¢ÂºïËÆ∞ÂΩïÔºå‰∏ç‰ºöÂÜçËÆ∞ÂΩï undo logÔºåÂè™ËÆ∞ÂΩï redo log Âà∞ buffer ‰∏≠</p></li><li><p>Âú®‰∏ÄÊù°Êõ¥Êñ∞ËØ≠Âè•ÊâßË°åÂÆåÊàêÂêéÔºà‰πüÂ∞±ÊòØÂ∞ÜÊâÄÊúâÂæÖÊõ¥Êñ∞ËÆ∞ÂΩïÈÉΩÊõ¥Êñ∞ÂÆå‰∫ÜÔºâÔºåÂ∞±‰ºöÂºÄÂßãËÆ∞ÂΩïËØ•ËØ≠Âè•ÂØπÂ∫îÁöÑ binlog Êó•ÂøóÔºåÊ≠§Êó∂ËÆ∞ÂΩïÁöÑ binlog Âπ∂Ê≤°ÊúâÂà∑Êñ∞Âà∞Á°¨Áõò‰∏äÔºåËøòÂú®ÂÜÖÂ≠ò‰∏≠ÔºåÂú®‰∫ãÂä°Êèê‰∫§Êó∂Êâç‰ºöÁªü‰∏ÄÂ∞ÜËØ•‰∫ãÂä°ËøêË°åËøáÁ®ã‰∏≠ÁöÑÊâÄÊúâ binlog Êó•ÂøóÂà∑Êñ∞Âà∞Á°¨Áõò</p></li></ul><p>ÂÅáËÆæË°®‰∏≠ÊúâÂ≠óÊÆµ id Âíå aÔºåÂ≠òÂú®‰∏ÄÊù° <code>id = 1, a = 2</code> ÁöÑËÆ∞ÂΩïÔºåÊ≠§Êó∂ÊâßË°åÊõ¥Êñ∞ËØ≠Âè•Ôºö</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">update</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> table</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>InnoDB ‰ºöÁúüÊ≠£ÁöÑÂéªÊâßË°åÊääÂÄº‰øÆÊîπÊàê (1,2) Ëøô‰∏™Êìç‰ΩúÔºåÂÖàÂä†Ë°åÈîÅÔºåÂú®ÂéªÊõ¥Êñ∞ÔºåÂπ∂‰∏ç‰ºöÊèêÂâçÂà§Êñ≠Áõ∏ÂêåÂ∞±‰∏ç‰øÆÊîπ‰∫Ü</p><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://mp.weixin.qq.com/s/wcJ2KisSaMnfP4nH5NYaQA</p><hr><h5 id="‰∏§ÊÆµÊèê‰∫§" tabindex="-1"><a class="header-anchor" href="#‰∏§ÊÆµÊèê‰∫§"><span>‰∏§ÊÆµÊèê‰∫§</span></a></h5><p>ÂΩìÂÆ¢Êà∑Á´ØÊâßË°å COMMIT ËØ≠Âè•ÊàñËÄÖÂú®Ëá™Âä®Êèê‰∫§ÁöÑÊÉÖÂÜµ‰∏ãÔºåMySQL ÂÜÖÈÉ®ÂºÄÂêØ‰∏Ä‰∏™ XA ‰∫ãÂä°ÔºåÂàÜ‰∏§Èò∂ÊÆµÊù•ÂÆåÊàê XA ‰∫ãÂä°ÁöÑÊèê‰∫§Ôºö</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> T </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> c</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">c</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ID</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-updateÁöÑÊâßË°åÊµÅÁ®ã.png" style="zoom:33%;"><p>ÊµÅÁ®ãËØ¥ÊòéÔºöÊâßË°åÂºïÊìéÂ∞ÜËøôË°åÊñ∞Êï∞ÊçÆËØªÂÖ•Âà∞ÂÜÖÂ≠ò‰∏≠ÔºàBuffer PoolÔºâÂêéÔºåÂÖàÂ∞ÜÊ≠§Ê¨°Êõ¥Êñ∞Êìç‰ΩúËÆ∞ÂΩïÂà∞ redo log buffer ÈáåÔºåÁÑ∂ÂêéÊõ¥Êñ∞ËÆ∞ÂΩï„ÄÇÊúÄÂêéÂ∞Ü redo log Âà∑ÁõòÂêé‰∫ãÂä°Â§Ñ‰∫é prepare Áä∂ÊÄÅÔºåÊâßË°åÂô®‰ºöÁîüÊàêËøô‰∏™Êìç‰ΩúÁöÑ binlogÔºåÂπ∂<strong>Êää binlog ÂÜôÂÖ•Á£ÅÁõò</strong>ÔºåÂÆåÊàêÊèê‰∫§</p><p>‰∏§Èò∂ÊÆµÔºö</p><ul><li>Prepare Èò∂ÊÆµÔºöÂ≠òÂÇ®ÂºïÊìéÂ∞ÜËØ•‰∫ãÂä°ÁöÑ <strong>redo Êó•ÂøóÂà∑Áõò</strong>ÔºåÂπ∂‰∏îÂ∞ÜÊú¨‰∫ãÂä°ÁöÑÁä∂ÊÄÅËÆæÁΩÆ‰∏∫ PREPAREÔºå‰ª£Ë°®ÊâßË°åÂÆåÊàêÈöèÊó∂ÂèØ‰ª•Êèê‰∫§‰∫ãÂä°</li><li>Commit Èò∂ÊÆµÔºöÂÖàÂ∞Ü‰∫ãÂä°ÊâßË°åËøáÁ®ã‰∏≠‰∫ßÁîüÁöÑ binlog Âà∑Êñ∞Âà∞Á°¨ÁõòÔºåÂÜçÊâßË°åÂ≠òÂÇ®ÂºïÊìéÁöÑÊèê‰∫§Â∑•‰ΩúÔºåÂºïÊìéÊää redo log ÊîπÊàêÊèê‰∫§Áä∂ÊÄÅ</li></ul><p>Â≠òÂÇ®ÂºïÊìéÂ±ÇÁöÑ redo log Âíå server Â±ÇÁöÑ binlog ÂèØ‰ª•ËÆ§‰∏∫ÊòØ‰∏Ä‰∏™ÂàÜÂ∏ÉÂºè‰∫ãÂä°Ôºå ÈÉΩÂèØ‰ª•Áî®‰∫éË°®Á§∫‰∫ãÂä°ÁöÑÊèê‰∫§Áä∂ÊÄÅÔºåËÄå<strong>‰∏§Èò∂ÊÆµÊèê‰∫§Â∞±ÊòØËÆ©Ëøô‰∏§‰∏™Áä∂ÊÄÅ‰øùÊåÅÈÄªËæë‰∏äÁöÑ‰∏ÄËá¥</strong>Ôºå‰πüÊúâÂà©‰∫é‰∏ª‰ªéÂ§çÂà∂ÔºåÊõ¥Â•ΩÁöÑ‰øùÊåÅ‰∏ª‰ªéÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄß</p><hr><h5 id="Êï∞ÊçÆÊÅ¢Â§ç" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÊÅ¢Â§ç"><span>Êï∞ÊçÆÊÅ¢Â§ç</span></a></h5><p>Á≥ªÁªüÂ¥©Ê∫ÉÂâçÊ≤°ÊúâÊèê‰∫§ÁöÑ‰∫ãÂä°ÁöÑ redo log ÂèØËÉΩÂ∑≤ÁªèÂà∑ÁõòÔºàÂÆöÊó∂Á∫øÁ®ãÊàñËÄÖ checkpointÔºâÔºåÊÄé‰πàÂ§ÑÁêÜÂ¥©Ê∫ÉÊÅ¢Â§çÔºü</p><p>Â∑•‰ΩúÊµÅÁ®ãÔºöËé∑Âèñ undo ÈìæË°®È¶ñËäÇÁÇπÈ°µÈù¢ÁöÑ undo segement header ‰∏≠ÁöÑ TRX_UNDO_STATE Â±ûÊÄßÔºåË°®Á§∫ÂΩìÂâçÈìæË°®ÁöÑ‰∫ãÂä°Â±ûÊÄßÔºå<strong>‰∫ãÂä°Áä∂ÊÄÅÊòØÊ¥ªË∑ÉÔºàÊú™Êèê‰∫§ÔºâÁöÑÂ∞±ÂÖ®ÈÉ®ÂõûÊªö</strong>ÔºåÂ¶ÇÊûúÊòØ PREPARE Áä∂ÊÄÅÔºåÂ∞±ÈúÄË¶ÅÊ†πÊçÆ binlog ÁöÑÁä∂ÊÄÅËøõË°åÂà§Êñ≠Ôºö</p><ul><li>Â¶ÇÊûúÂú®Êó∂Âàª A ÂèëÁîü‰∫ÜÂ¥©Ê∫ÉÔºàcrashÔºâÔºåÁî±‰∫éÊ≠§Êó∂ binlog ËøòÊ≤°ÂÆåÊàêÔºåÊâÄ‰ª•ÈúÄË¶ÅËøõË°åÂõûÊªö</li><li>Â¶ÇÊûúÂú®Êó∂Âàª B ÂèëÁîü‰∫ÜÂ¥©Ê∫ÉÔºåredo log Âíå binlog Êúâ‰∏Ä‰∏™ÂÖ±<strong>ÂêåÁöÑÊï∞ÊçÆÂ≠óÊÆµÂè´ XID</strong>ÔºåÂ¥©Ê∫ÉÊÅ¢Â§çÁöÑÊó∂ÂÄôÔºå‰ºöÊåâÈ°∫Â∫èÊâ´Êèè redo logÔºö <ul><li>Â¶ÇÊûú redo log ÈáåÈù¢ÁöÑ‰∫ãÂä°ÊòØÂÆåÊï¥ÁöÑÔºå‰πüÂ∞±ÊòØÂ∑≤ÁªèÊúâ‰∫Ü commit Ê†áËØÜÔºåËØ¥Êòé binlog ‰πüÂ∑≤ÁªèËÆ∞ÂΩïÂÆåÊï¥ÔºåÁõ¥Êé•‰ªé redo log ÊÅ¢Â§çÊï∞ÊçÆ</li><li>Â¶ÇÊûú redo log ÈáåÈù¢ÁöÑ‰∫ãÂä°Âè™Êúâ prepareÔºåÂ∞±Ê†πÊçÆ XID Âéª binlog ‰∏≠Âà§Êñ≠ÂØπÂ∫îÁöÑ‰∫ãÂä°ÊòØÂê¶Â≠òÂú®Âπ∂ÂÆåÊï¥ÔºåÂ¶ÇÊûúÂÆåÊï¥ÂèØ‰ª•ÊÅ¢Â§çÊï∞ÊçÆ</li></ul></li></ul><p>Âà§Êñ≠‰∏Ä‰∏™‰∫ãÂä°ÁöÑ binlog ÊòØÂê¶ÂÆåÊï¥ÁöÑÊñπÊ≥ïÔºö</p><ul><li>statement Ê†ºÂºèÁöÑ binlogÔºåÊúÄÂêé‰ºöÊúâ COMMIT</li><li>row Ê†ºÂºèÁöÑ binlogÔºåÊúÄÂêé‰ºöÊúâ‰∏Ä‰∏™ XID event</li><li>MySQL 5.6.2 ÁâàÊú¨‰ª•ÂêéÔºåÂºïÂÖ•‰∫Ü binlog-checksum ÂèÇÊï∞Áî®Êù•È™åËØÅ binlog ÂÜÖÂÆπÁöÑÊ≠£Á°ÆÊÄßÔºàÂèØËÉΩÊó•Âøó‰∏≠Èó¥Âá∫ÈîôÔºâ</li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://time.geekbang.org/column/article/73161</p><hr><h4 id="Âà∑ËÑè‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#Âà∑ËÑè‰ºòÂåñ"><span>Âà∑ËÑè‰ºòÂåñ</span></a></h4><p>Á≥ªÁªüÂú®ËøõË°åÂà∑ËÑèÊó∂‰ºöÂç†Áî®‰∏ÄÈÉ®ÂàÜÁ≥ªÁªüËµÑÊ∫êÔºå‰ºöÂΩ±ÂìçÁ≥ªÁªüÁöÑÊÄßËÉΩÔºå<strong>‰∫ßÁîüÁ≥ªÁªüÊäñÂä®</strong></p><ul><li>‰∏Ä‰∏™Êü•ËØ¢Ë¶ÅÊ∑òÊ±∞ÁöÑËÑèÈ°µ‰∏™Êï∞Â§™Â§öÔºå‰ºöÂØºËá¥Êü•ËØ¢ÁöÑÂìçÂ∫îÊó∂Èó¥ÊòéÊòæÂèòÈïø</li><li>Êó•ÂøóÂÜôÊª°ÔºåÊõ¥Êñ∞ÂÖ®ÈÉ®Â†µ‰ΩèÔºåÂÜôÊÄßËÉΩË∑å‰∏∫ 0ÔºåËøôÁßçÊÉÖÂÜµÂØπÊïèÊÑü‰∏öÂä°Êù•ËØ¥ÔºåÊòØ‰∏çËÉΩÊé•ÂèóÁöÑ</li></ul><p>InnoDB Âà∑ËÑèÈ°µÁöÑÊéßÂà∂Á≠ñÁï•Ôºö</p><ul><li><code>innodb_io_capacity</code> ÂèÇÊï∞‰ª£Ë°®Á£ÅÁõòÁöÑËØªÂÜôËÉΩÂäõÔºåÂª∫ËÆÆËÆæÁΩÆÊàêÁ£ÅÁõòÁöÑ IOPSÔºàÊØèÁßíÁöÑ IO Ê¨°Êï∞Ôºâ</li><li>Âà∑ËÑèÈÄüÂ∫¶ÂèÇËÄÉ‰∏§‰∏™Âõ†Á¥†ÔºöËÑèÈ°µÊØî‰æãÂíå redo log ÂÜôÁõòÈÄüÂ∫¶ <ul><li>ÂèÇÊï∞ <code>innodb_max_dirty_pages_pct</code> ÊòØËÑèÈ°µÊØî‰æã‰∏äÈôêÔºåÈªòËÆ§ÂÄºÊòØ 75%ÔºåInnoDB ‰ºöÊ†πÊçÆÂΩìÂâçÁöÑËÑèÈ°µÊØî‰æãÔºåÁÆóÂá∫‰∏Ä‰∏™ËåÉÂõ¥Âú® 0 Âà∞ 100 ‰πãÈó¥ÁöÑÊï∞Â≠ó</li><li>InnoDB ÊØèÊ¨°ÂÜôÂÖ•ÁöÑÊó•ÂøóÈÉΩÊúâ‰∏Ä‰∏™Â∫èÂè∑ÔºåÂΩìÂâçÂÜôÂÖ•ÁöÑÂ∫èÂè∑Ë∑ü checkpoint ÂØπÂ∫îÁöÑÂ∫èÂè∑‰πãÈó¥ÁöÑÂ∑ÆÂÄºÔºåInnoDB Ê†πÊçÆÂ∑ÆÂÄºÁÆóÂá∫‰∏Ä‰∏™ËåÉÂõ¥Âú® 0 Âà∞ 100 ‰πãÈó¥ÁöÑÊï∞Â≠ó</li><li>‰∏§ËÄÖËæÉÂ§ßÁöÑÂÄºËÆ∞‰∏∫ RÔºåÊâßË°åÂºïÊìéÊåâÁÖß innodb_io_capacity ÂÆö‰πâÁöÑËÉΩÂäõ‰πò‰ª• R% Êù•ÊéßÂà∂Âà∑ËÑèÈ°µÁöÑÈÄüÂ∫¶</li></ul></li><li><code>innodb_flush_neighbors</code> ÂèÇÊï∞ÁΩÆ‰∏∫ 1 ‰ª£Ë°®ÊéßÂà∂Âà∑ËÑèÊó∂Ê£ÄÊü•Áõ∏ÈÇªÁöÑÊï∞ÊçÆÈ°µÔºåÂ¶ÇÊûú‰πüÊòØËÑèÈ°µÂ∞±‰∏ÄËµ∑Âà∑ËÑèÔºåÂπ∂Ê£ÄÊü•ÈÇªÂ±ÖÁöÑÈÇªÂ±ÖÔºåËøô‰∏™Ë°å‰∏∫‰ºö‰∏ÄÁõ¥ËîìÂª∂Áõ¥Âà∞‰∏çÊòØËÑèÈ°µÔºåÂú® MySQL 8.0 ‰∏≠ËØ•ÂÄºÁöÑÈªòËÆ§ÂÄºÊòØ 0Ôºå‰∏çÂª∫ËÆÆÂºÄÂêØÊ≠§ÂäüËÉΩ</li></ul><hr><h3 id="‰∏ÄËá¥ÁâπÊÄß" tabindex="-1"><a class="header-anchor" href="#‰∏ÄËá¥ÁâπÊÄß"><span>‰∏ÄËá¥ÁâπÊÄß</span></a></h3><p>‰∏ÄËá¥ÊÄßÊòØÊåá‰∫ãÂä°ÊâßË°åÂâçÂêéÔºåÊï∞ÊçÆÂ∫ìÁöÑÂÆåÊï¥ÊÄßÁ∫¶ÊùüÊ≤°ÊúâË¢´Á†¥ÂùèÔºå‰∫ãÂä°ÊâßË°åÁöÑÂâçÂêéÈÉΩÊòØÂêàÊ≥ïÁöÑÊï∞ÊçÆÁä∂ÊÄÅ„ÄÇ</p><p>Êï∞ÊçÆÂ∫ìÁöÑÂÆåÊï¥ÊÄßÁ∫¶ÊùüÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫éÔºöÂÆû‰ΩìÂÆåÊï¥ÊÄßÔºàÂ¶ÇË°åÁöÑ‰∏ªÈîÆÂ≠òÂú®‰∏îÂîØ‰∏ÄÔºâ„ÄÅÂàóÂÆåÊï¥ÊÄßÔºàÂ¶ÇÂ≠óÊÆµÁöÑÁ±ªÂûã„ÄÅÂ§ßÂ∞è„ÄÅÈïøÂ∫¶Ë¶ÅÁ¨¶ÂêàË¶ÅÊ±ÇÔºâ„ÄÅÂ§ñÈîÆÁ∫¶Êùü„ÄÅÁî®Êà∑Ëá™ÂÆö‰πâÂÆåÊï¥ÊÄßÔºàÂ¶ÇËΩ¨Ë¥¶ÂâçÂêéÔºå‰∏§‰∏™Ë¥¶Êà∑‰ΩôÈ¢ùÁöÑÂíåÂ∫îËØ•‰∏çÂèòÔºâ</p><p>ÂÆûÁé∞‰∏ÄËá¥ÊÄßÁöÑÊé™ÊñΩÔºö</p><ul><li>‰øùËØÅÂéüÂ≠êÊÄß„ÄÅÊåÅ‰πÖÊÄßÂíåÈöîÁ¶ªÊÄßÔºåÂ¶ÇÊûúËøô‰∫õÁâπÊÄßÊó†Ê≥ï‰øùËØÅÔºå‰∫ãÂä°ÁöÑ‰∏ÄËá¥ÊÄß‰πüÊó†Ê≥ï‰øùËØÅ</li><li>Êï∞ÊçÆÂ∫ìÊú¨Ë∫´Êèê‰æõ‰øùÈöúÔºå‰æãÂ¶Ç‰∏çÂÖÅËÆ∏ÂêëÊï¥ÂΩ¢ÂàóÊèíÂÖ•Â≠óÁ¨¶‰∏≤ÂÄº„ÄÅÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶‰∏çËÉΩË∂ÖËøáÂàóÁöÑÈôêÂà∂Á≠â</li><li>Â∫îÁî®Â±ÇÈù¢ËøõË°å‰øùÈöúÔºå‰æãÂ¶ÇÂ¶ÇÊûúËΩ¨Ë¥¶Êìç‰ΩúÂè™Êâ£Èô§ËΩ¨Ë¥¶ËÄÖÁöÑ‰ΩôÈ¢ùÔºåËÄåÊ≤°ÊúâÂ¢ûÂä†Êé•Êî∂ËÄÖÁöÑ‰ΩôÈ¢ùÔºåÊó†ËÆ∫Êï∞ÊçÆÂ∫ìÂÆûÁé∞ÁöÑÂ§ö‰πàÂÆåÁæéÔºå‰πüÊó†Ê≥ï‰øùËØÅÁä∂ÊÄÅÁöÑ‰∏ÄËá¥</li></ul><hr><h2 id="ÈîÅÊú∫Âà∂" tabindex="-1"><a class="header-anchor" href="#ÈîÅÊú∫Âà∂"><span>ÈîÅÊú∫Âà∂</span></a></h2><h3 id="Âü∫Êú¨‰ªãÁªç-8" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-8"><span>Âü∫Êú¨‰ªãÁªç</span></a></h3><p>ÈîÅÊú∫Âà∂ÔºöÊï∞ÊçÆÂ∫ì‰∏∫‰∫Ü‰øùËØÅÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÔºåÂú®ÂÖ±‰∫´ÁöÑËµÑÊ∫êË¢´Âπ∂ÂèëËÆøÈóÆÊó∂ÂèòÂæóÂÆâÂÖ®ÊúâÂ∫èÊâÄËÆæËÆ°ÁöÑ‰∏ÄÁßçËßÑÂàô</p><p>Âà©Áî® MVCC ÊÄßË¥®ËøõË°åËØªÂèñÁöÑÊìç‰ΩúÂè´<strong>‰∏ÄËá¥ÊÄßËØª</strong>ÔºåËØªÂèñÊï∞ÊçÆÂâçÂä†ÈîÅÁöÑÊìç‰ΩúÂè´<strong>ÈîÅÂÆöËØª</strong></p><p>ÈîÅÁöÑÂàÜÁ±ªÔºö</p><ul><li><p>ÊåâÊìç‰ΩúÂàÜÁ±ªÔºö</p><ul><li>ÂÖ±‰∫´ÈîÅÔºö‰πüÂè´ËØªÈîÅ„ÄÇÂØπÂêå‰∏Ä‰ªΩÊï∞ÊçÆÔºåÂ§ö‰∏™‰∫ãÂä°ËØªÊìç‰ΩúÂèØ‰ª•ÂêåÊó∂Âä†ÈîÅËÄå‰∏ç‰∫íÁõ∏ÂΩ±Âìç Ôºå‰ΩÜ‰∏çËÉΩ‰øÆÊîπÊï∞ÊçÆ</li><li>Êéí‰ªñÈîÅÔºö‰πüÂè´ÂÜôÈîÅ„ÄÇÂΩìÂâçÁöÑÊìç‰ΩúÊ≤°ÊúâÂÆåÊàêÂâçÔºå‰ºöÈòªÊñ≠ÂÖ∂‰ªñÊìç‰ΩúÁöÑËØªÂèñÂíåÂÜôÂÖ•</li></ul></li><li><p>ÊåâÁ≤íÂ∫¶ÂàÜÁ±ªÔºö</p><ul><li>Ë°®Á∫ßÈîÅÔºö‰ºöÈîÅÂÆöÊï¥‰∏™Ë°®ÔºåÂºÄÈîÄÂ∞èÔºåÂä†ÈîÅÂø´Ôºõ‰∏ç‰ºöÂá∫Áé∞Ê≠ªÈîÅÔºõÈîÅÂÆöÂäõÂ∫¶Â§ßÔºåÂèëÁîüÈîÅÂÜ≤Á™ÅÊ¶ÇÁéáÈ´òÔºåÂπ∂ÂèëÂ∫¶ÊúÄ‰ΩéÔºåÂÅèÂêë MyISAM</li><li>Ë°åÁ∫ßÈîÅÔºö‰ºöÈîÅÂÆöÂΩìÂâçÊìç‰ΩúË°åÔºåÂºÄÈîÄÂ§ßÔºåÂä†ÈîÅÊÖ¢Ôºõ‰ºöÂá∫Áé∞Ê≠ªÈîÅÔºõÈîÅÂÆöÂäõÂ∫¶Â∞èÔºåÂèëÁîüÈîÅÂÜ≤Á™ÅÊ¶ÇÁéá‰ΩéÔºåÂπ∂ÂèëÂ∫¶È´òÔºåÂÅèÂêë InnoDB</li><li>È°µÁ∫ßÈîÅÔºöÈîÅÁöÑÂäõÂ∫¶„ÄÅÂèëÁîüÂÜ≤Á™ÅÁöÑÊ¶ÇÁéáÂíåÂä†ÈîÅÂºÄÈîÄ‰ªã‰∫éË°®ÈîÅÂíåË°åÈîÅ‰πãÈó¥Ôºå‰ºöÂá∫Áé∞Ê≠ªÈîÅÔºåÂπ∂ÂèëÊÄßËÉΩ‰∏ÄËà¨</li></ul></li><li><p>Êåâ‰ΩøÁî®ÊñπÂºèÂàÜÁ±ªÔºö</p><ul><li>ÊÇ≤ËßÇÈîÅÔºöÊØèÊ¨°Êü•ËØ¢Êï∞ÊçÆÊó∂ÈÉΩËÆ§‰∏∫Âà´‰∫∫‰ºö‰øÆÊîπÔºåÂæàÊÇ≤ËßÇÔºåÊâÄ‰ª•Êü•ËØ¢Êó∂Âä†ÈîÅ</li><li>‰πêËßÇÈîÅÔºöÊØèÊ¨°Êü•ËØ¢Êï∞ÊçÆÊó∂ÈÉΩËÆ§‰∏∫Âà´‰∫∫‰∏ç‰ºö‰øÆÊîπÔºåÂæà‰πêËßÇÔºå‰ΩÜÊòØÊõ¥Êñ∞Êó∂‰ºöÂà§Êñ≠‰∏Ä‰∏ãÂú®Ê≠§ÊúüÈó¥Âà´‰∫∫ÊúâÊ≤°ÊúâÂéªÊõ¥Êñ∞Ëøô‰∏™Êï∞ÊçÆ</li></ul></li><li><p>‰∏çÂêåÂ≠òÂÇ®ÂºïÊìéÊîØÊåÅÁöÑÈîÅ</p><table><thead><tr><th>Â≠òÂÇ®ÂºïÊìé</th><th>Ë°®Á∫ßÈîÅ</th><th>Ë°åÁ∫ßÈîÅ</th><th>È°µÁ∫ßÈîÅ</th></tr></thead><tbody><tr><td>MyISAM</td><td>ÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td></tr><tr><td>InnoDB</td><td><strong>ÊîØÊåÅ</strong></td><td><strong>ÊîØÊåÅ</strong></td><td>‰∏çÊîØÊåÅ</td></tr><tr><td>MEMORY</td><td>ÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td></tr><tr><td>BDB</td><td>ÊîØÊåÅ</td><td>‰∏çÊîØÊåÅ</td><td>ÊîØÊåÅ</td></tr></tbody></table></li></ul><p>‰ªéÈîÅÁöÑËßíÂ∫¶Êù•ËØ¥ÔºöË°®Á∫ßÈîÅÊõ¥ÈÄÇÂêà‰∫é‰ª•Êü•ËØ¢‰∏∫‰∏ªÔºåÂè™ÊúâÂ∞ëÈáèÊåâÁ¥¢ÂºïÊù°‰ª∂Êõ¥Êñ∞Êï∞ÊçÆÁöÑÂ∫îÁî®ÔºåÂ¶Ç Web Â∫îÁî®ÔºõËÄåË°åÁ∫ßÈîÅÂàôÊõ¥ÈÄÇÂêà‰∫éÊúâÂ§ßÈáèÊåâÁ¥¢ÂºïÊù°‰ª∂Âπ∂ÂèëÊõ¥Êñ∞Â∞ëÈáè‰∏çÂêåÊï∞ÊçÆÔºåÂêåÊó∂ÂèàÊúâÂπ∂Êü•ËØ¢ÁöÑÂ∫îÁî®ÔºåÂ¶Ç‰∏Ä‰∫õÂú®Á∫ø‰∫ãÂä°Â§ÑÁêÜÁ≥ªÁªü</p><h3 id="ÂÖ®Â±ÄÈîÅ" tabindex="-1"><a class="header-anchor" href="#ÂÖ®Â±ÄÈîÅ"><span>ÂÖ®Â±ÄÈîÅ</span></a></h3><p>‚Äã ÂÖ®Â±ÄÈîÅÂ∞±ÊòØÂØπÊï¥‰∏™Êï∞ÊçÆÂ∫ìÂÆû‰æãÂä†ÈîÅÔºåÂä†ÈîÅÂêéÊï¥‰∏™ÂÆû‰æãÂ∞±Â§Ñ‰∫éÂè™ËØªÁä∂ÊÄÅÔºåÂêéÁª≠ÁöÑDMLÁöÑÂÜôËØ≠Âè•ÔºåDDLËØ≠ Âè•ÔºåÂ∑≤ÁªèÊõ¥Êñ∞Êìç‰ΩúÁöÑ‰∫ãÂä°Êèê‰∫§ËØ≠Âè•ÈÉΩÂ∞ÜË¢´ÈòªÂ°û„ÄÇ ‚Äã ÂÖ∂ÂÖ∏ÂûãÁöÑ‰ΩøÁî®Âú∫ÊôØÊòØÂÅöÂÖ®Â∫ìÁöÑÈÄªËæëÂ§á‰ªΩÔºåÂØπÊâÄÊúâÁöÑË°®ËøõË°åÈîÅÂÆöÔºå‰ªéËÄåËé∑Âèñ‰∏ÄËá¥ÊÄßËßÜÂõæÔºå‰øùËØÅÊï∞ÊçÆÁöÑÂÆåÊï¥ ÊÄß„ÄÇ</p><p>ËØ≠Ê≥ï</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>flush tables with read lock ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Êï∞ÊçÆÂ§á‰ªΩ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>mysqldump  -uroot ‚Äìp123456  itcast &gt; itcast.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ÈáäÊîæÈîÅ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>unlock tables ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Êï∞ÊçÆÂ∫ì‰∏≠Âä†ÂÖ®Â±ÄÈîÅÔºåÊòØ‰∏Ä‰∏™ÊØîËæÉÈáçÁöÑÊìç‰ΩúÔºåÂ≠òÂú®‰ª•‰∏ãÈóÆÈ¢òÔºö Â¶ÇÊûúÂú®‰∏ªÂ∫ì‰∏äÂ§á‰ªΩÔºåÈÇ£‰πàÂú®Â§á‰ªΩÊúüÈó¥ÈÉΩ‰∏çËÉΩÊâßË°åÊõ¥Êñ∞Ôºå‰∏öÂä°Âü∫Êú¨‰∏äÂ∞±ÂæóÂÅúÊëÜ„ÄÇ Â¶ÇÊûúÂú®‰ªéÂ∫ì‰∏äÂ§á‰ªΩÔºåÈÇ£‰πàÂú®Â§á‰ªΩÊúüÈó¥‰ªéÂ∫ì‰∏çËÉΩÊâßË°å‰∏ªÂ∫ìÂêåÊ≠•ËøáÊù•ÁöÑ‰∫åËøõÂà∂Êó•ÂøóÔºàbinlogÔºâÔºå‰ºöÂØº Ëá¥‰∏ª‰ªéÂª∂Ëøü„ÄÇ Âú®InnoDBÂºïÊìé‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®Â§á‰ªΩÊó∂Âä†‰∏äÂèÇÊï∞ --single-transaction ÂèÇÊï∞Êù•ÂÆåÊàê‰∏çÂä†ÈîÅÁöÑ‰∏ÄËá¥ ÊÄßÊï∞ÊçÆÂ§á‰ªΩ„ÄÇ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>mysqldump  --single-transaction  -uroot ‚Äìp123456  itcast &gt; itcast.sql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h3 id="ÂÜÖÂ≠òÁªìÊûÑ" tabindex="-1"><a class="header-anchor" href="#ÂÜÖÂ≠òÁªìÊûÑ"><span>ÂÜÖÂ≠òÁªìÊûÑ</span></a></h3><p>ÂØπ‰∏ÄÊù°ËÆ∞ÂΩïÂä†ÈîÅÁöÑÊú¨Ë¥®Â∞±ÊòØ<strong>Âú®ÂÜÖÂ≠ò‰∏≠</strong>ÂàõÂª∫‰∏Ä‰∏™ÈîÅÁªìÊûÑ‰∏é‰πãÂÖ≥ËÅîÔºåÁªìÊûÑÂåÖÊã¨</p><ul><li>‰∫ãÂä°‰ø°ÊÅØÔºöÈîÅÂØπÂ∫îÁöÑ‰∫ãÂä°‰ø°ÊÅØÔºå‰∏Ä‰∏™ÈîÅÂ±û‰∫é‰∏Ä‰∏™‰∫ãÂä°</li><li>Á¥¢Âºï‰ø°ÊÅØÔºöÂØπ‰∫éË°åÁ∫ßÈîÅÔºåÈúÄË¶ÅËÆ∞ÂΩïÂä†ÈîÅÁöÑËÆ∞ÂΩïÂ±û‰∫éÂì™‰∏™Á¥¢Âºï</li><li>Ë°®ÈîÅÂíåË°åÈîÅ‰ø°ÊÅØÔºöË°®ÈîÅËÆ∞ÂΩïÁùÄÈîÅÂÆöÁöÑË°®ÔºåË°åÈîÅËÆ∞ÂΩï‰∫Ü Space ID ÊâÄÂú®Ë°®Á©∫Èó¥„ÄÅPage Number ÊâÄÂú®ÁöÑÈ°µÂè∑„ÄÅn_bits ‰ΩøÁî®‰∫ÜÂ§öÂ∞ëÊØîÁâπ</li><li>type_modeÔºö‰∏Ä‰∏™ 32 ÊØîÁâπÁöÑÊï∞ÔºåË¢´ÂàÜÊàê lock_mode„ÄÅlock_type„ÄÅrec_lock_type ‰∏â‰∏™ÈÉ®ÂàÜ <ul><li>lock_modeÔºöÈîÅÊ®°ÂºèÔºåËÆ∞ÂΩïÊòØÂÖ±‰∫´ÈîÅ„ÄÅÊéí‰ªñÈîÅ„ÄÅÊÑèÂêëÈîÅ‰πãÁ±ª</li><li>lock_typeÔºö‰ª£Ë°®Ë°®Á∫ßÈîÅËøòÊòØË°åÁ∫ßÈîÅ</li><li>rec_lock_typeÔºö‰ª£Ë°®Ë°åÈîÅÁöÑÂÖ∑‰ΩìÁ±ªÂûãÂíå is_waiting Â±ûÊÄßÔºåis_waiting = true Êó∂Ë°®Á§∫ÂΩìÂâç‰∫ãÂä°Â∞öÊú™Ëé∑ÂèñÂà∞ÈîÅÔºåÂ§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅ„ÄÇ‰∫ãÂä°Ëé∑ÂèñÈîÅÂêéÁöÑÈîÅÁªìÊûÑÊòØ is_waiting ‰∏∫ falseÔºåÈáäÊîæÈîÅÊó∂‰ºöÊ£ÄÊü•ÊòØÂê¶‰∏éÂΩìÂâçËÆ∞ÂΩïÂÖ≥ËÅîÁöÑÈîÅÁªìÊûÑÔºåÂ¶ÇÊûúÊúâÂ∞±Âî§ÈÜíÂØπÂ∫î‰∫ãÂä°ÁöÑÁ∫øÁ®ã</li></ul></li></ul><p>‰∏Ä‰∏™‰∫ãÂä°ÂèØËÉΩÊìç‰ΩúÂ§öÊù°ËÆ∞ÂΩïÔºå‰∏∫‰∫ÜËäÇÁúÅÂÜÖÂ≠òÔºåÊª°Ë∂≥‰∏ãÈù¢Êù°‰ª∂ÁöÑÈîÅ‰ΩøÁî®Âêå‰∏Ä‰∏™ÈîÅÁªìÊûÑÔºö</p><ul><li>Âú®Âêå‰∏Ä‰∏™‰∫ãÂä°‰∏≠ÁöÑÂä†ÈîÅÊìç‰Ωú</li><li>Ë¢´Âä†ÈîÅÁöÑËÆ∞ÂΩïÂú®Âêå‰∏Ä‰∏™È°µÈù¢‰∏≠</li><li>Âä†ÈîÅÁöÑÁ±ªÂûãÊòØ‰∏ÄÊ†∑ÁöÑ</li><li>Âä†ÈîÅÁöÑÁä∂ÊÄÅÊòØ‰∏ÄÊ†∑ÁöÑ</li></ul><hr><h3 id="server" tabindex="-1"><a class="header-anchor" href="#server"><span>Server</span></a></h3><p>MySQL ÈáåÈù¢Ë°®Á∫ßÂà´ÁöÑÈîÅÊúâ‰∏§ÁßçÔºö‰∏ÄÁßçÊòØË°®ÈîÅÔºå‰∏ÄÁßçÊòØÂÖÉÊï∞ÊçÆÈîÅÔºàmeta data lockÔºåMDL)</p><p>MDL Âè´ÂÖÉÊï∞ÊçÆÈîÅÔºå‰∏ªË¶ÅÁî®Êù•‰øùÊä§ MySQL ÂÜÖÈÉ®ÂØπË±°ÁöÑÂÖÉÊï∞ÊçÆÔºå‰øùËØÅÊï∞ÊçÆËØªÂÜôÁöÑÊ≠£Á°ÆÊÄßÔºå<strong>ÂΩìÂØπ‰∏Ä‰∏™Ë°®ÂÅöÂ¢ûÂà†ÊîπÊü•ÁöÑÊó∂ÂÄôÔºåÂä† MDL ËØªÈîÅÔºõÂΩìË¶ÅÂØπË°®ÂÅöÁªìÊûÑÂèòÊõ¥Êìç‰Ωú DDL ÁöÑÊó∂ÂÄôÔºåÂä† MDL ÂÜôÈîÅ</strong>Ôºå‰∏§ÁßçÈîÅ‰∏çÁõ∏‰∫íÂÖºÂÆπÔºåÊâÄ‰ª•ÂèØ‰ª•‰øùËØÅ DDL„ÄÅDML„ÄÅDQL Êìç‰ΩúÁöÑÂÆâÂÖ®</p><p>ËØ¥ÊòéÔºöDDL Êìç‰ΩúÊâßË°åÂâç‰ºöÈöêÂºèÊèê‰∫§ÂΩìÂâç‰ºöËØùÁöÑ‰∫ãÂä°ÔºåÂõ†‰∏∫ DDL ‰∏ÄËà¨‰ºöÂú®Ëã•Âπ≤‰∏™ÁâπÊÆä‰∫ãÂä°‰∏≠ÂÆåÊàêÔºåÂºÄÂêØÁâπÊÆä‰∫ãÂä°ÂâçÈúÄË¶ÅÊèê‰∫§Âà∞ÂÖ∂‰ªñ‰∫ãÂä°</p><p>MDL ÈîÅÁöÑÁâπÊÄßÔºö</p><ul><li>MDL ÈîÅ‰∏çÈúÄË¶ÅÊòæÂºè‰ΩøÁî®ÔºåÂú®ËÆøÈóÆ‰∏Ä‰∏™Ë°®ÁöÑÊó∂ÂÄô‰ºöË¢´Ëá™Âä®Âä†‰∏äÔºåÂú®‰∫ãÂä°ÂºÄÂßãÊó∂Áî≥ËØ∑ÔºåÊï¥‰∏™‰∫ãÂä°Êèê‰∫§ÂêéÈáäÊîæÔºàÊâßË°åÂÆåÂçïÊù°ËØ≠Âè•‰∏çÈáäÊîæÔºâ</li><li>MDL ÈîÅÊòØÂú® Server ‰∏≠ÂÆûÁé∞Ôºå‰∏çÊòØ InnoDB Â≠òÂÇ®ÂºïÊìéÂ±ÇËÉΩÁõ¥Êé•ÂÆûÁé∞ÁöÑÈîÅ</li><li>MDL ÈîÅËøòËÉΩÂÆûÁé∞ÂÖ∂‰ªñÁ≤íÂ∫¶Á∫ßÂà´ÁöÑÈîÅÔºåÊØîÂ¶ÇÂÖ®Â±ÄÈîÅ„ÄÅÂ∫ìÁ∫ßÂà´ÁöÑÈîÅ„ÄÅË°®Á©∫Èó¥Á∫ßÂà´ÁöÑÈîÅ</li></ul><p>FLUSH TABLES WITH READ LOCK ÁÆÄÁß∞ÔºàFTWRLÔºâÔºåÂÖ®Â±ÄËØªÈîÅÔºåËÆ©Êï¥‰∏™Â∫ìÂ§Ñ‰∫éÂè™ËØªÁä∂ÊÄÅÔºåDDL DML ÈÉΩË¢´ÈòªÂ°ûÔºåÂ∑•‰ΩúÊµÅÁ®ãÔºö</p><ol><li>‰∏äÂÖ®Â±ÄËØªÈîÅÔºàlock_global_read_lockÔºâ</li><li>Ê∏ÖÁêÜË°®ÁºìÂ≠òÔºàclose_cached_tablesÔºâ</li><li>‰∏äÂÖ®Â±Ä COMMIT ÈîÅÔºàmake_global_read_lock_block_commitÔºâ</li></ol><p>ËØ•ÂëΩ‰ª§‰∏ªË¶ÅÁî®‰∫éÂ§á‰ªΩÂ∑•ÂÖ∑ÂÅö<strong>‰∏ÄËá¥ÊÄßÂ§á‰ªΩ</strong>ÔºåÁî±‰∫é FTWRL ÈúÄË¶ÅÊåÅÊúâ‰∏§ÊääÂÖ®Â±ÄÁöÑ MDL ÈîÅÔºåÂπ∂‰∏îËøòË¶ÅÂÖ≥Èó≠ÊâÄÊúâË°®ÂØπË±°ÔºåÂõ†Ê≠§ÊùÄ‰º§ÊÄßÂæàÂ§ß</p><hr><h3 id="myisam-1" tabindex="-1"><a class="header-anchor" href="#myisam-1"><span>MyISAM</span></a></h3><h4 id="Ë°®Á∫ßÈîÅ" tabindex="-1"><a class="header-anchor" href="#Ë°®Á∫ßÈîÅ"><span>Ë°®Á∫ßÈîÅ</span></a></h4><p>MyISAM Â≠òÂÇ®ÂºïÊìéÂè™ÊîØÊåÅË°®ÈîÅÔºåËøô‰πüÊòØ MySQL ÂºÄÂßãÂá†‰∏™ÁâàÊú¨‰∏≠ÂîØ‰∏ÄÊîØÊåÅÁöÑÈîÅÁ±ªÂûã</p><p><strong>ÂÖÉÊï∞ÊçÆÈîÅ</strong></p><p>meta data lock , ÂÖÉÊï∞ÊçÆÈîÅÔºåÁÆÄÂÜôMDL„ÄÇ MDLÂä†ÈîÅËøáÁ®ãÊòØÁ≥ªÁªüËá™Âä®ÊéßÂà∂ÔºåÊó†ÈúÄÊòæÂºè‰ΩøÁî®ÔºåÂú®ËÆøÈóÆ‰∏ÄÂº†Ë°®ÁöÑÊó∂ÂÄô‰ºöËá™Âä®Âä†‰∏ä„ÄÇMDLÈîÅ‰∏ªË¶Å‰ΩúÁî®ÊòØÁª¥ Êä§Ë°®ÂÖÉÊï∞ÊçÆÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÔºåÂú®Ë°®‰∏äÊúâÊ¥ªÂä®‰∫ãÂä°ÁöÑÊó∂ÂÄôÔºå‰∏çÂèØ‰ª•ÂØπÂÖÉÊï∞ÊçÆËøõË°åÂÜôÂÖ•Êìç‰Ωú„ÄÇ‰∏∫‰∫ÜÈÅøÂÖçDML‰∏é DDLÂÜ≤Á™ÅÔºå‰øùËØÅËØªÂÜôÁöÑÊ≠£Á°ÆÊÄß„ÄÇ ËøôÈáåÁöÑÂÖÉÊï∞ÊçÆÔºåÂ§ßÂÆ∂ÂèØ‰ª•ÁÆÄÂçïÁêÜËß£‰∏∫Â∞±ÊòØ‰∏ÄÂº†Ë°®ÁöÑË°®ÁªìÊûÑ„ÄÇ ‰πüÂ∞±ÊòØËØ¥ÔºåÊüê‰∏ÄÂº†Ë°®Ê∂âÂèäÂà∞<strong>Êú™Êèê‰∫§ÁöÑ‰∫ãÂä°</strong> Êó∂ÔºåÊòØ‰∏çËÉΩÂ§ü‰øÆÊîπËøôÂº†Ë°®ÁöÑË°®ÁªìÊûÑÁöÑ„ÄÇ Âú®MySQL5.5‰∏≠ÂºïÂÖ•‰∫ÜMDLÔºåÂΩìÂØπ‰∏ÄÂº†Ë°®ËøõË°åÂ¢ûÂà†ÊîπÊü•ÁöÑÊó∂ÂÄôÔºåÂä†MDLËØªÈîÅ(ÂÖ±‰∫´)ÔºõÂΩìÂØπË°®ÁªìÊûÑËøõË°åÂèò Êõ¥Êìç‰ΩúÁöÑÊó∂ÂÄôÔºåÂä†MDLÂÜôÈîÅ(Êéí‰ªñ)„ÄÇ</p><p>MyISAM ÂºïÊìéÂú®ÊâßË°åÊü•ËØ¢ËØ≠Âè•‰πãÂâçÔºå‰ºö<strong>Ëá™Âä®</strong>ÁªôÊ∂âÂèäÂà∞ÁöÑÊâÄÊúâË°®Âä†ËØªÈîÅÔºåÂú®ÊâßË°åÂ¢ûÂà†Êîπ‰πãÂâçÔºå‰ºö<strong>Ëá™Âä®</strong>ÁªôÊ∂âÂèäÁöÑË°®Âä†ÂÜôÈîÅÔºåËøô‰∏™ËøáÁ®ãÂπ∂‰∏çÈúÄË¶ÅÁî®Êà∑Âπ≤È¢ÑÔºåÊâÄ‰ª•Áî®Êà∑‰∏ÄËà¨‰∏çÈúÄË¶ÅÁõ¥Êé•Áî® LOCK TABLE ÂëΩ‰ª§Áªô MyISAM Ë°®ÊòæÂºèÂä†ÈîÅ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687097771548.png" alt="1687097771548" tabindex="0" loading="lazy"><figcaption>1687097771548</figcaption></figure><p>Êü•ÁúãÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÂÖÉÊï∞ÊçÆÈîÅÁöÑÊÉÖÂÜµÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>select object_type,object_schema,object_name,lock_type,lock_duration from </span></span>
<span class="line"><span>performance_schema.metadata_locks ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>Âä†ÈîÅÂëΩ‰ª§ÔºöÔºàÂØπ InnoDB Â≠òÂÇ®ÂºïÊìé‰πüÈÄÇÁî®Ôºâ</p><p>ËØªÈîÅÔºöÊâÄÊúâËøûÊé•Âè™ËÉΩËØªÂèñÊï∞ÊçÆÔºå‰∏çËÉΩ‰øÆÊîπ</p><p>ÂÜôÈîÅÔºöÂÖ∂‰ªñËøûÊé•‰∏çËÉΩÊü•ËØ¢Âíå‰øÆÊîπÊï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ËØªÈîÅ</span></span>
<span class="line"><span>LOCK TABLE table_name READ;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ÂÜôÈîÅ</span></span>
<span class="line"><span>LOCK TABLE table_name WRITE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Ëß£ÈîÅÂëΩ‰ª§Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- Â∞ÜÂΩìÂâç‰ºöËØùÊâÄÊúâÁöÑË°®ËøõË°åËß£ÈîÅ</span></span>
<span class="line"><span>UNLOCK TABLES;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>ÈîÅÁöÑÂÖºÂÆπÊÄßÔºö</p><ul><li>ÂØπ MyISAM Ë°®ÁöÑËØªÊìç‰ΩúÔºå‰∏ç‰ºöÈòªÂ°ûÂÖ∂‰ªñÁî®Êà∑ÂØπÂêå‰∏ÄË°®ÁöÑËØªËØ∑Ê±ÇÔºå‰ΩÜ‰ºöÈòªÂ°ûÂØπÂêå‰∏ÄË°®ÁöÑÂÜôËØ∑Ê±Ç</li><li>ÂØπ MyISAM Ë°®ÁöÑÂÜôÊìç‰ΩúÔºåÂàô‰ºöÈòªÂ°ûÂÖ∂‰ªñÁî®Êà∑ÂØπÂêå‰∏ÄË°®ÁöÑËØªÂíåÂÜôÊìç‰Ωú</li></ul><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM ÈîÅÁöÑÂÖºÂÆπÊÄß.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ÈîÅË∞ÉÂ∫¶Ôºö<strong>MyISAM ÁöÑËØªÂÜôÈîÅË∞ÉÂ∫¶ÊòØÂÜô‰ºòÂÖà</strong>ÔºåÂõ†‰∏∫ÂÜôÈîÅÂêéÂÖ∂‰ªñÁ∫øÁ®ã‰∏çËÉΩÂÅö‰ªª‰ΩïÊìç‰ΩúÔºåÂ§ßÈáèÁöÑÊõ¥Êñ∞‰ºö‰ΩøÊü•ËØ¢ÂæàÈöæÂæóÂà∞ÈîÅÔºå‰ªéËÄåÈÄ†ÊàêÊ∞∏ËøúÈòªÂ°ûÔºåÊâÄ‰ª• MyISAM ‰∏çÈÄÇÂêàÂÅöÂÜô‰∏∫‰∏ªÁöÑË°®ÁöÑÂ≠òÂÇ®ÂºïÊìé</p><hr><h4 id="ÈîÅÊìç‰Ωú" tabindex="-1"><a class="header-anchor" href="#ÈîÅÊìç‰Ωú"><span>ÈîÅÊìç‰Ωú</span></a></h4><h5 id="ËØªÈîÅ" tabindex="-1"><a class="header-anchor" href="#ËØªÈîÅ"><span>ËØªÈîÅ</span></a></h5><p>‰∏§‰∏™ÂÆ¢Êà∑Á´ØÊìç‰Ωú Client 1Âíå Client 2ÔºåÁÆÄÂåñ‰∏∫ C1„ÄÅC2</p><ul><li><p>Êï∞ÊçÆÂáÜÂ§áÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE `tb_book` (</span></span>
<span class="line"><span>  `id` INT(11) AUTO_INCREMENT,</span></span>
<span class="line"><span>  `name` VARCHAR(50) DEFAULT NULL,</span></span>
<span class="line"><span>  `publish_time` DATE DEFAULT NULL,</span></span>
<span class="line"><span>  `status` CHAR(1) DEFAULT NULL,</span></span>
<span class="line"><span>  PRIMARY KEY (`id`)</span></span>
<span class="line"><span>) ENGINE=MYISAM DEFAULT CHARSET=utf8 ;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>INSERT INTO tb_book (id, NAME, publish_time, STATUS) VALUES(NULL,&#39;javaÁºñÁ®ãÊÄùÊÉ≥&#39;,&#39;2088-08-01&#39;,&#39;1&#39;);</span></span>
<span class="line"><span>INSERT INTO tb_book (id, NAME, publish_time, STATUS) VALUES(NULL,&#39;mysqlÁºñÁ®ãÊÄùÊÉ≥&#39;,&#39;2088-08-08&#39;,&#39;0&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>C1„ÄÅC2 Âä†ËØªÈîÅÔºåÂêåÊó∂Êü•ËØ¢ÂèØ‰ª•Ê≠£Â∏∏Êü•ËØ¢Âá∫Êï∞ÊçÆ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>LOCK TABLE tb_book READ;	-- C1„ÄÅC2</span></span>
<span class="line"><span>SELECT * FROM tb_book;		-- C1„ÄÅC2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM ËØªÈîÅ1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>C1 Âä†ËØªÈîÅÔºåC1„ÄÅC2 Êü•ËØ¢Êú™ÈîÅÂÆöÁöÑË°®ÔºåC1 Êä•ÈîôÔºåC2 Ê≠£Â∏∏Êü•ËØ¢</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>LOCK TABLE tb_book READ;	-- C1</span></span>
<span class="line"><span>SELECT * FROM tb_user;		-- C1„ÄÅC2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM ËØªÈîÅ2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>C1„ÄÅC2 ÊâßË°åÊèíÂÖ•Êìç‰ΩúÔºåC1 Êä•ÈîôÔºåC2 Á≠âÂæÖËé∑Âèñ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>INSERT INTO tb_book VALUES(NULL,&#39;SpringÈ´òÁ∫ß&#39;,&#39;2088-01-01&#39;,&#39;1&#39;);	-- C1„ÄÅC2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM ËØªÈîÅ3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ÂΩìÂú® C1 ‰∏≠ÈáäÊîæÈîÅÊåá‰ª§ UNLOCK TABLESÔºåC2 ‰∏≠ÁöÑ INSERT ËØ≠Âè•Á´ãÂç≥ÊâßË°å</p></li></ul><hr><h5 id="ÂÜôÈîÅ" tabindex="-1"><a class="header-anchor" href="#ÂÜôÈîÅ"><span>ÂÜôÈîÅ</span></a></h5><p>‰∏§‰∏™ÂÆ¢Êà∑Á´ØÊìç‰Ωú Client 1Âíå Client 2ÔºåÁÆÄÂåñ‰∏∫ C1„ÄÅC2</p><ul><li><p>C1 Âä†ÂÜôÈîÅÔºåC1„ÄÅC2Êü•ËØ¢Ë°®ÔºåC1 Ê≠£Â∏∏Êü•ËØ¢ÔºåC2 ÈúÄË¶ÅÁ≠âÂæÖ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>LOCK TABLE tb_book WRITE;	-- C1</span></span>
<span class="line"><span>SELECT * FROM tb_book;		-- C1„ÄÅC2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM ÂÜôÈîÅ1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ÂΩìÂú® C1 ‰∏≠ÈáäÊîæÈîÅÊåá‰ª§ UNLOCK TABLESÔºåC2 ‰∏≠ÁöÑ SELECT ËØ≠Âè•Á´ãÂç≥ÊâßË°å</p></li><li><p>C1„ÄÅC2 ÂêåÊó∂Âä†ÂÜôÈîÅ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>LOCK TABLE tb_book WRITE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM ÂÜôÈîÅ2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>C1 Âä†ÂÜôÈîÅÔºåC1„ÄÅC2Êü•ËØ¢Êú™ÈîÅÂÆöÁöÑË°®ÔºåC1 Êä•ÈîôÔºåC2 Ê≠£Â∏∏Êü•ËØ¢</p></li></ul><hr><h4 id="ÈîÅÁä∂ÊÄÅ" tabindex="-1"><a class="header-anchor" href="#ÈîÅÁä∂ÊÄÅ"><span>ÈîÅÁä∂ÊÄÅ</span></a></h4><ul><li><p>Êü•ÁúãÈîÅÁ´û‰∫âÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW OPEN TABLES;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ÈîÅ‰∫âÁî®ÊÉÖÂÜµÊü•Áúã1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>In_userÔºöË°®ÂΩìÂâçË¢´Êü•ËØ¢‰ΩøÁî®ÁöÑÊ¨°Êï∞ÔºåÂ¶ÇÊûúËØ•Êï∞‰∏∫Èõ∂ÔºåÂàôË°®ÊòØÊâìÂºÄÁöÑÔºå‰ΩÜÊòØÂΩìÂâçÊ≤°ÊúâË¢´‰ΩøÁî®</p><p>Name_lockedÔºöË°®ÂêçÁß∞ÊòØÂê¶Ë¢´ÈîÅÂÆöÔºåÂêçÁß∞ÈîÅÂÆöÁî®‰∫éÂèñÊ∂àË°®ÊàñÂØπË°®ËøõË°åÈáçÂëΩÂêçÁ≠âÊìç‰Ωú</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>LOCK TABLE tb_book READ;	-- ÊâßË°åÂëΩ‰ª§</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ÈîÅ‰∫âÁî®ÊÉÖÂÜµÊü•Áúã2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Êü•ÁúãÈîÅÁä∂ÊÄÅÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW STATUS LIKE &#39;Table_locks%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-MyISAM ÈîÅÁä∂ÊÄÅ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Table_locks_immediateÔºöÊåáÁöÑÊòØËÉΩÁ´ãÂç≥Ëé∑ÂæóË°®Á∫ßÈîÅÁöÑÊ¨°Êï∞ÔºåÊØèÁ´ãÂç≥Ëé∑ÂèñÈîÅÔºåÂÄºÂä† 1</p><p>Table_locks_waitedÔºöÊåáÁöÑÊòØ‰∏çËÉΩÁ´ãÂç≥Ëé∑ÂèñË°®Á∫ßÈîÅËÄåÈúÄË¶ÅÁ≠âÂæÖÁöÑÊ¨°Êï∞ÔºåÊØèÁ≠âÂæÖ‰∏ÄÊ¨°ÔºåËØ•ÂÄºÂä† 1ÔºåÊ≠§ÂÄºÈ´òËØ¥ÊòéÂ≠òÂú®ÁùÄËæÉ‰∏∫‰∏•ÈáçÁöÑË°®Á∫ßÈîÅ‰∫âÁî®ÊÉÖÂÜµ</p></li></ul><hr><h3 id="innodb-1" tabindex="-1"><a class="header-anchor" href="#innodb-1"><span>InnoDB</span></a></h3><h4 id="Ë°åÁ∫ßÈîÅ" tabindex="-1"><a class="header-anchor" href="#Ë°åÁ∫ßÈîÅ"><span>Ë°åÁ∫ßÈîÅ</span></a></h4><p>Ë°åÁ∫ßÈîÅÔºåÊØèÊ¨°Êìç‰ΩúÈîÅ‰ΩèÂØπÂ∫îÁöÑË°åÊï∞ÊçÆ„ÄÇÈîÅÂÆöÁ≤íÂ∫¶ÊúÄÂ∞èÔºåÂèëÁîüÈîÅÂÜ≤Á™ÅÁöÑÊ¶ÇÁéáÊúÄ‰ΩéÔºåÂπ∂ÂèëÂ∫¶ÊúÄÈ´ò„ÄÇÂ∫îÁî®Âú® InnoDBÂ≠òÂÇ®ÂºïÊìé‰∏≠„ÄÇ InnoDBÁöÑÊï∞ÊçÆÊòØÂü∫‰∫éÁ¥¢ÂºïÁªÑÁªáÁöÑÔºåË°åÈîÅÊòØÈÄöËøáÂØπÁ¥¢Âºï‰∏äÁöÑÁ¥¢ÂºïÈ°πÂä†ÈîÅÊù•ÂÆûÁé∞ÁöÑÔºåËÄå‰∏çÊòØÂØπËÆ∞ÂΩïÂä†ÁöÑ ÈîÅ„ÄÇÂØπ‰∫éË°åÁ∫ßÈîÅÔºå‰∏ªË¶ÅÂàÜ‰∏∫‰ª•‰∏ã‰∏âÁ±ªÔºö Ë°åÈîÅÔºàRecord LockÔºâÔºöÈîÅÂÆöÂçï‰∏™Ë°åËÆ∞ÂΩïÁöÑÈîÅÔºåÈò≤Ê≠¢ÂÖ∂‰ªñ‰∫ãÂä°ÂØπÊ≠§Ë°åËøõË°åupdateÂíådelete„ÄÇÂú® RC„ÄÅRRÈöîÁ¶ªÁ∫ßÂà´‰∏ãÈÉΩÊîØÊåÅ„ÄÇ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687173958031.png" alt="1687173958031" tabindex="0" loading="lazy"><figcaption>1687173958031</figcaption></figure><p>Èó¥ÈöôÈîÅÔºàGap LockÔºâÔºöÈîÅÂÆöÁ¥¢ÂºïËÆ∞ÂΩïÈó¥ÈöôÔºà‰∏çÂê´ËØ•ËÆ∞ÂΩïÔºâÔºåÁ°Æ‰øùÁ¥¢ÂºïËÆ∞ÂΩïÈó¥Èöô‰∏çÂèòÔºåÈò≤Ê≠¢ÂÖ∂‰ªñ‰∫ã Âä°Âú®Ëøô‰∏™Èó¥ÈöôËøõË°åinsertÔºå‰∫ßÁîüÂπªËØª„ÄÇÂú®RRÈöîÁ¶ªÁ∫ßÂà´‰∏ãÈÉΩÊîØÊåÅ„ÄÇ<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687173976336.png" alt="1687173976336" loading="lazy"></p><p>‰∏¥ÈîÆÈîÅÔºàNext-Key LockÔºâÔºöË°åÈîÅÂíåÈó¥ÈöôÈîÅÁªÑÂêàÔºåÂêåÊó∂ÈîÅ‰ΩèÊï∞ÊçÆÔºåÂπ∂ÈîÅ‰ΩèÊï∞ÊçÆÂâçÈù¢ÁöÑÈó¥ÈöôGap„ÄÇ Âú®RRÈöîÁ¶ªÁ∫ßÂà´‰∏ãÊîØÊåÅ„ÄÇ<img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687173999332.png" alt="1687173999332" loading="lazy"></p><h5 id="ËÆ∞ÂΩïÈîÅ" tabindex="-1"><a class="header-anchor" href="#ËÆ∞ÂΩïÈîÅ"><span>ËÆ∞ÂΩïÈîÅ</span></a></h5><p>InnoDB ‰∏é MyISAM ÁöÑÊúÄÂ§ß‰∏çÂêåÊúâ‰∏§ÁÇπÔºö‰∏ÄÊòØÊîØÊåÅ‰∫ãÂä°Ôºõ‰∫åÊòØÈááÁî®‰∫ÜË°åÁ∫ßÈîÅÔºå<strong>InnoDB ÂêåÊó∂ÊîØÊåÅË°®ÈîÅÂíåË°åÈîÅ</strong></p><p>Ë°åÁ∫ßÈîÅÔºå‰πüÁß∞‰∏∫ËÆ∞ÂΩïÈîÅÔºàRecord LockÔºâÔºåInnoDB ÂÆûÁé∞‰∫Ü‰ª•‰∏ã‰∏§ÁßçÁ±ªÂûãÁöÑË°åÈîÅÔºö</p><ul><li>ÂÖ±‰∫´ÈîÅ (S)ÔºöÂèàÁß∞‰∏∫ËØªÈîÅÔºåÁÆÄÁß∞ S ÈîÅÔºåÂ§ö‰∏™‰∫ãÂä°ÂØπ‰∫éÂêå‰∏ÄÊï∞ÊçÆÂèØ‰ª•ÂÖ±‰∫´‰∏ÄÊääÈîÅÔºåÈÉΩËÉΩËÆøÈóÆÂà∞Êï∞ÊçÆÔºå‰ΩÜÊòØÂè™ËÉΩËØª‰∏çËÉΩ‰øÆÊîπ</li><li>Êéí‰ªñÈîÅ (X)ÔºöÂèàÁß∞‰∏∫ÂÜôÈîÅÔºåÁÆÄÁß∞ X ÈîÅÔºå‰∏çËÉΩ‰∏éÂÖ∂‰ªñÈîÅÂπ∂Â≠òÔºåËé∑ÂèñÊéí‰ªñÈîÅÁöÑ‰∫ãÂä°ÊòØÂèØ‰ª•ÂØπÊï∞ÊçÆËØªÂèñÂíå‰øÆÊîπ</li></ul><p>RR ÈöîÁ¶ªÁïåÂà´‰∏ãÔºåÂØπ‰∫é UPDATE„ÄÅDELETE Âíå INSERT ËØ≠Âè•ÔºåInnoDB ‰ºö<strong>Ëá™Âä®ÁªôÊ∂âÂèäÊï∞ÊçÆÈõÜÂä†Êéí‰ªñÈîÅ</strong>ÔºàË°åÈîÅÔºâÔºåÂú® commit Êó∂Ëá™Âä®ÈáäÊîæÔºõÂØπ‰∫éÊôÆÈÄö SELECT ËØ≠Âè•Ôºå‰∏ç‰ºöÂä†‰ªª‰ΩïÈîÅÔºàÂè™ÊòØÈíàÂØπ InnoDB Â±ÇÊù•ËØ¥ÁöÑÔºåÂõ†‰∏∫Âú® Server Â±Ç‰ºö<strong>Âä† MDL ËØªÈîÅ</strong>ÔºâÔºåÈÄöËøá MVCC Èò≤Ê≠¢Âπ∂ÂèëÂÜ≤Á™Å</p><p>Âú®‰∫ãÂä°‰∏≠Âä†ÁöÑÈîÅÔºåÂπ∂‰∏çÊòØ‰∏çÈúÄË¶Å‰∫ÜÂ∞±ÈáäÊîæÔºåËÄåÊòØÂú®‰∫ãÂä°‰∏≠Ê≠¢ÊàñÊèê‰∫§Êó∂Ëá™Âä®ÈáäÊîæÔºåËøô‰∏™Â∞±ÊòØ<strong>‰∏§Èò∂ÊÆµÈîÅÂçèËÆÆ</strong>„ÄÇÊâÄ‰ª•‰∏ÄËà¨Â∞ÜÊõ¥Êñ∞ÂÖ±‰∫´ËµÑÊ∫êÔºàÂπ∂ÂèëÈ´òÔºâÁöÑ SQL ÊîæÂà∞‰∫ãÂä°ÁöÑÊúÄÂêéÊâßË°åÔºåÂèØ‰ª•ËÆ©ÂÖ∂‰ªñÁ∫øÁ®ãÂ∞ΩÈáèÁöÑÂáèÂ∞ëÁ≠âÂæÖÊó∂Èó¥</p><p>ÈîÅÁöÑÂÖºÂÆπÊÄßÔºö</p><ul><li><p>ÂÖ±‰∫´ÈîÅÂíåÂÖ±‰∫´ÈîÅ ÂÖºÂÆπ</p></li><li><p>ÂÖ±‰∫´ÈîÅÂíåÊéí‰ªñÈîÅ ÂÜ≤Á™Å</p></li><li><p>Êéí‰ªñÈîÅÂíåÊéí‰ªñÈîÅ ÂÜ≤Á™Å</p></li><li><p>Êéí‰ªñÈîÅÂíåÂÖ±‰∫´ÈîÅ ÂÜ≤Á™Å</p><p>Â∏∏ËßÅÁöÑSQLËØ≠Âè•ÔºåÂú®ÊâßË°åÊó∂ÔºåÊâÄÂä†ÁöÑË°åÈîÅÂ¶Ç‰∏ãÔºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/1687174241521.png" alt="1687174241521" tabindex="0" loading="lazy"><figcaption>1687174241521</figcaption></figure></li></ul><p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåInnoDBÂú® REPEATABLE READ‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ËøêË°åÔºåInnoDB‰ΩøÁî® next-key ÈîÅËøõË°åÊêú Á¥¢ÂíåÁ¥¢ÂºïÊâ´ÊèèÔºå‰ª•Èò≤Ê≠¢ÂπªËØª„ÄÇ ÈíàÂØπÂîØ‰∏ÄÁ¥¢ÂºïËøõË°åÊ£ÄÁ¥¢Êó∂ÔºåÂØπÂ∑≤Â≠òÂú®ÁöÑËÆ∞ÂΩïËøõË°åÁ≠âÂÄºÂåπÈÖçÊó∂ÔºåÂ∞Ü‰ºöËá™Âä®‰ºòÂåñ‰∏∫Ë°åÈîÅ„ÄÇ InnoDBÁöÑË°åÈîÅÊòØÈíàÂØπ‰∫éÁ¥¢ÂºïÂä†ÁöÑÈîÅÔºå‰∏çÈÄöËøáÁ¥¢ÂºïÊù°‰ª∂Ê£ÄÁ¥¢Êï∞ÊçÆÔºåÈÇ£‰πàInnoDBÂ∞ÜÂØπË°®‰∏≠ÁöÑÊâÄÊúâËÆ∞ ÂΩïÂä†ÈîÅÔºåÊ≠§Êó∂ Â∞±‰ºö<strong>ÂçáÁ∫ß‰∏∫Ë°®ÈîÅ</strong>„ÄÇ</p><p>ÊòæÂºèÁªôÊï∞ÊçÆÈõÜÂä†ÂÖ±‰∫´ÈîÅÊàñÊéí‰ªñÈîÅÔºö<strong>Âä†ÈîÅËØªÂ∞±ÊòØÂΩìÂâçËØªÔºåËØªÂèñÁöÑÊòØÊúÄÊñ∞Êï∞ÊçÆ</strong></p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM table_name WHERE ... LOCK IN SHARE MODE	-- ÂÖ±‰∫´ÈîÅ</span></span>
<span class="line"><span>SELECT * FROM table_name WHERE ... FOR UPDATE			-- Êéí‰ªñÈîÅ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Ê≥®ÊÑèÔºö<strong>ÈîÅÈªòËÆ§‰ºöÈîÅËÅöÁ∞áÁ¥¢ÂºïÔºàÈîÅÂ∞±ÊòØÂä†Âú®Á¥¢Âºï‰∏äÔºâ</strong>Ôºå‰ΩÜÊòØÂΩì‰ΩøÁî®Ë¶ÜÁõñÁ¥¢ÂºïÊó∂ÔºåÂä†ÂÖ±‰∫´ÈîÅÂè™ÈîÅ‰∫åÁ∫ßÁ¥¢ÂºïÔºå‰∏çÈîÅËÅöÁ∞áÁ¥¢Âºï</p><hr><h5 id="ÈîÅÊìç‰Ωú-1" tabindex="-1"><a class="header-anchor" href="#ÈîÅÊìç‰Ωú-1"><span>ÈîÅÊìç‰Ωú</span></a></h5><p>‰∏§‰∏™ÂÆ¢Êà∑Á´ØÊìç‰Ωú Client 1Âíå Client 2ÔºåÁÆÄÂåñ‰∏∫ C1„ÄÅC2</p><ul><li><p>ÁéØÂ¢ÉÂáÜÂ§á</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE TABLE test_innodb_lock(</span></span>
<span class="line"><span>	id INT(11),</span></span>
<span class="line"><span>	name VARCHAR(16),</span></span>
<span class="line"><span>	sex VARCHAR(1)</span></span>
<span class="line"><span>)ENGINE = INNODB DEFAULT CHARSET=utf8;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>INSERT INTO test_innodb_lock VALUES(1,&#39;100&#39;,&#39;1&#39;);</span></span>
<span class="line"><span>-- ..........</span></span>
<span class="line"><span></span></span>
<span class="line"><span>CREATE INDEX idx_test_innodb_lock_id ON test_innodb_lock(id);</span></span>
<span class="line"><span>CREATE INDEX idx_test_innodb_lock_name ON test_innodb_lock(name);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂÖ≥Èó≠Ëá™Âä®Êèê‰∫§ÂäüËÉΩÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET AUTOCOMMIT=0;	-- C1„ÄÅC2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Ê≠£Â∏∏Êü•ËØ¢Êï∞ÊçÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM test_innodb_lock;	-- C1„ÄÅC2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢ id ‰∏∫ 3 ÁöÑÊï∞ÊçÆÔºåÊ≠£Â∏∏Êü•ËØ¢Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM test_innodb_lock WHERE id=3;	-- C1„ÄÅC2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB ÈîÅÊìç‰Ωú1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>C1 Êõ¥Êñ∞ id ‰∏∫ 3 ÁöÑÊï∞ÊçÆÔºå‰ΩÜ‰∏çÊèê‰∫§Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>UPDATE test_innodb_lock SET name=&#39;300&#39; WHERE id=3;	-- C1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB ÈîÅÊìç‰Ωú2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>C2 Êü•ËØ¢‰∏çÂà∞ C1 ‰øÆÊîπÁöÑÊï∞ÊçÆÔºåÂõ†‰∏∫ÈöîÁ¶ªÁïåÂà´‰∏∫ REPEATABLE READÔºåC1 Êèê‰∫§‰∫ãÂä°ÔºåC2 Êü•ËØ¢Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>COMMIT;	-- C1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB ÈîÅÊìç‰Ωú3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Êèê‰∫§Âêé‰ªçÁÑ∂Êü•ËØ¢‰∏çÂà∞ C1 ‰øÆÊîπÁöÑÊï∞ÊçÆÔºåÂõ†‰∏∫ÈöîÁ¶ªÁ∫ßÂà´ÂèØ‰ª•Èò≤Ê≠¢ËÑèËØª„ÄÅ‰∏çÂèØÈáçÂ§çËØªÔºåÊâÄ‰ª• C2 ÈúÄË¶ÅÊèê‰∫§ÊâçÂèØ‰ª•Êü•ËØ¢Âà∞ÂÖ∂‰ªñ‰∫ãÂä°ÂØπÊï∞ÊçÆÁöÑ‰øÆÊîπÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>COMMIT;	-- C2</span></span>
<span class="line"><span>SELECT * FROM test_innodb_lock WHERE id=3;	-- C2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB ÈîÅÊìç‰Ωú4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>C1 Êõ¥Êñ∞ id ‰∏∫ 3 ÁöÑÊï∞ÊçÆÔºå‰ΩÜ‰∏çÊèê‰∫§ÔºåC2 ‰πüÊõ¥Êñ∞ id ‰∏∫ 3 ÁöÑÊï∞ÊçÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>UPDATE test_innodb_lock SET name=&#39;3&#39; WHERE id=3;	-- C1</span></span>
<span class="line"><span>UPDATE test_innodb_lock SET name=&#39;30&#39; WHERE id=3;	-- C2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB ÈîÅÊìç‰Ωú5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ÂΩì C1 Êèê‰∫§ÔºåC2 Áõ¥Êé•Ëß£Èô§ÈòªÂ°ûÔºåÁõ¥Êé•Êõ¥Êñ∞</p></li><li><p>Êìç‰Ωú‰∏çÂêåË°åÁöÑÊï∞ÊçÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>UPDATE test_innodb_lock SET name=&#39;10&#39; WHERE id=1;	-- C1</span></span>
<span class="line"><span>UPDATE test_innodb_lock SET name=&#39;30&#39; WHERE id=3;	-- C2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB ÈîÅÊìç‰Ωú6.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Áî±‰∫é C1„ÄÅC2 Êìç‰ΩúÁöÑ‰∏çÂêåË°åÔºåËé∑Âèñ‰∏çÂêåÁöÑË°åÈîÅÔºåÊâÄ‰ª•ÈÉΩÂèØ‰ª•Ê≠£Â∏∏Ëé∑ÂèñË°åÈîÅ</p></li></ul><hr><h4 id="ÈîÅÂàÜÁ±ª" tabindex="-1"><a class="header-anchor" href="#ÈîÅÂàÜÁ±ª"><span>ÈîÅÂàÜÁ±ª</span></a></h4><h5 id="Èó¥ÈöôÈîÅ" tabindex="-1"><a class="header-anchor" href="#Èó¥ÈöôÈîÅ"><span>Èó¥ÈöôÈîÅ</span></a></h5><p>InnoDB ‰ºöÂØπÈó¥ÈöôÔºàGAPÔºâËøõË°åÂä†ÈîÅÔºåÂ∞±ÊòØÈó¥ÈöôÈîÅ ÔºàRR ÈöîÁ¶ªÁ∫ßÂà´‰∏ãÊâçÊúâËØ•ÈîÅÔºâ„ÄÇÈó¥ÈöôÈîÅ‰πãÈó¥‰∏çÂ≠òÂú®ÂÜ≤Á™ÅÂÖ≥Á≥ªÔºå<strong>Â§ö‰∏™‰∫ãÂä°ÂèØ‰ª•ÂêåÊó∂ÂØπ‰∏Ä‰∏™Èó¥ÈöôÂä†ÈîÅ</strong>Ôºå‰ΩÜÊòØÈó¥ÈöôÈîÅ‰ºöÈòªÊ≠¢ÂæÄËøô‰∏™Èó¥Èöô‰∏≠ÊèíÂÖ•‰∏Ä‰∏™ËÆ∞ÂΩïÁöÑÊìç‰Ωú</p><p>InnoDB Âä†ÈîÅÁöÑÂü∫Êú¨Âçï‰ΩçÊòØ next-key lockÔºåËØ•ÈîÅÊòØË°åÈîÅÂíå gap lock ÁöÑÁªÑÂêàÔºàX or S ÈîÅÔºâÔºå‰ΩÜÊòØÂä†ÈîÅËøáÁ®ãÊòØÂàÜ‰∏∫Èó¥ÈöôÈîÅÂíåË°åÈîÅ‰∏§ÊÆµÊâßË°å</p><ul><li>ÂèØ‰ª•<strong>‰øùÊä§ÂΩìÂâçËÆ∞ÂΩïÂíåÂâçÈù¢ÁöÑÈó¥Èöô</strong>ÔºåÈÅµÂæ™Â∑¶ÂºÄÂè≥Èó≠ÂéüÂàôÔºåÂçïÁ∫ØÁöÑÈó¥ÈöôÈîÅÊòØÂ∑¶ÂºÄÂè≥ÂºÄ</li><li>ÂÅáËÆæÊúâ 10„ÄÅ11„ÄÅ13ÔºåÈÇ£‰πàÂèØËÉΩÁöÑÈó¥ÈöôÈîÅÂåÖÊã¨Ôºö(Ë¥üÊó†Á©∑,10]„ÄÅ(10,11]„ÄÅ(11,13]„ÄÅ(13,Ê≠£Êó†Á©∑)</li></ul><p>Âá†ÁßçÁ¥¢ÂºïÁöÑÂä†ÈîÅÊÉÖÂÜµÔºö</p><ul><li>ÂîØ‰∏ÄÁ¥¢ÂºïÂä†ÈîÅÂú®ÂÄºÂ≠òÂú®Êó∂ÊòØË°åÈîÅÔºånext-key lock ‰ºöÈÄÄÂåñ‰∏∫Ë°åÈîÅÔºåÂÄº‰∏çÂ≠òÂú®‰ºöÂèòÊàêÈó¥ÈöôÈîÅ</li><li>ÊôÆÈÄöÁ¥¢ÂºïÂä†ÈîÅ‰ºöÁªßÁª≠ÂêëÂè≥ÈÅçÂéÜÂà∞‰∏çÊª°Ë∂≥Êù°‰ª∂ÁöÑÂÄº‰∏∫Ê≠¢Ôºånext-key lock ÈÄÄÂåñ‰∏∫Èó¥ÈöôÈîÅ</li><li>ËåÉÂõ¥Êü•ËØ¢Êó†ËÆ∫ÊòØÂê¶ÊòØÂîØ‰∏ÄÁ¥¢ÂºïÔºåÈÉΩÈúÄË¶ÅËÆøÈóÆÂà∞‰∏çÊª°Ë∂≥Êù°‰ª∂ÁöÑÁ¨¨‰∏Ä‰∏™ÂÄº‰∏∫Ê≠¢</li><li>ÂØπ‰∫éËÅîÂêàÁ¥¢Âºï‰∏îÊòØÂîØ‰∏ÄÁ¥¢ÂºïÔºåÂ¶ÇÊûú where Êù°‰ª∂Âè™ÂåÖÊã¨ËÅîÂêàÁ¥¢ÂºïÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÈÇ£‰πà‰ºöÂä†Èó¥ÈöôÈîÅ</li></ul><p>Èó¥ÈöôÈîÅ‰ºòÁÇπÔºöRR Á∫ßÂà´‰∏ãÈó¥ÈöôÈîÅÂèØ‰ª•<strong>Ëß£ÂÜ≥‰∫ãÂä°ÁöÑ‰∏ÄÈÉ®ÂàÜÁöÑÂπªËØªÈóÆÈ¢ò</strong>ÔºåÈÄöËøáÂØπÈó¥ÈöôÂä†ÈîÅÔºåÂèØ‰ª•Èò≤Ê≠¢ËØªÂèñËøáÁ®ã‰∏≠Êï∞ÊçÆÊù°ÁõÆÂèëÁîüÂèòÂåñ„ÄÇ‰∏ÄÈÉ®ÂàÜÁöÑÊÑèÊÄùÊòØ‰∏ç‰ºöÂØπÂÖ®ÈÉ®Èó¥ÈöôÂä†ÈîÅÔºåÂè™ËÉΩÂä†ÈîÅ‰∏ÄÈÉ®ÂàÜÁöÑÈó¥Èöô</p><p>Èó¥ÈöôÈîÅÂç±ÂÆ≥Ôºö</p><ul><li>ÂΩìÈîÅÂÆö‰∏Ä‰∏™ËåÉÂõ¥ÁöÑÈîÆÂÄºÂêéÔºåÂç≥‰ΩøÊüê‰∫õ‰∏çÂ≠òÂú®ÁöÑÈîÆÂÄº‰πü‰ºöË¢´Êó†ËæúÁöÑÈîÅÂÆöÔºåÈÄ†ÊàêÂú®ÈîÅÂÆöÁöÑÊó∂ÂÄôÊó†Ê≥ïÊèíÂÖ•ÈîÅÂÆöÈîÆÂÄºËåÉÂõ¥ÂÜÖÁöÑ‰ªª‰ΩïÊï∞ÊçÆÔºåÂú®Êüê‰∫õÂú∫ÊôØ‰∏ãËøôÂèØËÉΩ‰ºöÂØπÊÄßËÉΩÈÄ†ÊàêÂæàÂ§ßÁöÑÂç±ÂÆ≥ÔºåÂΩ±ÂìçÂπ∂ÂèëÂ∫¶</li><li>‰∫ãÂä° A B ÂêåÊó∂ÈîÅ‰Ωè‰∏Ä‰∏™Èó¥ÈöôÂêéÔºåA ÂæÄÂΩìÂâçÈó¥ÈöôÊèíÂÖ•Êï∞ÊçÆÊó∂‰ºöË¢´ B ÁöÑÈó¥ÈöôÈîÅÈòªÂ°ûÔºåB ‰πüÊâßË°åÊèíÂÖ•Èó¥ÈöôÊï∞ÊçÆÁöÑÊìç‰ΩúÊó∂Â∞±‰ºö<strong>‰∫ßÁîüÊ≠ªÈîÅ</strong></li></ul><p>Áé∞Âú∫ÊºîÁ§∫Ôºö</p><ul><li><p>ÂÖ≥Èó≠Ëá™Âä®Êèê‰∫§ÂäüËÉΩÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET AUTOCOMMIT=0;	-- C1„ÄÅC2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ËØ¢Êï∞ÊçÆË°®Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM test_innodb_lock;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB Èó¥ÈöôÈîÅ1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>C1 Ê†πÊçÆ id ËåÉÂõ¥Êõ¥Êñ∞Êï∞ÊçÆÔºåC2 ÊèíÂÖ•Êï∞ÊçÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>UPDATE test_innodb_lock SET name=&#39;8888&#39; WHERE id &lt; 4;	-- C1</span></span>
<span class="line"><span>INSERT INTO test_innodb_lock VALUES(2,&#39;200&#39;,&#39;2&#39;);		-- C2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB Èó¥ÈöôÈîÅ2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Âá∫Áé∞Èó¥ÈöôÈîÅÔºåC2 Ë¢´ÈòªÂ°ûÔºåÁ≠âÂæÖ C1 Êèê‰∫§‰∫ãÂä°ÂêéÊâçËÉΩÊõ¥Êñ∞</p></li></ul><hr><h5 id="ÊÑèÂêëÈîÅ" tabindex="-1"><a class="header-anchor" href="#ÊÑèÂêëÈîÅ"><span>ÊÑèÂêëÈîÅ</span></a></h5><p>InnoDB ‰∏∫‰∫ÜÊîØÊåÅÂ§öÁ≤íÂ∫¶ÁöÑÂä†ÈîÅÔºåÂÖÅËÆ∏Ë°åÈîÅÂíåË°®ÈîÅÂêåÊó∂Â≠òÂú®ÔºåÊîØÊåÅÂú®‰∏çÂêåÁ≤íÂ∫¶‰∏äÁöÑÂä†ÈîÅÊìç‰ΩúÔºåInnoDB Â¢ûÂä†‰∫ÜÊÑèÂêëÈîÅÔºàIntention LockÔºâ</p><p>ÊÑèÂêëÈîÅÊòØÂ∞ÜÈîÅÂÆöÁöÑÂØπË±°ÂàÜ‰∏∫Â§ö‰∏™Â±ÇÊ¨°ÔºåÊÑèÂêëÈîÅÊÑèÂë≥ÁùÄ‰∫ãÂä°Â∏åÊúõÂú®Êõ¥ÁªÜÁ≤íÂ∫¶‰∏äËøõË°åÂä†ÈîÅÔºåÊÑèÂêëÈîÅÂàÜ‰∏∫‰∏§ÁßçÔºö</p><ul><li>ÊÑèÂêëÂÖ±‰∫´ÈîÅÔºàISÔºâÔºö‰∫ãÂä°ÊúâÊÑèÂêëÂØπË°®Âä†ÂÖ±‰∫´ÈîÅÔºå‰∏éË°®ÈîÅÂÖ±‰∫´ÈîÅÔºàreadÔºâÂÖºÂÆπÔºå‰∏éË°®ÈîÅÊéí‰ªñÈîÅÔºàwriteÔºâ‰∫íÊñ•„ÄÇ</li><li>ÊÑèÂêëÊéí‰ªñÈîÅÔºàIXÔºâÔºö‰∫ãÂä°ÊúâÊÑèÂêëÂØπË°®Âä†Êéí‰ªñÈîÅÔºå‰∏éË°®ÈîÅÂÖ±‰∫´ÈîÅÔºàreadÔºâÂèäÊéí‰ªñÈîÅÔºàwriteÔºâÈÉΩ‰∫íÊñ•„ÄÇÊÑèÂêëÈîÅ‰πãÈó¥‰∏ç‰ºöÁõ∏‰∫íÊéíÊñ•„ÄÇ</li></ul><p><strong>IXÔºåIS ÊòØË°®Á∫ßÈîÅ</strong>Ôºå‰∏ç‰ºöÂíåË°åÁ∫ßÁöÑ XÔºåS ÈîÅÂèëÁîüÂÜ≤Á™ÅÔºåÊÑèÂêëÈîÅÊòØÂú®Âä†Ë°®Á∫ßÈîÅ‰πãÂâçÊ∑ªÂä†Ôºå‰∏∫‰∫ÜÂú®Âä†Ë°®Á∫ßÈîÅÊó∂ÂèØ‰ª•Âø´ÈÄüÂà§Êñ≠Ë°®‰∏≠ÊòØÂê¶ÊúâËÆ∞ÂΩïË¢´‰∏äÈîÅÔºåÊØîÂ¶ÇÂêë‰∏Ä‰∏™Ë°®Ê∑ªÂä†Ë°®Á∫ß X ÈîÅÁöÑÊó∂Ôºö</p><ul><li>Ê≤°ÊúâÊÑèÂêëÈîÅÔºåÂàôÈúÄË¶ÅÈÅçÂéÜÊï¥‰∏™Ë°®Âà§Êñ≠ÊòØÂê¶ÊúâÈîÅÂÆöÁöÑËÆ∞ÂΩï</li><li>Êúâ‰∫ÜÊÑèÂêëÈîÅÔºåÈ¶ñÂÖàÂà§Êñ≠ÊòØÂê¶Â≠òÂú®ÊÑèÂêëÈîÅÔºåÁÑ∂ÂêéÂà§Êñ≠ËØ•ÊÑèÂêëÈîÅ‰∏éÂç≥Â∞ÜÊ∑ªÂä†ÁöÑË°®Á∫ßÈîÅÊòØÂê¶ÂÖºÂÆπÂç≥ÂèØÔºåÂõ†‰∏∫ÊÑèÂêëÈîÅÁöÑÂ≠òÂú®‰ª£Ë°®ÊúâË°®Á∫ßÈîÅÁöÑÂ≠òÂú®ÊàñËÄÖÂç≥Â∞ÜÊúâË°®Á∫ßÈîÅÁöÑÂ≠òÂú®</li></ul><p>ÂÖºÂÆπÊÄßÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ÊÑèÂêëÈîÅÂÖºÂÆπÊÄß.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>ÊèíÂÖ•ÊÑèÂêëÈîÅ</strong> Insert Intention Lock ÊòØÂú®ÊèíÂÖ•‰∏ÄË°åËÆ∞ÂΩïÊìç‰Ωú‰πãÂâçËÆæÁΩÆÁöÑ‰∏ÄÁßçÈó¥ÈöôÈîÅÔºåÊòØË°åÁ∫ßÈîÅ</p><p>ÊèíÂÖ•ÊÑèÂêëÈîÅÈáäÊîæ‰∫Ü‰∏ÄÁßçÊèíÂÖ•‰ø°Âè∑ÔºåÂç≥Â§ö‰∏™‰∫ãÂä°Âú®Áõ∏ÂêåÁöÑÁ¥¢ÂºïÈó¥ÈöôÊèíÂÖ•Êó∂Â¶ÇÊûú‰∏çÊòØÊèíÂÖ•Áõ∏ÂêåÁöÑÈó¥Èöô‰ΩçÁΩÆÂ∞±‰∏çÈúÄË¶Å‰∫íÁõ∏Á≠âÂæÖ„ÄÇÂÅáËÆæÊüêÂàóÊúâÁ¥¢ÂºïÔºåÂè™Ë¶Å‰∏§‰∏™‰∫ãÂä°ÊèíÂÖ•‰ΩçÁΩÆ‰∏çÂêåÔºåÂ¶Ç‰∫ãÂä° A ÊèíÂÖ• 3Ôºå‰∫ãÂä° B ÊèíÂÖ• 4ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ÂêåÊó∂ÊèíÂÖ•</p><hr><h5 id="Ëá™Â¢ûÈîÅ" tabindex="-1"><a class="header-anchor" href="#Ëá™Â¢ûÈîÅ"><span>Ëá™Â¢ûÈîÅ</span></a></h5><p>Á≥ªÁªü‰ºöËá™Âä®Áªô AUTO_INCREMENT ‰øÆÈ•∞ÁöÑÂàóËøõË°åÈÄíÂ¢ûËµãÂÄºÔºåÂÆûÁé∞ÊñπÂºèÔºö</p><ul><li>AUTO_INC ÈîÅÔºöË°®Á∫ßÈîÅÔºåÊâßË°åÊèíÂÖ•ËØ≠Âè•Êó∂‰ºöËá™Âä®Ê∑ªÂä†ÔºåÂú®ËØ•ËØ≠Âè•ÊâßË°åÂÆåÊàêÂêéÈáäÊîæÔºåÂπ∂‰∏çÊòØ‰∫ãÂä°ÁªìÊùü</li><li>ËΩªÈáèÁ∫ßÈîÅÔºö‰∏∫ÊèíÂÖ•ËØ≠Âè•ÁîüÊàê AUTO_INCREMENT ‰øÆÈ•∞ÁöÑÂàóÊó∂Ëé∑ÂèñËØ•ÈîÅÔºåÁîüÊàê‰ª•ÂêéÈáäÊîæÊéâÔºå‰∏çÈúÄË¶ÅÁ≠âÂà∞ÊèíÂÖ•ËØ≠Âè•ÊâßË°åÂÆåÂêéÈáäÊîæ</li></ul><p>Á≥ªÁªüÂèòÈáè <code>innodb_autoinc_lock_mode</code> ÊéßÂà∂ÈááÂèñÂì™ÁßçÊñπÂºèÔºö</p><ul><li>0ÔºöÂÖ®ÈÉ®ÈááÁî® AUTO_INC ÈîÅ</li><li>1ÔºöÂÖ®ÈÉ®ÈááÁî®ËΩªÈáèÁ∫ßÈîÅ</li><li>2ÔºöÊ∑∑Âêà‰ΩøÁî®ÔºåÂú®ÊèíÂÖ•ËÆ∞ÂΩïÁöÑÊï∞ÈáèÁ°ÆÂÆöÊó∂ÈááÁî®ËΩªÈáèÁ∫ßÈîÅÔºå‰∏çÁ°ÆÂÆöÊó∂ÈááÁî® AUTO_INC ÈîÅ</li></ul><hr><h5 id="ÈöêÂºèÈîÅ" tabindex="-1"><a class="header-anchor" href="#ÈöêÂºèÈîÅ"><span>ÈöêÂºèÈîÅ</span></a></h5><p>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã INSERT ËØ≠Âè•ÊòØ‰∏çÈúÄË¶ÅÂú®ÂÜÖÂ≠ò‰∏≠ÁîüÊàêÈîÅÁªìÊûÑÁöÑÔºå‰ºöËøõË°åÈöêÂºèÁöÑÂä†ÈîÅÔºå‰øùÊä§ÁöÑÊòØÊèíÂÖ•ÂêéÁöÑÂÆâÂÖ®</p><p>Ê≥®ÊÑèÔºöÂ¶ÇÊûúÊèíÂÖ•ÁöÑÈó¥ÈöôË¢´ÂÖ∂‰ªñ‰∫ãÂä°Âä†‰∫ÜÈó¥ÈöôÈîÅÔºåÊ≠§Ê¨°ÊèíÂÖ•‰ºöË¢´ÈòªÂ°ûÔºåÂπ∂Âú®ËØ•Èó¥ÈöôÊèíÂÖ•‰∏Ä‰∏™ÊèíÂÖ•ÊÑèÂêëÈîÅ</p><ul><li>ËÅöÁ∞áÁ¥¢ÂºïÔºöÁ¥¢ÂºïËÆ∞ÂΩïÊúâ trx_id ÈöêËóèÂàóÔºåË°®Á§∫ÊúÄÂêéÊîπÂä®ËØ•ËÆ∞ÂΩïÁöÑ‰∫ãÂä° idÔºåÊèíÂÖ•Êï∞ÊçÆÂêé‰∫ãÂä° id Â∞±ÊòØÂΩìÂâç‰∫ãÂä°„ÄÇÂÖ∂‰ªñ‰∫ãÂä°ÊÉ≥Ëé∑ÂèñËØ•ËÆ∞ÂΩïÁöÑÈîÅÊó∂‰ºöÂà§Êñ≠ÂΩìÂâçËÆ∞ÂΩïÁöÑ‰∫ãÂä° id ÊòØÂê¶ÊòØÊ¥ªË∑ÉÁöÑÔºåÂ¶ÇÊûú‰∏çÊòØÂ∞±ÂèØ‰ª•Ê≠£Â∏∏Âä†ÈîÅÔºõÂ¶ÇÊûúÊòØÂ∞±ÂàõÂª∫‰∏Ä‰∏™ X ÁöÑÈîÅÁªìÊûÑÔºåËØ•ÈîÅÁöÑ is_waiting ÊòØ falseÔºå‰∏∫Ëá™Â∑±ÁöÑ‰∫ãÂä°ÂàõÂª∫‰∏Ä‰∏™ÈîÅÁªìÊûÑÔºåis_waiting ÊòØ trueÔºàÁ±ª‰ºº Java ‰∏≠ÁöÑÈîÅÂçáÁ∫ßÔºâ</li><li>‰∫åÁ∫ßÁ¥¢ÂºïÔºöËé∑ÂèñÊï∞ÊçÆÈ°µ Page Header ‰∏≠ÁöÑ PAGE_MAX_TRX_ID Â±ûÊÄßÔºå‰ª£Ë°®‰øÆÊîπÂΩìÂâçÈ°µÈù¢ÁöÑÊúÄÂ§ßÁöÑ‰∫ãÂä° IDÔºåÂ¶ÇÊûúÂ∞è‰∫éÂΩìÂâçÊ¥ªË∑ÉÁöÑÊúÄÂ∞è‰∫ãÂä° idÔºåÂ∞±ËØÅÊòéÊèíÂÖ•ËØ•Êï∞ÊçÆÁöÑ‰∫ãÂä°Â∑≤ÁªèÊèê‰∫§ÔºåÂê¶ÂàôÂ∞±ÈúÄË¶ÅËé∑ÂèñÂà∞‰∏ªÈîÆÂÄºËøõË°åÂõûË°®Êìç‰Ωú</li></ul><p>ÈöêÂºèÈîÅËµ∑Âà∞‰∫ÜÂª∂ËøüÁîüÊàêÈîÅÁöÑÊïàÊûúÔºåÂ¶ÇÊûúÂÖ∂‰ªñ‰∫ãÂä°‰∏éÈöêÂºèÈîÅÊ≤°ÊúâÂÜ≤Á™ÅÔºåÂ∞±ÂèØ‰ª•ÈÅøÂÖçÈîÅÁªìÊûÑÁöÑÁîüÊàêÔºåËäÇÁúÅ‰∫ÜÂÜÖÂ≠òËµÑÊ∫ê</p><p>INSERT Âú®‰∏§ÁßçÊÉÖÂÜµ‰∏ã‰ºöÁîüÊàêÈîÅÁªìÊûÑÔºö</p><ul><li>ÈáçÂ§çÈîÆÔºöÂú®ÊèíÂÖ•‰∏ªÈîÆÊàñÂîØ‰∏Ä‰∫åÁ∫ßÁ¥¢ÂºïÊó∂ÈÅáÂà∞ÈáçÂ§çÁöÑÈîÆÂÄº‰ºöÊä•ÈîôÔºåÂú®Êä•ÈîôÂâçÈúÄË¶ÅÂØπÂØπÂ∫îÁöÑËÅöÁ∞áÁ¥¢ÂºïËøõË°åÂä†ÈîÅ <ul><li>ÈöîÁ¶ªÁ∫ßÂà´ &lt;= Read UncommittedÔºåÂä† S Âûã Record Lock</li><li>ÈöîÁ¶ªÁ∫ßÂà´ &gt;= Repeatable ReadÔºåÂä† S Âûã next_key ÈîÅ</li></ul></li><li>Â§ñÈîÆÊ£ÄÊü•ÔºöÂ¶ÇÊûúÂæÖÊèíÂÖ•ÁöÑËÆ∞ÂΩïÂú®Áà∂Ë°®‰∏≠ÂèØ‰ª•ÊâæÂà∞Ôºå‰ºöÂØπÁà∂Ë°®ÁöÑËÆ∞ÂΩïÂä† S Âûã Record Lock„ÄÇÂ¶ÇÊûúÂæÖÊèíÂÖ•ÁöÑËÆ∞ÂΩïÂú®Áà∂Ë°®‰∏≠Êâæ‰∏çÂà∞ <ul><li>ÈöîÁ¶ªÁ∫ßÂà´ &lt;= Read CommittedÔºå‰∏çÂä†ÈîÅ</li><li>ÈöîÁ¶ªÁ∫ßÂà´ &gt;= Repeatable ReadÔºåÂä†Èó¥ÈöôÈîÅ</li></ul></li></ul><hr><h4 id="ÈîÅ‰ºòÂåñ" tabindex="-1"><a class="header-anchor" href="#ÈîÅ‰ºòÂåñ"><span>ÈîÅ‰ºòÂåñ</span></a></h4><h5 id="‰ºòÂåñÈîÅ" tabindex="-1"><a class="header-anchor" href="#‰ºòÂåñÈîÅ"><span>‰ºòÂåñÈîÅ</span></a></h5><p>InnoDB Â≠òÂÇ®ÂºïÊìéÂÆûÁé∞‰∫ÜË°åÁ∫ßÈîÅÂÆöÔºåËôΩÁÑ∂Âú®ÈîÅÂÆöÊú∫Âà∂ÁöÑÂÆûÁé∞ÊñπÈù¢Â∏¶Êù•‰∫ÜÊÄßËÉΩÊçüËÄóÂèØËÉΩÊØîË°®ÈîÅ‰ºöÊõ¥È´òÔºå‰ΩÜÊòØÂú®Êï¥‰ΩìÂπ∂ÂèëÂ§ÑÁêÜËÉΩÂäõÊñπÈù¢Ë¶ÅËøúËøú‰ºò‰∫é MyISAM ÁöÑË°®ÈîÅÔºåÂΩìÁ≥ªÁªüÂπ∂ÂèëÈáèËæÉÈ´òÁöÑÊó∂ÂÄôÔºåInnoDB ÁöÑÊï¥‰ΩìÊÄßËÉΩËøúËøúÂ•Ω‰∫é MyISAM</p><p>‰ΩÜÊòØ‰ΩøÁî®‰∏çÂΩìÂèØËÉΩ‰ºöËÆ© InnoDB ÁöÑÊï¥‰ΩìÊÄßËÉΩË°®Áé∞‰∏ç‰ªÖ‰∏çËÉΩÊØî MyISAM È´òÔºåÁîöËá≥ÂèØËÉΩ‰ºöÊõ¥Â∑Æ</p><p>‰ºòÂåñÂª∫ËÆÆÔºö</p><ul><li>Â∞ΩÂèØËÉΩËÆ©ÊâÄÊúâÊï∞ÊçÆÊ£ÄÁ¥¢ÈÉΩËÉΩÈÄöËøáÁ¥¢ÂºïÊù•ÂÆåÊàêÔºåÈÅøÂÖçÊó†Á¥¢ÂºïË°åÈîÅÂçáÁ∫ß‰∏∫Ë°®ÈîÅ</li><li>ÂêàÁêÜËÆæËÆ°Á¥¢ÂºïÔºåÂ∞ΩÈáèÁº©Â∞èÈîÅÁöÑËåÉÂõ¥</li><li>Â∞ΩÂèØËÉΩÂáèÂ∞ëÁ¥¢ÂºïÊù°‰ª∂ÂèäÁ¥¢ÂºïËåÉÂõ¥ÔºåÈÅøÂÖçÈó¥ÈöôÈîÅ</li><li>Â∞ΩÈáèÊéßÂà∂‰∫ãÂä°Â§ßÂ∞èÔºåÂáèÂ∞ëÈîÅÂÆöËµÑÊ∫êÈáèÂíåÊó∂Èó¥ÈïøÂ∫¶</li><li>Â∞ΩÂèØ‰ΩøÁî®‰ΩéÁ∫ßÂà´‰∫ãÂä°ÈöîÁ¶ªÔºàÈúÄË¶Å‰∏öÂä°Â±ÇÈù¢Êª°Ë∂≥ÈúÄÊ±ÇÔºâ</li></ul><hr><h5 id="ÈîÅÂçáÁ∫ß" tabindex="-1"><a class="header-anchor" href="#ÈîÅÂçáÁ∫ß"><span>ÈîÅÂçáÁ∫ß</span></a></h5><p>Á¥¢ÂºïÂ§±ÊïàÈÄ†Êàê<strong>Ë°åÈîÅÂçáÁ∫ß‰∏∫Ë°®ÈîÅ</strong>Ôºå‰∏çÈÄöËøáÁ¥¢ÂºïÊ£ÄÁ¥¢Êï∞ÊçÆÔºåÂÖ®Â±ÄÊâ´ÊèèÁöÑËøáÁ®ã‰∏≠ InnoDB ‰ºöÂ∞ÜÂØπË°®‰∏≠ÁöÑÊâÄÊúâËÆ∞ÂΩïÂä†ÈîÅÔºåÂÆûÈôÖÊïàÊûúÂíå<strong>Ë°®ÈîÅ</strong>‰∏ÄÊ†∑ÔºåÂÆûÈôÖÂºÄÂèëËøáÁ®ãÂ∫îÈÅøÂÖçÂá∫Áé∞Á¥¢ÂºïÂ§±ÊïàÁöÑÁä∂ÂÜµ</p><ul><li><p>Êü•ÁúãÂΩìÂâçË°®ÁöÑÁ¥¢ÂºïÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW INDEX FROM test_innodb_lock;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂÖ≥Èó≠Ëá™Âä®Êèê‰∫§ÂäüËÉΩÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET AUTOCOMMIT=0;	-- C1„ÄÅC2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÊâßË°åÊõ¥Êñ∞ËØ≠Âè•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>UPDATE test_innodb_lock SET sex=&#39;2&#39; WHERE name=10;	-- C1</span></span>
<span class="line"><span>UPDATE test_innodb_lock SET sex=&#39;2&#39; WHERE id=3;		-- C2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB ÈîÅÂçáÁ∫ß.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Á¥¢ÂºïÂ§±ÊïàÔºöÊâßË°åÊõ¥Êñ∞Êó∂ name Â≠óÊÆµ‰∏∫ varchar Á±ªÂûãÔºåÈÄ†ÊàêÁ¥¢ÂºïÂ§±ÊïàÔºåÊúÄÁªàË°åÈîÅÂèò‰∏∫Ë°®ÈîÅ</p></li></ul><hr><h5 id="Ê≠ªÈîÅ" tabindex="-1"><a class="header-anchor" href="#Ê≠ªÈîÅ"><span>Ê≠ªÈîÅ</span></a></h5><p>‰∏çÂêå‰∫ãÂä°Áî±‰∫é‰∫íÁõ∏ÊåÅÊúâÂØπÊñπÈúÄË¶ÅÁöÑÈîÅËÄåÂØºËá¥‰∫ãÂä°ÈÉΩÊó†Ê≥ïÁªßÁª≠ÊâßË°åÁöÑÊÉÖÂÜµÁß∞‰∏∫Ê≠ªÈîÅ</p><p>Ê≠ªÈîÅÊÉÖÂÜµÔºöÁ∫øÁ®ã A ‰øÆÊîπ‰∫Ü id = 1 ÁöÑÊï∞ÊçÆÔºåËØ∑Ê±Ç‰øÆÊîπ id = 2 ÁöÑÊï∞ÊçÆÔºåÁ∫øÁ®ã B ‰øÆÊîπ‰∫Ü id = 2 ÁöÑÊï∞ÊçÆÔºåËØ∑Ê±Ç‰øÆÊîπ id = 1 ÁöÑÊï∞ÊçÆÔºå‰∫ßÁîüÊ≠ªÈîÅ</p><p>Ëß£ÂÜ≥Á≠ñÁï•Ôºö</p><ul><li><p>Áõ¥Êé•ËøõÂÖ•Á≠âÂæÖÁõ¥Âà∞Ë∂ÖÊó∂ÔºåË∂ÖÊó∂Êó∂Èó¥ÂèØ‰ª•ÈÄöËøáÂèÇÊï∞ innodb_lock_wait_timeout Êù•ËÆæÁΩÆÔºåÈªòËÆ§ 50 ÁßíÔºå‰ΩÜÊòØÊó∂Èó¥ÁöÑËÆæÁΩÆ‰∏çÂ•ΩÊéßÂà∂ÔºåË∂ÖÊó∂ÂèØËÉΩ‰∏çÊòØÂõ†‰∏∫Ê≠ªÈîÅÔºåËÄåÊòØÂõ†‰∏∫‰∫ãÂä°Â§ÑÁêÜÊØîËæÉÊÖ¢ÔºåÊâÄ‰ª•‰∏ÄËà¨‰∏çÈááÂèñËØ•ÊñπÂºè</p></li><li><p>‰∏ªÂä®Ê≠ªÈîÅÊ£ÄÊµãÔºåÂèëÁé∞Ê≠ªÈîÅÂêé<strong>‰∏ªÂä®ÂõûÊªöÊ≠ªÈîÅÈìæÊù°‰∏≠ËæÉÂ∞èÁöÑ‰∏Ä‰∏™‰∫ãÂä°</strong>ÔºåËÆ©ÂÖ∂‰ªñ‰∫ãÂä°Âæó‰ª•ÁªßÁª≠ÊâßË°åÔºåÂ∞ÜÂèÇÊï∞ <code>innodb_deadlock_detect</code> ËÆæÁΩÆ‰∏∫ onÔºåË°®Á§∫ÂºÄÂêØËØ•ÂäüËÉΩÔºà‰∫ãÂä°ËæÉÂ∞èÁöÑÊÑèÊÄùÂ∞±ÊòØ‰∫ãÂä°ÊâßË°åËøáÁ®ã‰∏≠ÊèíÂÖ•„ÄÅÂà†Èô§„ÄÅÊõ¥Êñ∞ÁöÑËÆ∞ÂΩïÊù°Êï∞Ôºâ</p><p>Ê≠ªÈîÅÊ£ÄÊµãÂπ∂‰∏çÊòØÊØè‰∏™ËØ≠Âè•ÈÉΩË¶ÅÊ£ÄÊµãÔºåÂè™ÊúâÂú®Âä†ÈîÅËÆøÈóÆÁöÑË°å‰∏äÂ∑≤ÁªèÊúâÈîÅÊó∂ÔºåÂΩìÂâç‰∫ãÂä°Ë¢´ÈòªÂ°û‰∫ÜÊâç‰ºöÊ£ÄÊµãÔºå‰πüÊòØ‰ªéÂΩìÂâç‰∫ãÂä°ÂºÄÂßãËøõË°åÊ£ÄÊµã</p></li></ul><p>ÈÄöËøáÊâßË°å <code>SHOW ENGINE INNODB STATUS</code> ÂèØ‰ª•Êü•ÁúãÊúÄËøëÂèëÁîüÁöÑ‰∏ÄÊ¨°Ê≠ªÂæ™ÁéØÔºåÂÖ®Â±ÄÁ≥ªÁªüÂèòÈáè <code>innodb_print_all_deadlocks</code> ËÆæÁΩÆ‰∏∫ onÔºåÂ∞±ÂèØ‰ª•Â∞ÜÊØè‰∏™Ê≠ªÈîÅ‰ø°ÊÅØÈÉΩËÆ∞ÂΩïÂú® MySQL ÈîôËØØÊó•Âøó‰∏≠</p><p>Ê≠ªÈîÅ‰∏ÄËà¨ÊòØË°åÁ∫ßÈîÅÔºåÂΩìË°®ÈîÅÂèëÁîüÊ≠ªÈîÅÊó∂Ôºå‰ºöÂú®‰∫ãÂä°‰∏≠ËÆøÈóÆÂÖ∂‰ªñË°®Êó∂<strong>Áõ¥Êé•Êä•Èîô</strong>ÔºåÁ†¥Âùè‰∫ÜÊåÅÊúâÂπ∂Á≠âÂæÖÁöÑÊ≠ªÈîÅÊù°‰ª∂</p><hr><h4 id="ÈîÅÁä∂ÊÄÅ-1" tabindex="-1"><a class="header-anchor" href="#ÈîÅÁä∂ÊÄÅ-1"><span>ÈîÅÁä∂ÊÄÅ</span></a></h4><p>Êü•ÁúãÈîÅ‰ø°ÊÅØ</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW STATUS LIKE &#39;innodb_row_lock%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDB ÈîÅ‰∫âÁî®.png" style="zoom:80%;"><p>ÂèÇÊï∞ËØ¥ÊòéÔºö</p><ul><li>Innodb_row_lock_current_waitsÔºöÂΩìÂâçÊ≠£Âú®Á≠âÂæÖÈîÅÂÆöÁöÑÊï∞Èáè</li><li>Innodb_row_lock_timeÔºö‰ªéÁ≥ªÁªüÂêØÂä®Âà∞Áé∞Âú®ÈîÅÂÆöÊÄªÊó∂Èó¥ÈïøÂ∫¶</li><li>Innodb_row_lock_time_avgÔºöÊØèÊ¨°Á≠âÂæÖÊâÄËä±Âπ≥ÂùáÊó∂Èïø</li><li>Innodb_row_lock_time_maxÔºö‰ªéÁ≥ªÁªüÂêØÂä®Âà∞Áé∞Âú®Á≠âÂæÖÊúÄÈïøÁöÑ‰∏ÄÊ¨°ÊâÄËä±ÁöÑÊó∂Èó¥</li><li>Innodb_row_lock_waitsÔºöÁ≥ªÁªüÂêØÂä®ÂêéÂà∞Áé∞Âú®ÊÄªÂÖ±Á≠âÂæÖÁöÑÊ¨°Êï∞</li></ul><p>ÂΩìÁ≠âÂæÖÁöÑÊ¨°Êï∞ÂæàÈ´òÔºåËÄå‰∏îÊØèÊ¨°Á≠âÂæÖÁöÑÊó∂Èïø‰πü‰∏çÁü≠ÁöÑÊó∂ÂÄôÔºåÂ∞±ÈúÄË¶ÅÂàÜÊûêÁ≥ªÁªü‰∏≠‰∏∫‰ªÄ‰πà‰ºöÊúâÂ¶ÇÊ≠§Â§öÁöÑÁ≠âÂæÖÔºåÁÑ∂ÂêéÊ†πÊçÆÂàÜÊûêÁªìÊûúÂà∂ÂÆö‰ºòÂåñËÆ°Âàí</p><p>Êü•ÁúãÈîÅÁä∂ÊÄÅÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM information_schema.innodb_locks;	#ÈîÅÁöÑÊ¶ÇÂÜµ</span></span>
<span class="line"><span>SHOW ENGINE INNODB STATUS\G; #InnoDBÊï¥‰ΩìÁä∂ÊÄÅÔºåÂÖ∂‰∏≠ÂåÖÊã¨ÈîÅÁöÑÊÉÖÂÜµ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-InnoDBÊü•ÁúãÈîÅÁä∂ÊÄÅ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>lock_id ÊòØÈîÅ idÔºõlock_trx_id ‰∏∫‰∫ãÂä° idÔºõlock_mode ‰∏∫ X ‰ª£Ë°®ÊéíÂÆÉÈîÅÔºàÂÜôÈîÅÔºâÔºõlock_type ‰∏∫ RECORD ‰ª£Ë°®ÈîÅ‰∏∫Ë°åÈîÅÔºàËÆ∞ÂΩïÈîÅÔºâ</p><hr><h3 id="‰πêËßÇÈîÅ" tabindex="-1"><a class="header-anchor" href="#‰πêËßÇÈîÅ"><span>‰πêËßÇÈîÅ</span></a></h3><p>ÊÇ≤ËßÇÈîÅÔºöÂú®Êï¥‰∏™Êï∞ÊçÆÂ§ÑÁêÜËøáÁ®ã‰∏≠ÔºåÂ∞ÜÊï∞ÊçÆÂ§Ñ‰∫éÈîÅÂÆöÁä∂ÊÄÅÔºå‰∏∫‰∫Ü‰øùËØÅ‰∫ãÂä°ÁöÑÈöîÁ¶ªÊÄßÔºåÂ∞±ÈúÄË¶Å‰∏ÄËá¥ÊÄßÈîÅÂÆöËØª„ÄÇËØªÂèñÊï∞ÊçÆÊó∂ÁªôÂä†ÈîÅÔºåÂÖ∂ÂÆÉ‰∫ãÂä°Êó†Ê≥ï‰øÆÊîπËøô‰∫õÊï∞ÊçÆÔºå‰øÆÊîπÂà†Èô§Êï∞ÊçÆÊó∂‰πüÂä†ÈîÅÔºåÂÖ∂ÂÆÉ‰∫ãÂä°ÂêåÊ†∑Êó†Ê≥ïËØªÂèñËøô‰∫õÊï∞ÊçÆ</p><p>ÊÇ≤ËßÇÈîÅÂíå‰πêËßÇÈîÅ‰ΩøÁî®ÂâçÊèêÔºö</p><ul><li>ÂØπ‰∫éËØªÁöÑÊìç‰ΩúËøúÂ§ö‰∫éÂÜôÁöÑÊìç‰ΩúÁöÑÊó∂ÂÄôÔºå‰∏Ä‰∏™Êõ¥Êñ∞Êìç‰ΩúÂä†ÈîÅ‰ºöÈòªÂ°ûÊâÄÊúâÁöÑËØªÂèñÊìç‰ΩúÔºåÈôç‰Ωé‰∫ÜÂêûÂêêÈáèÔºåÊúÄÂêéÈúÄË¶ÅÈáäÊîæÈîÅÔºåÈîÅÊòØÈúÄË¶Å‰∏Ä‰∫õÂºÄÈîÄÁöÑÔºåËøôÊó∂ÂÄôÂèØ‰ª•ÈÄâÊã©‰πêËßÇÈîÅ</li><li>Â¶ÇÊûúÊòØËØªÂÜôÊØî‰æãÂ∑ÆË∑ù‰∏çÊòØÈùûÂ∏∏Â§ßÊàñËÄÖÁ≥ªÁªüÊ≤°ÊúâÂìçÂ∫î‰∏çÂèäÊó∂ÔºåÂêûÂêêÈáèÁì∂È¢àÁöÑÈóÆÈ¢òÔºåÈÇ£Â∞±‰∏çË¶ÅÂéª‰ΩøÁî®‰πêËßÇÈîÅÔºåÂÆÉÂ¢ûÂä†‰∫ÜÂ§çÊùÇÂ∫¶Ôºå‰πüÂ∏¶Êù•‰∫Ü‰∏öÂä°È¢ùÂ§ñÁöÑÈ£éÈô©ÔºåËøôÊó∂ÂÄôÂèØ‰ª•ÈÄâÊã©ÊÇ≤ËßÇÈîÅ</li></ul><p>‰πêËßÇÈîÅÁöÑÂÆûÁé∞ÊñπÂºèÔºöÂ∞±ÊòØ CASÔºåÊØîËæÉÂπ∂‰∫§Êç¢</p><ul><li><p>ÁâàÊú¨Âè∑</p><ol><li><p>ÁªôÊï∞ÊçÆË°®‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ version ÂàóÔºåÊØèÊ¨°Êõ¥Êñ∞ÂêéÈÉΩÂ∞ÜËøô‰∏™ÂàóÁöÑÂÄºÂä† 1</p></li><li><p>ËØªÂèñÊï∞ÊçÆÊó∂ÔºåÂ∞ÜÁâàÊú¨Âè∑ËØªÂèñÂá∫Êù•ÔºåÂú®ÊâßË°åÊõ¥Êñ∞ÁöÑÊó∂ÂÄôÔºåÊØîËæÉÁâàÊú¨Âè∑</p></li><li><p>Â¶ÇÊûúÁõ∏ÂêåÂàôÊâßË°åÊõ¥Êñ∞ÔºåÂ¶ÇÊûú‰∏çÁõ∏ÂêåÔºåËØ¥ÊòéÊ≠§Êù°Êï∞ÊçÆÂ∑≤ÁªèÂèëÁîü‰∫ÜÂèòÂåñ</p></li><li><p>Áî®Êà∑Ëá™Ë°åÊ†πÊçÆËøô‰∏™ÈÄöÁü•Êù•ÂÜ≥ÂÆöÊÄé‰πàÂ§ÑÁêÜÔºåÊØîÂ¶ÇÈáçÊñ∞ÂºÄÂßã‰∏ÄÈÅçÔºåÊàñËÄÖÊîæÂºÉÊú¨Ê¨°Êõ¥Êñ∞</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>-- ÂàõÂª∫cityË°®</span></span>
<span class="line"><span>CREATE TABLE city(</span></span>
<span class="line"><span>	id INT PRIMARY KEY AUTO_INCREMENT,  -- ÂüéÂ∏Çid</span></span>
<span class="line"><span>	NAME VARCHAR(20),                   -- ÂüéÂ∏ÇÂêçÁß∞</span></span>
<span class="line"><span>	VERSION INT                         -- ÁâàÊú¨Âè∑</span></span>
<span class="line"><span>);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- Ê∑ªÂä†Êï∞ÊçÆ</span></span>
<span class="line"><span>INSERT INTO city VALUES (NULL,&#39;Âåó‰∫¨&#39;,1),(NULL,&#39;‰∏äÊµ∑&#39;,1),(NULL,&#39;ÂπøÂ∑û&#39;,1),(NULL,&#39;Ê∑±Âú≥&#39;,1);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>-- ‰øÆÊîπÂåó‰∫¨‰∏∫Âåó‰∫¨Â∏Ç</span></span>
<span class="line"><span>-- 1.Êü•ËØ¢Âåó‰∫¨ÁöÑversion</span></span>
<span class="line"><span>SELECT VERSION FROM city WHERE NAME=&#39;Âåó‰∫¨&#39;;</span></span>
<span class="line"><span>-- 2.‰øÆÊîπÂåó‰∫¨‰∏∫Âåó‰∫¨Â∏ÇÔºåÁâàÊú¨Âè∑+1„ÄÇÂπ∂ÂØπÊØîÁâàÊú¨Âè∑</span></span>
<span class="line"><span>UPDATE city SET NAME=&#39;Âåó‰∫¨Â∏Ç&#39;,VERSION=VERSION+1 WHERE NAME=&#39;Âåó‰∫¨&#39; AND VERSION=1;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></li><li><p>Êó∂Èó¥Êà≥</p><ul><li>ÂíåÁâàÊú¨Âè∑ÊñπÂºèÂü∫Êú¨‰∏ÄÊ†∑ÔºåÁªôÊï∞ÊçÆË°®‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ÂàóÔºåÂêçÁß∞Êó†ÊâÄË∞ìÔºåÊï∞ÊçÆÁ±ªÂûãÈúÄË¶ÅÊòØ <strong>timestamp</strong></li><li>ÊØèÊ¨°Êõ¥Êñ∞ÂêéÈÉΩÂ∞ÜÊúÄÊñ∞Êó∂Èó¥ÊèíÂÖ•Âà∞Ê≠§Âàó</li><li>ËØªÂèñÊï∞ÊçÆÊó∂ÔºåÂ∞ÜÊó∂Èó¥ËØªÂèñÂá∫Êù•ÔºåÂú®ÊâßË°åÊõ¥Êñ∞ÁöÑÊó∂ÂÄôÔºåÊØîËæÉÊó∂Èó¥</li><li>Â¶ÇÊûúÁõ∏ÂêåÂàôÊâßË°åÊõ¥Êñ∞ÔºåÂ¶ÇÊûú‰∏çÁõ∏ÂêåÔºåËØ¥ÊòéÊ≠§Êù°Êï∞ÊçÆÂ∑≤ÁªèÂèëÁîü‰∫ÜÂèòÂåñ</li></ul></li></ul><p>‰πêËßÇÈîÅÁöÑÂºÇÂ∏∏ÊÉÖÂÜµÔºöÂ¶ÇÊûú version Ë¢´ÂÖ∂‰ªñ‰∫ãÂä°Êä¢ÂÖàÊõ¥Êñ∞ÔºåÂàôÂú®ÂΩìÂâç‰∫ãÂä°‰∏≠Êõ¥Êñ∞Â§±Ë¥•Ôºåtrx_id Ê≤°ÊúâÂèòÊàêÂΩìÂâç‰∫ãÂä°ÁöÑ IDÔºåÂΩìÂâç‰∫ãÂä°ÂÜçÊ¨°Êü•ËØ¢ËøòÊòØÊóßÂÄºÔºåÂ∞±‰ºöÂá∫Áé∞<strong>ÂÄºÊ≤°Âèò‰ΩÜÊòØÊõ¥Êñ∞‰∏ç‰∫Ü</strong>ÁöÑÁé∞Ë±°ÔºàanomalyÔºâ</p><p>Ëß£ÂÜ≥ÊñπÊ°àÔºöÊØèÊ¨° CAS Êõ¥Êñ∞‰∏çÁÆ°ÊàêÂäüÂ§±Ë¥•ÔºåÂ∞±ÁªìÊùüÂΩìÂâç‰∫ãÂä°ÔºõÂ¶ÇÊûúÂ§±Ë¥•ÂàôÈáçÊñ∞Ëµ∑‰∏Ä‰∏™‰∫ãÂä°ËøõË°åÊü•ËØ¢Êõ¥Êñ∞</p><hr><h2 id="‰∏ª‰ªé" tabindex="-1"><a class="header-anchor" href="#‰∏ª‰ªé"><span>‰∏ª‰ªé</span></a></h2><h3 id="Âü∫Êú¨‰ªãÁªç-9" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-9"><span>Âü∫Êú¨‰ªãÁªç</span></a></h3><p>‰∏ª‰ªéÂ§çÂà∂ÊòØÊåáÂ∞Ü‰∏ªÊï∞ÊçÆÂ∫ìÁöÑ DDL Âíå DML Êìç‰ΩúÈÄöËøá‰∫åËøõÂà∂Êó•Âøó‰º†Âà∞‰ªéÂ∫ìÊúçÂä°Âô®‰∏≠ÔºåÁÑ∂ÂêéÂú®‰ªéÂ∫ì‰∏äÂØπËøô‰∫õÊó•ÂøóÈáçÊñ∞ÊâßË°åÔºà‰πüÂè´ÈáçÂÅöÔºâÔºå‰ªéËÄå‰ΩøÂæó‰ªéÂ∫ìÂíå‰∏ªÂ∫ìÁöÑÊï∞ÊçÆ‰øùÊåÅÂêåÊ≠•</p><p>MySQL ÊîØÊåÅ‰∏ÄÂè∞‰∏ªÂ∫ìÂêåÊó∂ÂêëÂ§öÂè∞‰ªéÂ∫ìËøõË°åÂ§çÂà∂Ôºå‰ªéÂ∫ìÂêåÊó∂‰πüÂèØ‰ª•‰Ωú‰∏∫ÂÖ∂‰ªñ‰ªéÊúçÂä°Âô®ÁöÑ‰∏ªÂ∫ìÔºåÂÆûÁé∞ÈìæÁä∂Â§çÂà∂</p><p>MySQL Â§çÂà∂ÁöÑ‰ºòÁÇπ‰∏ªË¶ÅÂåÖÂê´‰ª•‰∏ã‰∏â‰∏™ÊñπÈù¢Ôºö</p><ul><li>‰∏ªÂ∫ìÂá∫Áé∞ÈóÆÈ¢òÔºåÂèØ‰ª•Âø´ÈÄüÂàáÊç¢Âà∞‰ªéÂ∫ìÊèê‰æõÊúçÂä°</li><li>ÂèØ‰ª•Âú®‰ªéÂ∫ì‰∏äÊâßË°åÊü•ËØ¢Êìç‰ΩúÔºå‰ªé‰∏ªÂ∫ì‰∏≠Êõ¥Êñ∞ÔºåÂÆûÁé∞ËØªÂÜôÂàÜÁ¶ª</li><li>ÂèØ‰ª•Âú®‰ªéÂ∫ì‰∏≠ÊâßË°åÂ§á‰ªΩÔºå‰ª•ÈÅøÂÖçÂ§á‰ªΩÊúüÈó¥ÂΩ±Âìç‰∏ªÂ∫ìÁöÑÊúçÂä°ÔºàÂ§á‰ªΩÊó∂‰ºöÂä†ÂÖ®Â±ÄËØªÈîÅÔºâ</li></ul><hr><h3 id="‰∏ª‰ªéÂ§çÂà∂" tabindex="-1"><a class="header-anchor" href="#‰∏ª‰ªéÂ§çÂà∂"><span>‰∏ª‰ªéÂ§çÂà∂</span></a></h3><h4 id="‰∏ª‰ªéÁªìÊûÑ" tabindex="-1"><a class="header-anchor" href="#‰∏ª‰ªéÁªìÊûÑ"><span>‰∏ª‰ªéÁªìÊûÑ</span></a></h4><p>MySQL ÁöÑ‰∏ª‰ªé‰πãÈó¥Áª¥ÊåÅ‰∫Ü‰∏Ä‰∏™<strong>ÈïøËøûÊé•</strong>„ÄÇ‰∏ªÂ∫ìÂÜÖÈÉ®Êúâ‰∏Ä‰∏™Á∫øÁ®ãÔºå‰∏ìÈó®Áî®‰∫éÊúçÂä°‰ªéÂ∫ìÁöÑÈïøËøûÊé•ÔºåËøûÊé•ËøáÁ®ãÔºö</p><ul><li>‰ªéÂ∫ìÊâßË°å change master ÂëΩ‰ª§ÔºåËÆæÁΩÆ‰∏ªÂ∫ìÁöÑ IP„ÄÅÁ´ØÂè£„ÄÅÁî®Êà∑Âêç„ÄÅÂØÜÁ†Å‰ª•ÂèäË¶Å‰ªéÂì™‰∏™‰ΩçÁΩÆÂºÄÂßãËØ∑Ê±Ç binlogÔºåËøô‰∏™‰ΩçÁΩÆÂåÖÂê´Êñá‰ª∂ÂêçÂíåÊó•ÂøóÂÅèÁßªÈáè</li><li>‰ªéÂ∫ìÊâßË°å start slave ÂëΩ‰ª§ÔºåËøôÊó∂‰ªéÂ∫ì‰ºöÂêØÂä®‰∏§‰∏™Á∫øÁ®ãÔºåÂ∞±ÊòØÂõæ‰∏≠ÁöÑ io_thread Âíå sql_threadÔºåÂÖ∂‰∏≠ io_thread Ë¥üË¥£‰∏é‰∏ªÂ∫ìÂª∫Á´ãËøûÊé•</li><li>‰∏ªÂ∫ìÊ†°È™åÂÆåÁî®Êà∑Âêç„ÄÅÂØÜÁ†ÅÂêéÔºåÂºÄÂßãÊåâÁÖß‰ªé‰º†ËøáÊù•ÁöÑ‰ΩçÁΩÆÔºå‰ªéÊú¨Âú∞ËØªÂèñ binlog ÂèëÁªô‰ªéÂ∫ìÔºåÂºÄÂßã‰∏ª‰ªéÂ§çÂà∂</li></ul><p>‰∏ª‰ªéÂ§çÂà∂ÂéüÁêÜÂõæÔºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰∏ª‰ªéÂ§çÂà∂ÂéüÁêÜÂõæ.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>‰∏ª‰ªéÂ§çÂà∂‰∏ªË¶Å‰æùËµñÁöÑÊòØ binlogÔºåMySQL ÈªòËÆ§ÊòØÂºÇÊ≠•Â§çÂà∂ÔºåÈúÄË¶Å‰∏â‰∏™Á∫øÁ®ãÔºö</p><ul><li>binlog threadÔºöÂú®‰∏ªÂ∫ì‰∫ãÂä°Êèê‰∫§Êó∂ÔºåÊääÊï∞ÊçÆÂèòÊõ¥ËÆ∞ÂΩïÂú®Êó•ÂøóÊñá‰ª∂ binlog ‰∏≠ÔºåÂπ∂ÈÄöÁü• slave ÊúâÊï∞ÊçÆÊõ¥Êñ∞</li><li>I/O threadÔºöË¥üË¥£‰ªé‰∏ªÊúçÂä°Âô®‰∏ä<strong>ÊãâÂèñ‰∫åËøõÂà∂Êó•Âøó</strong>ÔºåÂπ∂Â∞Ü binlog Êó•ÂøóÂÜÖÂÆπ‰æùÊ¨°ÂÜôÂà∞ relay log ‰∏≠ËΩ¨Êó•ÂøóÁöÑÊúÄÊú´Á´ØÔºåÂπ∂Â∞ÜÊñ∞ÁöÑ binlog Êñá‰ª∂ÂêçÂíå offset ËÆ∞ÂΩïÂà∞ master-info Êñá‰ª∂‰∏≠Ôºå‰ª•‰æø‰∏ã‰∏ÄÊ¨°ËØªÂèñÊó•ÂøóÊó∂‰ªéÊåáÂÆö binlog Êó•ÂøóÊñá‰ª∂Âèä‰ΩçÁΩÆÂºÄÂßãËØªÂèñÊñ∞ÁöÑ binlog Êó•ÂøóÂÜÖÂÆπ</li><li>SQL threadÔºöÁõëÊµãÊú¨Âú∞ relay log ‰∏≠Êñ∞Â¢û‰∫ÜÊó•ÂøóÂÜÖÂÆπÔºåËØªÂèñ‰∏≠ÁªßÊó•ÂøóÂπ∂ÈáçÂÅöÂÖ∂‰∏≠ÁöÑ SQL ËØ≠Âè•Ôºå‰ªéÂ∫ìÂú® relay-log.info ‰∏≠ËÆ∞ÂΩïÂΩìÂâçÂ∫îÁî®‰∏≠ÁªßÊó•ÂøóÁöÑÊñá‰ª∂ÂêçÂíå‰ΩçÁÇπ‰ª•‰æø‰∏ã‰∏ÄÊ¨°ÊâßË°å</li></ul><p>ÂêåÊ≠•‰∏éÂºÇÊ≠•Ôºö</p><ul><li>ÂºÇÊ≠•Â§çÂà∂ÊúâÊï∞ÊçÆ‰∏¢Â§±È£éÈô©Ôºå‰æãÂ¶ÇÊï∞ÊçÆËøòÊú™ÂêåÊ≠•Âà∞‰ªéÂ∫ìÔºå‰∏ªÂ∫ìÂ∞±ÁªôÂÆ¢Êà∑Á´ØÂìçÂ∫îÔºåÁÑ∂Âêé‰∏ªÂ∫ìÊåÇ‰∫ÜÔºåÊ≠§Êó∂‰ªéÂ∫ìÊôãÂçá‰∏∫‰∏ªÂ∫ìÁöÑËØùÊï∞ÊçÆÊòØÁº∫Â§±ÁöÑ</li><li>ÂêåÊ≠•Â§çÂà∂Ôºå‰∏ªÂ∫ìÈúÄË¶ÅÂ∞Ü binlog Â§çÂà∂Âà∞ÊâÄÊúâ‰ªéÂ∫ìÔºåÁ≠âÊâÄÊúâ‰ªéÂ∫ìÂìçÂ∫î‰∫Ü‰πãÂêé‰∏ªÂ∫ìÊâçËøõË°åÂÖ∂‰ªñÈÄªËæëÔºåËøôÊ†∑ÁöÑËØùÊÄßËÉΩÂæàÂ∑ÆÔºå‰∏ÄËà¨‰∏ç‰ºöÈÄâÊã©</li><li>MySQL 5.7 ‰πãÂêéÂá∫Áé∞‰∫ÜÂçäÂêåÊ≠•Â§çÂà∂ÔºåÊúâÂèÇÊï∞ÂèØ‰ª•ÈÄâÊã©ÊàêÂäüÂêåÊ≠•Âá†‰∏™‰ªéÂ∫ìÂ∞±ËøîÂõûÂìçÂ∫î</li></ul><hr><h4 id="‰∏ª‰∏ªÁªìÊûÑ" tabindex="-1"><a class="header-anchor" href="#‰∏ª‰∏ªÁªìÊûÑ"><span>‰∏ª‰∏ªÁªìÊûÑ</span></a></h4><p>‰∏ª‰∏ªÁªìÊûÑÂ∞±ÊòØ‰∏§‰∏™Êï∞ÊçÆÂ∫ì‰πãÈó¥ÊÄªÊòØ‰∫í‰∏∫‰∏ª‰ªéÂÖ≥Á≥ªÔºåËøôÊ†∑Âú®ÂàáÊç¢ÁöÑÊó∂ÂÄôÂ∞±‰∏çÁî®ÂÜç‰øÆÊîπ‰∏ª‰ªéÂÖ≥Á≥ª</p><p>Âæ™ÁéØÂ§çÂà∂ÔºöÂú®Â∫ì A ‰∏äÊõ¥Êñ∞‰∫Ü‰∏ÄÊù°ËØ≠Âè•ÔºåÁÑ∂ÂêéÊääÁîüÊàêÁöÑ binlog ÂèëÁªôÂ∫ì BÔºåÂ∫ì B ÊâßË°åÂÆåËøôÊù°Êõ¥Êñ∞ËØ≠Âè•Âêé‰πü‰ºöÁîüÊàê binlogÔºå‰ºöÂÜçÂèëÁªô A</p><p>Ëß£ÂÜ≥ÊñπÊ≥ïÔºö</p><ul><li>‰∏§‰∏™Â∫ìÁöÑ server id ÂøÖÈ°ª‰∏çÂêåÔºåÂ¶ÇÊûúÁõ∏ÂêåÂàôÂÆÉ‰ª¨‰πãÈó¥‰∏çËÉΩËÆæÂÆö‰∏∫‰∏ª‰∏ªÂÖ≥Á≥ª</li><li>‰∏Ä‰∏™Â∫ìÊé•Âà∞ binlog Âπ∂Âú®ÈáçÊîæÁöÑËøáÁ®ã‰∏≠ÔºåÁîüÊàê‰∏éÂéü binlog ÁöÑ server id Áõ∏ÂêåÁöÑÊñ∞ÁöÑ binlog</li><li>ÊØè‰∏™Â∫ìÂú®Êî∂Âà∞‰ªé‰∏ªÂ∫ìÂèëËøáÊù•ÁöÑÊó•ÂøóÂêéÔºåÂÖàÂà§Êñ≠ server idÔºåÂ¶ÇÊûúË∑üËá™Â∑±ÁöÑÁõ∏ÂêåÔºåË°®Á§∫Ëøô‰∏™Êó•ÂøóÊòØËá™Â∑±ÁîüÊàêÁöÑÔºåÂ∞±Áõ¥Êé•‰∏¢ÂºÉËøô‰∏™Êó•Âøó</li></ul><hr><h3 id="‰∏ª‰ªéÂª∂Ëøü" tabindex="-1"><a class="header-anchor" href="#‰∏ª‰ªéÂª∂Ëøü"><span>‰∏ª‰ªéÂª∂Ëøü</span></a></h3><h4 id="Âª∂ËøüÂéüÂõ†" tabindex="-1"><a class="header-anchor" href="#Âª∂ËøüÂéüÂõ†"><span>Âª∂ËøüÂéüÂõ†</span></a></h4><p>Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ªÂ∫ìÊâßË°åÊõ¥Êñ∞ÁîüÊàêÁöÑÊâÄÊúâ binlogÔºåÈÉΩÂèØ‰ª•‰º†Âà∞‰ªéÂ∫ìÂπ∂Ë¢´Ê≠£Á°ÆÂú∞ÊâßË°åÔºå‰ªéÂ∫ìÂ∞±ËÉΩËææÂà∞Ë∑ü‰∏ªÂ∫ì‰∏ÄËá¥ÁöÑÁä∂ÊÄÅÔºåËøôÂ∞±ÊòØÊúÄÁªà‰∏ÄËá¥ÊÄß</p><p>‰∏ª‰ªéÂª∂ËøüÊòØ‰∏ª‰ªé‰πãÈó¥ÊòØÂ≠òÂú®‰∏ÄÂÆöÊó∂Èó¥ÁöÑÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÔºåÂ∞±ÊòØÂêå‰∏Ä‰∏™‰∫ãÂä°Âú®‰ªéÂ∫ìÊâßË°åÂÆåÊàêÁöÑÊó∂Èó¥Âíå‰∏ªÂ∫ìÊâßË°åÂÆåÊàêÁöÑÊó∂Èó¥ÁöÑÂ∑ÆÂÄºÔºåÂç≥ T2-T1</p><ul><li>‰∏ªÂ∫ì A ÊâßË°åÂÆåÊàê‰∏Ä‰∏™‰∫ãÂä°ÔºåÂÜôÂÖ• binlogÔºåËØ•Êó∂ÂàªËÆ∞‰∏∫ T1</li><li>Êó•Âøó‰º†Áªô‰ªéÂ∫ì BÔºå‰ªéÂ∫ì B ÊâßË°åÂÆåËøô‰∏™‰∫ãÂä°ÔºåËØ•Êó∂ÂàªËÆ∞‰∏∫ T2</li></ul><p>ÈÄöËøáÂú®‰ªéÂ∫ìÊâßË°å <code>show slave status</code> ÂëΩ‰ª§ÔºåËøîÂõûÁªìÊûú‰ºöÊòæÁ§∫ seconds_behind_master Ë°®Á§∫ÂΩìÂâç‰ªéÂ∫ìÂª∂Ëøü‰∫ÜÂ§öÂ∞ëÁßí</p><ul><li>ÊØè‰∏Ä‰∏™‰∫ãÂä°ÁöÑ binlog ÈÉΩÊúâ‰∏Ä‰∏™Êó∂Èó¥Â≠óÊÆµÔºåÁî®‰∫éËÆ∞ÂΩï‰∏ªÂ∫ì‰∏äÂÜôÂÖ•ÁöÑÊó∂Èó¥</li><li>‰ªéÂ∫ìÂèñÂá∫ÂΩìÂâçÊ≠£Âú®ÊâßË°åÁöÑ‰∫ãÂä°ÁöÑÊó∂Èó¥Â≠óÊÆµÔºåË∑üÁ≥ªÁªüÁöÑÊó∂Èó¥ËøõË°åÁõ∏ÂáèÔºåÂæóÂà∞ÁöÑÂ∞±ÊòØ seconds_behind_master</li></ul><p>‰∏ª‰ªéÂª∂ËøüÁöÑÂéüÂõ†Ôºö</p><ul><li>‰ªéÂ∫ìÁöÑÊú∫Âô®ÊÄßËÉΩÊØî‰∏ªÂ∫ìÁöÑÂ∑ÆÔºåÂØºËá¥‰ªéÂ∫ìÁöÑÂ§çÂà∂ËÉΩÂäõÂº±</li><li>‰ªéÂ∫ìÁöÑÊü•ËØ¢ÂéãÂäõÂ§ßÔºåÂª∫Á´ã‰∏Ä‰∏ªÂ§ö‰ªéÁöÑÁªìÊûÑ</li><li>Â§ß‰∫ãÂä°ÁöÑÊâßË°åÔºå‰∏ªÂ∫ìÂøÖÈ°ªË¶ÅÁ≠âÂà∞‰∫ãÂä°ÂÆåÊàê‰πãÂêéÊâç‰ºöÂÜôÂÖ• binlogÔºåÂØºËá¥‰ªéËäÇÁÇπÂá∫Áé∞Â∫îÁî® binlog Âª∂Ëøü</li><li>‰∏ªÂ∫ìÁöÑ DDLÔºå‰ªéÂ∫ì‰∏é‰∏ªÂ∫ìÁöÑ DDL ÂêåÊ≠•ÊòØ‰∏≤Ë°åËøõË°åÔºåDDL Âú®‰∏ªÂ∫ìÊâßË°åÊó∂Èó¥ÂæàÈïøÔºåÈÇ£‰πà‰ªéÂ∫ì‰πü‰ºöÊ∂àËÄóÂêåÊ†∑ÁöÑÊó∂Èó¥</li><li>ÈîÅÂÜ≤Á™ÅÈóÆÈ¢ò‰πüÂèØËÉΩÂØºËá¥‰ªéËäÇÁÇπÁöÑ SQL Á∫øÁ®ãÊâßË°åÊÖ¢</li></ul><p>‰∏ª‰ªéÂêåÊ≠•ÈóÆÈ¢òÊ∞∏ËøúÈÉΩÊòØ<strong>‰∏ÄËá¥ÊÄßÂíåÊÄßËÉΩÁöÑÊùÉË°°</strong>ÔºåÈúÄË¶ÅÊ†πÊçÆÂÆûÈôÖÁöÑÂ∫îÁî®Âú∫ÊôØÔºåÂèØ‰ª•ÈááÂèñ‰∏ãÈù¢ÁöÑÂäûÊ≥ïÔºö</p><ul><li>‰ºòÂåñ SQLÔºåÈÅøÂÖçÊÖ¢ SQLÔºåÂáèÂ∞ëÊâπÈáèÊìç‰Ωú</li><li>Èôç‰ΩéÂ§öÁ∫øÁ®ãÂ§ß‰∫ãÂä°Âπ∂ÂèëÁöÑÊ¶ÇÁéáÔºå‰ºòÂåñ‰∏öÂä°ÈÄªËæë</li><li>‰∏öÂä°‰∏≠Â§ßÂ§öÊï∞ÊÉÖÂÜµÊü•ËØ¢Êìç‰ΩúË¶ÅÊØîÊõ¥Êñ∞Êìç‰ΩúÊõ¥Â§öÔºåÊê≠Âª∫<strong>‰∏Ä‰∏ªÂ§ö‰ªé</strong>ÁªìÊûÑÔºåËÆ©Ëøô‰∫õ‰ªéÂ∫ìÊù•ÂàÜÊãÖËØªÁöÑÂéãÂäõ</li><li>Â∞ΩÈáèÈááÁî®Áü≠ÁöÑÈìæË∑ØÔºå‰∏ªÂ∫ìÂíå‰ªéÂ∫ìÊúçÂä°Âô®ÁöÑË∑ùÁ¶ªÂ∞ΩÈáèË¶ÅÁü≠ÔºåÊèêÂçáÁ´ØÂè£Â∏¶ÂÆΩÔºåÂáèÂ∞ë binlog ‰º†ËæìÁöÑÁΩëÁªúÂª∂Êó∂</li><li>ÂÆûÊó∂ÊÄßË¶ÅÊ±ÇÈ´òÁöÑ‰∏öÂä°ËØªÂº∫Âà∂Ëµ∞‰∏ªÂ∫ìÔºå‰ªéÂ∫ìÂè™ÂÅöÂ§á‰ªΩ</li></ul><hr><h4 id="Âπ∂Ë°åÂ§çÂà∂" tabindex="-1"><a class="header-anchor" href="#Âπ∂Ë°åÂ§çÂà∂"><span>Âπ∂Ë°åÂ§çÂà∂</span></a></h4><h5 id="mysql5-6" tabindex="-1"><a class="header-anchor" href="#mysql5-6"><span>MySQL5.6</span></a></h5><p>È´òÂπ∂ÂèëÊÉÖÂÜµ‰∏ãÔºå‰∏ªÂ∫ìÁöÑ‰ºö‰∫ßÁîüÂ§ßÈáèÁöÑ binlogÔºåÂú®‰ªéÂ∫ì‰∏≠Êúâ‰∏§‰∏™Á∫øÁ®ã IO Thread Âíå SQL Thread ÂçïÁ∫øÁ®ãÊâßË°åÔºå‰ºöÂØºËá¥‰∏ªÂ∫ìÂª∂ËøüÂèòÂ§ß„ÄÇ‰∏∫‰∫ÜÊîπÂñÑÂ§çÂà∂Âª∂ËøüÈóÆÈ¢òÔºåMySQL 5.6 ÁâàÊú¨Â¢ûÂä†‰∫ÜÂπ∂Ë°åÂ§çÂà∂ÂäüËÉΩÔºå‰ª•ÈááÁî®Â§öÁ∫øÁ®ãÊú∫Âà∂Êù•‰øÉËøõÊâßË°å</p><p>coordinator Â∞±ÊòØÂéüÊù•ÁöÑ SQL ThreadÔºåÂπ∂Ë°åÂ§çÂà∂‰∏≠ÂÆÉ‰∏çÂÜçÁõ¥Êé•Êõ¥Êñ∞Êï∞ÊçÆÔºå<strong>Âè™Ë¥üË¥£ËØªÂèñ‰∏≠ËΩ¨Êó•ÂøóÂíåÂàÜÂèë‰∫ãÂä°</strong>Ôºö</p><ul><li>Á∫øÁ®ãÂàÜÈÖçÂÆåÊàêÂπ∂‰∏çÊòØÁ´ãÂç≥ÊâßË°åÔºå‰∏∫‰∫ÜÈò≤Ê≠¢ÈÄ†ÊàêÊõ¥Êñ∞Ë¶ÜÁõñÔºåÊõ¥Êñ∞Âêå‰∏Ä DB ÁöÑ‰∏§‰∏™‰∫ãÂä°ÂøÖÈ°ªË¢´ÂàÜÂèëÂà∞Âêå‰∏Ä‰∏™Â∑•‰ΩúÁ∫øÁ®ã</li><li>Âêå‰∏Ä‰∏™‰∫ãÂä°‰∏çËÉΩË¢´ÊãÜÂºÄÔºåÂøÖÈ°ªÊîæÂà∞Âêå‰∏Ä‰∏™Â∑•‰ΩúÁ∫øÁ®ã</li></ul><p>MySQL 5.6 ÁâàÊú¨ÁöÑÁ≠ñÁï•ÔºöÊØè‰∏™Á∫øÁ®ãÂØπÂ∫î‰∏Ä‰∏™ hash Ë°®ÔºåÁî®‰∫é‰øùÂ≠òÂΩìÂâçËøô‰∏™Á∫øÁ®ãÁöÑÊâßË°åÈòüÂàóÈáåÁöÑ‰∫ãÂä°ÊâÄÊ∂âÂèäÁöÑË°®Ôºåhash Ë°®ÁöÑ key ÊòØÊï∞ÊçÆÂ∫ìÂêçÔºåvalue ÊòØ‰∏Ä‰∏™Êï∞Â≠óÔºåË°®Á§∫ÈòüÂàó‰∏≠ÊúâÂ§öÂ∞ë‰∏™‰∫ãÂä°‰øÆÊîπËøô‰∏™Â∫ìÔºåÈÄÇÁî®‰∫é‰∏ªÂ∫ì‰∏äÊúâÂ§ö‰∏™ DB ÁöÑÊÉÖÂÜµ</p><p>ÊØè‰∏™‰∫ãÂä°Âú®ÂàÜÂèëÁöÑÊó∂ÂÄôÔºåË∑üÁ∫øÁ®ãÁöÑ<strong>ÂÜ≤Á™Å</strong>Ôºà‰∫ãÂä°Êìç‰ΩúÁöÑÊòØÂêå‰∏Ä‰∏™Â∫ìÔºâÂÖ≥Á≥ªÂåÖÊã¨‰ª•‰∏ã‰∏âÁßçÊÉÖÂÜµÔºö</p><ul><li>Â¶ÇÊûúË∑üÊâÄÊúâÁ∫øÁ®ãÈÉΩ‰∏çÂÜ≤Á™ÅÔºåcoordinator Á∫øÁ®ãÂ∞±‰ºöÊääËøô‰∏™‰∫ãÂä°ÂàÜÈÖçÁªôÊúÄÁ©∫Èó≤ÁöÑÁ∫øÁ®ã</li><li>Â¶ÇÊûúÂè™Ë∑ü‰∏Ä‰∏™Á∫øÁ®ãÂÜ≤Á™ÅÔºåcoordinator Á∫øÁ®ãÂ∞±‰ºöÊääËøô‰∏™‰∫ãÂä°ÂàÜÈÖçÁªôËøô‰∏™Â≠òÂú®ÂÜ≤Á™ÅÂÖ≥Á≥ªÁöÑÁ∫øÁ®ã</li><li>Â¶ÇÊûúË∑üÂ§ö‰∫é‰∏Ä‰∏™Á∫øÁ®ãÂÜ≤Á™ÅÔºåcoordinator Á∫øÁ®ãÂ∞±ËøõÂÖ•Á≠âÂæÖÁä∂ÊÄÅÔºåÁõ¥Âà∞ÂíåËøô‰∏™‰∫ãÂä°Â≠òÂú®ÂÜ≤Á™ÅÂÖ≥Á≥ªÁöÑÁ∫øÁ®ãÂè™Ââ©‰∏ã 1 ‰∏™</li></ul><p>‰ºòÁº∫ÁÇπÔºö</p><ul><li>ÊûÑÈÄ† hash ÂÄºÁöÑÊó∂ÂÄôÂæàÂø´ÔºåÂè™ÈúÄË¶ÅÂ∫ìÂêçÔºåËÄå‰∏î‰∏Ä‰∏™ÂÆû‰æã‰∏ä DB Êï∞‰πü‰∏ç‰ºöÂæàÂ§öÔºå‰∏ç‰ºöÂá∫Áé∞ÈúÄË¶ÅÊûÑÈÄ†ÂæàÂ§öÈ°πÁöÑÊÉÖÂÜµ</li><li>‰∏çË¶ÅÊ±Ç binlog ÁöÑÊ†ºÂºèÔºåstatement Ê†ºÂºèÁöÑ binlog ‰πüÂèØ‰ª•ÂæàÂÆπÊòìÊãøÂà∞Â∫ìÂêçÔºàÊó•ÂøóÁ´†ËäÇËØ¶Ëß£‰∫Ü binlogÔºâ</li><li>‰∏ªÂ∫ì‰∏äÁöÑË°®ÈÉΩÊîæÂú®Âêå‰∏Ä‰∏™ DB ÈáåÈù¢ÔºåËøô‰∏™Á≠ñÁï•Â∞±Ê≤°ÊúâÊïàÊûú‰∫ÜÔºõÊàñËÄÖ‰∏çÂêå DB ÁöÑÁÉ≠ÁÇπ‰∏çÂêåÔºåÊØîÂ¶Ç‰∏Ä‰∏™ÊòØ‰∏öÂä°ÈÄªËæëÂ∫ìÔºå‰∏Ä‰∏™ÊòØÁ≥ªÁªüÈÖçÁΩÆÂ∫ìÔºåÈÇ£‰πüËµ∑‰∏çÂà∞Âπ∂Ë°åÁöÑÊïàÊûúÔºåÈúÄË¶Å<strong>ÊääÁõ∏ÂêåÁÉ≠Â∫¶ÁöÑË°®ÂùáÂåÄÂàÜÂà∞Ëøô‰∫õ‰∏çÂêåÁöÑ DB ‰∏≠</strong>ÔºåÊâçÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™Á≠ñÁï•</li></ul><hr><h5 id="mysql5-7" tabindex="-1"><a class="header-anchor" href="#mysql5-7"><span>MySQL5.7</span></a></h5><p>MySQL 5.7 Áî±ÂèÇÊï∞ slave-parallel-type Êù•ÊéßÂà∂Âπ∂Ë°åÂ§çÂà∂Á≠ñÁï•Ôºö</p><ul><li>ÈÖçÁΩÆ‰∏∫ DATABASEÔºåË°®Á§∫‰ΩøÁî® MySQL 5.6 ÁâàÊú¨ÁöÑ<strong>ÊåâÂ∫ìÔºàDBÔºâÂπ∂Ë°åÁ≠ñÁï•</strong></li><li>ÈÖçÁΩÆ‰∏∫ LOGICAL_CLOCKÔºåË°®Á§∫ÁöÑ<strong>ÊåâÊèê‰∫§Áä∂ÊÄÅÂπ∂Ë°å</strong>ÊâßË°å</li></ul><p>ÊåâÊèê‰∫§Áä∂ÊÄÅÂπ∂Ë°åÂ§çÂà∂Á≠ñÁï•ÁöÑÊÄùÊÉ≥ÊòØÔºö</p><ul><li>ÊâÄÊúâÂ§Ñ‰∫é commit Áä∂ÊÄÅÁöÑ‰∫ãÂä°ÂèØ‰ª•Âπ∂Ë°åÊâßË°åÔºõÂêåÊó∂Â§Ñ‰∫é prepare Áä∂ÊÄÅÁöÑ‰∫ãÂä°ÔºåÂú®‰ªéÂ∫ìÊâßË°åÊó∂ÊòØÂèØ‰ª•Âπ∂Ë°åÁöÑ</li><li>Â§Ñ‰∫é prepare Áä∂ÊÄÅÁöÑ‰∫ãÂä°Ôºå‰∏éÂ§Ñ‰∫é commit Áä∂ÊÄÅÁöÑ‰∫ãÂä°‰πãÈó¥ÔºåÂú®‰ªéÂ∫ìÊâßË°åÊó∂‰πüÊòØÂèØ‰ª•Âπ∂Ë°åÁöÑ</li></ul><p>MySQL 5.7.22 ÁâàÊú¨ÈáåÔºåMySQL Â¢ûÂä†‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÂπ∂Ë°åÂ§çÂà∂Á≠ñÁï•ÔºåÂü∫‰∫é WRITESET ÁöÑÂπ∂Ë°åÂ§çÂà∂ÔºåÊñ∞Â¢û‰∫Ü‰∏Ä‰∏™ÂèÇÊï∞ binlog-transaction-dependency-trackingÔºåÁî®Êù•ÊéßÂà∂ÊòØÂê¶ÂêØÁî®Ëøô‰∏™Êñ∞Á≠ñÁï•Ôºö</p><ul><li><p>COMMIT_ORDERÔºöË°®Á§∫Ê†πÊçÆÂêåÊó∂ËøõÂÖ• prepare Âíå commit Êù•Âà§Êñ≠ÊòØÂê¶ÂèØ‰ª•Âπ∂Ë°åÁöÑÁ≠ñÁï•</p></li><li><p>WRITESETÔºöË°®Á§∫ÁöÑÊòØÂØπ‰∫éÊØè‰∏™‰∫ãÂä°Ê∂âÂèäÊõ¥Êñ∞ÁöÑÊØè‰∏ÄË°åÔºåËÆ°ÁÆóÂá∫Ëøô‰∏ÄË°åÁöÑ hash ÂÄºÔºåÁªÑÊàêËØ•‰∫ãÂä°ÁöÑ writeset ÈõÜÂêàÔºåÂ¶ÇÊûú‰∏§‰∏™‰∫ãÂä°Ê≤°ÊúâÊìç‰ΩúÁõ∏ÂêåÁöÑË°åÔºå‰πüÂ∞±ÊòØËØ¥ÂÆÉ‰ª¨ÁöÑ writeset Ê≤°Êúâ‰∫§ÈõÜÔºåÂ∞±ÂèØ‰ª•Âπ∂Ë°åÔºà<strong>ÊåâË°åÂπ∂Ë°å</strong>Ôºâ</p><p>‰∏∫‰∫ÜÂîØ‰∏ÄÊ†áËØÜÔºåËøô‰∏™ hash Ë°®ÁöÑÂÄºÊòØÈÄöËøá <code>Â∫ìÂêç + Ë°®Âêç + Á¥¢ÂºïÂêç + ÂÄº</code>ÔºàË°®Á§∫ÁöÑÊòØÊüê‰∏ÄË°åÔºâËÆ°ÁÆóÂá∫Êù•ÁöÑ</p></li><li><p>WRITESET_SESSIONÔºöÊòØÂú® WRITESET ÁöÑÂü∫Á°Ä‰∏äÂ§ö‰∫Ü‰∏Ä‰∏™Á∫¶ÊùüÔºåÂç≥Âú®‰∏ªÂ∫ì‰∏äÂêå‰∏Ä‰∏™Á∫øÁ®ãÂÖàÂêéÊâßË°åÁöÑ‰∏§‰∏™‰∫ãÂä°ÔºåÂú®Â§áÂ∫ìÊâßË°åÁöÑÊó∂ÂÄôÔºåË¶Å‰øùËØÅÁõ∏ÂêåÁöÑÂÖàÂêéÈ°∫Â∫è</p></li></ul><p>MySQL 5.7.22 ÊåâË°åÂπ∂ÂèëÁöÑ‰ºòÂäøÔºö</p><ul><li>writeset ÊòØÂú®‰∏ªÂ∫ìÁîüÊàêÂêéÁõ¥Êé•ÂÜôÂÖ•Âà∞ binlog ÈáåÈù¢ÁöÑÔºåËøôÊ†∑Âú®Â§áÂ∫ìÊâßË°åÁöÑÊó∂ÂÄôÔºå‰∏çÈúÄË¶ÅËß£Êûê binlog ÂÜÖÂÆπÔºåËäÇÁúÅ‰∫ÜËÆ°ÁÆóÈáè</li><li>‰∏çÈúÄË¶ÅÊääÊï¥‰∏™‰∫ãÂä°ÁöÑ binlog ÈÉΩÊâ´‰∏ÄÈÅçÊâçËÉΩÂÜ≥ÂÆöÂàÜÂèëÂà∞Âì™‰∏™Á∫øÁ®ãÔºåÊõ¥ÁúÅÂÜÖÂ≠ò</li><li>‰ªéÂ∫ìÁöÑÂàÜÂèëÁ≠ñÁï•‰∏ç‰æùËµñ‰∫é binlog ÂÜÖÂÆπÔºåÊâÄ‰ª• binlog ÊòØ statement Ê†ºÂºè‰πüÂèØ‰ª•ÔºåÊõ¥ËäÇÁ∫¶ÂÜÖÂ≠òÔºàÂõ†‰∏∫ row ÊâçËÆ∞ÂΩïÊõ¥ÊîπÁöÑË°åÔºâ</li></ul><p>MySQL 5.7.22 ÁöÑÂπ∂Ë°åÂ§çÂà∂Á≠ñÁï•Âú®ÈÄöÁî®ÊÄß‰∏äÊòØÊúâ‰øùËØÅÁöÑÔºå‰ΩÜÊòØÂØπ‰∫éË°®‰∏äÊ≤°‰∏ªÈîÆ„ÄÅÂîØ‰∏ÄÂíåÂ§ñÈîÆÁ∫¶ÊùüÁöÑÂú∫ÊôØÔºåWRITESET Á≠ñÁï•‰πüÊòØÊ≤°Ê≥ïÂπ∂Ë°åÁöÑÔºå‰πü‰ºöÊöÇÊó∂ÈÄÄÂåñ‰∏∫ÂçïÁ∫øÁ®ãÊ®°Âûã</p><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://time.geekbang.org/column/article/77083</p><hr><h3 id="ËØªÂÜôÂàÜÁ¶ª" tabindex="-1"><a class="header-anchor" href="#ËØªÂÜôÂàÜÁ¶ª"><span>ËØªÂÜôÂàÜÁ¶ª</span></a></h3><h4 id="ËØªÂÜôÂª∂Ëøü" tabindex="-1"><a class="header-anchor" href="#ËØªÂÜôÂª∂Ëøü"><span>ËØªÂÜôÂª∂Ëøü</span></a></h4><p>ËØªÂÜôÂàÜÁ¶ªÔºöÂèØ‰ª•Èôç‰Ωé‰∏ªÂ∫ìÁöÑËÆøÈóÆÂéãÂäõÔºåÊèêÈ´òÁ≥ªÁªüÁöÑÂπ∂ÂèëËÉΩÂäõ</p><ul><li>‰∏ªÂ∫ì‰∏çÂª∫Êü•ËØ¢ÁöÑÁ¥¢ÂºïÔºå‰ªéÂ∫ìÂª∫Êü•ËØ¢ÁöÑÁ¥¢Âºï„ÄÇÂõ†‰∏∫Á¥¢ÂºïÈúÄË¶ÅÁª¥Êä§ÁöÑÔºåÊØîÂ¶ÇÊèíÂÖ•‰∏ÄÊù°Êï∞ÊçÆÔºå‰∏ç‰ªÖË¶ÅÂú®ËÅöÁ∞áÁ¥¢Âºï‰∏äÈù¢ÊèíÂÖ•ÔºåÂØπÂ∫îÁöÑ‰∫åÁ∫ßÁ¥¢Âºï‰πüÂæóÊèíÂÖ•</li><li>Â∞ÜËØªÊìç‰ΩúÂàÜÂà∞‰ªéÂ∫ì‰∫Ü‰πãÂêéÔºåÂèØ‰ª•Âú®‰∏ªÂ∫ìÊääÊü•ËØ¢Ë¶ÅÁî®ÁöÑÁ¥¢ÂºïÂà†‰∫ÜÔºåÂáèÂ∞ëÂÜôÊìç‰ΩúÂØπ‰∏ªÂ∫ìÁöÑÂΩ±Âìç</li></ul><p>ËØªÂÜôÂàÜÁ¶ª‰∫ßÁîü‰∫ÜËØªÂÜôÂª∂ËøüÔºåÈÄ†ÊàêÊï∞ÊçÆÁöÑ‰∏ç‰∏ÄËá¥ÊÄß„ÄÇÂÅáÂ¶ÇÂÆ¢Êà∑Á´ØÊâßË°åÂÆå‰∏Ä‰∏™Êõ¥Êñ∞‰∫ãÂä°ÂêéÈ©¨‰∏äÂèëËµ∑Êü•ËØ¢ÔºåÂ¶ÇÊûúÊü•ËØ¢ÈÄâÊã©ÁöÑÊòØ‰ªéÂ∫ìÁöÑËØùÔºåÂèØËÉΩËØªÂà∞ÁöÑËøòÊòØ‰ª•ÂâçÁöÑÊï∞ÊçÆÔºåÂè´ËøáÊúüËØª</p><p>Ëß£ÂÜ≥ÊñπÊ°àÔºö</p><ul><li>Âº∫Âà∂Â∞ÜÂÜô‰πãÂêé<strong>Á´ãÂàªËØªÁöÑÊìç‰ΩúËΩ¨ÁßªÂà∞‰∏ªÂ∫ì</strong>ÔºåÊØîÂ¶ÇÂàöÊ≥®ÂÜåÁöÑÁî®Êà∑ÔºåÁõ¥Êé•ÁôªÂΩï‰ªéÂ∫ìÊü•ËØ¢ÂèØËÉΩÊü•ËØ¢‰∏çÂà∞ÔºåÂÖàËµ∞‰∏ªÂ∫ìÁôªÂΩï</li><li><strong>‰∫åÊ¨°Êü•ËØ¢</strong>ÔºåÂ¶ÇÊûú‰ªéÂ∫ìÊü•‰∏çÂà∞Êï∞ÊçÆÔºåÂàôÂÜçÂéª‰∏ªÂ∫ìÊü•‰∏ÄÈÅçÔºåÁî± API Â∞ÅË£ÖÔºåÊØîËæÉÁÆÄÂçïÔºå‰ΩÜÂØºËá¥‰∏ªÂ∫ìÂéãÂäõÂ§ß</li><li>Êõ¥Êñ∞‰∏ªÂ∫ìÂêéÔºåËØª‰ªéÂ∫ì‰πãÂâçÂÖà sleep ‰∏Ä‰∏ãÔºåÁ±ª‰ºº‰∫éÊâßË°å‰∏ÄÊù° <code>select sleep(1)</code> ÂëΩ‰ª§ÔºåÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ã‰∏ªÂ§áÂª∂ËøüÂú® 1 Áßí‰πãÂÜÖ</li></ul><hr><h4 id="Á°Æ‰øùÊú∫Âà∂" tabindex="-1"><a class="header-anchor" href="#Á°Æ‰øùÊú∫Âà∂"><span>Á°Æ‰øùÊú∫Âà∂</span></a></h4><h5 id="Êó†Âª∂Ëøü" tabindex="-1"><a class="header-anchor" href="#Êó†Âª∂Ëøü"><span>Êó†Âª∂Ëøü</span></a></h5><p>Á°Æ‰øù‰∏ªÂ§áÊó†Âª∂ËøüÁöÑÊñπÊ≥ïÔºö</p><ul><li>ÊØèÊ¨°‰ªéÂ∫ìÊâßË°åÊü•ËØ¢ËØ∑Ê±ÇÂâçÔºåÂÖàÂà§Êñ≠ seconds_behind_master ÊòØÂê¶Â∑≤ÁªèÁ≠â‰∫é 0ÔºåÂ¶ÇÊûú‰∏çÁ≠â‰∫éÈÇ£Â∞±Á≠âÂà∞ÂèÇÊï∞Âèò‰∏∫ 0 ÊâßË°åÊü•ËØ¢ËØ∑Ê±Ç</li><li>ÂØπÊØî‰ΩçÁÇπÔºåMaster_Log_File Âíå Read_Master_Log_Pos Ë°®Á§∫ÁöÑÊòØËØªÂà∞ÁöÑ‰∏ªÂ∫ìÁöÑÊúÄÊñ∞‰ΩçÁÇπÔºåRelay_Master_Log_File Âíå Exec_Master_Log_Pos Ë°®Á§∫ÁöÑÊòØÂ§áÂ∫ìÊâßË°åÁöÑÊúÄÊñ∞‰ΩçÁÇπÔºåËøô‰∏§ÁªÑÂÄºÂÆåÂÖ®Áõ∏ÂêåÂ∞±ËØ¥ÊòéÊé•Êî∂Âà∞ÁöÑÊó•ÂøóÂ∑≤ÁªèÂêåÊ≠•ÂÆåÊàê</li><li>ÂØπÊØî GTID ÈõÜÂêàÔºåRetrieved_Gtid_Set ÊòØÂ§áÂ∫ìÊî∂Âà∞ÁöÑÊâÄÊúâÊó•ÂøóÁöÑ GTID ÈõÜÂêàÔºåExecuted_Gtid_Set ÊòØÂ§áÂ∫ìÊâÄÊúâÂ∑≤ÁªèÊâßË°åÂÆåÊàêÁöÑ GTID ÈõÜÂêàÔºåÂ¶ÇÊûúËøô‰∏§‰∏™ÈõÜÂêàÁõ∏Âêå‰πüË°®Á§∫Â§áÂ∫ìÊé•Êî∂Âà∞ÁöÑÊó•ÂøóÈÉΩÂ∑≤ÁªèÂêåÊ≠•ÂÆåÊàê</li></ul><hr><h5 id="ÂçäÂêåÊ≠•" tabindex="-1"><a class="header-anchor" href="#ÂçäÂêåÊ≠•"><span>ÂçäÂêåÊ≠•</span></a></h5><p>ÂçäÂêåÊ≠•Â§çÂà∂Â∞±ÊòØ semi-sync replicationÔºåÈÄÇÁî®‰∫é‰∏Ä‰∏ª‰∏ÄÂ§áÁöÑÂú∫ÊôØÔºåÂ∑•‰ΩúÊµÅÁ®ãÔºö</p><ul><li>‰∫ãÂä°Êèê‰∫§ÁöÑÊó∂ÂÄôÔºå‰∏ªÂ∫ìÊää binlog ÂèëÁªô‰ªéÂ∫ì</li><li>‰ªéÂ∫ìÊî∂Âà∞ binlog ‰ª•ÂêéÔºåÂèëÂõûÁªô‰∏ªÂ∫ì‰∏Ä‰∏™ ackÔºåË°®Á§∫Êî∂Âà∞‰∫Ü</li><li>‰∏ªÂ∫ìÊî∂Âà∞Ëøô‰∏™ ack ‰ª•ÂêéÔºåÊâçËÉΩÁªôÂÆ¢Êà∑Á´ØËøîÂõû‰∫ãÂä°ÂÆåÊàêÁöÑÁ°ÆËÆ§</li></ul><p>Âú®‰∏Ä‰∏ªÂ§ö‰ªéÂú∫ÊôØ‰∏≠Ôºå‰∏ªÂ∫ìÂè™Ë¶ÅÁ≠âÂà∞‰∏Ä‰∏™‰ªéÂ∫ìÁöÑ ackÔºåÂ∞±ÂºÄÂßãÁªôÂÆ¢Êà∑Á´ØËøîÂõûÁ°ÆËÆ§ÔºåËøôÊó∂Âú®‰ªéÂ∫ì‰∏äÊâßË°åÊü•ËØ¢ËØ∑Ê±ÇÔºåÊúâ‰∏§ÁßçÊÉÖÂÜµÔºö</p><ul><li>Â¶ÇÊûúÊü•ËØ¢ÊòØËêΩÂú®Ëøô‰∏™ÂìçÂ∫î‰∫Ü ack ÁöÑ‰ªéÂ∫ì‰∏äÔºåÊòØËÉΩÂ§üÁ°Æ‰øùËØªÂà∞ÊúÄÊñ∞Êï∞ÊçÆ</li><li>Â¶ÇÊûúÊü•ËØ¢ËêΩÂà∞ÂÖ∂‰ªñ‰ªéÂ∫ì‰∏äÔºåÂÆÉ‰ª¨ÂèØËÉΩËøòÊ≤°ÊúâÊî∂Âà∞ÊúÄÊñ∞ÁöÑÊó•ÂøóÔºåÂ∞±‰ºö‰∫ßÁîüËøáÊúüËØªÁöÑÈóÆÈ¢ò</li></ul><p>Âú®‰∏öÂä°Êõ¥Êñ∞ÁöÑÈ´òÂ≥∞ÊúüÔºå‰∏ªÂ∫ìÁöÑ‰ΩçÁÇπÊàñËÄÖ GTID ÈõÜÂêàÊõ¥Êñ∞ÂæàÂø´ÔºåÂØºËá¥‰ªéÂ∫ìÊù•‰∏çÂèäÂ§ÑÁêÜÔºåÈÇ£‰πà‰∏§‰∏™‰ΩçÁÇπÁ≠âÂÄºÂà§Êñ≠Â∞±‰ºö‰∏ÄÁõ¥‰∏çÊàêÁ´ãÔºåÂæàÂèØËÉΩÂá∫Áé∞‰ªéÂ∫ì‰∏äËøüËøüÊó†Ê≥ïÂìçÂ∫îÊü•ËØ¢ËØ∑Ê±ÇÁöÑÊÉÖÂÜµ</p><hr><h5 id="Á≠â‰ΩçÁÇπ" tabindex="-1"><a class="header-anchor" href="#Á≠â‰ΩçÁÇπ"><span>Á≠â‰ΩçÁÇπ</span></a></h5><p>Âú®<strong>‰ªéÂ∫ìÊâßË°åÂà§Êñ≠‰ΩçÁÇπ</strong>ÁöÑÂëΩ‰ª§ÔºåÂèÇÊï∞ file Âíå pos ÊåáÁöÑÊòØ‰∏ªÂ∫ì‰∏äÁöÑÊñá‰ª∂ÂêçÂíå‰ΩçÁΩÆÔºåtimeout ÂèØÈÄâÔºåËÆæÁΩÆ‰∏∫Ê≠£Êï¥Êï∞ N Ë°®Á§∫ÊúÄÂ§öÁ≠âÂæÖ N Áßí</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT master_pos_wait(file, pos[, timeout]);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ÂëΩ‰ª§Ê≠£Â∏∏ËøîÂõûÁöÑÁªìÊûúÊòØ‰∏Ä‰∏™Ê≠£Êï¥Êï∞ MÔºåË°®Á§∫‰ªéÂëΩ‰ª§ÂºÄÂßãÊâßË°åÔºåÂà∞Â∫îÁî®ÂÆå file Âíå pos Ë°®Á§∫ÁöÑ binlog ‰ΩçÁΩÆÔºåÊâßË°å‰∫ÜÂ§öÂ∞ë‰∫ãÂä°</p><ul><li>Â¶ÇÊûúÊâßË°åÊúüÈó¥ÔºåÂ§áÂ∫ìÂêåÊ≠•Á∫øÁ®ãÂèëÁîüÂºÇÂ∏∏ÔºåÂàôËøîÂõû NULL</li><li>Â¶ÇÊûúÁ≠âÂæÖË∂ÖËøá N ÁßíÔºåÂ∞±ËøîÂõû -1</li><li>Â¶ÇÊûúÂàöÂºÄÂßãÊâßË°åÁöÑÊó∂ÂÄôÔºåÂ∞±ÂèëÁé∞Â∑≤ÁªèÊâßË°åËøáËøô‰∏™‰ΩçÁΩÆ‰∫ÜÔºåÂàôËøîÂõû 0</li></ul><p>Â∑•‰ΩúÊµÅÁ®ãÔºöÂÖàÊâßË°å trx1ÔºåÂÜçÊâßË°å‰∏Ä‰∏™Êü•ËØ¢ËØ∑Ê±ÇÁöÑÈÄªËæëÔºåË¶Å<strong>‰øùËØÅËÉΩÂ§üÊü•Âà∞Ê≠£Á°ÆÁöÑÊï∞ÊçÆ</strong></p><ul><li>trx1 ‰∫ãÂä°Êõ¥Êñ∞ÂÆåÊàêÂêéÔºåÈ©¨‰∏äÊâßË°å <code>show master status</code> ÂæóÂà∞ÂΩìÂâç‰∏ªÂ∫ìÊâßË°åÂà∞ÁöÑ File Âíå Position</li><li>ÈÄâÂÆö‰∏Ä‰∏™‰ªéÂ∫ìÊâßË°åÂà§Êñ≠‰ΩçÁÇπËØ≠Âè•ÔºåÂ¶ÇÊûúËøîÂõûÂÄºÊòØ &gt;=0 ÁöÑÊ≠£Êï¥Êï∞ÔºåËØ¥Êòé‰ªéÂ∫ìÂ∑≤ÁªèÂêåÊ≠•ÂÆå‰∫ãÂä°ÔºåÂèØ‰ª•Âú®Ëøô‰∏™‰ªéÂ∫ìÊâßË°åÊü•ËØ¢ËØ≠Âè•</li><li>Â¶ÇÊûúÂá∫Áé∞ÂÖ∂‰ªñÊÉÖÂÜµÔºåÈúÄË¶ÅÂà∞‰∏ªÂ∫ìÊâßË°åÊü•ËØ¢ËØ≠Âè•</li></ul><p>Ê≥®ÊÑèÔºöÂ¶ÇÊûúÊâÄÊúâÁöÑ‰ªéÂ∫ìÈÉΩÂª∂ËøüË∂ÖËøá timeout ÁßíÔºåÊü•ËØ¢ÂéãÂäõÂ∞±ÈÉΩË∑ëÂà∞‰∏ªÂ∫ì‰∏äÔºåÊâÄ‰ª•ÈúÄË¶ÅËøõË°åÊùÉË°°</p><hr><h5 id="Á≠âgtid" tabindex="-1"><a class="header-anchor" href="#Á≠âgtid"><span>Á≠âGTID</span></a></h5><p>Êï∞ÊçÆÂ∫ìÂºÄÂêØ‰∫Ü GTID Ê®°ÂºèÔºåMySQL Êèê‰æõ‰∫ÜÂà§Êñ≠ GTID ÁöÑÂëΩ‰ª§</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT wait_for_executed_gtid_set(gtid_set [, timeout])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>Á≠âÂæÖÁõ¥Âà∞Ëøô‰∏™Â∫ìÊâßË°åÁöÑ‰∫ãÂä°‰∏≠ÂåÖÂê´‰º†ÂÖ•ÁöÑ gtid_setÔºåËøîÂõû 0</li><li>Ë∂ÖÊó∂ËøîÂõû 1</li></ul><p>Â∑•‰ΩúÊµÅÁ®ãÔºöÂÖàÊâßË°å trx1ÔºåÂÜçÊâßË°å‰∏Ä‰∏™Êü•ËØ¢ËØ∑Ê±ÇÁöÑÈÄªËæëÔºåË¶Å‰øùËØÅËÉΩÂ§üÊü•Âà∞Ê≠£Á°ÆÁöÑÊï∞ÊçÆ</p><ul><li>trx1 ‰∫ãÂä°Êõ¥Êñ∞ÂÆåÊàêÂêéÔºå‰ªéËøîÂõûÂåÖÁõ¥Êé•Ëé∑ÂèñËøô‰∏™‰∫ãÂä°ÁöÑ GTIDÔºåËÆ∞‰∏∫ gtid</li><li>ÈÄâÂÆö‰∏Ä‰∏™‰ªéÂ∫ìÊâßË°åÊü•ËØ¢ËØ≠Âè•ÔºåÂ¶ÇÊûúËøîÂõûÂÄºÊòØ 0ÔºåÂàôÂú®Ëøô‰∏™‰ªéÂ∫ìÊâßË°åÊü•ËØ¢ËØ≠Âè•ÔºåÂê¶ÂàôÂà∞‰∏ªÂ∫ìÊâßË°åÊü•ËØ¢ËØ≠Âè•</li></ul><p>ÂØπÊØîÁ≠âÂæÖ‰ΩçÁÇπÊñπÊ≥ïÔºåÂáèÂ∞ë‰∫Ü‰∏ÄÊ¨° <code>show master status</code> ÁöÑÊñπÊ≥ïÔºåÂ∞ÜÂèÇÊï∞ session_track_gtids ËÆæÁΩÆ‰∏∫ OWN_GTIDÔºåÁÑ∂ÂêéÈÄöËøá API Êé•Âè£ mysql_session_track_get_first ‰ªéËøîÂõûÂåÖËß£ÊûêÂá∫ GTID ÁöÑÂÄºÂç≥ÂèØ</p><p>ÊÄªÁªìÔºöÊâÄÊúâÁöÑÁ≠âÂæÖÊó†Âª∂ËøüÁöÑÊñπÊ≥ïÔºåÈÉΩÈúÄË¶ÅÊ†πÊçÆÂÖ∑‰ΩìÁöÑ‰∏öÂä°Âú∫ÊôØÂéªÂà§Êñ≠ÂÆûÊñΩ</p><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://time.geekbang.org/column/article/77636</p><hr><h4 id="Ë¥üËΩΩÂùáË°°" tabindex="-1"><a class="header-anchor" href="#Ë¥üËΩΩÂùáË°°"><span>Ë¥üËΩΩÂùáË°°</span></a></h4><p>Ë¥üËΩΩÂùáË°°ÊòØÂ∫îÁî®‰∏≠‰ΩøÁî®ÈùûÂ∏∏ÊôÆÈÅçÁöÑ‰∏ÄÁßç‰ºòÂåñÊñπÊ≥ïÔºåÊú∫Âà∂Â∞±ÊòØÂà©Áî®ÊüêÁßçÂùáË°°ÁÆóÊ≥ïÔºåÂ∞ÜÂõ∫ÂÆöÁöÑË¥üËΩΩÈáèÂàÜÂ∏ÉÂà∞‰∏çÂêåÁöÑÊúçÂä°Âô®‰∏äÔºå‰ª•Ê≠§Êù•Èôç‰ΩéÂçïÂè∞ÊúçÂä°Âô®ÁöÑË¥üËΩΩÔºåËææÂà∞‰ºòÂåñÁöÑÊïàÊûú</p><ul><li><p>ÂàÜÊµÅÊü•ËØ¢ÔºöÈÄöËøá MySQL ÁöÑ‰∏ª‰ªéÂ§çÂà∂ÔºåÂÆûÁé∞ËØªÂÜôÂàÜÁ¶ªÔºå‰ΩøÂ¢ûÂà†ÊîπÊìç‰ΩúËµ∞‰∏ªËäÇÁÇπÔºåÊü•ËØ¢Êìç‰ΩúËµ∞‰ªéËäÇÁÇπÔºå‰ªéËÄåÂèØ‰ª•Èôç‰ΩéÂçïÂè∞ÊúçÂä°Âô®ÁöÑËØªÂÜôÂéãÂäõ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Ë¥üËΩΩÂùáË°°‰∏ª‰ªéÂ§çÂà∂.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>ÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ∫ìÊû∂ÊûÑÔºöÈÄÇÂêàÂ§ßÊï∞ÊçÆÈáè„ÄÅË¥üËΩΩÈ´òÁöÑÊÉÖÂÜµÔºåÂÖ∑ÊúâËâØÂ•ΩÁöÑÊãìÂ±ïÊÄßÂíåÈ´òÂèØÁî®ÊÄß„ÄÇÈÄöËøáÂú®Â§öÂè∞ÊúçÂä°Âô®‰πãÈó¥ÂàÜÂ∏ÉÊï∞ÊçÆÔºåÂèØ‰ª•ÂÆûÁé∞Âú®Â§öÂè∞ÊúçÂä°Âô®‰πãÈó¥ÁöÑË¥üËΩΩÂùáË°°ÔºåÊèêÈ´òËÆøÈóÆÊïàÁéá</p></li></ul><hr><h3 id="‰∏ª‰ªéÊê≠Âª∫" tabindex="-1"><a class="header-anchor" href="#‰∏ª‰ªéÊê≠Âª∫"><span>‰∏ª‰ªéÊê≠Âª∫</span></a></h3><h4 id="master" tabindex="-1"><a class="header-anchor" href="#master"><span>master</span></a></h4><ol><li><p>Âú®master ÁöÑÈÖçÁΩÆÊñá‰ª∂Ôºà/etc/mysql/my.cnfÔºâ‰∏≠ÔºåÈÖçÁΩÆÂ¶Ç‰∏ãÂÜÖÂÆπÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#mysql ÊúçÂä°ID,‰øùËØÅÊï¥‰∏™ÈõÜÁæ§ÁéØÂ¢É‰∏≠ÂîØ‰∏Ä</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">server-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#mysql binlog Êó•ÂøóÁöÑÂ≠òÂÇ®Ë∑ØÂæÑÂíåÊñá‰ª∂Âêç</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">log-bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/var/lib/mysql/mysqlbin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#ÈîôËØØÊó•Âøó,ÈªòËÆ§Â∑≤ÁªèÂºÄÂêØ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#log-err</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#mysqlÁöÑÂÆâË£ÖÁõÆÂΩï</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#basedir</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#mysqlÁöÑ‰∏¥Êó∂ÁõÆÂΩï</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#tmpdir</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#mysqlÁöÑÊï∞ÊçÆÂ≠òÊîæÁõÆÂΩï</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#datadir</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#ÊòØÂê¶Âè™ËØª,1 ‰ª£Ë°®Âè™ËØª, 0 ‰ª£Ë°®ËØªÂÜô</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">read-only</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#ÂøΩÁï•ÁöÑÊï∞ÊçÆ, Êåá‰∏çÈúÄË¶ÅÂêåÊ≠•ÁöÑÊï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">binlog-ignore-db</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mysql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#ÊåáÂÆöÂêåÊ≠•ÁöÑÊï∞ÊçÆÂ∫ì</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#binlog-do-db=db01</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÊâßË°åÂÆåÊØï‰πãÂêéÔºåÈúÄË¶ÅÈáçÂêØ MySQL</p></li><li><p>ÂàõÂª∫ÂêåÊ≠•Êï∞ÊçÆÁöÑË¥¶Êà∑ÔºåÂπ∂‰∏îËøõË°åÊéàÊùÉÊìç‰ΩúÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>GRANT REPLICATION SLAVE ON *.* TO &#39;seazean&#39;@&#39;192.168.0.137&#39; IDENTIFIED BY &#39;123456&#39;;</span></span>
<span class="line"><span>FLUSH PRIVILEGES;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Êü•Áúã master Áä∂ÊÄÅÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW MASTER STATUS;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Êü•ÁúãmasterÁä∂ÊÄÅ.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>FileÔºö‰ªéÂì™‰∏™Êó•ÂøóÊñá‰ª∂ÂºÄÂßãÊé®ÈÄÅÊó•ÂøóÊñá‰ª∂</li><li>PositionÔºö‰ªéÂì™‰∏™‰ΩçÁΩÆÂºÄÂßãÊé®ÈÄÅÊó•Âøó</li><li>Binlog_Ignore_DBÔºöÊåáÂÆö‰∏çÈúÄË¶ÅÂêåÊ≠•ÁöÑÊï∞ÊçÆÂ∫ì</li></ul></li></ol><hr><h4 id="slave" tabindex="-1"><a class="header-anchor" href="#slave"><span>slave</span></a></h4><ol><li><p>Âú® slave Á´ØÈÖçÁΩÆÊñá‰ª∂‰∏≠ÔºåÈÖçÁΩÆÂ¶Ç‰∏ãÂÜÖÂÆπÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#mysqlÊúçÂä°Á´ØID,ÂîØ‰∏Ä</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">server-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#ÊåáÂÆöbinlogÊó•Âøó</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">log-bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/var/lib/mysql/mysqlbin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÊâßË°åÂÆåÊØï‰πãÂêéÔºåÈúÄË¶ÅÈáçÂêØ MySQL</p></li><li><p>ÊåáÂÆöÂΩìÂâç‰ªéÂ∫ìÂØπÂ∫îÁöÑ‰∏ªÂ∫ìÁöÑIPÂú∞ÂùÄ„ÄÅÁî®Êà∑Âêç„ÄÅÂØÜÁ†ÅÔºå‰ªéÂì™‰∏™Êó•ÂøóÊñá‰ª∂ÂºÄÂßãÁöÑÈÇ£‰∏™‰ΩçÁΩÆÂºÄÂßãÂêåÊ≠•Êé®ÈÄÅÊó•Âøó</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CHANGE MASTER TO MASTER_HOST= &#39;192.168.0.138&#39;, MASTER_USER=&#39;seazean&#39;, MASTER_PASSWORD=&#39;seazean&#39;, MASTER_LOG_FILE=&#39;mysqlbin.000001&#39;, MASTER_LOG_POS=413;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂºÄÂêØÂêåÊ≠•Êìç‰ΩúÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>START SLAVE;</span></span>
<span class="line"><span>SHOW SLAVE STATUS;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÂÅúÊ≠¢ÂêåÊ≠•Êìç‰ΩúÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>STOP SLAVE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><hr><h4 id="È™åËØÅ" tabindex="-1"><a class="header-anchor" href="#È™åËØÅ"><span>È™åËØÅ</span></a></h4><ol><li><p>Âú®‰∏ªÂ∫ì‰∏≠ÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºåÂàõÂª∫Ë°®Âπ∂ÊèíÂÖ•Êï∞ÊçÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>CREATE DATABASE db01;</span></span>
<span class="line"><span>USE db01;</span></span>
<span class="line"><span>CREATE TABLE user(</span></span>
<span class="line"><span>	id INT(11) NOT NULL AUTO_INCREMENT,</span></span>
<span class="line"><span>	name VARCHAR(50) NOT NULL,</span></span>
<span class="line"><span>	sex VARCHAR(1),</span></span>
<span class="line"><span>	PRIMARY KEY (id)</span></span>
<span class="line"><span>)ENGINE=INNODB DEFAULT CHARSET=utf8;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>INSERT INTO user(id,NAME,sex) VALUES(NULL,&#39;Tom&#39;,&#39;1&#39;);</span></span>
<span class="line"><span>INSERT INTO user(id,NAME,sex) VALUES(NULL,&#39;Trigger&#39;,&#39;0&#39;);</span></span>
<span class="line"><span>INSERT INTO user(id,NAME,sex) VALUES(NULL,&#39;Dawn&#39;,&#39;1&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Âú®‰ªéÂ∫ì‰∏≠Êü•ËØ¢Êï∞ÊçÆÔºåËøõË°åÈ™åËØÅÔºö</p><p>Âú®‰ªéÂ∫ì‰∏≠ÔºåÂèØ‰ª•Êü•ÁúãÂà∞ÂàöÊâçÂàõÂª∫ÁöÑÊï∞ÊçÆÂ∫ìÔºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰∏ª‰ªéÂ§çÂà∂È™åËØÅ1.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Âú®ËØ•Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÊü•ËØ¢Ë°®‰∏≠ÁöÑÊï∞ÊçÆÔºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-‰∏ª‰ªéÂ§çÂà∂È™åËØÅ2.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ol><hr><h3 id="‰∏ª‰ªéÂàáÊç¢" tabindex="-1"><a class="header-anchor" href="#‰∏ª‰ªéÂàáÊç¢"><span>‰∏ª‰ªéÂàáÊç¢</span></a></h3><h4 id="Ê≠£Â∏∏ÂàáÊç¢" tabindex="-1"><a class="header-anchor" href="#Ê≠£Â∏∏ÂàáÊç¢"><span>Ê≠£Â∏∏ÂàáÊç¢</span></a></h4><p>Ê≠£Â∏∏ÂàáÊç¢Ê≠•È™§Ôºö</p><ul><li><p>Âú®ÂºÄÂßãÂàáÊç¢‰πãÂâçÂÖàÂØπ‰∏ªÂ∫ìËøõË°åÈîÅË°® <code>flush tables with read lock</code>ÔºåÁÑ∂ÂêéÁ≠âÂæÖÊâÄÊúâËØ≠Âè•ÊâßË°åÂÆåÊàêÔºåÂàáÊç¢ÂÆåÊàêÂêéÂèØ‰ª•ÈáäÊîæÈîÅ</p></li><li><p>Ê£ÄÊü• slave ÂêåÊ≠•Áä∂ÊÄÅÔºåÂú® slave ÊâßË°å <code>show processlist</code></p></li><li><p>ÂÅúÊ≠¢ slave io Á∫øÁ®ãÔºåÊâßË°åÂëΩ‰ª§ <code>STOP SLAVE IO_THREAD</code></p></li><li><p>ÊèêÂçá slave ‰∏∫ master</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Stop</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> slave;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Reset</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> master</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">Reset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> slave all;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> global</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> read_only</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;	</span><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">-- ËÆæÁΩÆ‰∏∫ÂèØÊõ¥Êñ∞Áä∂ÊÄÅ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Â∞ÜÂéüÊù• master Âèò‰∏∫ slaveÔºàÂèÇËÄÉÊê≠Âª∫ÊµÅÁ®ã‰∏≠ÁöÑ slave ÊñπÊ≥ïÔºâ</p></li></ul><p><strong>ÂèØÈù†ÊÄß‰ºòÂÖàÁ≠ñÁï•</strong>Ôºö</p><ul><li>Âà§Êñ≠Â§áÂ∫ì B Áé∞Âú®ÁöÑ seconds_behind_masterÔºåÂ¶ÇÊûúÂ∞è‰∫éÊüê‰∏™ÂÄºÔºàÊØîÂ¶Ç 5 ÁßíÔºâÁªßÁª≠‰∏ã‰∏ÄÊ≠•ÔºåÂê¶ÂàôÊåÅÁª≠ÈáçËØïËøô‰∏ÄÊ≠•</li><li>Êää‰∏ªÂ∫ì A ÊîπÊàêÂè™ËØªÁä∂ÊÄÅÔºåÂç≥Êää readonly ËÆæÁΩÆ‰∏∫ true</li><li>Âà§Êñ≠Â§áÂ∫ì B ÁöÑ seconds_behind_master ÁöÑÂÄºÔºåÁõ¥Âà∞Ëøô‰∏™ÂÄºÂèòÊàê 0 ‰∏∫Ê≠¢ÔºàËØ•Ê≠•È™§ÊØîËæÉËÄóÊó∂ÔºåÊâÄ‰ª•Ê≠•È™§ 1 ‰∏≠Ë¶ÅÂ∞ΩÈáèÁ≠âÂæÖËØ•ÂÄºÂèòÂ∞èÔºâ</li><li>ÊääÂ§áÂ∫ì B ÊîπÊàêÂèØËØªÂÜôÁä∂ÊÄÅÔºå‰πüÂ∞±ÊòØÊää readonly ËÆæÁΩÆ‰∏∫ false</li><li>Êää‰∏öÂä°ËØ∑Ê±ÇÂàáÂà∞Â§áÂ∫ì B</li></ul><p>ÂèØÁî®ÊÄß‰ºòÂÖàÁ≠ñÁï•ÔºöÂÖàÂÅöÊúÄÂêé‰∏§Ê≠•Ôºå‰ºöÈÄ†Êàê‰∏ªÂ§áÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÁöÑÈóÆÈ¢ò</p><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://time.geekbang.org/column/article/76795</p><hr><h4 id="ÂÅ•Â∫∑Ê£ÄÊµã" tabindex="-1"><a class="header-anchor" href="#ÂÅ•Â∫∑Ê£ÄÊµã"><span>ÂÅ•Â∫∑Ê£ÄÊµã</span></a></h4><p>‰∏ªÂ∫ìÂèëÁîüÊïÖÈöúÂêé‰ªéÂ∫ì‰ºö‰∏ä‰ΩçÔºå<strong>ÂÖ∂‰ªñ‰ªéÂ∫ìÊåáÂêëÊñ∞ÁöÑ‰∏ªÂ∫ì</strong>ÔºåÊâÄ‰ª•ÈúÄË¶Å‰∏Ä‰∏™ÂÅ•Â∫∑Ê£ÄÊµãÁöÑÊú∫Âà∂Êù•Âà§Êñ≠‰∏ªÂ∫ìÊòØÂê¶ÂÆïÊú∫</p><ul><li><p>select 1 Âà§Êñ≠Ôºå‰ΩÜÊòØÈ´òÂπ∂Âèë‰∏ãÊ£ÄÊµã‰∏çÂá∫Á∫øÁ®ãÁöÑÈîÅÁ≠âÂæÖÁöÑÈòªÂ°ûÈóÆÈ¢ò</p></li><li><p>Êü•Ë°®Âà§Êñ≠ÔºåÂú®Á≥ªÁªüÂ∫ìÔºàmysql Â∫ìÔºâÈáåÂàõÂª∫‰∏Ä‰∏™Ë°®ÔºåÊØîÂ¶ÇÂëΩÂêç‰∏∫ health_checkÔºåÈáåÈù¢Âè™Êîæ‰∏ÄË°åÊï∞ÊçÆÔºåÁÑ∂ÂêéÂÆöÊúüÊâßË°å„ÄÇ‰ΩÜÊòØÂΩì binlog ÊâÄÂú®Á£ÅÁõòÁöÑÁ©∫Èó¥Âç†Áî®ÁéáËææÂà∞ 100%ÔºåÊâÄÊúâÁöÑÊõ¥Êñ∞Âíå‰∫ãÂä°Êèê‰∫§ËØ≠Âè•ÈÉΩË¢´ÈòªÂ°ûÔºåÊü•ËØ¢ËØ≠Âè•ÂèØ‰ª•ÁªßÁª≠ËøêË°å</p></li><li><p>Êõ¥Êñ∞Âà§Êñ≠ÔºåÂú®ÂÅ•Â∫∑Ê£ÄÊµãË°®‰∏≠Êîæ‰∏Ä‰∏™ timestamp Â≠óÊÆµÔºåÁî®Êù•Ë°®Á§∫ÊúÄÂêé‰∏ÄÊ¨°ÊâßË°åÊ£ÄÊµãÁöÑÊó∂Èó¥</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>UPDATE mysql.health_check SET t_modified=now();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ËäÇÁÇπÂèØÁî®ÊÄßÁöÑÊ£ÄÊµãÈÉΩÂ∫îËØ•ÂåÖÂê´‰∏ªÂ∫ìÂíåÂ§áÂ∫ìÔºå‰∏∫‰∫ÜËÆ©‰∏ªÂ§á‰πãÈó¥ÁöÑÊõ¥Êñ∞‰∏ç‰∫ßÁîüÂÜ≤Á™ÅÔºåÂèØ‰ª•Âú® mysql.health_check Ë°®‰∏äÂ≠òÂÖ•Â§öË°åÊï∞ÊçÆÔºåÂπ∂Áî®‰∏ªÂ§áÁöÑ server_id ÂÅö‰∏ªÈîÆÔºå‰øùËØÅ‰∏ª„ÄÅÂ§áÂ∫ìÂêÑËá™ÁöÑÊ£ÄÊµãÂëΩ‰ª§‰∏ç‰ºöÂèëÁîüÂÜ≤Á™Å</p></li></ul><hr><h4 id="Âü∫‰∫é‰ΩçÁÇπ" tabindex="-1"><a class="header-anchor" href="#Âü∫‰∫é‰ΩçÁÇπ"><span>Âü∫‰∫é‰ΩçÁÇπ</span></a></h4><p>‰∏ªÂ∫ì‰∏ä‰ΩçÂêéÔºå‰ªéÂ∫ì B ÊâßË°å CHANGE MASTER TO ÂëΩ‰ª§ÔºåÊåáÂÆö MASTER_LOG_FILE„ÄÅMASTER_LOG_POS Ë°®Á§∫‰ªéÊñ∞‰∏ªÂ∫ì A ÁöÑÂì™‰∏™Êñá‰ª∂ÁöÑÂì™‰∏™‰ΩçÁÇπÂºÄÂßãÂêåÊ≠•ÔºåËøô‰∏™‰ΩçÁΩÆÂ∞±ÊòØ<strong>ÂêåÊ≠•‰ΩçÁÇπ</strong>ÔºåÂØπÂ∫î‰∏ªÂ∫ìÁöÑÊñá‰ª∂ÂêçÂíåÊó•ÂøóÂÅèÁßªÈáè</p><p>ÂØªÊâæ‰ΩçÁÇπÈúÄË¶ÅÊâæ‰∏Ä‰∏™Á®çÂæÆÂæÄÂâçÁöÑÔºåÁÑ∂ÂêéÂÜçÈÄöËøáÂà§Êñ≠Ë∑≥ËøáÈÇ£‰∫õÂú®‰ªéÂ∫ì B ‰∏äÂ∑≤ÁªèÊâßË°åËøáÁöÑ‰∫ãÂä°ÔºåËé∑Âèñ‰ΩçÁÇπÊñπÊ≥ïÔºö</p><ul><li>Á≠âÂæÖÊñ∞‰∏ªÂ∫ì A Êää‰∏≠ËΩ¨Êó•ÂøóÔºàrelay logÔºâÂÖ®ÈÉ®ÂêåÊ≠•ÂÆåÊàê</li><li>Âú® A ‰∏äÊâßË°å show master status ÂëΩ‰ª§ÔºåÂæóÂà∞ÂΩìÂâç A ‰∏äÊúÄÊñ∞ÁöÑ File Âíå Position</li><li>ÂèñÂéü‰∏ªÂ∫ìÊïÖÈöúÁöÑÊó∂Âàª TÔºåÁî® mysqlbinlog Â∑•ÂÖ∑Ëß£ÊûêÊñ∞‰∏ªÂ∫ì A ÁöÑ FileÔºåÂæóÂà∞ T Êó∂ÂàªÁöÑ‰ΩçÁÇπ</li></ul><p>ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãËØ•ÂÄºÂπ∂‰∏çÂáÜÁ°ÆÔºåÂú®ÂàáÊç¢ÁöÑËøáÁ®ã‰∏≠‰ºöÂèëÁîüÈîôËØØÔºåÊâÄ‰ª•Ë¶ÅÂÖà‰∏ªÂä®Ë∑≥ËøáËøô‰∫õÈîôËØØÔºö</p><ul><li><p>ÂàáÊç¢ËøáÁ®ã‰∏≠ÔºåÂèØËÉΩ‰ºöÈáçÂ§çÊâßË°å‰∏Ä‰∏™‰∫ãÂä°ÔºåÊâÄ‰ª•ÈúÄË¶Å‰∏ªÂä®Ë∑≥ËøáÊâÄÊúâÈáçÂ§çÁöÑ‰∫ãÂä°</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET GLOBAL sql_slave_skip_counter=1;</span></span>
<span class="line"><span>START SLAVE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ËÆæÁΩÆ slave_skip_errors ÂèÇÊï∞ÔºåÁõ¥Êé•ËÆæÁΩÆË∑≥ËøáÊåáÂÆöÁöÑÈîôËØØÔºå‰øùËØÅ‰∏ª‰ªéÂàáÊç¢ÁöÑÊ≠£Â∏∏ËøõË°å</p><ul><li>1062 ÈîôËØØÊòØÊèíÂÖ•Êï∞ÊçÆÊó∂ÂîØ‰∏ÄÈîÆÂÜ≤Á™Å</li><li>1032 ÈîôËØØÊòØÂà†Èô§Êï∞ÊçÆÊó∂Êâæ‰∏çÂà∞Ë°å</li></ul><p>ËØ•ÊñπÊ≥ïÈíàÂØπÁöÑÊòØ‰∏ªÂ§áÂàáÊç¢Êó∂ÔºåÁî±‰∫éÊâæ‰∏çÂà∞Á≤æÁ°ÆÁöÑÂêåÊ≠•‰ΩçÁÇπÔºåÂè™ËÉΩÈááÁî®ËøôÁßçÊñπÊ≥ïÊù•ÂàõÂª∫‰ªéÂ∫ìÂíåÊñ∞‰∏ªÂ∫ìÁöÑ‰∏ªÂ§áÂÖ≥Á≥ª„ÄÇÁ≠âÂà∞‰∏ªÂ§áÈó¥ÁöÑÂêåÊ≠•ÂÖ≥Á≥ªÂª∫Á´ãÂÆåÊàêÂπ∂Á®≥ÂÆöÊâßË°å‰∏ÄÊÆµÊó∂Èó¥ÂêéÔºåËøòÈúÄË¶ÅÊääËøô‰∏™ÂèÇÊï∞ËÆæÁΩÆ‰∏∫Á©∫Ôºå‰ª•ÂÖçÁúüÁöÑÂá∫Áé∞‰∫Ü‰∏ª‰ªéÊï∞ÊçÆ‰∏ç‰∏ÄËá¥‰πüË∑≥Ëøá‰∫Ü</p></li></ul><hr><h4 id="Âü∫‰∫égtid" tabindex="-1"><a class="header-anchor" href="#Âü∫‰∫égtid"><span>Âü∫‰∫éGTID</span></a></h4><h5 id="gtid" tabindex="-1"><a class="header-anchor" href="#gtid"><span>GTID</span></a></h5><p>GTID ÁöÑÂÖ®Áß∞ÊòØ Global Transaction IdentifierÔºåÂÖ®Â±Ä‰∫ãÂä° IDÔºåÊòØ‰∏Ä‰∏™‰∫ãÂä°<strong>Âú®Êèê‰∫§Êó∂ÁîüÊàê</strong>ÁöÑÔºåÊòØËøô‰∏™‰∫ãÂä°ÁöÑÂîØ‰∏ÄÊ†áËØÜÔºåÁªÑÊàêÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>GTID=source_id:transaction_id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>source_idÔºöÊòØ‰∏Ä‰∏™ÂÆû‰æãÁ¨¨‰∏ÄÊ¨°ÂêØÂä®Êó∂Ëá™Âä®ÁîüÊàêÁöÑÔºåÊòØ‰∏Ä‰∏™ÂÖ®Â±ÄÂîØ‰∏ÄÁöÑÂÄº</li><li>transaction_idÔºöÂàùÂßãÂÄºÊòØ 1ÔºåÊØèÊ¨°Êèê‰∫§‰∫ãÂä°ÁöÑÊó∂ÂÄôÂàÜÈÖçÁªôËøô‰∏™‰∫ãÂä°ÔºåÂπ∂Âä† 1ÔºåÊòØËøûÁª≠ÁöÑÔºàÂå∫ÂàÜ‰∫ãÂä° IDÔºå‰∫ãÂä° ID ÊòØÂú®ÊâßË°åÊó∂ÁîüÊàêÔºâ</li></ul><p>ÂêØÂä® MySQL ÂÆû‰æãÊó∂ÔºåÂä†‰∏äÂèÇÊï∞ <code>gtid_mode=on</code> Âíå <code>enforce_gtid_consistency=on</code> Â∞±ÂèØ‰ª•ÂêØÂä® GTID Ê®°ÂºèÔºåÊØè‰∏™‰∫ãÂä°ÈÉΩ‰ºöÂíå‰∏Ä‰∏™ GTID ‰∏Ä‰∏ÄÂØπÂ∫îÔºåÊØè‰∏™ MySQL ÂÆû‰æãÈÉΩÁª¥Êä§‰∫Ü‰∏Ä‰∏™ GTID ÈõÜÂêàÔºåÁî®Êù•Â≠òÂÇ®ÂΩìÂâçÂÆû‰æã<strong>ÊâßË°åËøáÁöÑÊâÄÊúâ‰∫ãÂä°</strong></p><p>GTID Êúâ‰∏§ÁßçÁîüÊàêÊñπÂºèÔºå‰ΩøÁî®Âì™ÁßçÊñπÂºèÂèñÂÜ≥‰∫é session ÂèòÈáè gtid_nextÔºö</p><ul><li><p><code>gtid_next=automatic</code>Ôºö‰ΩøÁî®ÈªòËÆ§ÂÄºÔºåÊää source_id:transaction_id ÔºàÈÄíÂ¢ûÔºâÂàÜÈÖçÁªôËøô‰∏™‰∫ãÂä°ÔºåÁÑ∂ÂêéÂä†ÂÖ•Êú¨ÂÆû‰æãÁöÑ GTID ÈõÜÂêà</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>@@SESSION.GTID_NEXT = &#39;source_id:transaction_id&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><code>gtid_next=GTID</code>ÔºöÊåáÂÆöÁöÑ GTID ÁöÑÂÄºÔºåÂ¶ÇÊûúËØ•ÂÄºÂ∑≤ÁªèÂ≠òÂú®‰∫éÂÆû‰æãÁöÑ GTID ÈõÜÂêà‰∏≠ÔºåÊé•‰∏ãÊù•ÊâßË°åÁöÑ‰∫ãÂä°‰ºöÁõ¥Êé•Ë¢´Á≥ªÁªüÂøΩÁï•ÔºõÂèç‰πãÂ∞±Â∞ÜËØ•ÂÄºÂàÜÈÖçÁªôÊé•‰∏ãÊù•Ë¶ÅÊâßË°åÁöÑ‰∫ãÂä°ÔºåÁ≥ªÁªü‰∏çÈúÄË¶ÅÁªôËøô‰∏™‰∫ãÂä°ÁîüÊàêÊñ∞ÁöÑ GTIDÔºå‰πü‰∏çÁî®Âä† 1</p><p>Ê≥®ÊÑèÔºö‰∏Ä‰∏™ GTID Âè™ËÉΩÁªô‰∏Ä‰∏™‰∫ãÂä°‰ΩøÁî®ÔºåÊâÄ‰ª•ÊâßË°å‰∏ã‰∏Ä‰∏™‰∫ãÂä°ÔºåË¶ÅÊää gtid_next ËÆæÁΩÆÊàêÂè¶Â§ñ‰∏Ä‰∏™ GTID ÊàñËÄÖ automatic</p></li></ul><p>‰∏öÂä°Âú∫ÊôØÔºö</p><ul><li><p>‰∏ªÂ∫ì X Âíå‰ªéÂ∫ì Y ÊâßË°å‰∏ÄÊù°Áõ∏ÂêåÁöÑÊåá‰ª§ÂêéËøõË°å‰∫ãÂä°ÂêåÊ≠•</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>INSERT INTO t VALUES(1,1);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÂΩì Y ÂêåÊ≠• X Êó∂Ôºå‰ºöÂá∫Áé∞‰∏ªÈîÆÂÜ≤Á™ÅÔºåÂØºËá¥ÂÆû‰æã X ÁöÑÂêåÊ≠•Á∫øÁ®ãÂÅúÊ≠¢ÔºåËß£ÂÜ≥ÊñπÊ≥ïÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SET gtid_next=&#39;(ËøôÈáåÊòØ‰∏ªÂ∫ì X ÁöÑ GTID ÂÄº)&#39;;</span></span>
<span class="line"><span>BEGIN;</span></span>
<span class="line"><span>COMMIT;</span></span>
<span class="line"><span>SET gtid_next=automatic;</span></span>
<span class="line"><span>START SLAVE;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Ââç‰∏âÊù°ËØ≠Âè•ÈÄöËøá<strong>Êèê‰∫§‰∏Ä‰∏™Á©∫‰∫ãÂä°</strong>ÔºåÊää X ÁöÑ GTID Âä†Âà∞ÂÆû‰æã Y ÁöÑ GTID ÈõÜÂêà‰∏≠ÔºåÂÆû‰æã Y Â∞±‰ºöÁõ¥Êé•Ë∑≥ËøáËøô‰∏™‰∫ãÂä°</p></li></ul><hr><h5 id="ÂàáÊç¢" tabindex="-1"><a class="header-anchor" href="#ÂàáÊç¢"><span>ÂàáÊç¢</span></a></h5><p>Âú® GTID Ê®°Âºè‰∏ãÔºåCHANGE MASTER TO ‰∏çÈúÄË¶ÅÊåáÂÆöÊó•ÂøóÂêçÂíåÊó•ÂøóÂÅèÁßªÈáèÔºåÊåáÂÆö <code>master_auto_position=1</code> ‰ª£Ë°®‰ΩøÁî® GTID Ê®°Âºè</p><p>Êñ∞‰∏ªÂ∫ìÂÆû‰æã A ÁöÑ GTID ÈõÜÂêàËÆ∞‰∏∫ set_aÔºå‰ªéÂ∫ìÂÆû‰æã B ÁöÑ GTID ÈõÜÂêàËÆ∞‰∏∫ set_bÔºå‰∏ªÂ§áÂàáÊç¢ÈÄªËæëÔºö</p><ul><li>ÂÆû‰æã B ÊåáÂÆö‰∏ªÂ∫ì AÔºåÂü∫‰∫é‰∏ªÂ§áÂçèËÆÆÂª∫Á´ãËøûÊé•ÔºåÂÆû‰æã B Âπ∂Êää set_b ÂèëÁªô‰∏ªÂ∫ì A</li><li>ÂÆû‰æã A ÁÆóÂá∫ set_a ‰∏é set_b ÁöÑÂ∑ÆÈõÜÔºåÂ∞±ÊòØÊâÄÊúâÂ≠òÂú®‰∫é set_a ‰ΩÜ‰∏çÂ≠òÂú®‰∫é set_b ÁöÑ GTID ÁöÑÈõÜÂêàÔºåÂà§Êñ≠ A Êú¨Âú∞ÊòØÂê¶ÂåÖÂê´‰∫ÜËøô‰∏™<strong>Â∑ÆÈõÜ</strong>ÈúÄË¶ÅÁöÑÊâÄÊúâ binlog ‰∫ãÂä° <ul><li>Â¶ÇÊûú‰∏çÂåÖÂê´ÔºåË°®Á§∫ A Â∑≤ÁªèÊääÂÆû‰æã B ÈúÄË¶ÅÁöÑ binlog ÁªôÂà†Êéâ‰∫ÜÔºåÁõ¥Êé•ËøîÂõûÈîôËØØ</li><li>Â¶ÇÊûúÁ°ÆËÆ§ÂÖ®ÈÉ®ÂåÖÂê´ÔºåA ‰ªéËá™Â∑±ÁöÑ binlog Êñá‰ª∂ÈáåÈù¢ÔºåÊâæÂá∫Á¨¨‰∏Ä‰∏™‰∏çÂú® set_b ÁöÑ‰∫ãÂä°ÔºåÂèëÁªô B</li></ul></li><li>ÂÆû‰æã A ‰πãÂêéÂ∞±‰ªéËøô‰∏™‰∫ãÂä°ÂºÄÂßãÔºåÂæÄÂêéËØªÊñá‰ª∂ÔºåÊåâÈ°∫Â∫èÂèñ binlog ÂèëÁªô B ÂéªÊâßË°å</li></ul><p>ÂèÇËÄÉÊñáÁ´†Ôºöhttps://time.geekbang.org/column/article/77427</p><hr><h2 id="Êó•Âøó" tabindex="-1"><a class="header-anchor" href="#Êó•Âøó"><span>Êó•Âøó</span></a></h2><h3 id="Êó•ÂøóÂàÜÁ±ª" tabindex="-1"><a class="header-anchor" href="#Êó•ÂøóÂàÜÁ±ª"><span>Êó•ÂøóÂàÜÁ±ª</span></a></h3><p>Âú®‰ªª‰Ωï‰∏ÄÁßçÊï∞ÊçÆÂ∫ì‰∏≠ÔºåÈÉΩ‰ºöÊúâÂêÑÁßçÂêÑÊ†∑ÁöÑÊó•ÂøóÔºåËÆ∞ÂΩïÁùÄÊï∞ÊçÆÂ∫ìÂ∑•‰ΩúÁöÑËøáÁ®ãÔºåÂèØ‰ª•Â∏ÆÂä©Êï∞ÊçÆÂ∫ìÁÆ°ÁêÜÂëòËøΩË∏™Êï∞ÊçÆÂ∫ìÊõæÁªèÂèëÁîüËøáÁöÑÂêÑÁßç‰∫ã‰ª∂</p><p>MySQLÊó•Âøó‰∏ªË¶ÅÂåÖÊã¨ÂÖ≠ÁßçÔºö</p><ol><li>ÈáçÂÅöÊó•ÂøóÔºàredo logÔºâ</li><li>ÂõûÊªöÊó•ÂøóÔºàundo logÔºâ</li><li>ÂΩíÊ°£Êó•ÂøóÔºàbinlogÔºâÔºà‰∫åËøõÂà∂Êó•ÂøóÔºâ</li><li>ÈîôËØØÊó•ÂøóÔºàerrorlogÔºâ</li><li>ÊÖ¢Êü•ËØ¢Êó•ÂøóÔºàslow query logÔºâ</li><li>‰∏ÄËà¨Êü•ËØ¢Êó•ÂøóÔºàgeneral logÔºâ</li><li>‰∏≠ÁªßÊó•ÂøóÔºàrelay logÔºâ</li></ol><hr><h3 id="ÈîôËØØÊó•Âøó" tabindex="-1"><a class="header-anchor" href="#ÈîôËØØÊó•Âøó"><span>ÈîôËØØÊó•Âøó</span></a></h3><p>ÈîôËØØÊó•ÂøóÊòØ MySQL ‰∏≠ÊúÄÈáçË¶ÅÁöÑÊó•Âøó‰πã‰∏ÄÔºåËÆ∞ÂΩï‰∫ÜÂΩì mysqld ÂêØÂä®ÂíåÂÅúÊ≠¢Êó∂Ôºå‰ª•ÂèäÊúçÂä°Âô®Âú®ËøêË°åËøáÁ®ã‰∏≠ÂèëÁîü‰ªª‰Ωï‰∏•ÈáçÈîôËØØÊó∂ÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ„ÄÇÂΩìÊï∞ÊçÆÂ∫ìÂá∫Áé∞‰ªª‰ΩïÊïÖÈöúÂØºËá¥Êó†Ê≥ïÊ≠£Â∏∏‰ΩøÁî®Êó∂ÔºåÂèØ‰ª•È¶ñÂÖàÊü•ÁúãÊ≠§Êó•Âøó</p><p>ËØ•Êó•ÂøóÊòØÈªòËÆ§ÂºÄÂêØÁöÑÔºåÈªòËÆ§‰ΩçÁΩÆÊòØÔºö<code>/var/log/mysql/error.log</code></p><p>Êü•ÁúãÊåá‰ª§Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SHOW VARIABLES LIKE &#39;log_error%&#39;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Êü•ÁúãÊó•ÂøóÂÜÖÂÆπÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /var/log/mysql/error.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h3 id="ÂΩíÊ°£Êó•Âøó" tabindex="-1"><a class="header-anchor" href="#ÂΩíÊ°£Êó•Âøó"><span>ÂΩíÊ°£Êó•Âøó</span></a></h3><h4 id="Âü∫Êú¨‰ªãÁªç-10" tabindex="-1"><a class="header-anchor" href="#Âü∫Êú¨‰ªãÁªç-10"><span>Âü∫Êú¨‰ªãÁªç</span></a></h4><p>ÂΩíÊ°£Êó•ÂøóÔºàBINLOGÔºâ‰πüÂè´‰∫åËøõÂà∂Êó•ÂøóÔºåÊòØÂõ†‰∏∫ÈááÁî®‰∫åËøõÂà∂ËøõË°åÂ≠òÂÇ®ÔºåËÆ∞ÂΩï‰∫ÜÊâÄÊúâÁöÑ DDLÔºàÊï∞ÊçÆÂÆö‰πâËØ≠Ë®ÄÔºâËØ≠Âè•Âíå DMLÔºàÊï∞ÊçÆÊìç‰ΩúËØ≠Ë®ÄÔºâËØ≠Âè•Ôºå‰ΩÜ<strong>‰∏çÂåÖÊã¨Êï∞ÊçÆÊü•ËØ¢ËØ≠Âè•ÔºåÂú®‰∫ãÂä°Êèê‰∫§ÂâçÁöÑÊúÄÂêéÈò∂ÊÆµÂÜôÂÖ•</strong></p><p>‰ΩúÁî®Ôºö<strong>ÁÅæÈöæÊó∂ÁöÑÊï∞ÊçÆÊÅ¢Â§çÂíå MySQL ÁöÑ‰∏ª‰ªéÂ§çÂà∂</strong></p><p>ÂΩíÊ°£Êó•ÂøóÈªòËÆ§ÊÉÖÂÜµ‰∏ãÊòØÊ≤°ÊúâÂºÄÂêØÁöÑÔºåÈúÄË¶ÅÂú® MySQL ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÂºÄÂêØÔºåÂπ∂ÈÖçÁΩÆ MySQL Êó•ÂøóÁöÑÊ†ºÂºèÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> /etc/mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> my.cnf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ÈÖçÁΩÆÂºÄÂêØbinlogÊó•ÂøóÔºå Êó•ÂøóÁöÑÊñá‰ª∂ÂâçÁºÄ‰∏∫ mysqlbin -----&gt; ÁîüÊàêÁöÑÊñá‰ª∂ÂêçÂ¶Ç: mysqlbin.000001</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">log_bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mysqlbin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ÈÖçÁΩÆ‰∫åËøõÂà∂Êó•ÂøóÁöÑÊ†ºÂºè</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">binlog_format</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">STATEMENT</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Êó•ÂøóÂ≠òÊîæ‰ΩçÁΩÆÔºöÈÖçÁΩÆÊó∂ÁªôÂÆö‰∫ÜÊñá‰ª∂Âêç‰ΩÜÊòØÊ≤°ÊúâÊåáÂÆöË∑ØÂæÑÔºåÊó•ÂøóÈªòËÆ§ÂÜôÂÖ•MySQL ÁöÑÊï∞ÊçÆÁõÆÂΩï</p><p>Êó•ÂøóÊ†ºÂºèÔºö</p><ul><li><p>STATEMENTÔºöËØ•Êó•ÂøóÊ†ºÂºèÂú®Êó•ÂøóÊñá‰ª∂‰∏≠ËÆ∞ÂΩïÁöÑÈÉΩÊòØ <strong>SQL ËØ≠Âè•</strong>ÔºåÊØè‰∏ÄÊù°ÂØπÊï∞ÊçÆËøõË°å‰øÆÊîπÁöÑ SQL ÈÉΩ‰ºöËÆ∞ÂΩïÂú®Êó•ÂøóÊñá‰ª∂‰∏≠ÔºåÈÄöËøá mysqlbinlog Â∑•ÂÖ∑ÔºåÂèØ‰ª•Êü•ÁúãÂà∞ÊØèÊù°ËØ≠Âè•ÁöÑÊñáÊú¨„ÄÇ‰∏ª‰ªéÂ§çÂà∂Êó∂Ôºå‰ªéÂ∫ì‰ºöÂ∞ÜÊó•ÂøóËß£Êûê‰∏∫ÂéüËØ≠Âè•ÔºåÂπ∂Âú®‰ªéÂ∫ìÈáçÊñ∞ÊâßË°å‰∏ÄÈÅç</p><p>Áº∫ÁÇπÔºöÂèØËÉΩ‰ºöÂØºËá¥‰∏ªÂ§á‰∏ç‰∏ÄËá¥ÔºåÂõ†‰∏∫ËÆ∞ÂΩïÁöÑ SQL Âú®‰∏çÂêåÁöÑÁéØÂ¢É‰∏≠ÂèØËÉΩÈÄâÊã©ÁöÑÁ¥¢Âºï‰∏çÂêåÔºåÂØºËá¥ÁªìÊûú‰∏çÂêå</p></li><li><p>ROWÔºöËØ•Êó•ÂøóÊ†ºÂºèÂú®Êó•ÂøóÊñá‰ª∂‰∏≠ËÆ∞ÂΩïÁöÑÊòØÊØè‰∏ÄË°åÁöÑ<strong>Êï∞ÊçÆÂèòÊõ¥</strong>ÔºåËÄå‰∏çÊòØËÆ∞ÂΩï SQL ËØ≠Âè•„ÄÇÊØîÂ¶ÇÊâßË°å SQL ËØ≠Âè• <code>update tb_book set status=&#39;1&#39;</code>ÔºåÂ¶ÇÊûúÊòØ STATEMENTÔºåÂú®Êó•Âøó‰∏≠‰ºöËÆ∞ÂΩï‰∏ÄË°å SQL ËØ≠Âè•Ôºõ Â¶ÇÊûúÊòØ ROWÔºåÁî±‰∫éÊòØÂØπÂÖ®Ë°®ËøõË°åÊõ¥Êñ∞ÔºåÂ∞±ÊòØÊØè‰∏ÄË°åËÆ∞ÂΩïÈÉΩ‰ºöÂèëÁîüÂèòÊõ¥ÔºåROW Ê†ºÂºèÁöÑÊó•Âøó‰∏≠‰ºöËÆ∞ÂΩïÊØè‰∏ÄË°åÁöÑÊï∞ÊçÆÂèòÊõ¥</p><p>Áº∫ÁÇπÔºöËÆ∞ÂΩïÁöÑÊï∞ÊçÆÊØîËæÉÂ§öÔºåÂç†Áî®ÂæàÂ§öÁöÑÂ≠òÂÇ®Á©∫Èó¥</p></li><li><p>MIXEDÔºöËøôÊòØ MySQL ÈªòËÆ§ÁöÑÊó•ÂøóÊ†ºÂºèÔºåÊ∑∑Âêà‰∫ÜSTATEMENT Âíå ROW ‰∏§ÁßçÊ†ºÂºèÔºåMIXED Ê†ºÂºèËÉΩÂ∞ΩÈáèÂà©Áî®‰∏§ÁßçÊ®°ÂºèÁöÑ‰ºòÁÇπÔºåËÄåÈÅøÂºÄÂÆÉ‰ª¨ÁöÑÁº∫ÁÇπ</p></li></ul><hr><h4 id="Êó•ÂøóÂà∑Áõò-1" tabindex="-1"><a class="header-anchor" href="#Êó•ÂøóÂà∑Áõò-1"><span>Êó•ÂøóÂà∑Áõò</span></a></h4><p>‰∫ãÂä°ÊâßË°åËøáÁ®ã‰∏≠ÔºåÂÖàÂ∞ÜÊó•ÂøóÂÜôÔºàwriteÔºâÂà∞ binlog cacheÔºå‰∫ãÂä°Êèê‰∫§Êó∂ÂÜçÊää binlog cache ÂÜôÔºàfsyncÔºâÂà∞ binlog Êñá‰ª∂‰∏≠Ôºå‰∏Ä‰∏™‰∫ãÂä°ÁöÑ binlog ÊòØ‰∏çËÉΩË¢´ÊãÜÂºÄÁöÑÔºåÊâÄ‰ª•‰∏çËÆ∫Ëøô‰∏™‰∫ãÂä°Â§öÂ§ß‰πüË¶ÅÁ°Æ‰øù‰∏ÄÊ¨°ÊÄßÂÜôÂÖ•</p><p>‰∫ãÂä°Êèê‰∫§Êó∂ÊâßË°åÂô®Êää binlog cache ÈáåÁöÑÂÆåÊï¥‰∫ãÂä°ÂÜôÂÖ•Âà∞ binlog ‰∏≠ÔºåÂπ∂Ê∏ÖÁ©∫ binlog cache</p><p>write Âíå fsync ÁöÑÊó∂Êú∫Áî±ÂèÇÊï∞ sync_binlog ÊéßÂà∂ÁöÑÔºö</p><ul><li>sync_binlog=0ÔºöË°®Á§∫ÊØèÊ¨°Êèê‰∫§‰∫ãÂä°ÈÉΩÂè™ writeÔºå‰∏ç fsync</li><li>sync_binlog=1ÔºöË°®Á§∫ÊØèÊ¨°Êèê‰∫§‰∫ãÂä°ÈÉΩ‰ºöÊâßË°å fsync</li><li>sync_binlog=N(N&gt;1)ÔºöË°®Á§∫ÊØèÊ¨°Êèê‰∫§‰∫ãÂä°ÈÉΩ writeÔºå‰ΩÜÁ¥ØÁßØ N ‰∏™‰∫ãÂä°ÂêéÊâç fsyncÔºå‰ΩÜÊòØÂ¶ÇÊûú‰∏ªÊú∫ÂèëÁîüÂºÇÂ∏∏ÈáçÂêØÔºå‰ºö‰∏¢Â§±ÊúÄËøë N ‰∏™‰∫ãÂä°ÁöÑ binlog Êó•Âøó</li></ul><hr><h4 id="Êó•ÂøóËØªÂèñ" tabindex="-1"><a class="header-anchor" href="#Êó•ÂøóËØªÂèñ"><span>Êó•ÂøóËØªÂèñ</span></a></h4><p>Êó•ÂøóÊñá‰ª∂Â≠òÂÇ®‰ΩçÁΩÆÔºö/var/lib/mysql</p><p>Áî±‰∫éÊó•Âøó‰ª•‰∫åËøõÂà∂ÊñπÂºèÂ≠òÂÇ®Ôºå‰∏çËÉΩÁõ¥Êé•ËØªÂèñÔºåÈúÄË¶ÅÁî® mysqlbinlog Â∑•ÂÖ∑Êù•Êü•ÁúãÔºåËØ≠Ê≥ïÂ¶Ç‰∏ãÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqlbinlog</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> log-file</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Êü•Áúã STATEMENT Ê†ºÂºèÊó•ÂøóÔºö</p><ul><li><p>ÊâßË°åÊèíÂÖ•ËØ≠Âè•Ôºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>INSERT INTO tb_book VALUES(NULL,&#39;Lucene&#39;,&#39;2088-05-01&#39;,&#39;0&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><code>cd /var/lib/mysql</code>Ôºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">      177</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5Êúà</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  23</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 21:08</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysqlbin.000001</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">-rw-r-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">       18</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 5Êúà</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  23</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 21:04</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysqlbin.index</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>mysqlbin.indexÔºöËØ•Êñá‰ª∂ÊòØÊó•ÂøóÁ¥¢ÂºïÊñá‰ª∂ Ôºå ËÆ∞ÂΩïÊó•ÂøóÁöÑÊñá‰ª∂ÂêçÔºõ</p><p>mysqlbing.000001ÔºöÊó•ÂøóÊñá‰ª∂</p></li><li><p>Êü•ÁúãÊó•ÂøóÂÜÖÂÆπÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqlbinlog</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mysqlbing.000001</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Êó•ÂøóËØªÂèñ1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Êó•ÂøóÁªìÂ∞æÊúâ COMMIT</p></li></ul><p>Êü•Áúã ROW Ê†ºÂºèÊó•ÂøóÔºö</p><ul><li><p>‰øÆÊîπÈÖçÁΩÆÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ÈÖçÁΩÆ‰∫åËøõÂà∂Êó•ÂøóÁöÑÊ†ºÂºè</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">binlog_format</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ROW</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ÊèíÂÖ•Êï∞ÊçÆÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>INSERT INTO tb_book VALUES(NULL,&#39;SpringCloudÂÆûÊàò&#39;,&#39;2088-05-05&#39;,&#39;0&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Êü•ÁúãÊó•ÂøóÂÜÖÂÆπÔºöÊó•ÂøóÊ†ºÂºè ROWÔºåÁõ¥Êé•Êü•ÁúãÊï∞ÊçÆÊòØ‰π±Á†ÅÔºåÂèØ‰ª•Âú® mysqlbinlog ÂêéÈù¢Âä†‰∏äÂèÇÊï∞ -vv</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>mysqlbinlog -vv mysqlbin.000002</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Êó•ÂøóËØªÂèñ2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><hr><h4 id="Êó•ÂøóÂà†Èô§" tabindex="-1"><a class="header-anchor" href="#Êó•ÂøóÂà†Èô§"><span>Êó•ÂøóÂà†Èô§</span></a></h4><p>ÂØπ‰∫éÊØîËæÉÁπÅÂøôÁöÑÁ≥ªÁªüÔºåÁîüÊàêÊó•ÂøóÈáèÂ§ßÔºåËøô‰∫õÊó•ÂøóÂ¶ÇÊûúÈïøÊó∂Èó¥‰∏çÊ∏ÖÈô§ÔºåÂ∞Ü‰ºöÂç†Áî®Â§ßÈáèÁöÑÁ£ÅÁõòÁ©∫Èó¥ÔºåÈúÄË¶ÅÂà†Èô§Êó•Âøó</p><ul><li><p>Reset Master Êåá‰ª§Âà†Èô§ÂÖ®ÈÉ® binlog Êó•ÂøóÔºåÂà†Èô§‰πãÂêéÔºåÊó•ÂøóÁºñÂè∑Â∞Ü‰ªé xxxx.000001ÈáçÊñ∞ÂºÄÂßã</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>Reset Master	-- MySQLÊåá‰ª§</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>ÊâßË°åÊåá‰ª§ <code>PURGE MASTER LOGS TO &#39;mysqlbin.***</code>ÔºåËØ•ÂëΩ‰ª§Â∞ÜÂà†Èô§ <code> ***</code> ÁºñÂè∑‰πãÂâçÁöÑÊâÄÊúâÊó•Âøó</p></li><li><p>ÊâßË°åÊåá‰ª§ <code>PURGE MASTER LOGS BEFORE &#39;yyyy-mm-dd hh:mm:ss&#39;</code> ÔºåËØ•ÂëΩ‰ª§Â∞ÜÂà†Èô§Êó•Âøó‰∏∫ <code>yyyy-mm-dd hh:mm:ss</code> ‰πãÂâç‰∫ßÁîüÁöÑÊó•Âøó</p></li><li><p>ËÆæÁΩÆÂèÇÊï∞ <code>--expire_logs_days=#</code>ÔºåÊ≠§ÂèÇÊï∞ÁöÑÂê´‰πâÊòØËÆæÁΩÆÊó•ÂøóÁöÑËøáÊúüÂ§©Êï∞ÔºåËøá‰∫ÜÊåáÂÆöÁöÑÂ§©Êï∞ÂêéÊó•ÂøóÂ∞Ü‰ºöË¢´Ëá™Âä®Âà†Èô§ÔºåËøôÊ†∑ÂÅöÊúâÂà©‰∫éÂáèÂ∞ëÁÆ°ÁêÜÊó•ÂøóÁöÑÂ∑•‰ΩúÈáèÔºåÈÖçÁΩÆ my.cnf Êñá‰ª∂Ôºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">log_bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mysqlbin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">binlog_format</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ROW</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">--expire_logs_days</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h4 id="Êï∞ÊçÆÊÅ¢Â§ç-1" tabindex="-1"><a class="header-anchor" href="#Êï∞ÊçÆÊÅ¢Â§ç-1"><span>Êï∞ÊçÆÊÅ¢Â§ç</span></a></h4><p>ËØØÂà†Â∫ìÊàñËÄÖË°®Êó∂ÔºåÈúÄË¶ÅÊ†πÊçÆ binlog ËøõË°åÊï∞ÊçÆÊÅ¢Â§ç</p><p>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÊï∞ÊçÆÂ∫ìÊúâÂÆöÊó∂ÁöÑÂÖ®ÈáèÂ§á‰ªΩÔºåÂÅáÂ¶ÇÊØèÂ§© 0 ÁÇπÂÆöÊó∂Â§á‰ªΩÔºå12 ÁÇπËØØÂà†‰∫ÜÂ∫ìÔºåÊÅ¢Â§çÊµÅÁ®ãÔºö</p><ul><li>ÂèñÊúÄËøë‰∏ÄÊ¨°ÂÖ®ÈáèÂ§á‰ªΩÔºåÁî®Â§á‰ªΩÊÅ¢Â§çÂá∫‰∏Ä‰∏™‰∏¥Êó∂Â∫ì</li><li>‰ªéÊó•ÂøóÊñá‰ª∂‰∏≠ÂèñÂá∫ÂáåÊô® 0 ÁÇπ‰πãÂêéÁöÑÊó•Âøó</li><li>ÊääÈô§‰∫ÜËØØÂà†Èô§Êï∞ÊçÆÁöÑËØ≠Âè•Â§ñÊó•ÂøóÔºåÂÖ®ÈÉ®Â∫îÁî®Âà∞‰∏¥Êó∂Â∫ì</li></ul><p>Ë∑≥ËøáËØØÂà†Èô§ËØ≠Âè•Êó•ÂøóÁöÑÊñπÊ≥ïÔºö</p><ul><li>Â¶ÇÊûúÂéüÂÆû‰æãÊ≤°Êúâ‰ΩøÁî® GTID Ê®°ÂºèÔºåÂè™ËÉΩÂú®Â∫îÁî®Âà∞ÂåÖÂê´ 12 ÁÇπÁöÑ binlog Êñá‰ª∂ÁöÑÊó∂ÂÄôÔºåÂÖàÁî® ‚Äìstop-position ÂèÇÊï∞ÊâßË°åÂà∞ËØØÊìç‰Ωú‰πãÂâçÁöÑÊó•ÂøóÔºåÁÑ∂ÂêéÂÜçÁî® ‚Äìstart-position ‰ªéËØØÊìç‰Ωú‰πãÂêéÁöÑÊó•ÂøóÁªßÁª≠ÊâßË°å</li><li>Â¶ÇÊûúÂÆû‰æã‰ΩøÁî®‰∫Ü GTID Ê®°ÂºèÔºåÂÅáËÆæËØØÊìç‰ΩúÂëΩ‰ª§ÁöÑ GTID ÊòØ gtid1ÔºåÈÇ£‰πàÂè™ÈúÄË¶ÅÊèê‰∫§‰∏Ä‰∏™Á©∫‰∫ãÂä°ÂÖàÂ∞ÜËøô‰∏™ GTID Âä†Âà∞‰∏¥Êó∂ÂÆû‰æãÁöÑ GTID ÈõÜÂêàÔºå‰πãÂêéÊåâÈ°∫Â∫èÊâßË°å binlog ÁöÑÊó∂Â∞±‰ºöËá™Âä®Ë∑≥ËøáËØØÊìç‰ΩúÁöÑËØ≠Âè•</li></ul><hr><h3 id="Êü•ËØ¢Êó•Âøó" tabindex="-1"><a class="header-anchor" href="#Êü•ËØ¢Êó•Âøó"><span>Êü•ËØ¢Êó•Âøó</span></a></h3><p>Êü•ËØ¢Êó•Âøó‰∏≠ËÆ∞ÂΩï‰∫ÜÂÆ¢Êà∑Á´ØÁöÑÊâÄÊúâÊìç‰ΩúËØ≠Âè•ÔºåËÄå‰∫åËøõÂà∂Êó•Âøó‰∏çÂåÖÂê´Êü•ËØ¢Êï∞ÊçÆÁöÑ SQL ËØ≠Âè•</p><p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊü•ËØ¢Êó•ÂøóÊòØÊú™ÂºÄÂêØÁöÑ„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂºÄÂêØÊü•ËØ¢Êó•ÂøóÔºåÈÖçÁΩÆ my.cnfÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ËØ•ÈÄâÈ°πÁî®Êù•ÂºÄÂêØÊü•ËØ¢Êó•ÂøóÔºåÂèØÈÄâÂÄº0ÊàñËÄÖ1Ôºå0‰ª£Ë°®ÂÖ≥Èó≠Ôºå1‰ª£Ë°®ÂºÄÂêØ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">general_log</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ËÆæÁΩÆÊó•ÂøóÁöÑÊñá‰ª∂ÂêçÔºåÂ¶ÇÊûúÊ≤°ÊúâÊåáÂÆöÔºåÈªòËÆ§ÁöÑÊñá‰ª∂Âêç‰∏∫host_name.logÔºåÂ≠òÊîæÂú®/var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">general_log_file</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mysql_query.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ÈÖçÁΩÆÂÆåÊØï‰πãÂêéÔºåÂú®Êï∞ÊçÆÂ∫ìÊâßË°å‰ª•‰∏ãÊìç‰ΩúÔºö</p><div class="language-mysql line-numbers-mode" data-highlighter="shiki" data-ext="mysql" data-title="mysql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span>SELECT * FROM tb_book;</span></span>
<span class="line"><span>SELECT * FROM tb_book WHERE id = 1;</span></span>
<span class="line"><span>UPDATE tb_book SET name = &#39;luceneÂÖ•Èó®ÊåáÂçó&#39; WHERE id = 5;</span></span>
<span class="line"><span>SELECT * FROM tb_book WHERE id &lt; 8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ÊâßË°åÂÆåÊØï‰πãÂêéÔºå ÂÜçÊ¨°Êù•Êü•ËØ¢Êó•ÂøóÊñá‰ª∂Ôºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-Êü•ËØ¢Êó•Âøó.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h3 id="ÊÖ¢Êó•Âøó" tabindex="-1"><a class="header-anchor" href="#ÊÖ¢Êó•Âøó"><span>ÊÖ¢Êó•Âøó</span></a></h3><p>ÊÖ¢Êü•ËØ¢Êó•ÂøóËÆ∞ÂΩïÊâÄÊúâÊâßË°åÊó∂Èó¥Ë∂ÖËøá long_query_time Âπ∂‰∏îÊâ´ÊèèËÆ∞ÂΩïÊï∞‰∏çÂ∞è‰∫é min_examined_row_limit ÁöÑÊâÄÊúâÁöÑ SQL ËØ≠Âè•ÁöÑÊó•Âøólong_query_time ÈªòËÆ§‰∏∫ 10 ÁßíÔºåÊúÄÂ∞è‰∏∫ 0Ôºå Á≤æÂ∫¶Âà∞ÂæÆÁßí</p><p>ÊÖ¢Êü•ËØ¢Êó•ÂøóÈªòËÆ§ÊòØÂÖ≥Èó≠ÁöÑÔºåÂèØ‰ª•ÈÄöËøá‰∏§‰∏™ÂèÇÊï∞Êù•ÊéßÂà∂ÊÖ¢Êü•ËØ¢Êó•ÂøóÔºåÈÖçÁΩÆÊñá‰ª∂ <code>/etc/mysql/my.cnf</code>Ôºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ËØ•ÂèÇÊï∞Áî®Êù•ÊéßÂà∂ÊÖ¢Êü•ËØ¢Êó•ÂøóÊòØÂê¶ÂºÄÂêØÔºåÂèØÈÄâÂÄº0ÊàñËÄÖ1Ôºå0‰ª£Ë°®ÂÖ≥Èó≠Ôºå1‰ª£Ë°®ÂºÄÂêØ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">slow_query_log</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ËØ•ÂèÇÊï∞Áî®Êù•ÊåáÂÆöÊÖ¢Êü•ËØ¢Êó•ÂøóÁöÑÊñá‰ª∂ÂêçÔºåÂ≠òÊîæÂú® /var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">slow_query_log_file</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">slow_query.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># ËØ•ÈÄâÈ°πÁî®Êù•ÈÖçÁΩÆÊü•ËØ¢ÁöÑÊó∂Èó¥ÈôêÂà∂ÔºåË∂ÖËøáËøô‰∏™Êó∂Èó¥Â∞ÜËÆ§‰∏∫ÂÄºÊÖ¢Êü•ËØ¢ÔºåÂ∞ÜÈúÄË¶ÅËøõË°åÊó•ÂøóËÆ∞ÂΩïÔºåÈªòËÆ§10s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">long_query_time</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">10</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Êó•ÂøóËØªÂèñÔºö</p><ul><li><p>Áõ¥Êé•ÈÄöËøá cat Êåá‰ª§Êü•ËØ¢ËØ•Êó•ÂøóÊñá‰ª∂Ôºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slow_query.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ÊÖ¢Êó•ÂøóËØªÂèñ1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>Â¶ÇÊûúÊÖ¢Êü•ËØ¢Êó•ÂøóÂÜÖÂÆπÂæàÂ§öÔºåÁõ¥Êé•Êü•ÁúãÊñá‰ª∂ÊØîËæÉÁπÅÁêêÔºåÂèØ‰ª•ÂÄüÂä© mysql Ëá™Â∏¶ÁöÑ mysqldumpslow Â∑•ÂÖ∑ÂØπÊÖ¢Êü•ËØ¢Êó•ÂøóËøõË°åÂàÜÁ±ªÊ±áÊÄªÔºö</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysqldumpslow</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> slow_query.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/MySQL-ÊÖ¢Êó•ÂøóËØªÂèñ2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ul><hr><h2 id="ËåÉÂºè" tabindex="-1"><a class="header-anchor" href="#ËåÉÂºè"><span>ËåÉÂºè</span></a></h2><h3 id="Á¨¨‰∏ÄËåÉÂºè" tabindex="-1"><a class="header-anchor" href="#Á¨¨‰∏ÄËåÉÂºè"><span>Á¨¨‰∏ÄËåÉÂºè</span></a></h3><p>Âª∫Á´ãÁßëÂ≠¶ÁöÑÔºå<strong>ËßÑËåÉÁöÑÊï∞ÊçÆË°®</strong>Â∞±ÈúÄË¶ÅÊª°Ë∂≥‰∏Ä‰∫õËßÑÂàôÊù•‰ºòÂåñÊï∞ÊçÆÁöÑËÆæËÆ°ÂíåÂ≠òÂÇ®ÔºåËøô‰∫õËßÑÂàôÂ∞±Áß∞‰∏∫ËåÉÂºè</p><p>**1NFÔºö**Êï∞ÊçÆÂ∫ìË°®ÁöÑÊØè‰∏ÄÂàóÈÉΩÊòØ‰∏çÂèØÂàÜÂâ≤ÁöÑÂéüÂ≠êÊï∞ÊçÆÈ°πÔºå‰∏çËÉΩÊòØÈõÜÂêà„ÄÅÊï∞ÁªÑÁ≠âÈùûÂéüÂ≠êÊï∞ÊçÆÈ°π„ÄÇÂç≥Ë°®‰∏≠ÁöÑÊüê‰∏™ÂàóÊúâÂ§ö‰∏™ÂÄºÊó∂ÔºåÂøÖÈ°ªÊãÜÂàÜ‰∏∫‰∏çÂêåÁöÑÂàó„ÄÇÁÆÄËÄåË®Ä‰πãÔºå<strong>Á¨¨‰∏ÄËåÉÂºèÊØè‰∏ÄÂàó‰∏çÂèØÂÜçÊãÜÂàÜÔºåÁß∞‰∏∫ÂéüÂ≠êÊÄß</strong></p><p>Âü∫Êú¨Ë°®Ôºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/ÊôÆÈÄöË°®.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Á¨¨‰∏ÄËåÉÂºèË°®Ôºö</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Á¨¨‰∏ÄËåÉÂºè.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h3 id="Á¨¨‰∫åËåÉÂºè" tabindex="-1"><a class="header-anchor" href="#Á¨¨‰∫åËåÉÂºè"><span>Á¨¨‰∫åËåÉÂºè</span></a></h3><p>**2NFÔºö**Âú®Êª°Ë∂≥Á¨¨‰∏ÄËåÉÂºèÁöÑÂü∫Á°Ä‰∏äÔºåÈùû‰∏ªÂ±ûÊÄßÂÆåÂÖ®‰æùËµñ‰∫é‰∏ªÁ†ÅÔºà‰∏ªÂÖ≥ÈîÆÂ≠ó„ÄÅ‰∏ªÈîÆÔºâÔºåÊ∂àÈô§Èùû‰∏ªÂ±ûÊÄßÂØπ‰∏ªÁ†ÅÁöÑÈÉ®ÂàÜÂáΩÊï∞‰æùËµñ„ÄÇÁÆÄËÄåË®Ä‰πãÔºå<strong>Ë°®‰∏≠ÁöÑÊØè‰∏Ä‰∏™Â≠óÊÆµ ÔºàÊâÄÊúâÂàóÔºâÈÉΩÂÆåÂÖ®‰æùËµñ‰∫é‰∏ªÈîÆÔºåËÆ∞ÂΩïÁöÑÂîØ‰∏ÄÊÄß</strong></p><p>‰ΩúÁî®ÔºöÈÅµÂÆàÁ¨¨‰∫åËåÉÂºèÂáèÂ∞ëÊï∞ÊçÆÂÜó‰ΩôÔºåÈÄöËøá‰∏ªÈîÆÂå∫ÂàÜÁõ∏ÂêåÊï∞ÊçÆ„ÄÇ</p><ol><li>ÂáΩÊï∞‰æùËµñÔºöA ‚Üí BÔºåÂ¶ÇÊûúÈÄöËøá A Â±ûÊÄß(Â±ûÊÄßÁªÑ)ÁöÑÂÄºÔºåÂèØ‰ª•Á°ÆÂÆöÂîØ‰∏Ä B Â±ûÊÄßÁöÑÂÄºÔºåÂàôÁß∞ B ‰æùËµñ‰∫é A <ul><li>Â≠¶Âè∑ ‚Üí ÂßìÂêçÔºõ(Â≠¶Âè∑ÔºåËØæÁ®ãÂêçÁß∞) ‚Üí ÂàÜÊï∞</li></ul></li><li>ÂÆåÂÖ®ÂáΩÊï∞‰æùËµñÔºöA ‚Üí BÔºåÂ¶ÇÊûúAÊòØ‰∏Ä‰∏™Â±ûÊÄßÁªÑÔºåÂàô B Â±ûÊÄßÂÄºÁöÑÁ°ÆÂÆöÈúÄË¶Å‰æùËµñ‰∫é A Â±ûÊÄßÁªÑÁöÑÊâÄÊúâÂ±ûÊÄßÂÄº <ul><li>(Â≠¶Âè∑ÔºåËØæÁ®ãÂêçÁß∞) ‚Üí ÂàÜÊï∞</li></ul></li><li>ÈÉ®ÂàÜÂáΩÊï∞‰æùËµñÔºöA ‚Üí BÔºåÂ¶ÇÊûú A ÊòØ‰∏Ä‰∏™Â±ûÊÄßÁªÑÔºåÂàô B Â±ûÊÄßÂÄºÁöÑÁ°ÆÂÆöÂè™ÈúÄË¶Å‰æùËµñ‰∫é A Â±ûÊÄßÁªÑÁöÑÊüê‰∫õÂ±ûÊÄßÂÄº <ul><li>(Â≠¶Âè∑ÔºåËØæÁ®ãÂêçÁß∞) ‚Üí ÂßìÂêç</li></ul></li><li>‰º†ÈÄíÂáΩÊï∞‰æùËµñÔºöA ‚Üí BÔºåB ‚Üí CÔºåÂ¶ÇÊûúÈÄöËøáAÂ±ûÊÄß(Â±ûÊÄßÁªÑ)ÁöÑÂÄºÔºåÂèØ‰ª•Á°ÆÂÆöÂîØ‰∏Ä B Â±ûÊÄßÁöÑÂÄºÔºåÂú®ÈÄöËøá B Â±ûÊÄß(Â±ûÊÄßÁªÑ)ÁöÑÂÄºÔºåÂèØ‰ª•Á°ÆÂÆöÂîØ‰∏Ä C Â±ûÊÄßÁöÑÂÄºÔºåÂàôÁß∞ C ‰º†ÈÄíÂáΩÊï∞‰æùËµñ‰∫é A <ul><li>Â≠¶Âè∑ ‚Üí Á≥ªÂêçÔºåÁ≥ªÂêç ‚Üí Á≥ª‰∏ª‰ªª</li></ul></li><li>Á†ÅÔºöÂ¶ÇÊûúÂú®‰∏ÄÂº†Ë°®‰∏≠Ôºå‰∏Ä‰∏™Â±ûÊÄßÊàñÂ±ûÊÄßÁªÑÔºåË¢´ÂÖ∂‰ªñÊâÄÊúâÂ±ûÊÄßÊâÄÂÆåÂÖ®‰æùËµñÔºåÂàôÁß∞Ëøô‰∏™Â±ûÊÄß(Â±ûÊÄßÁªÑ)‰∏∫ËØ•Ë°®ÁöÑÁ†Å <ul><li>ËØ•Ë°®‰∏≠ÁöÑÁ†ÅÔºö(Â≠¶Âè∑ÔºåËØæÁ®ãÂêçÁß∞)</li><li>‰∏ªÂ±ûÊÄßÔºöÁ†ÅÂ±ûÊÄßÁªÑ‰∏≠ÁöÑÊâÄÊúâÂ±ûÊÄß</li><li>Èùû‰∏ªÂ±ûÊÄßÔºöÈô§Á†ÅÂ±ûÊÄßÁªÑ‰ª•Â§ñÁöÑÂ±ûÊÄß</li></ul></li></ol><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Á¨¨‰∫åËåÉÂºè.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h3 id="Á¨¨‰∏âËåÉÂºè" tabindex="-1"><a class="header-anchor" href="#Á¨¨‰∏âËåÉÂºè"><span>Á¨¨‰∏âËåÉÂºè</span></a></h3><p>**3NFÔºö**Âú®Êª°Ë∂≥Á¨¨‰∫åËåÉÂºèÁöÑÂü∫Á°Ä‰∏äÔºåË°®‰∏≠ÁöÑ‰ªª‰ΩïÂ±ûÊÄß‰∏ç‰æùËµñ‰∫éÂÖ∂ÂÆÉÈùû‰∏ªÂ±ûÊÄßÔºåÊ∂àÈô§‰º†ÈÄí‰æùËµñ„ÄÇÁÆÄËÄåË®Ä‰πãÔºå<strong>Èùû‰∏ªÈîÆÈÉΩÁõ¥Êé•‰æùËµñ‰∫é‰∏ªÈîÆÔºåËÄå‰∏çÊòØÈÄöËøáÂÖ∂ÂÆÉÁöÑÈîÆÊù•Èó¥Êé•‰æùËµñ‰∫é‰∏ªÈîÆ</strong>„ÄÇ</p><p>‰ΩúÁî®ÔºöÂèØ‰ª•ÈÄöËøá‰∏ªÈîÆ id Âå∫ÂàÜÁõ∏ÂêåÊï∞ÊçÆÔºå‰øÆÊîπÊï∞ÊçÆÁöÑÊó∂ÂÄôÂè™ÈúÄË¶Å‰øÆÊîπ‰∏ÄÂº†Ë°®ÔºàÊñπ‰æø‰øÆÊîπÔºâÔºåÂèç‰πãÈúÄË¶Å‰øÆÊîπÂ§öË°®„ÄÇ</p><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/Á¨¨‰∏âËåÉÂºè.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><hr><h3 id="ÊÄªÁªì" tabindex="-1"><a class="header-anchor" href="#ÊÄªÁªì"><span>ÊÄªÁªì</span></a></h3><figure><img src="https://jackchen-note.oss-cn-beijing.aliyuncs.com/Java/mysql/‰∏âÂ§ßËåÉÂºè.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/skxndbzu/JackChenBlogs/edit/main/src/posts/Êï∞ÊçÆÂ∫ì/MySQL.md" aria-label="Âú® GitHub ‰∏äÁºñËæëÊ≠§È°µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Âú® GitHub ‰∏äÁºñËæëÊ≠§È°µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">‰∏äÊ¨°ÁºñËæë‰∫é: </span><!----></div><div class="contributors"><span class="vp-meta-label">Ë¥°ÁåÆËÄÖ: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 615880048@qq.com">ÈôàÈì≠Èπ§</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/elasticsearch.html" aria-label="elasticsearch"><div class="hint"><span class="arrow start"></span>‰∏ä‰∏ÄÈ°µ</div><div class="link"><span class="font-icon icon iconfont icon-pen-to-square" style=""></span>elasticsearch</div></a><a class="route-link auto-link next" href="/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/" aria-label="Redis"><div class="hint">‰∏ã‰∏ÄÈ°µ<span class="arrow end"></span></div><div class="link">Redis<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">ÂçÉÈáå‰πãË°å Âßã‰∫éË∂≥‰∏ã</div><div class="vp-copyright">Copyright ¬© 2024 Jack-Chen </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BYKnUcUk.js" defer></script>
  </body>
</html>
